{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Introduction to WeeWX \u00b6 The WeeWX weather system is written in Python and runs on Linux, MacOSX, Solaris, and *BSD. It collects data from many types of weather stations and sensors, then generates plots, HTML pages, and monthly and yearly summary reports. It can push plots, pages, and reports to a web server, and data to many online weather services. Initial development began in the winter of 2008-2009, with the first release in 2009. WeeWX is about 25,000 lines of code, plus another 15,000 for the hardware drivers. The source code is hosted on GitHub . Installation instructions and releases are available at weewx.com/downloads . See the hardware list for a complete list of supported stations, and for pictures to help identify your hardware! The hardware comparison shows specifications for many types of hardware, including some not yet supported by WeeWX. The WeeWX distribution includes drivers for many types of hardware. These are listed in the driver list in the Hardware Guide . See the WeeWX Wiki for additional drivers and other extensions. Installation \u00b6 See the section Installing WeeWX in the User's Guide . Documentation \u00b6 WeeWX includes extensive documentation, and the WeeWX developers work hard to keep it relevant and up to date. If you have questions, please consult the documentation first. User's Guide - installation, getting started, where to find things, backup/restore, troubleshooting Customization Guide - instructions for customizing reports and plots, localization, formatting, writing extensions Utilities Guide - tools to manage stations, reports, and data Hardware Guide - how to configure hardware, features of supported hardware Upgrade Guide - detailed changes in each release Reference - application options, skin options, definition of units and unit systems Notes for developers - things you should know if you write drivers or skins Support \u00b6 Please first try to solve any problems yourself by reading the documentation. If that fails, check the answers to frequently-asked questions, browse the latest guides and software in the WeeWX Wiki, or post a question to the WeeWX user group. FAQ \u00b6 The Frequently Asked Questions (FAQ) is contributed by WeeWX users. It contains pointers to more information for problems and questions most frequently asked in the WeeWX forums. https://github.com/weewx/weewx/wiki/WeeWX-Frequently-Asked-Questions Wiki \u00b6 The wiki content is contributed by WeeWX users. It contains suggestions and experiences with different types of hardware, skins, extensions to WeeWX, and other useful tips and tricks. https://github.com/weewx/weewx/wiki Forums \u00b6 weewx-user is for general issues such as installation, sharing skins and templates, reporting unexpected behavior, and suggestions for improvement. weewx-development is for discussions about developing drivers, extensions, or working on the core code. Licensing and Copyright \u00b6 WeeWX is licensed under the GNU Public License v3. \u00a9 Copyright 2009-2023 Thomas Keffer, Matthew Wall, and Gary Roderick","title":"Overview"},{"location":"#introduction-to-weewx","text":"The WeeWX weather system is written in Python and runs on Linux, MacOSX, Solaris, and *BSD. It collects data from many types of weather stations and sensors, then generates plots, HTML pages, and monthly and yearly summary reports. It can push plots, pages, and reports to a web server, and data to many online weather services. Initial development began in the winter of 2008-2009, with the first release in 2009. WeeWX is about 25,000 lines of code, plus another 15,000 for the hardware drivers. The source code is hosted on GitHub . Installation instructions and releases are available at weewx.com/downloads . See the hardware list for a complete list of supported stations, and for pictures to help identify your hardware! The hardware comparison shows specifications for many types of hardware, including some not yet supported by WeeWX. The WeeWX distribution includes drivers for many types of hardware. These are listed in the driver list in the Hardware Guide . See the WeeWX Wiki for additional drivers and other extensions.","title":"Introduction to WeeWX"},{"location":"#installation","text":"See the section Installing WeeWX in the User's Guide .","title":"Installation"},{"location":"#documentation","text":"WeeWX includes extensive documentation, and the WeeWX developers work hard to keep it relevant and up to date. If you have questions, please consult the documentation first. User's Guide - installation, getting started, where to find things, backup/restore, troubleshooting Customization Guide - instructions for customizing reports and plots, localization, formatting, writing extensions Utilities Guide - tools to manage stations, reports, and data Hardware Guide - how to configure hardware, features of supported hardware Upgrade Guide - detailed changes in each release Reference - application options, skin options, definition of units and unit systems Notes for developers - things you should know if you write drivers or skins","title":"Documentation"},{"location":"#support","text":"Please first try to solve any problems yourself by reading the documentation. If that fails, check the answers to frequently-asked questions, browse the latest guides and software in the WeeWX Wiki, or post a question to the WeeWX user group.","title":"Support"},{"location":"#faq","text":"The Frequently Asked Questions (FAQ) is contributed by WeeWX users. It contains pointers to more information for problems and questions most frequently asked in the WeeWX forums. https://github.com/weewx/weewx/wiki/WeeWX-Frequently-Asked-Questions","title":"FAQ"},{"location":"#wiki","text":"The wiki content is contributed by WeeWX users. It contains suggestions and experiences with different types of hardware, skins, extensions to WeeWX, and other useful tips and tricks. https://github.com/weewx/weewx/wiki","title":"Wiki"},{"location":"#forums","text":"weewx-user is for general issues such as installation, sharing skins and templates, reporting unexpected behavior, and suggestions for improvement. weewx-development is for discussions about developing drivers, extensions, or working on the core code.","title":"Forums"},{"location":"#licensing-and-copyright","text":"WeeWX is licensed under the GNU Public License v3. \u00a9 Copyright 2009-2023 Thomas Keffer, Matthew Wall, and Gary Roderick","title":"Licensing and Copyright"},{"location":"changes/","text":"WeeWX change history \u00b6 5.0.0 MM/DD/YYYY \u00b6 Python 2.7 is no longer supported. You must have Python 3.7 (introduced May 2018) or greater. WeeWX can now be installed using pip . With pip installs, station data is stored in ~/weewx-data by default, instead of /home/weewx . This allows pip installs to be done without root privileges. However, /home/weewx can still be used. The new utility weectl replaces wee_database , wee_debug , wee_device , wee_extension , and wee_config . Try weectl --help to see how to use it. Documentation now uses MkDocs . Package installs now use systemd instead of the old System V /etc/init.d . Removed all references to the deprecated package distutils , which is due to be removed in Python v3.12. Removed the utility wunderfixer . The Weather Underground seems to no longer allow posting past-dated records. Logging handler rotate has been removed. Its need to access the privileged location /var/log/ on start up would cause crashes, even if it was never used. Users can opt to add it back in by following the wiki on Logging . MacOS now logs to syslog like any other system, rather than rotate . Method ImageDraw.textsize() and constants ImageFont.LAYOUT_BASIC , and Image.ANTIALIAS were deprecated in Pillow 9.2 (1-Jul-2022), then removed in Pillow 10.0 (1-Jul-2023). V5.0 replaces them with alternatives. Fixes issue #884 . Fix bug when using Pillow v9.5.0. Fixes issue #862 . The Standard skin now uses the font DejaVuSansMono-Bold and includes a copy. Before, it had to rely on hardwired font paths, which were less reliable. If the uploaders get a response code of 429 (\"TOO MANY REQUESTS\"), they no longer bother trying again. Limit station registration to once a day, max. Station registration now uses HTTP POST, instead of HTTP GET. Station registration is delayed by a random length of time to avoid everyone hitting the server at the same time. Fix problem where aggregation of null wind directions returns 90\u00b0 instead of null. Fixes issue #849 . Fix wrong station type for Vantage weectl device --info query. Add retransmit information for Vantage weectl device --info query. Fix problem when setting Vantage repeater. Fixes issue #863 . Detect \"dash\" values for rain-related measurements on Vantage stations. Change aggregations minsumtime and maxsumtime to return start-of-day, rather than the time of max rainfall during the day. Relax requirement that column dateTime be the first column in the database. Fixes issue #855 . Allow aggregation of xtypes that are not in the database schema. Fixes issue #864 . Tag suffix has_data() now works for xtypes. Fixes issue #877 . Additional shorthand notations for aggregation and trend intervals. For example, 3h for three hours. Accumulator firstlast no longer coerces values to a string. Thanks to user \"Karen\" for spotting this! Fix problem that caused crashes with firstlast accumulator type. Fixes issue #876 . Fixed problem that prevented the astrometric heliocentric longitude of a body from being calculated properly. Default format for azimuth properties (such as wind direction) is now zero padded 3 digits. E.g., 005\u00b0 instead of 5\u00b0 . Most almanac properties are now returned as ValueHelpers , so they will obey local formatting conventions (in particular, decimal separators). To avoid breaking old skins, these properties now have new names. For example, use $almanac.venus.altitude instead of $almanac.venus.alt . Fix problem that prevented database from getting hit when calculating pressure . Fixes issue #875 . Fix problem that prevented option stale_age from being honored in image generation. Thanks to user Ian for PR #879 ! Fix problem that prevented complex aggregates such as max_ge from being used in plots. Fixes issue #881 . Updated humidex formula and reference. Fixes issue #883 . Fix bugs in the \"basic\" skin example. Fix bug that prevented calculating $trend when one of the two records is missing. Fix bug that caused the extension installer to crash if one of the service groups was missing in the configuration file. Fixes issue #886 . New option retry_wait . If weewxd encounters a critical error, it will sleep this long before doing a restart. Change from old Google Analytics UA code to the GA4 tag system in the Standard and Seasons skins. Fixes issue #892 . 4.10.2 02/22/2023 \u00b6 Removed errant \"f-string\" in imagegenerator.py . Added missing .long_form to celestial.inc that would cause total daylight to be given in seconds, instead of long form. Fix problem that a None value in long_form() would raise an exception. PR #843. Thanks to user Karen! The module user.extensions is now imported into wee_reports . Thanks to user jocelynj! PR #842. Fix problem that prevented wee_device --set-retransmit from working on Vantage stations. Using a bad data binding with an aggregation tag no longer results in an exception. Instead, it shows the tag in the results. Related to PR #817. 4.10.1 01/30/2023 \u00b6 Logging handler rotate has been removed. Its need to access privileged location /var/log/weewx.log on start up would cause crashes, even if it was never used. 4.10.0 01/29/2023 \u00b6 Don't inject txBatteryStatus and consBatteryVoltage into records in the Vantage driver. Let the accumulators do it. Fixes issue #802. Different wake-up strategy for the Vantage console. Do not write config_path and entry_path to updated configuration dictionary. Fixes issue #806. Allow more flexible formatting for delta times. This can break old skins. See Upgrade Guide. PR #807. Fix bug that prevents group_deltatime from being used by timespans. Users who used custom formatting for delta times will be affected. See the Upgrade Guide. Fixes issue #808. Add suffix .length to class TimespanBinder. This allows expressions such as $month.length. PR #809. Thanks to user Karen! Added new unit hertz . PR #812. Again, thanks to user Karen! Calculate *.wind.maxtime out of windGust like *.wind.max Fixes issue #833 Fix bug that prevents group_deltatime from being used by timespans. Users Add suffix .length to class TimespanBinder. This allows expressions such as Option line_gap_fraction can now be used with bar plots. Fixes issue #818. 4.9.1 10/25/2022 \u00b6 Fix problem with wind for older versions of sqlite. 4.9.0 10/24/2022 \u00b6 Fix problem that create 'ghost' values for VantageVue stations. Fix problem that causes leafWet3 and leafWet4 to be emitted in VP2 stations that do not have the necessary sensors. Fixes issue #771. Try waking the Vantage console before giving up on LOOP errors. Better Vantage diagnostics. Fixes issue #772. Add missing 30-day barometer graph to Smartphone skin. Fixes issue #774. Fix check for reuse_ssl for Python versions greater than 3.10. Fixes issue #775. The utility wee_reports can now be invoked by specifying a --date and --time . Fixes issue #776. Allow timestamps that are not integers. Fixes issue #779. Add localization file for Traditional Chinese. Thanks to user lyuxingliu! PR #777. Don't swallow syntax errors when wee_config is looking for drivers. Include wind in daily summary if windSpeed is present. Refine translations for French skin. Thanks to user Pascal! Allow a custom cipher to be specified for FTP uploads. See option cipher under [[FTP]] . Ensure that rundir exists and has correct permissions in weewx-multi Allow auto-provisioning feature of Seasons to work when using a SQL expression for option data_type in the ImageGenerator. Fixes issue #782. Allow constants albedo , cn , and cd to be specified when calculating ET. See the User's Guide. Resolves issue #730. Fix problem that prevented wee_reports from using a default location for weewx.conf . Post location of the configuration file and the top-level module to the station registry. Thanks to Vince! PR #705. Fix minor install warning under Python 3.10. Fixes issue #799. Fix problem where xtypes.ArchiveTable.get_series() does not pass option_dict on to get_aggregate() . Fixes issue #797 Added copytruncate option to default log rotation configuration. Thanks to user sastorsl. Addresses PR #791. Update the default and example rules in rsyslog configuration. The output from the weewx daemon goes to weewxd.log whereas the output from wee_xxx utilities goes to weewx.log . Also added examples of how to deal with systemd/journald messing with log output. Addresses PR #788 and PR #790. Thanks to user sastorsl. Allow additional aggregation intervals for observation type $wind . In particular, vecdir and vecavg can be done for aggregation intervals other than multiples of a day. Fixes issue #800. 4.8.0 04/21/2022 \u00b6 Allow unit to be overridden for a specific plot by using new option unit . Fixes issue #729. Fix problem that prevented wind from appearing in NOAA yearly summaries. Fix honoring global values for log_success and log_failure . Fix issue #757. wee_import CSV imports now allow import of text fields. Addresses issue #732. Explain in the Customization Guide how to include arbitrary SQL expressions in a plot. Reorder font download order, for slightly faster downloads. Fix issue #760. Add observation types highOutTemp and lowOutTemp to group_temperature. Add unit groups for sunshine and rain duration, cloudcover, and pop. PR #765 Do not allow HUP signals (reload is not allowed as of V4.6). PR #766. Do not fork if using systemd. PR #767. Fix problem that prevented wee_config --reconfigure from working when using Python 2.7, if the configuration file contained UTF-8 characters. 4.7.0 03/01/2022 \u00b6 Introduced new option generate_once . If True , templates will be generated only on the first run of the reporting engine. Thanks to user Rich! PR #748. Added option wee_device --current for Vantage. Fixed two typos in the Standard skin. Fixed spelling mistakes in the Norwegian translations. Thanks to Aslak! PR#746 Supply a sensible default context for group_deltatime when no context has been specified. If windGustDir is missing, extract a value from the accumulators. Fixed typo that shows itself if no [Labels]/[[Generic]] section is supplied. Fixes issue #752. Fixed calculation of field bar_reduction for Vantage type 2 LOOP packets. Fix problem that prevents windSpeed and windDir from being displayed in the RSS feed. Fixes issue #755. 4.6.2 02/10/2022 \u00b6 Removed diagnostic code that was inadverently left in the titlebar.inc file in Seasons skin. 4.6.1 02/10/2022 \u00b6 Make the show_rss and show_reports flags work properly. Fixes issue #739. Added $to_list() utility for use in Cheetah templates. Fixed a few more untranslated fields in Seasons skin. Observation types that use the sum extractor are set to None if no LOOP packets contributed to the accumulator. Fixes issue #737. Added ppm as default group_fraction . Added default label string for ppm . Added Norwegian translations. Thanks to user Aslak! PR #742. Fixed problem that caused wee_database --check-strings / --fix-strings to fail on TEXT fields. Fixes issue #738. 4.6.0 02/04/2022 \u00b6 Easy localization of all skins that come with WeeWX. Big thanks to user Karen, who drove the effort! PR #665. Allow options --date , --from , and --to to be used with wee_database --reweight . PR #659. Thanks to user edi-x! Added Cheetah helper functions $jsonize() , $rnd() , and $to_int() . The tag $alltime , formerly available as an example, is now a part of WeeWX core. New SLE example $colorize() . New document on how to write SLEs. Added conversions for unix_epoch_ms and unix_epoch_ns . Calculations in celestial.inc now explicitly use unix_epoch . Added almanac attribute visible and visible_change . For example, $almanac.sun.visible returns the amount of daylight, $almanac.sun.visible_change the difference since yesterday. Fixed problem that could cause weather xtypes services not to shut down properly. PR #672. Thanks again to user edi-x! Added Cheetah tag $filename , the relative path of the generated file. Useful for setting canonical URLs. PR #671. Thanks again to user Karen! XType get_scalar() and get_series() calls can now take extra keyword arguments. PR #673. Fixed problem where a bad clock packet could crash the WMR100 driver. Davis documentation for LOOP2 10-minute wind gusts is wrong. The Vantage actually emits mph, not tenths of mph. Changed driver so it now decodes the field correctly. Fixes issue #686. Sending a HUP signal to weewxd no longer causes the configuration file to be reread. Logging is not done until after the configuration file has been read. This allows customized logging to start from the very beginning. Fixes issue #699. Simplified the logging of Cheetah exceptions to show only what's relevant. Fixes issue #700. Include a requirements.txt file, for installing using pip. Thanks to user Cl\u00e9ment! PR #691. Fixed problem where ConfigObj interpolation would interfere with setting logging formats. Added option --batch-size to the Vantage version of wee_device . See PR #693. Slightly faster evaluation of the tag suffix has_data . New aggregation type not_null . A string in the database no longer raises an error. Fixes issue #695. Added plot option skip_if_empty . If set to True , and there is no non-null data in the plot, then the plot will not be generated at all. If set to a time domain (such as year ), then it will do the check over that domain. See PR #702. Parameterized the Seasons skin, making it considerably smaller, while requiring less configuration. It now includes all types found in the wview-extended schema. See PR #702. New FTP option ftp_encoding for oddball FTP servers that send their responses back in something other than UTF-8. Availability of the pyephem module and extended almanac data is now logged during startup. Added column for last contact in the sensor status table in the Season skin to help diagnose missing/flaky sensors. Fix the weewx.debian and weewx-multi init scripts to work with non-root user. Added sample tmpfiles configuration to ensure run directory on modern systems when running weewx as non-root user. Fixed bug that prevented the ssh port from being specified when using rsync. Fixes issue #725. Improved alphanumeric sorting of loop packet/archive record fields displayed when WeeWX is run directly. Added sample weewxd init file for 'service' based init on freebsd. Thanks to user ryan. Added i18n-report utility to help check skins for translated strings. 4.5.1 04/02/2021 \u00b6 Reverted the wview schema back to the V3 style. Fixed problem where setup.py would fail if the station description used UTF-8 characters. Fixed problem where unit labels would not render correctly under Python 2.7 if they were set by a 3rd party extension. Fixes issue #662. Added TCP support to the WS1 driver. Thanks to user Mike Juniper! Fixes issue #664. 4.5.0 04/02/2021 \u00b6 The utility wee_database has new options --add-column , --rename-column , and --drop-columns for adding, renaming, and deleting columns in the database. New optional tag .series() , for creating and formatting series in templates. See the document Tabs for series in the wiki. This is still experimental and subject to change! Addresses issue #341. New optional tag .json() for formatting results as JSON. New optional tag .round() . Useful for rounding results of .raw and .json options. Improved performance when calculating series using aggregation periods that are multiples of a day. Changed NOAA reports to use the normalized_ascii encoding instead of utf8 (which did not display correctly for most browsers). Fixes issue #646. Plots longer than 2 years use a 6 month time increment. Uploads to PWSWeather and WOW now use HTTPS. Fixes issue #650. Fixed bug that prevented the Vantage driver from waiting before a wakeup retry. Thanks to user Les Niles! Changed the way of expressing the old \"wview\" schema to the new V4 way. Hopefully, this will lead to fewer support issues. Fixes issue #651. Fixed problem where iterating over a time period without an aggregation would wrongly include the record on the left. Fixed bug that caused the incorrect label to be applied to plots where the aggregation type changes the unit. Fixes issue #654. Plots now locate the x-coordinate in the middle of the aggregation interval for all aggregation types (not just min, max, avg). Revisits PR #232. Added new time units unix_epoch_ms and unix_epoch_ns , which are unix epoch time in milliseconds and nanoseconds, respectively. The FTP uploader now calculates and saves a hash value for each uploaded file. If it does not change, the file is not uploaded, resulting in significant time savings. PR #655. Thanks to user Karen! Updated the version of six.py included with WeeWX to 1.15.0. Fixes issue #657. Option aggregate_interval can now be specified by using one of the \"shortcuts\", that is, hour , day , week , month , or year . Options log_success and log_failure are now honored by the StdArchive and StdQC services. Fixes issue #727. 4.4.0 01/30/2021 \u00b6 StdWXCalculate can now do calculations for only LOOP packets, only archive records, or both. PR #630. Thanks to user g-eddy! Introduced aggregate types avg_ge and avg_le . PR #631. Thanks to user edi-x! NOAA reports now use a utf8 encoding instead of strict_ascii . This will only affect new installations. Fixes issue #644. Introduced new encoding type normalized_ascii , which replaces characters that have accented marks with analogous ascii characters. For example, \u00f6 gets replaced with o. Patching process is more forgiving about records with interval less than or equal to zero. Fixed problem where invalid mintime or maxtime was returned for days with no data. Fixes issue #635. Syntax errors in weewx.conf are now logged. PR #637. Thanks to user Rich Bell! Fixed problem where plots could fail if the data range was outside of a specified axes range. Fixes issue #638. Fixed problem that could cause reporting to fail under Python2.7 if the configuration dictionary contained a comment with a UTF-8 character. Fixes issue #639. Fixed problem that could cause program to crash if asking for deltas of a non- existent key. The version 4.3.0 patch to fix the incorrect calculation of sums in the daily summary tables itself contained a bug. This version includes a patch to fix the problem. It runs once at startup. Fixes issue #642. 4.3.0 01/04/2020 \u00b6 Version 4.2.0 had a bug, which caused the sums in the daily summary to be incorrectly calculated. This version includes a patch to fix the problem. It runs once at startup. Fixes issue #623. The WMR200 driver is no longer supported. An unsupported version can be found at https://github.com/weewx/weewx-wmr200 . Support for LaCrosse WS23xx and Oregon WMR300 will continue. Service weewx.wxxtypes.StdDelta was inadvertently left out of the list of services to be run. Fortunately, it is not used. Yet. Added it back in. Added the \"old\" NWS algorithm as an option for calculating heat index. Changed how various undocumented parameters in [StdWXCalculate] are specified. The only one people are likely to have used is ignore_zero_wind . Its name has changed to force_null , and it has been moved. See the Upgrading Guide . Documented the various [StdWXCalculate] options. Fixed corner case for windDir when using software record generation, ignore_zero_wind=True , and windSpeed=0 for entire record interval. Now emits last windDir value. Fixed problem when looking up stars with more than one word in their name. Fixes issue #620. Fixed problem where wind gust direction is not available when using software record generation. Added --no-prompt action to wee_import , allowing wee_import to be run unattended. Fixed problem that prevented option observations from being used in the simulator. Thanks to user Graham! Fixed problem where wind chill was calculated incorrectly for METRICWX databases. PR #627. Thanks to user edi-x! Allow wind vectors to be converted to unit of beaufort. Fixes issue #629. Option log_failure under [StdReport] is set to True by the upgrade process. See the Upgrading Guide . 4.2.0 10/26/2020 \u00b6 CHANGES COMING! This is the last release that will support the LaCrosse WS23xx, Oregon WMR200 and WMR300 stations. In the future, they will be published as unsupported extensions. Made it easier to add new, derived types via StdWXCalculate . Fixes issue #491. Changed the tag system slightly in order to make it possible for the XTypes system to add new aggregations that take an argument. Added the new data types in the extended_wview schema to the WeeWX types system. Fixes issue #613. Added ability to label left, right or both y-axes of graphs. PR #610. Fixes issue #609. Thanks to user Brent Fraser! Added units and labels for the lightning data types. Fixed problem where threads attempt to access non-existent database. Fixes issue #579. Fixed problem that caused reporting units to revert to US if they were in a mixed unit system. Fixes issue #576. Fixed problem that could cause the station registry to fail if given a location with a non-ASCII location name. Changed TE923 bucket size from 0.02589 inches to 1/36 of an inch (0.02777778 in). PR #575. Fixes issue #574. Thanks to user Timothy! Undocumented option retry_certificate has been renamed to retry_ssl , and now covers all SSL errors (not just certificate errors). Fixes issue #569. Thanks to user Eric! Fixed problem caused by specifying a [Logging]/[[formatters]] section in weewx.conf that uses interpolated variables. Fixed problem in the Vantage driver that resulted in incorrect sunrise / sunset being included in loop packets when run under Python 3. Thanks to users Constantine and Jacques! Improved auto-scaling of plot axes. Fixed problem where aggregates of windvec and windgustvec returned the aggregate since start of day, not the start of the aggregation period. Fixes issue #590. New unit beaufort , included in group_speed . Treating beaufort as a separate type has been deprecated. Fixes issue #591. New unit kPa , included in group_pressure . Fixes issue #596. Fixed bug in the simulator. Made it easier to subclass class Simulator . Expressions in StdCalibration are now ordered. Later corrections can depend on earlier corrections. Fixed problem under Python 2, where option none could cause exception. PR #597. Thanks to user Cl\u00e9ment! Fixed problem with ws23xx driver under Python 3 that caused it to crash. Use a more modern formula for heat index. Fixes issue #601. Thanks to user Peter Q! Allow overriding the data binding when using iterators. Fixes issue #580. Fixed problem where old daily summaries may not have a version number. Fixed problem in WMR200 driver where missing UV reports as index 255. Added option force_direction for working around a WU bug. Fixes issue #614. Fixed problem where null bytes in an import data file would cause wee_import to fail. 4.1.1 06/01/2020 \u00b6 Fixed problem that caused wind speed to be reported to AWEKAS in m/s instead of km/h. Fixed problem that caused FTP attempts not to be retried. Fixed problem that caused monthly and yearly summaries to appear only sporadically. Fixed problem when using the ultimeter driver under Python 2. Fixed problem when using the ws1 driver under Python 2. Fixed problem that prevented remote directories from being created by FTP. New strategy for calculating system uptime under Python 3. Revisits issue #428. Alternative to PR #561. 4.1.0 05/25/2020 \u00b6 Archive records emitted by the Vantage driver now include the number of wind samples per archive interval in field wind_samples. wee_import can now import WeatherCat monthly .cat files. Changed the logging configuration dictionary to match the Python documents. Thanks to user Graham for figuring this out! Fixed problem that prevented ws1 driver from working under Python 3. PR #556. Eliminate use of logging in wee_config, allowing it to be used for installs without syslog. Allow expressions to be used as a datatype when plotting. Added option 'reuse_ssl' to FTP. This activates a workaround for a bug in the Python ftp library that causes long-lived connections to get closed prematurely. Works only with Python 3.6 and greater. The cc3000 driver will automatically reboot the hardware if it stops sending observations. PR #549. Install using setup.py forgot to set WEEWX_ROOT when installing in non-standard places. Fixes issue #546. Fixed bug in ws28xx driver that prevented it from running under Python 3. Fixes issue #543. Changed query strategy for calculating min and max wind vectors, which should result in much faster plot generation. Fixed bug in wmr9x8 driver that prevented it from running under Python 3. Fixed several bugs in the te923 driver that prevented it from running under Python 3. Added a logging handler for rotating files. See https://bit.ly/2StYSHb for how to use it. It is the default for macOS. More information if an exception is raised while querying for vantage hardware type. wunderfixer: fixed problem under Python 3 where response was not converted to str before attempting to parse the JSON. Option --simulate now requires api_key and password, so it can hit the WU. Fixed problem in te923 driver under Python 3 that caused it to crash. 4.0.0 04/30/2020 \u00b6 Ported to Python 3. WeeWX should now run under Python 3.5 and greater, as well as Python 2.7. Support for Python 2.5 and 2.6 has been dropped. New facility for creating new user-defined derived types. See the Wiki article https://github.com/weewx/weewx/wiki/WeeWX-V4-user-defined-types WeeWX now uses the Python 'logging' facility. This means log, formats, and other things can now be customized. Fixes issue #353. Strings appearing in the data stream no longer cause a TypeError if they can be converted to a number. Strings can now be accumulated and extracted in the accumulators, making it possible to include them in the database schemas. The utility wee_reports now loads services, allowing it to use user-supplied extensions. Fixes issue #95. New default schema (\"wview_extended\") that offers many new types. The old schema is still supported. Fixes issue #115. Optional, more flexible, way of specifying schemas for the daily summaries. The old way is still supported. The install process now offers to register a user's station with weewx.com. The package MySQL-python, which we used previously, is not always available on Python 3. Ported the MySQL code to use the package mysqlclient as an alternative. The default for WOW no longer throttles posting frequency (the default used to be no more than once every 15 minutes). Added new aggregate types minsum, minsumtime, sum_le. PR #382. Unit group group_distance is now a first-class group. Added new tag $python_version. Ported to Python2-PyMySQL package on OpenSUSE. Added new aggregation types 'first' (similar to 'last'), 'diff' (the difference between last and first value in the aggregation interval), and 'tderiv' (the difference divided by the time difference). Created new unit group 'group_energy2', defined as watt-seconds. Useful for high resolution energy monitors. An observation type known to the system, but not in a record, will now return a proper ValueTuple, rather than UnknownType. Type \"stormStart\" was added to the unit system. Fixes issue #380. Added new aggregation type 'growdeg'. Similar to 'heatdeg', or 'cooldeg', it measures growing degree-days. Basically, cooldeg, but with a different base. Fixes issue #367. Thanks to user Clay Jackson for guidance! Ported OS uptime to OpenBSD. Fixes issue #428. Thanks to user Jeff Ross! Catch SSL certificate errors in uploaders. Retry after an hour. Fixes issue #413. Wunderfixer has been ported to the new WU API. This API requires an API key, which you can get from WU. Put it in weewx.conf. Added option --upload-only. Thanks to user Leon Shaner! Fixes issues #414 and #445. Wee_import can now import Weather Display monthly log files. Fixed problem where sub-sections DegreeDays and Trend were located under the wrong weewx.conf section. Fixes issue #432. Thanks to user mph for spotting this! Added new parameters to the Weather Underground uploader. Fixes issue #435. Added new air quality types pm1_0, pm2_5, and pm10_0 to the unit system. Added new unit microgram_per_meter_cubed. Added new unit group, group_concentration. Plist for the Mac launcher now includes a log file for stderr. Night-day transition in plots now uses shortest travel distance around color wheel to minimize extra colors. Fixes issue #457. Thanks to user Alex Edwards! Fixed bug that causes plots to fail when both min and max are zero. Fixes issue #463. Fixed problem with sqlite driver that can lead to memory growth. See PR #467. Thanks to user Rich Bell! Fixed bug that caused windrun to be calculated wrongly under METRICWX unit system. Fixes issue #452. If a bad value of 'interval' is encountered in a record, the program will simply ignore it, rather than stopping. Address issue #375. Change in how the archive timespan is calculated in the engine. This allows oddball archive intervals. Fixes issue #469. NOAA reports are now more tolerant of missing data. Fixes issue #300. Use of strftime() date and time format codes in template file names is now supported as an alternative to the legacy 'YYYY', 'MM' and 'DD'. The legacy codes continue to be supported for backwards compatibility. Fixes issue #415. New --calc-missing action added to wee_database to calculate and store derived observations. wee_import now calculates missing derived observations once all imported data has been saved to archive. Fixes issue #443. wee_import now tolerates periods that contain no source data. Fixes issue #499. wee_import now accepts strings representing cardinal, intercardinal and secondary intercardinal directions in CSV imports. Partially fixes issue #238. The field delimiter character may now be defined for wee_import CSV imports. Ignore historical records if the timestamp is in the future. Can now recover from MariaDB-specific database connection error 1927. Changed the name of the unit \"litre\" to \"liter\", making its spelling more consistent with \"meter\". The spelling \"litre\" is still accepted. Systemd type changed from \"simple\" to \"forking\". Thanks to user Jaap de Munck for figuring this one out! The configuration file is now an optional argument. This means most users will be able to use the simple command line 'sudo weewxd'. Use correct log path for netbsd and openbsd in logger setup. StdWXCalculate no longer calculates anything by default. Instead, types to be calculated must be listed in weewx.conf. See the Upgrade Guide. setup.py install no longer saves the old 'bin' subdirectory. Instead, it simply overwrites it. Support for the vantage LOOP2 packet format. Fixes issue #374. The vantage driver now allows 3 retries per read, rather than per archive interval. 3.9.2 07/14/2019 \u00b6 StdPrint now explicitly converts loop and archive fields to UTF-8 before printing. This means unicode strings can now be included in loop and archive fields. Fix WMR300 driver so that it will reject (corrupt) logger records if they have negative interval (similar to issue #375). Added 'rain_warning' option in WMR300 driver to remind station owners to reset the rain counter when the rain counter exceeds a threshold (default is 90%). Thanks to weewx user Leon! Added several other debug tools to the WMR300 driver. PR #402. Wunderfixer now keeps going if a post does not satisfy [[Essentials]]. Fixes issue #329 (again). Fixed problem that prevented the wee_device --history option from working with the CC3000 driver. Fix incorrect log_success operation in ftp, rsync, copy and image generators. PR #373. Partial fix of issue #370. Fixed problem that could cause the WMR200 to crash WeeWX if the record interval is zero. Fixes issue #375. Posts to the Weather Underground now use https, instead of http. Thanks to user mljenkins! PR #378. Fixed problem with handling CWOP connection errors. Commit 0a21a72 Fixed problem that prevented to CopyGenerator from handling nested directories. Fixes issue #379. Fixed problem that prevented humidity calibration from being set on Vantage stations. Improved accuracy of the calculation of Moon phases. Revisits issue #342. When the AWEKAS code augments the record for rainRate, it now checks for a bad timestamp. The ts1 driver now returns 'barometer' instead of 'pressure'. Thanks to user 'windcrusader'! Fixes issue #393. Fixed problem when calculating vector averages. Thanks to user timtsm! PR #396. windrun is now calculated on a per-archive period basis, instead of for the whole day. Thanks to user 'windcrusader'! PR #399. Fixes issue #250. Wunderfixer has new option to set socket timeout. This is to compensate for WU \"capacity issues\". Thanks to user Leon! See PR #403. Fixed bug in WS1 driver that caused crash if rain_total was None. If a file user/schemas.py still exists (a relic from V2.7 and earlier), it is renamed to user/schemas.py.old. Fixes issue #54. V3.x test suites now use same data set as V4.x, minimizing the chance of a false negative when switching versions. Fixed fine offset driver to warn about (and skip) historical data that have zero for interval. Correct rounding problems for rain and other types when posting to CWOP. Fixes issue #431. Thanks to user ls4096! Fixed problem that can cause an exception with restx services that do not use the database manager. See commit 459ccb1. Sending a SIGTERM signal to weewxd now causes it to exit with status 128 + signal#. PR #442. Thanks to user sshambar! Fixed bug that could cause WMR200 packets with a timestamp between startup and the minimum interval to have an interval length of zero. Fixes issue #375 (again!). 3.9.1 02/06/2019 \u00b6 In genplot, do not attempt to normalize unspecified paths. Introduced option no_catchup. If set to true, a catchup will not be attempted. Fixes issue #368. 3.9.0 02/05/2019 \u00b6 New skin called Seasons. For new users, it will be installed and enabled. For old users, it will be installed, but not enabled. Fixes issue #75. There are also two new skins for mobile phones: Mobile and Smartphone. These are installed, but not enabled, for all users. Reworked how options get applied for reports. Backstop default values are supplied by a new file weewx/defaults.py. These can get overridden by skin.conf, or in a new section [StdReports] / [[Defaults]] in weewx.conf. See the Customization Guide, section \"How options work\", for details. Fixes issue #248. The skin.conf is optional. It is possible to specify the entire skin configuration in the configuration file weewx.conf. Dropped support of Python 2.5. You must now use either Python 2.6 or 2.7. This is in anticipation of porting to Python 3. The image generator now supports the use of a 'stale_age' option. Thanks to user John Smith. Fixes issue #290. Rose line width can now be specified with option rose_line_width. The Felsius unit of temperature (see https://xkcd.com/1923/ ) is now supported. New tag $almanac.sidereal_time for calculating current sidereal time New tag $almanac.separation() for calculating planet separations. Can now use ephem.readdb() to load arbitrary bodies into the almanac. StdQC now includes an entry for rain again (inexplicably removed in v3.1.0). If software record generation is used, the archive interval is now what is specified in weewx.conf, even if the station supports hardware generation. Fixed problem where records were downloaded on startup, even if software record generation was specified. The tag formatting taxonomy has been simplified. Just use suffix \".format()\" now. Documentation updated to reflect changes. Backwards compatibility with old suffixes is supported. Fixes issue #328. Can now set Rapidfire parameter rtfreq. Thanks to user 'whorfin'. PR #304. Template names can now include the week number. Thanks to user 'stimpy23'. PR #319. New aggregation type for plots: 'cumulative'. Thanks to user 'henrikost'. PR #302. Fixed problem where MySQL error 2013 could crash WeeWX. Fixes issue #327. Posts to the Weather Underground will be skipped if an observation type that is listed in the [[[Essentials]]] subsection is missing. Fixes issue #329. Upgrade process now explicity upgrades version-to-version, instead of doing a merge to the new config file. Fixes issue #217. Example xstats now includes tags for last_year and last_year_todate. Thanks to user evilbunny2008. PR #325. Guard against a negative value for 'interval' in WMR200 stations. Check for missing or negative values for the record field 'interval'. Changed the formula used to calculate percentage illumination of the moon to something more accurate around 2018. This formula is only used if pyephem is not installed. Fixes issue #342. Fixed bug that caused older, \"type A\" Vantage Pro2, to crash. Fixes issue #343. Fixed a bug that caused a divide-by-zero error if a plot range was the same as a specified min or max scale. Fixes issue #344. Fixed bug that prevented an optional data_binding from being used in tags when iterating over records. Fixes issue #345. Examples lowBattery and alarm now try SMTP_SSL connections, then degrade if that's not available. Fixes issue #351. Fixed problem with Brazilian locations at the start of DST. It manifested itself with the error \"NoColumnError: no such column: wind\". Fixes issue #356. Fixed problem that caused sunrise/sunset to be calculated improperly in Sun.py. Improved coverage of test suites. Fixes issue #337. wee_device, when used with the Vantage series, now honors the \"no prompt\" (-y) option. Fixes issue #361. Log watch now correctly logs garbage collection events. Thanks to user buster-one. PR #340. 3.8.2 08/15/2018 \u00b6 Added flag to weewx-multi init script to prevent systemd from breaking it. Thanks to users Timo, Glenn McKechnie, and Paul Oversmith. Fixed problem that caused wind direction in archive records to always be calculated in software, even with stations that provide it in hardware. Fixes issue #336. 3.8.1 06/27/2018 \u00b6 Map cc3000 backup battery to consBatteryVoltage and station battery to supplyVoltage to more accurately reflect the battery functions. Update the syntax in the rsyslog configuration sample Significant overhaul to the WMR300 driver. The driver should now work reliably on any version of pyusb and libusb. The driver will now delete history records from the logger before the logger fills up (the WMR300 logger is not a circular buffer). Thanks to users Markus Biewer and Cameron. Fixes issue #288. Added automatic clearing of logger for CC3000 driver to prevent logger overflow (the CC3000 logger is not a circular buffer). The default is to not clear the history, but it is highly recommended that you add a logging threshold once you are confident that all logger data have been captured to the weewx database. Improved the robustness of reading from the CC3000 logger. Better CRC error message in Vantage driver. Parameterize the configuration directory in weewx-multi init script. In StdWXCalculate, use None for an observation only if the variables on which the derived depends are available and None. Fixes issue #291. Fixed bug that prevented specifying an explicit alamanac time from working. Fixed bug that prevented historical records from being downloaded from ws23xx stations. Thanks to user Matt Brown! Fixes issue #295 Fixed bug that crashed program if a sqlite permission error occurred. If wind speed is zero, accumulators now return last known wind direction (instead of None). Thanks to user DigitalDan05. PR #303. Windrun calculations now include the \"current\" record. Fixes issue #294. Fixed bug involving stations that report windGust, but not windGustDir, in their LOOP data (e.g., Fine Offset), which prevented the direction of max wind from appearing in statistics. Fixes issue #320. The engine now waits until the system time is greater than the creation time of the weewx.conf file before starting up. Fixes issue #330. 3.8.0 11/22/2017 \u00b6 The stats.py example now works with heating and cooling degree days. Fixes issue #224. The ordinal increment between x- and y-axis labels can now be chosen. The increment between x-axis tick marks can now be chosen. Thanks to user paolobenve! PR #226. Bar chart fill colors can now be specified for individual observation types. Fixes issue #227. For aggregation types of avg , min and max , plots now locate the x- coordinate in the middle of the aggregation interval (instead of the end). Thanks again to user paolobenve! PR #232. The nominal number of ticks on the y-axis can now be specified using option y_nticks . Fixed bug that could cause tick crowding when hardwiring y-axis min and max values. The uploader framework in restx.py now allows POSTS with a JSON payload, and allows additional headers to be added to the HTTP request object. MySQL error 2006 (\"MySQL server has gone away\") now gets mapped to weedb.CannotConnectError . PR #246 Whether to use an FTP secure data connection is now set separately from whether to authenticate using TLS. Fixes issue #284. Corrected formatting used to report indoor temp and humidity to the Weather Underground. Added inDewpoint to the observation group dictionary. Added missing aggregation type 'min_ge'. Thanks to user Christopher McAvaney! Plots can now use an aggregate_type of last . Fixes issue #261. When extracting observation type stormRain (Davis Vantage only), the accumulators now extract the last (instead of average) value. Added additional accumulator extractors. Allow reports to be run against a binding other than wx_binding . Do chdir at start of ImageGenerator so that skin.conf paths are treated the same as those of other generators. Changed default value of stale for CWOP from 60 to 600 seconds. PR #277. Vantage driver: Allow user to specify the Vantage Pro model type in weewx.conf. Repeater support added to '-\u2014set-transmitter-type' command. New commands: '\u2014-set-retransmit', '--set-latitude', '--set-longitude' '--set-wind-cup', '--set-temperature-logging' Details explained in hardware.htm. Thanks to user dl1rf! PR #270, #272. Using the set-altitude command in wee_device no longer changes the barometer calibration constant in Vantage devices. See PR #263. Thanks to user dl1rf! Fixed bug in wmr200 driver that resulted in archive records with no interval field and 'NOT NULL constraint failed: archive.interval' errors. Fixed bug in wmr200 driver that caused windDir to always be None when windSpeed is zero. Include rain count in cc3000 status. In the restx posting, catch all types of httplib.HTTPException, not just BadStatusLine and IncompleteRead. 3.7.1 03/22/2017 \u00b6 Fixed log syntax in wmr100 and wmr9x8 drivers. Emit Rapidfire cache info only when debug is level 3 or higher. Thanks to user Darryn Capes-Davis. Fixed problem that prevented Rapidfire from being used with databases in metric units. Fixes issue #230. Set WOW post_interval in config dict instead of thread arguments so that overrides are possible. Thanks to user Kenneth Baker. Distribute example code and example extensions in a single examples directory. Ensure that the examples directory is included in the rpm and deb packages. Fixed issue that prevented a port from being specified for MySQL installations. MySQL error 2003 (\"Can't connect to MySQL server...\") now gets mapped to weedb.CannotConnectError . PR #234. By default, autocommit is now enabled for the MySQL driver. Fixes issue #237. Highs and lows from LOOP packets were not being used in preference to archive records in daily summaries. Fixed issue #239. 3.7.0 03/11/2017 \u00b6 The tag $current now uses the record included in the event NEW_ARCHIVE_RECORD , rather than retrieve the last record from the database. This means you can use the tag $current for observation types that are in the record, but not necessarily in the database. Fixes issue #13. Most aggregation periods now allow you to go farther in the past. For example, the tag $week($weeks_ago=1) would give you last week. You can also now specify the start and end of an aggregation period, such as $week.start and $week.end . Can now do SummaryByDay (as well as SummaryByMonth and SummaryByYear ). NB: This can generate lots of files --- one for every day in your database! Leaving this undocumented for now. Fixes issue #185. When doing hardware record generation, the engine now augments the record with any additional observation types it can extract out of the accumulators. Fixes issue #15. It's now possible to iterate over every record within a timespan. Fixes issue #182. Use schema_name = hardware_name pattern in sensor map for drivers that support extensible sensor suites, including the drivers for cc3000, te923, wmr300, wmr100, wmr200, wmr9x8 Simplified sensor mapping implementation for wmr100 and wmr200 drivers. For recent weewx releases, these are the default mappings for wmr200: 3.6.0: in:0, out:1, e2:2, e3:3, ..., e8:8 hard-coded 3.6.1: in:0, out:1, e1:2, e2:3, ..., e7:8 hard-coded 3.7.0: in:0, out:1, e1:2, e2:3, ..., e7:8 sensor_map and these are default mappings for wmr100: 3.6.2: in:0, out:1, e1:2, e2:3, ..., e7:8 hard-coded 3.7.0: in:0, out:1, e1:2, e2:3, ..., e7:8 sensor_map Enabled battery status for every remote T/H and T sensor in wmr100 driver. Enabled heatindex for each remote T/H sensor in wmr200 driver. Fixed inverted battery status indicator in wmr200 driver. Fixed 'Calculatios' typo in wmr100, wmr200, wmr9x8, and wmr300 drivers. Fixed usb initialization issues in the wmr300 driver. Added warning in wmr300 driver when rain counter reaches maximum value. Decode heatindex and windchill from wmr300 sensor outputs. Report the firmware version when initializing the cc3000 driver. Fixed bug in vantage driver that would prevent console wake up during retries when fetching EEPROM vales. Thanks to user Dan Begallie! The vantage driver no longer emits values for non-existent sensors. As a result, LOOP and archive packets are now much smaller. If this works out, other drivers will follow suit. Partial fix of issue #175. The vantage driver now emits the barometer trend in LOOP packets as field trendIcon . The engine now logs locale. Additional information if a TERM signal is received. Removed the site-specific \"Pond\" extensions from the Standard skin. The Standard skin now includes plots of outside humidity. Fixes issue #181. Fixed reference to index.html.tmpl in the xstats example. Changed algorithm for calculating ET to something more appropriate for hourly values (former algorithm assumed daily values). Fixes issue #160. Fixed bug in Celsius to Fahrenheit conversion that affected pressure conversions in uwxutils.py , none of which were actually used. Fixed bug that was introduced in v3.6.0, which prevented wee_reports from working for anything other than the current time. Documented the experimental anti-alias feature, which has been in weewx since v3.1.0. Fixes issue #6. Fixed problem where multiple subsections under [SummaryBy...] stanzas could cause multiple copies of their target date to be included in the Cheetah variable $SummaryByYear and $SummaryByMonth . Fixes issue #187. Moved examples out of bin directory. Eliminated experimental directory. Reinforce the use of user directory, eliminate use of examples directory. Renamed xsearch.py to stats.py . OS uptime now works for freeBSD. Thanks to user Bill Richter! PR #188. Broke out developer's notes into a separate document. Added @media CSS for docs to improve printed/PDF formatting. Thanks to user Tiouck! Added a 0.01 second delay after each read_byte in ws23xx driver to reduce chance of data spikes caused by RS232 line contention. Thanks lionel.sylvie! The observation windGustDir has been removed from wmr100, wmr200, te923, and fousb drivers. These drivers were simply assigning windGustDir to windDir , since none of the hardware reports an actual wind gust. Calculation of aggregates over a period of one day or longer can now respect any change in archive interval. To take advantage of this feature, you will have to apply an update to your daily summaries. This can be done using the tool wee_database , option --update . Refer to the Changes to daily summaries section in the Upgrade Guide to determine whether you should update or not. Fixes issue #61. Max value of windSpeed for the day is now the max archive value of windSpeed . Formerly, it was the max LOOP value. If you wish to patch your older daily summaries to interpret max windSpeed this way, use the tool wee_database with option --update . Fixes issue #195. The types of accumulators, and the strategies to put and extract records out of them, can now be specified by config stanzas. This will be of interest to extension writers. See issue #115. Fixed battery status label in acurite driver: changed from txTempBatteryStatus to outTempBatteryStatus . Thanks to user manos! Made the lowBattery example more robust - it now checks for any known low battery status, not just txBatteryStatus . Thanks to user manos! Added info-level log message to calculate_rain so that any rain counter reset will be logged. Added better logging for cc3000 when the cc3000 loses contact with sensors for extended periods of time. How long to wait before retrying after a bad uploader login is now settable with option retry_login . Fixes issue #212. The test suites now use dedicated users weewx1 and weewx2 . A shell script has been included to setup these users. A more formal exception hierarchy has been adopted for the internal database library weedb . See weedb/NOTES.md . The weedb Connection and Cursor objects can now be used in a \"with\" clause. Slightly more robust mechanism for decoding last time a file was FTP'd. 3.6.2 11/08/2016 \u00b6 Fixed incorrect WU daily rain field name Fixed bug that crashed Cheetah if the weewx.conf configuration file included a BOM. Fixes issue #172. 3.6.1 10/13/2016 \u00b6 Fixed bug in wunderfixer. Fixed handling of StdWXCalculate.Calculations in modify_config in the wmr100, wmr200, wmr300, and wmr9x8 drivers. Eliminate the apache2, ftp, and rsync suggested dependencies from the deb package. This keeps the weewx dependencies to a bare minimum. Added retries to usb read in wmr300 driver. Remapped sensor identifiers in wmr200 driver so that extraTemp1 and extraHumid1 are usable. Standardized format to be used for times to YYYY-mm-ddTHH:MM . 3.6.0 10/07/2016 \u00b6 Added the ability to run reports using a cron-like notation, instead of with every report cycle. See User's Guide for details. Thanks to user Gary Roderick. PR #122. Fixes issue #17. Added the ability to easily import CSV, Weather Underground, and Cumulus data using a new utility, wee_import. Thanks again to \u00fcber-user Gary Roderick. PR #148. Fixes issue #97. Refactored documentation so that executable utilities are now in their own document, utilities.htm. Fixed rpm package so that it will retain any changes to the user directory. Thanks to user Pat OBrien. No ET when beyond the reach of the sun. Software calculated ET now returns the amount of evapotranspiration that occurred during the archive interval. Fixes issue #160 Fixed wee_config to handle config files that have no FTP or RSYNC. Fixed bug in StdWXCalculate that ignored setting of 'None' (#110). Which derived variables are to be calculated are now in a separate subsection of [StdWXCalculate] called [[Calculations]]. Upgrade process takes care of upgrading your config file. Reset weewx launchtime when waiting for sane system clock (thanks to user James Taylor). Fixed anti-alias bug in genplot. Issue #111. Corrected the conversion factor between inHg and mbar. Thanks to user Olivier. Consolidated unit conversions into module weewx.units. Plots longer than two years now use an x-axis increment of one year. Thanks to user Olivier! The WS1 driver now retries connection if it fails. Thanks to user Kevin Caccamo! PR #112. Major update to the CC3000 driver: - reading historical records is more robust - added better error handling and reporting - fixed to handle random NULL characters in historical records - fixed rain units - added ability to get data from logger as fast as it will send it - added support for additional temperature sensors T1 and T2 - added transmitter channel in station diagnostics - added option to set/get channel, baro offset - added option to reset rain counter Fixed brittle reference to USBError.args[0] in wmr200, wmr300, and te923 drivers. Fixed typo in default te923 sensor mapping for h_3. Thanks to user ngulden. Added flag for reports so that reports can be disabled by setting enable=False instead of deleting or commenting entire report sections in weewx.conf. The vantage and ws23xx drivers now include the fix for the policy of \"wind direction is undefined when no wind speed\". This was applied to other drivers in weewx 3.3.0. Fixed te923 driver behavior when reading from logger, especially on stations with large memory configuration. Thanks to users Joep and Nico. Fixed rain counter problems in wmr300 driver. The driver no longer attempts to cache partial packets. Do no process packets with non-loop data when reading loop data. Thanks to user EricG. Made wmr300 driver more robust against empty usb data buffers. Fixed pressure/barometer in wmr300 driver when reading historical records. Fixed problem with the Vantage driver where program could crash if a serial I/O error happens during write. Fixes issue #134. Changed name of command to clear the Vantage memory from --clear to --clear-memory to make it more consistent with other devices. Fixed problem that prevented channel 8 from being set by the Vantage driver. Added solaris .smf configuration. Thanks to user whorfin. Added option post_indoor_observations for weather underground. Added maximum value to radiation and UV plots. In the .deb package, put weewx reports in /var/www/html/weewx instead of /var/www/weewx to match the change of DocumentRoot in debian 8 and later. 3.5.0 03/13/2016 \u00b6 Fixed bug that prevented rsync uploader from working. Fixed bug in wmr300 driver when receiving empty buffers from the station. The type of MySQL database engine can now be specified. Default is 'INNODB'. Updated userguide with capabilities of the TE923 driver added in 3.4.0. Added aggregation type min_ge(val). Provide better feedback when a driver does not implement a configurator. Added humidex and appTemp to group_temperature. Fixed issue #96. Backfill of the daily summary is now done in \"tranches,\" reducing the memory requirements of MySQL. Thanks to \u00fcber-user Gary Roderick! Fixes issue #83. Made some changes in the Vantage driver to improve performance, particularly with the IP version of the logger. Thanks to user Luc Heijst for nagging me that the driver could be improved, and for figuring out how. Plotting routines now use Unicode internally, but convert to UTF-8 if a font does not support it. Fixes issue #101. Improved readability of documents on mobile devices. Thank you Chris Davies-Barnard! The loop_on_init option can now be specified in weewx.conf When uploading data to CWOP, skip records older than 60 seconds. Fixes issue #106. Added modify_config method to the driver's configuration editor so that drivers can modify the configuration during installation, if necessary. The fousb and ws23xx drivers use modify_config to set record_generation to software. This addresses issue #84. The wmr100, wmr200, wmr9x8, and wmr300 drivers use modify_config to set rainRate, heatindex, windchill, and dewpoint calculations to hardware instead of prefer_hardware since each of these stations has partial packets. This addresses issue #7 (SF #46). 3.4.0 01/16/2016 \u00b6 The tag $hour has now been added. It's now possible to iterate over hours. Thanks to user Julen! Complete overhaul of the te923 driver. Thanks to user Andrew Miles. The driver now supports the data logger and automatically detects small or large memory models. Added ability to set/get the altitude, lat/lon, and other station parameters. Significant speedup to reading station memory, from 531s to 91s, which is much closer to the 53s for the te923tool written in C (all for a station with the small memory model). The wee_debug utility is now properly installed, not just distributed. Fixed bug in almanac code that caused an incorrect sunrise or sunset to be calculated if it followed a calculation with an explicit horizon value. Localization of tags is now optional. Use function toString() with argument localize set to False. Example: $current.outTemp.toString($localize=False) Fixes issue #88. In the acurite driver, default to use_constants=True. Fixed bug in the rhel and suse rpm packaging that resulted in a configuration file with html, database, and web pages in the setup.py locations instead of the rpm locations. The extension utility wee_extension now recognizes zip archives as well as tar and compressed tar archives. Check for a sane system time when starting up. If time is not reasonable, wait for it. Log the time status while waiting. Added log_success option to cheetah, copy, image, rsync, and ftp generators. Older versions of MySQL (v5.0 and later) are now supported. 3.3.1 12/06/2015 \u00b6 Fixed bug when posting to WOW. Fixed bug where the subsection for a custom report gets moved to the very end of the [StdReport] section of a configuration file on upgrade. Fixes issue #81. 3.3.0 12/05/2015 \u00b6 Now really includes wunderfixer. It was inadvertently left out of the install script. Rewrote the almanac so it now supports star ephemeris. For example, $almanac.rigel.next_rising. Fixes issue #79. Uninstalling an extension with a skin now deletes all empty directories. This fixes issue #43. Fixed bug in WMR200 driver that caused it to emit dayRain, when what it was really emitting was the \"rain in the last 24h, excluding current hour.\" Fixes issue #62. Fixed bug in WMR200 driver that caused it to emit gauge pressure for altimeter pressure. Thanks to user Mark Jenks for nagging me that something was wrong. Fixed bug that caused wind direction to be calculated incorrectly, depending on the ordering of a dictionary. Thanks to user Chris Matteri for not only spotting this subtle bug, but offering a solution. StdPrint now prints packets and records in (case-insensitive) alphabetical order. Fixed wind speed decoding in the acurite driver. Thanks to aweatherguy. The StdRESTful service now supports POSTs, as well as GETs. The FTP utility now catches PickleError exceptions, then does a retry. Added unit 'minute' to the conversion dictionary. The vertical position of the bottom label in the plots can now be set in skin.conf with option bottom_label_offset. An optional port number can now be specified with the MySQL database. Added option use_constants in the Acurite driver. Default is false; the calibration constants are ignored, and a linear approximation is used for all types of consoles. Specify use_constants for 01035/01036 consoles to calculate using the constants. The 02032/02064 consoles always use the linear approximation. Fixed test for basic sensor connectivity in the Acurite driver. The policy of \"wind direction is undefined when no wind speed\" is enforced by the StdWXCalculate service. There were a few drivers that were still applying the policy: acurite, cc3000, fousb, ws1, wmr100, wmr200, ultimeter. These have been fixed. Changed logic that decides whether the configuration file includes a custom schema, or the name of an existing schema. Added new command-line utility wee_debug, for generating a troubleshooting information report. Added option --log-label to specify the label that appears in syslog entries. This makes it possible to organize output from multiple weewx instances running on a single system. Fixed problem with the Vantage driver that caused it to decode the console display units incorrectly. Thanks to Luc Heijst! The WMR300 driver is now part of the weewx distribution. 3.2.1 07/18/15 \u00b6 Fixed problem when using setup.py to install into a non-standard location. Weewx would start a new database in the \"standard\" location, ignoring the old one in the non-standard location. 3.2.0 07/15/15 \u00b6 There are now five command-line utilities, some new, some old wee_config : (New) For configuring weewx.conf, in particular, selecting a new device driver. wee_extension : (New) For adding and removing extensions. wee_database : (Formerly called wee_config_database) wee_device : (Formerly called wee_config_device) wee_reports : No changes. The script setup.py is no longer used to install or uninstall extensions. Instead, use the new utility wee_extension. Wunderfixer is now included with weewx --- no need to download it separately. It now works with MySQL, as well as sqlite, databases. It also supports metric databases. Thanks to user Gary Roderick! Fixed bug in 12-hour temperature lookup for calculating station pressure from sea level pressure when database units are other than US unit system. Added guards for bogus values in various wxformula functions. Added windrun, evapotranspiration, humidex, apparent temperature, maximum theoretical solar radiation, beaufort, and cloudbase to StdWXCalculate. If StdWXCalculate cannot calculate a derived variable when asked to, it now sets the value to null. Fixes issue #10. Added option to specify algorithm in StdWXCalculate. So far this applies only to the altimeter calculation. Added option max_delta_12h in StdWXCalculate, a window in which a record will be accepted as being \"12 hours ago.\" Default is 1800 seconds. Fixed bug in debian install script - 'Acurite' was not in the list of stations. $almanac.sunrise and $almanac.sunset now return ValueHelpers. Fixes issue #26. Added group_distance with units mile and km. Added group_length with units inch and cm. Failure to launch a report thread no longer crashes program. The WU uploader now publishes soil temperature and moisture, as well as leaf wetness. Increased precision of wind and wind gust posts to WU from 0 to 1 decimal point. Increased precision of barometer posts to WOW from 1 to 3 decimal points. A bad CWOP server address no longer crashes the CWOP thread. The \"alarm\" example now includes a try block to catch a NameError exception should the alarm expression include a variable not in the archive record. Fixed bug that shows itself if marker_size is not specified in skin.conf Show URLs in the log for restful uploaders when debug=2 or greater. Fixed problem that could cause an exception in the WMR200 driver when formatting an error string. Added better recovery from USB failures in the ws28xx driver. Added data_format option to FineOffset driver. Thanks to Darryl Dixon. Decoding of data is now more robust in the WS1 driver. Get data from the station as fast as the station can spit it out. Thanks to Michael Walker. Changes to the WS23xx driver include: - Fixed wind speed values when reading from logger. Values were too high by a factor of 10. - wrapped non-fatal errors in WeeWXIO exceptions to improve error handling and failure recovery Changes to the AcuRite driver include: - The AcuRite driver now reports partial packets as soon as it gets them instead of retaining data until it can report a complete packet - Improved timing algorithm for AcuRite data. Thanks to Brett Warden. - Added acurite log entries to logwatch script. Thanks to Andy. - Prevent negative rainfall amounts in acurite driver by detecting counter wraparound - Use 13 bits for rain counter instead of 12 bits - Use only 12 bits for inside temperature in acurite driver when decoding for 02032 stations Changes to the TE923 driver include: - consolidated retries - improved error handling and reporting Changes to the WMR9x8 driver include: - Correct bug that caused yesterday's rain to be decoded as dayRain - LOOP packet type 'battery' is now an int, instead of a bool - The driver can now be run standalone for debugging purposes. The Vantage driver now catches undocumented termios exceptions and converts them to weewx exceptions. This allows retries if flushing input or output buffers fail. Fixes issue #34. Default values for databases are now defined in a new section [DatabaseTypes]. New option \"database_type\" links databases to database type. Installer will automatically update old weewx.conf files. The RESTful services that come with weewx are now turned on and off by option \"enable\". Installer will automatically update old weewx.conf files. Other RESTful services that don't use this method will continue to work. Option bar_gap_fraction is now ignored. Bar plot widths are rendered explicitly since V3.0, making the option unnecessary. Fixes issue #25. Added additional debug logging to main engine loop. FTP uploader now retries several times to connect to a server, instead of giving up after one try. Thanks to user Craig Hunter! 3.1.0 02/05/15 \u00b6 Fixed setup.py bug that caused list-drivers to fail on deb and rpm installs. Added a wait-and-check to the stop option in the weewx.debian rc script. Fixed bug in the Vantage driver that causes below sea-level altitudes to be read as a large positive number. Also, fixed problem with altitude units when doing --info (ticket #42). Fixed bug in wmr100 driver that causes gust wind direction to be null. Fixed bug in wmr200 driver that causes gust wind direction to be null. Fixed ultimeter driver to ensure wind direction is None when no wind speed Thanks to user Steve Sykes. Fixed bug in calculation of inDewpoint. Thanks to user Howard Walter. Assign default units for extraHumid3,4,5,6,7, extraTemp4,5,6,7, leafTemp3,4, and leafWet1,2. Use StdWXCalculate to ensure that wind direction is None if no wind speed. Fixed sign bug in ultimeter driver. Thanks to user Garrett Power. Use a sliding window with default period of 15 minutes to calculate the rainRate for stations that do not provide it. Added support for AcuRite weather stations. Thanks to users Rich of Modern Toil, George Nincehelser, Brett Warden, Preston Moulton, and Andy. The ultimeter driver now reads data as fast as the station can produce it. Typically this results in LOOP data 2 or 3 times per second, instead of once per second. Thanks to user Chris Thompstone. The daily summary for wind now uses type INTEGER for column sumtime, like the other observation types. Utility wee_reports no longer chokes if the optionally-specified timestamp is not in the database. Can also use \"nearest time\" if option 'max_delta' is specified in [CheetahGenerator]. Utility wee_config_device can now dump Vantage loggers to metric databases. Fixes ticket #40. Fixed problem where dumping to database could cause stats to get added to the daily summaries twice. FTP over TLS (FTPS) sessions are now possible, but don't work very well with Microsoft FTP servers. Requires Python v2.7. Will not work with older versions of Python. Fixes ticket #37. WeatherUnderground passwords are now quoted, allowing special characters to be used. Fixes ticket #35. New tag $obs, allowing access to the contents of the skin configuration section [Labels][[Generic]]. Fixes ticket #33. Better error message if there's a parse error in the configuration file. Added wxformulas for evapotranspiration, humidex, apparent temperature, and other calculations. Added --loop-on-init option for weewxd. If set, the engine will keep retrying if the device cannot be loaded. Otherwise, it will exit. Changed the weedb exception model to bring it closer to the MySQL exception model. This will only affect those programming directly to the weedb API. 3.0.1 12/07/14 \u00b6 Fixed bug in setup.py that would forget to insert device-specific options in weewx.conf during new installations. 3.0.0 12/04/14 \u00b6 Big update with lots of changes and lots of new features. The overall goal was to make it easier to write and install extensions. Adding custom databases, units, accumulators and many other little things have been made easier. Skins and skin.conf continue to be 100% backwards compatible (since V1.5!). However, search-list extensions will have to be rewritten. Details in the Upgrading Guide. Previously, configuration options for all possible devices were included in the configuration file, weewx.conf. Now, for new installs, it has been slimmed down to the minimum and, instead, configuration options are added on an \"as needed\" basis, using a new setup.py option \"configure\". Your configuration file, weewx.conf should be automatically updated to V3 by the upgrade process, using your previously chosen hardware. But, check it over. Not sure we got everything correct. See the Upgrading Guide. Specific changes follow. There is no longer a separate \"stats\" database. Instead, statistics are included in the regular database (e.g., 'weewx.sdb') as separate tables, one for each observation type. Total rewrite of how data gets bound to a database. You now specify a \"data binding\" to indicate where data should be going, and where it is coming from. The default binding is \"wx_binding,\" the weather binding, so most users will not have to change a thing. Other database bindings can be used in tags. Example: $current($data_binding=$alt_binding).outTemp Alternate times can also be specified: $current($timestamp=$othertime).outTemp Explicit time differences for trends can now be specified: $trend($time_delta=3600).barometer Introduced a new tag $latest, which uses the last available timestamp in a data binding (which may or may not be the same as the \"current\" timestamp). Introduced a new tag $hours_ago, which returns the stats for X hours ago. So, the max temperature last hour would be $hours_ago($hours_ago=1).outTemp.max. Introduced a shortcut $hour, which returns the stats for this hour. So, the high temperature for this hour would be $hour.outTemp.max Introduced a new tag $days_ago, which returns the stats for X days ago. So, the max temperature the day before yesterday would be $days_ago($days_ago=2).outTemp.max. Included a shortcut $yesterday: The tag $yesterday.outTemp.max would be yesterday's max temperature. Introduced a new aggregation type \".last\", which returns the last value in an aggregation interval. E.g., $week.outTemp.last would return the last temperature seen in the week. Introduced a new aggregation type \".lasttime\" which returns the time of the above. Can now differentiate between the max speed seen in the archive records (e.g., $day.windSpeed.max) and the max gust seen ($day.wind.max or $day.windGust.max). Allow other data bindings to be used in images. Made it easier to add new unit types and unit groups. The archive interval can now change within a database without consequences. Total rewrite of how devices are configured. A single utility wee_config_device replaces each of the device-specific configuration utilities. The Customization Guide was extended with additional examples and option documentation. Removed the no longer needed serviced StdRESTful, obsolete since V2.6 Fixed bug in querying for schemas that prevented older versions of MySQL (V4.X) from working. Improved error handling and retries for ws1, ultimeter, and cc3000 drivers. Fixed missing dew initializations in wmr9x8 driver. Fixed model/_model initialization in wmr9x8 driver. Fixed uninitialized usb interface in wmr200 driver. Fixed wakup/wakeup typo in _getEEPROM_value in vantage driver. Made the ftpupload algorithm a little more robust to corruption of the file that records the last upload time. Added observation type 'snow'. It generally follows the semantics of 'rain'. Fixed possible fatal exception in WS23xx driver. Fixed use of str as variable name in WS23xx driver. Now catches database exceptions raised during commits, converting them to weedb exceptions. Weewx catches these, allowing the program to keep going, even in the face of most database errors. For the fine offset stations, record connection status as rxCheckPercent (either 0 or 100%) and sensor battery status as outTempBatteryStatus (0 indicates ok, 1 indicates low battery). For WS23xx stations, hardware record generation is now enabled and is the default (previously, software record generation was the default). Fixed bug in WS28xx driver the prevented reading of historical records when starting with an empty database. The database schemas are now their own package. The schema that was in user/schemas.py can now be found in weewx/schemas/wview.py. 2.7.0 10/11/14 \u00b6 Added the ability to configure new Vantage sensor types without using the console. This will be useful to Envoy users. Thanks to user Deborah Pickett for this contribution! Allow calibration constants to be set in the Vantage EEPROM. This will particularly be useful to southern hemisphere users who may want to align their ISS to true north (instead of south), then apply a 180 correction. Thanks again to Deborah Pickett! Enabled multiple rsync instances for a single weewx instance. More extensive debug information for rscync users. Added the ability to localize the weewx and server uptime. See the Customization Guide for details. This will also cause a minor backwards incompatibility. See the Upgrading Guide for details. Added catchup to the WS28xx driver, but still no hardware record generation. Changed lux-to-W/m^2 conversion factor in the fine offset driver. Added rain rate calculation to Ultimeter driver. Changed setTime to retrieve system time directly rather than using a value passed by the engine. This greatly improves the accuracy of StdTimeSync, particularly in network based implementations. Thanks to user Denny Page! Moved clock synchronization options clock_check and max_drift back to section [StdTimeSynch]. Fixed ENDPOINT_IN in the te923 driver. This should provide better compatibility with a wider range of pyusb versions. Now catches MySQL exceptions during commits and rollbacks (as well as queries) and converts them to weedb exceptions. Catch and report configobj errors when reading skin.conf during the generation of reports. Ensure correct location, lat, lon, and altitude modifications in the debian postinst installer script. In the debian installer, default to ttyUSB0 instead of ttyS0 for stations with a serial interface. Added CC3000 to debian installer scripts. Fixed bug that can affect hardware that emits floating point timestamps, where the timestamp is within 1 second of the end of an archive interval. Changed UVBatteryStatus to uvBatteryStatus in the WMR100 driver in order to match the convention used by other drivers. Fixed the shebang for te923, ws23xx, ultimeter, ws1, and cc3000 drivers. 2.6.4 06/16/14 \u00b6 The WMR100 driver now calculates SLP in software. This fixes a problem with the WMRS200 station, which does not allow the user to set altitude. The WMR100 driver was incorrectly tagging rain over the last 24 hours as rain since midnight. This caused a problem with WU and CWOP posts. Fix cosmetic problem in wee_config_fousb pressure calibration. Detect both NP (not present) and OFL (outside factory limits) on ws28xx. Added driver for PeetBros Ultimeter stations. Added driver for ADS WS1 stations. Added driver for RainWise Mark III stations and CC3000 data logger. Added automatic power cycling to the FineOffsetUSB driver. Power cycle the station when a USB lockup is detected. Only works with USB hubs that provide per-port power switching. Fix imagegenerator aggregation to permit data tables with no 'interval' column. Prompt for metric/US units for debian installations. For WS28xx stations, return 0 for battery ok and 1 for battery failure. If a connection to the console has been successfully opened, but then on subsequent connection attempts suffers an I/O error, weewx will now attempt a retry (before it would just exit). 2.6.3 04/10/14 \u00b6 Hardened the WMR100 driver against malformed packets. The plot images can now use UTF-8 characters. Fixed a problem where the Ambient threads could crash if there were no rain database entries. Battery status values txBatteryStatus and consBatteryVoltage now appear in the archive record. The last LOOP value seen is used. CWOP posts are now slightly more robust. Fixed pressure calculation in wee_config_fousb. Prevent failures in imagegenerator when no unicode-capable fonts are installed. Provide explicit pairing feedback using wee_config_ws28xx Count wxengine restarts in logwatch. Cleaned up USB initialization for fousb, ws28xx, and te923 drivers. 2.6.2 02/16/14 \u00b6 Fixed bug that crashes WMR200 driver if outTemp is missing. Fixed bug that can crash RESTful threads if there is missing rain data. Sqlite connections can now explicitly specify a timeout and isolation_level. Server uptime now reported for MacOS Fixed bug that prevented Rapidfire posts from being identified as such. 2.6.1 02/08/14 \u00b6 Fixed bug that crashed main thread if a StdQC value fell out of range. 2.6.0 02/08/14 \u00b6 Changed the RESTful architecture so RESTful services are now first-class weewx services. This should simplify the installation of 3rd party extensions that use these services. Broke up service_list, the very long list of services to be run, into five separate lists. This will allow services to be grouped together, according to when they should be run. Defined a structure for packaging customizations into extensions, and added an installer for those extensions to setup.py. Changed the default time and date labels to use locale dependent formatting. The defaults should now work in most locales, provided you set the environment variable LANG before running weewx. Changed default QC barometric low from 28 to 26. Added inTemp, inHumidity, and rain. Ranges in MinMax QC can now include units. When QC rejects values it now logs the rejection. Introduced a new unit system, METRICWX. Similar to METRIC, it uses mm for rain, mm/hr for rain rate, and m/s for speed. Added an option --string-check and --fix to the utility wee_config_database to fix embedded strings found in the sqlite archive database. Font handles are now cached in order to work around a memory leak in PIL. Now does garbage collection every 3 hours through the main loop. Image margins now scale with image and font sizes. Now works with the pure Python version of Cheetah's NameMapper, albeit very slowly. Fixed bug that prevented weewx from working with Python v2.5. Fixed bug in SummaryByMonth and SummaryByYear that would result in duplicate month/year entries when generating from multiple ByMonth or ByYear templates. Consolidated pressure calculation code in ws23xx, ws28xx, te923, and fousb. Catch USB failures when reading Fine Offset archive interval. Added Vantage types stormRain and windSpeed10 to the list of observation types. Simulator now generates types dewpoint, pressure, radiation, and UV. The forecast extension is once again distributed separately from weewx. Minor cleanup to Standard skin for better out-of-the-box behavior: - default to no radar image instead of pointing every station to Oregon - not every WMR100 is a WMR100N Failure to set an archive interval when using bar plots no longer results in an exception. Change to skin directory before invoking Cheetah on any templates. 2.5.1 12/30/13 \u00b6 Added UV plots to the templates. They will be shown automatically if you have any UV data. Fixed bug when reading cooling_base option. Default to sane behavior if skin does not define Labels. Fixed bug in setting of CheetahGenerator options. Fixed qsf and qpf summary values in forecast module. Fixed handling of empty sky cover fields in WU forecasts. Forecast module now considers the fctcode, condition, and wx fields for precipitation and obstructions to visibility. Added options to forecast module to help diagnose parsing failures and new forecast formats. Added retries when saving forecast to database and when reading from database. Fixes to the Fine Offset driver to eliminate spikes caused by reading from memory before the pointer had been updated (not the same thing as an unstable read). Added driver for LaCrosse 2300 series of weather stations. Added driver for Hideki TE923 series of weather stations. 2.5.0 10/29/13 \u00b6 Introduced a new architecture that makes it easier to define search list extensions. The old architecture should be 100% backwards compatible. Added station registry service. This allows weewx to optionally \"phone home\" and put your station location on a map. Added a forecast service and reporting options. The forecast service can generate Zambretti weather or XTide tide forecasts, or it can download Weather Underground or US National Weather Service weather forecasts. These data can then be displayed in reports using the Cheetah template engine. The forecast service is disabled by default. Weewx now allows easier localization to non-English speaking locales. In particular, set the environment variable LANG to your locale, and then weewx date and number formatting will follow local conventions. There are also more labeling options in skin.conf. Details in a new section in the Customization Guide. Added aggregate type \"minmax\" and \"maxmin\". Thank you user Gary Roderick! New option in [StdArchive] called \"loop_hilo\". Setting to True will cause both LOOP and archive data to be used for high/low statistics. This is the default. Setting to False causes only archive data to be used. When a template fails, skip only that template, not everything that the generator is processing. Trend calculations no longer need a record at precisely (for example) 3 hours in the past. It can be within a \"grace\" period. FineOffset driver now uses the 'delay' field instead of the fixed_block 'read_period' for the archive record interval when reading records from console memory. FineOffset driver now support for multiple stations on the same USB. FineOffset driver now reduces logging verbosity when bad magic numbers appear. Log only when the numbers are unrecognized or change. The purpose of the magic numbers is still unknown. WMR100, Vantage, FineOffset, and WS28xx drivers now emit a null wind direction when the wind speed is zero. Same for wind gust. For WMR9x8 stations, wind chill is now retrieved from the console rather than calculated in software. Thank you user Peter Ferencz! For WMR9x8 stations, the first extra temperature sensor (packet code 4) now shows up as extraTemp1 (instead of outTemp). Thanks again to Peter Ferencz. For WMR9x8 stations, packet types 2 and 3 have been separated. Only the latter is used for outside temperature, humidity, dewpoint. The former is used for \"extra\" sensors. Corrected the calculation for channel numbers >=3. Also, extended the number of battery codes. Thanks to Per Edstr\u00f6m for his patience in figuring this out! For WMR200 stations, altitude-corrected pressure is now emitted correctly. ws28xx driver improvements, including: better thread control; better logging for debugging/diagnostics; better timing to reduce dropouts; eliminate writes to disk to reduce wear when used on flash devices. Plus, support for multiple stations on the same USB. Fixed rain units in ws28xx driver. The LOOP value for daily ET on Vantages was too high by a factor of 10. This has been corrected. Fixed a bug that caused values of ET to be miscalculated when using software record generation. Ported to Korora 19 (Fedora 19). Thanks to user zmodemguru! Plots under 16 hours in length, now use 1 hour increments (instead of 3 hours). No longer emits \"deprecation\" warning when working with some versions of the MySQLdb python driver. Added ability to build platform-specific RPMs, e.g., one for RedHat-based distributions and one for SuSE-based distributions. Fixed the 'stop' and 'restart' options in the SuSE rc script. The weewx logwatch script now recognizes more log entries and errors. 2.4.0 08/03/13 \u00b6 The configuration utility wee_config_vantage now allows you to set DST to 'auto', 'off', or 'on'. It also lets you set either a time zone code, or a time zone offset. The service StdTimeSync now catches startup events and syncs the clock on them. It has now been moved to the beginning of the list \"service_list\" in weewx.conf. Users may want to do the same with their old configuration file. A new event, END_ARCHIVE_PERIOD has been added, signaling the end of the archive period. The LOOP packets emitted by the driver for the Davis Vantage series now includes the max wind gust and direction seen since the beginning of the current archive period. Changed the null value from zero (which the Davis documentation specifies) to 0x7fff for the VP2 type 'highRadiation'. Archive record packets with date and time equal to zero or 0xff now terminate dumps. The code that picks a filename for \"summary by\" reports has now been factored out into a separate function (getSummaryByFileName). This allows the logic to be changed by subclassing. Fixed a bug that did not allow plots with aggregations less than 60 minutes across a DST boundary. Fixed bug in the WMR100 driver that prevented UV indexes from being reported. The driver for the LaCrosse WS-28XX weather series continues to evolve and mature. However, you should still consider it experimental. 2.3.3 06/21/13 \u00b6 The option week_start now works. Updated WMR200 driver from Chris Manton. Fixed bug that prevented queries from being run against a MySQL database. 2.3.2 06/16/13 \u00b6 Added support for the temperature-only sensor THWR800. Thanks to user fstuyk! Fixed bug that prevented overriding the FTP directory in section [[FTP]] of the configuration file. Day plots now show 24 hours instead of 27. If you want the old behavior, then change option \"time_length\" to 97200. Plots shorter than 24 hours are now possible. Thanks to user Andrew Tridgell. If one of the sections SummaryByMonth, SummaryByYear, or ToDate is missing, the report engine no longer crashes. If you live at a high latitude and the sun never sets, the Almanac now does the right thing. Fixed bug that caused the first day in the stats database to be left out of calculations of all-time stats. 2.3.1 04/15/13 \u00b6 Fixed bug that prevented Fine Offset stations from downloading archive records if the archive database had no records in it. rsync should now work with Python 2.5 and 2.6 (not just 2.7) 2.3.0 04/10/13 \u00b6 Davis Vantage stations can now produce station pressures (aka, \"absolute pressure\"), altimeter pressures, as well as sea-level pressure. These will be put in the archive database. Along the same line, 'altimeter' pressure is now reported to CWOP, rather than the 'barometer' pressure. If altimeter pressure is not available, no pressure is reported. Fixed bug in CWOP upload that put spaces in the upload string if the pressure was under 1000 millibars. A bad record archive type now causes a catch up to be abandoned, rather than program termination. Fixed bug in trends, when showing changes in temperature. NB: this fix will not work with explicit unit conversion. I.e., $trend.outTemp.degree_C will not work. Modified wee_config_vantage and wee_config_fousb so that the configuration file will be guessed if none is specified. Fixed wxformulas.heatindexC to handle arguments of None type. Fixed bug that causes Corrections to be applied twice to archive records if software record generation is used. rsync now allows a port to be specified. Fixed day/night transition bug. Added gradients to the day/night transitions. Numerous fixes to the WMR200 driver. Now has a \"watchdog\" thread. All of the device drivers have now been put in their own package 'weewx.drivers' to keep them together. Many have also had name changes to make them more consistent: OLD NEW VantagePro.py (Vantage) vantage.py (Vantage) WMR918.py (WMR-918) wmr9x8.py (WMR9x8) wmrx.py (WMR-USB) wmr100.py (WMR100) new (experimental) drivers: wmr200.py (WMR200) ws28xx.py (WS28xx) The interface to the device driver \"loader\" function has changed slightly. It now takes a second parameter, \"engine\". Details are in the Upgrading doc. The FineOffsetUSB driver now supports hardware archive record generation. When starting weewx, the FineOffsetUSB driver will now try to 'catch up' - it will read the console memory for any records that are not yet in the database. Added illuminance-to-radiation conversion in FineOffsetUSB driver. Added pressure calibration option to wee_config_fousb and explicit support for pressure calibration in FineOffsetUSB driver. Fixed windchill calculation in FineOffsetUSB driver. Fixed FineOffsetUSB driver to handle cases where the 'delay' is undefined, resulting in a TypeError that caused weewx to stop. The FineOffsetUSB driver now uses 'max_rain_rate' (measured in cm/hr) instead of 'max_sane_rain' (measured in mm) to filter spurious rain sensor readings. This is done in the driver instead of StdQC so that a single parameter can apply to both LOOP and ARCHIVE records. 2.2.1 02/15/13 \u00b6 Added a function call to the Vantage driver that allows the lamp to be turned on and off. Added a corresponding option to wee_config_vantage. Fixed bug where an undefined wind direction caused an exception when using ordinal wind directions. 2.2.0 02/14/13 \u00b6 Weewx can now be installed using Debian (DEB) or Redhat (RPM) packages, as well as with the old 'setup.py' method. Because they install things in different places, you should stick with one method or another. Don't mix and match. Thanks to Matthew Wall for putting this together! Added plot options line_gap_fraction and bar_gap_fraction, which control how gaps in the data are handled by the plots. Also, added more flexible control of plot colors, using a notation such as 0xBBGGRR, #RRGGBB, or the English name, such as 'yellow'. Finally, added day/night bands to the plots. All contributed by Matthew Wall. Thanks again, Matthew! Ordinal wind directions can now be shown, just by adding the tag suffix \".ordinal_compass\". For example, $current.windDir.ordinal_compass might show 'SSE' The abbreviations are set in the skin configuration file. Fixed bug that caused rain totals to be misreported to Weather Underground when using a metric database. Generalized the weewx machinery so it can be used for applications other than weather applications. Got rid of option stats_types in weewx.conf and put it in bin/user/schemas.py. See upgrading.html if you have a specialized stats database. The stats database now includes an internal table of participating observation types. This allows it to be easily combined with the archive database, should you choose to do so. The table is automatically created for older stats databases. Added rain rate calculation to FineOffsetUSB driver. Added adaptive polling option to FineOffsetUSB driver. Fixed barometric pressure calculation for FineOffsetUSB driver. Changed the name of the utilities, so they will be easier to find in /usr/bin: weewxd.py -> weewxd runreports.py -> wee_reports config_database.py -> wee_config_database config_vp.py -> wee_config_vantage config_fousb.py -> wee_config_fousb 2.1.1 01/02/13 \u00b6 Fixed bug that shows itself when one of the variables is 'None' when calculating a trend. 2.1.0 01/02/13 \u00b6 Now supports the Oregon Scientific WMR918/968 series, courtesy of user William Page. Thanks, William!! Now supports the Fine Offset series of weather stations, thanks to user Matthew Wall. Thanks, Matthew!! Now includes a Redhat init.d script, contributed by Mark Jenks. Thanks, Mark!! Added rsync report type as an alternative to the existing FTP report. Another thanks to William Page! Fill color for bar charts can now be specified separately from the outline color, resulting in much more attractive charts. Another thanks to Matthew Wall!! Added a tag for trends. The barometer trend can now be returned as $trend.barometer. Similar syntax for other observation types. config_vp.py now returns the console version number if available (older consoles do not offer this). Hardware dewpoint calculations with the WMR100 seem to be unreliable below about 20F, so these are now done in software. Thanks to user Mark Jenks for sleuthing this. 2.0.2 11/23/12 \u00b6 Now allows both the archive and stats data to be held in the same database. Improved chances of weewx.Archive being reused by allowing optional table name to be specified. 2.0.1 11/05/12 \u00b6 Fixed problem with reconfiguring databases to a new unit system. 2.0.0 11/04/12 \u00b6 A big release with lots of changes. The two most important are the support of additional weather hardware, and the support of the MySQL database. All skin configurations are backwardly compatible, but the configuration file, weewx.conf, is not. The install utility setup.py will install a fresh version, which you will then have to edit by hand. If you have written a custom service, see the upgrade guide on how to port your service to the new architecture. Added the ability to generate archive records in software, thus opening the door for supporting weather stations that do not have a logger. Support for the Oregon Scientific WMR100, the cheapest weather station I could find, in order to demonstrate the above! Added a software weather station simulator. Introduced weedb, a database-independent Python wrapper around sqlite3 and MySQLdb, which fixes some of their flaws. Ported everything to use weedb, and thus MySQL (as well as sqlite) Internally, the databases can now use either Metric units, or US Customary. NB: you cannot switch systems in the middle of a database. You have to stick to one or other other. However, the utility config_database.py does have a reconfigure option that allows copying the data to a new database, performing the conversion along the way. See the Customization Guide. You can now use \"mmHg\" as a unit of pressure. Added new almanac information, such as first and last quarter moons, and civil twilight. Changed the engine architecture so it is more event driven. It now uses callbacks, making it easier to add new event types. Added utility config_vp.py, for configuring the VantagePro hardware. Added utility config_database.py, for configuring the databases. Made it easier to write custom RESTful protocols. Thanks to user Brad, for the idea and the use case! The stats type 'squarecount' now contains the number of valid wind directions that went into calculating 'xsum' and 'ysum'. It used to be the number of valid wind speeds. Wind direction is now calculated using 'squarecount' (instead of 'count'). Simplified and reduced the memory requirements of the CRC16 calculations. Improved test suites. Lots of little nips and tucks here and there, mostly to reduce the coupling between different modules. In particular, now a service generally gets configured only using its section of weewx.conf. I also worked hard at making sure that cursors, connections, files, and lots of other bits and pieces get properly closed instead of relying on garbage collection. Hopefully, this will reduce the long-term growth of memory usage. 1.14.1 07/06/12 \u00b6 Hardened retry strategy for the WeatherLink IP. If the port fails to open at all, or a socket error occurs, it will thrown an exception (resulting in a retry in 60 seconds). If a socket returns an incomplete result, it will continue to retry until everything has been read. Fixed minor bug that causes the reporting thread to prematurely terminate if an exception is thrown while doing an FTP. 1.14.0 06/18/12 \u00b6 Added smartphone formatted mobile webpage, contributed by user Torbj\u00f6rn Einarsson. If you are doing a fresh install, then these pages will be generated automatically. If you are doing an upgrade, then see the upgrade guide on how to have these webpages generated. Thanks, Tobbe! Three changes suggested by user Charlie Spirakis: o Changed umask in daemon.py to 0022; o Allow location of process ID file to be specified on the command line of weewx; o Start script allows daemon to be run as a specific user. Thanks, Charlie! Corrected bug in humidity reports to CWOP that shows itself when the humidity is in the single digits. Now includes software in CWOP APRS equipment field. 1.13.2 05/02/12 \u00b6 Now allows CWOP stations with prefix 'EW'. Fixed bug that showed itself in the line color with plots with 3 or more lines. Changed debug message when reaching the end of memory in the VP2 to something slightly less alarming. 1.13.1 03/25/12 \u00b6 Added finer control over the line plots. Can now add optional markers. The marker_type can be 'none' (the default), 'cross', 'box', 'circle', or 'x'. Also, line_type can now either be 'solid' (the default) or 'none' (for scatter plots). Same day I'll add 'dashed', but not now. :-) Conditionally imports sqlite3. If it does not support the \"with\" statement, then imports pysqlite2 as sqlite3. 1.13.0 03/13/12 \u00b6 The binding to the SQL database to be used now happens much later when running reports. This allows more than one database to be used when running a report. Extra databases can be specified in the option list for a report. I use this to display broadband bandwidth information, which was collected by a separate program. Email me for details on how to do this. Introducing this feature changed the signature of a few functions. See the upgrade guide for details. 1.12.4 02/13/12 \u00b6 User Alf H\u00f8gemark found an error in the encoding of solar data for CWOP and sent me a fix. Thanks, Alf! Now always uses \"import sqlite3\", resulting in using the version of pysqlite that comes with Python. This means the install instructions have been simplified. Now doesn't choke when using the (rare) Python version of NameMapper used by Cheetah. 1.12.3 02/09/12 \u00b6 Added start script for FreeBSD, courtesy of user Fabian Abplanalp. Thanks, Fabian! Added the ability to respond to a \"status\" query to the Debian startup script. RESTful posts can now recover from more HTTP errors. Station serial port can now recover from a SerialException error (usually caused when there is a process competing for the serial port). Continue to fiddle with the retry logic when reading LOOP data. 1.12.2 01/18/12 \u00b6 Added check for FTP error code '521' to the list of possibilities if a directory already exists. Thanks to user Clyde! More complete information when unable to load a module file. Thanks, Jason! Added a few new unit types to the list of possible target units when using explicit conversion. Thanks, Antonio! Discovered and fixed problem caused by the Davis docs giving the wrong \"resend\" code (should be decimal 21, not hex 21). Improved robustness of VantagePro configuration utility. Fixed problem where an exception gets thrown when changing VP archive interval. Simplified some of the logic in the VP2 driver. 1.12.1 11/03/11 \u00b6 Now corrects for rain bucket size if it is something other than the standard 0.01 inch bucket. 1.12.0 10/29/11 \u00b6 Added the ability to change bucket type, rain year start, and barometer calibration data in the console using the utility configure.py. Added option \"--info\", which queries the console and returns information about EEPROM settings. Changed configure.py so it can do hardware-specific configurations, in anticipation of supporting hardware besides the Davis series. Reorganized the documentation. 1.11.0 10/06/11 \u00b6 Added support for the Davis WeatherLinkIP. Thanks, Peter Nock and Travis Pickle! Added support for older Rev A type archive records. Added patch from user Dan Haller that sends UV and radiation data to the WeatherUnderground if available. Thanks, Dan! Added patch from user Marijn Vriens that allows fallback to the version of pysqlite that comes with many versions of Python. Thanks, Marijn! Now does garbage collection after an archive record is obtained and before the main loop is restarted. 1.10.2 04/14/11 \u00b6 Added RA and declination for the Sun and Moon to the Daily Almanac. Equinox and solstice are now displayed in chronological order. Same with new and full moons. Examples alarm.py and lowBattery.py now include more error checks, allow an optional 'subject' line to the sent email, and allow a comma separated list of recipients. 1.10.1 03/30/11 \u00b6 Substitutes US Units if a user does not specify anything (instead of exception KeyError). Almanac uses default temperature and pressure if they are 'None'. Prettied up web page almanac data in the case where pyephem has not been installed. Fixed up malformed CSS script weewx.css. 1.10.0 03/29/11 \u00b6 Added extensive almanac information if the optional package 'pyephem' has been installed Added a weewx \"favorite icon\" favicon.ico that displays in your browser toolbar. Added a mobile formatted HTML page, courtesy of user Vince Skahan (thanks, Vince!!). Tags can now be ended with a unit type to convert to a new unit. For example, say your pressure group (\"group_pressure\") has been set to show inHg. The normal tag notation of \"$day.barometer.avg\" will show something like \"30.05 inHg\". However, the tag \"$day.barometer.avg.mbar\" will show \"1017.5 mbar\". Added special tag \"exists\" to test whether an observation type exists. Example \"$year.foo.exists\" will return False if there is no type \"foo\" in the statistical database. Added special tag \"has_data\" to test whether an observation type exists and has a non-zero number of data points over the aggregation period. For example, \"$year.soilMoist1.has_data\" will return \"True\" if soilMoist1 both exists in the stats database and contains some data (meaning, you have the hardware). Y-axis plot labels (such as \"\u00b0F\") can now be overridden in the plot configuration section of skin.conf by using option \"y_label\". Added executable module \"runreports.py\" for running report generation only. Added package \"user\", which can contain any user extensions. This package will not get overridden in the upgrade process. Added the ability to reconfigure the main database, i.e., add or drop data types. Along the same line, statistical types can also be added or dropped. Email me for details on how to do this. Now makes all of the LOOP and archive data available to services. This includes new keys: LOOP data: 'extraAlarm1' 'extraAlarm2' 'extraAlarm3' 'extraAlarm4' 'extraAlarm5' 'extraAlarm6' 'extraAlarm7' 'extraAlarm8' 'forecastIcon' 'forecastRule' 'insideAlarm' 'outsideAlarm1' 'outsideAlarm2' 'rainAlarm' 'soilLeafAlarm1' 'soilLeafAlarm2' 'soilLeafAlarm3' 'soilLeafAlarm4' 'sunrise' 'sunset' Archive data: 'forecastRule' 'highOutTemp' 'highRadiation' 'highUV' 'lowOutTemp' Started a more formal test suite. There are now tests for the report generators. These are not included in the normal distribution, but can be retrieved from SourceForge via svn. 1.9.3 02/04/11 \u00b6 Now correctly decodes temperatures from LOOP packets as signed shorts (rather than unsigned). Now does a CRC check on LOOP data. Changed VantagePro.accumulateLoop to make it slightly more robust. 1.9.2 11/20/10 \u00b6 Now catches exception of type OverflowError when calculating celsius dewpoint. (Despite the documentation indicating otherwise, math.log() can still throw an OverflowError) Fixed bug that causes crash in VantagePro.accumulateLoop() during fall DST transition in certain situations. VP2 does not store records during the one hour fall DST transition. Improved logic in dealing with this. Changed install so that it backs up the ./bin subdirectory, then overwrites the old one. Also, does not install the ./skins subdirectory at all if one already exists (thus preserving any user customization). 1.9.1 09/09/10 \u00b6 Now catches exceptions of type httplib.BadStatusLine when doing RESTful posts. Added an extra decimal point of precision to dew point reports to the Weather Underground and PWS. 1.9.0 07/04/10 \u00b6 Added a new service, StdQC, that offers a rudimentary data check. Corrected error in rain year total if rain year does not start in January. Moved option max_drift (the max amount of clock drift to tolerate) to section [Station]. Added check for a bad storm start time. Added checks for bad dateTime. Simplified VantagePro module. 1.8.4 06/06/10 \u00b6 Fixed problem that shows itself if weewx starts up at precisely the beginning of an archive interval. Symptom is max recursion depth exceeded. Units for UV in LOOP records corrected. Also, introduced new group for UV, group_uv_index. Thanks to user A. Burriel for this fix! 1.8.3 05/20/10 \u00b6 Problem with configuring archive interval found and fixed by user A. Burriel (thanks, Antonio!) 1.8.2 05/09/10 \u00b6 Added check to skip calibration for a type that doesn't exist in LOOP or archive records. This allows windSpeed and windGust to be calibrated separately. 1.8.1 05/01/10 \u00b6 Ported to Cheetah V2.4.X 1.8.0 04/28/10 \u00b6 Added CWOP support. Storage of LOOP and archive data into the SQL databases is now just another service, StdArchive. Added a calibration service, StdCalibrate, that can correct LOOP and archive data. Average console battery voltage is now calculated from LOOP data, and saved to the archive as 'consBatteryVoltage'. Transmitter battery status is now ORd together from LOOP data, and saved to the archive as 'txBatteryStatus'. Added stack tracebacks for unrecoverable exceptions. Added a wrapper to the serial port in the VantagePro code. When used in a Python \"with\" statement, it automatically releases the serial port if an exception happens, allowing a more orderly shutdown. Offered some hints in the documentation on how to automount your VP2 when using a USB connection. Corrected error in units. getTargetType() that showed itself with when the console memory was freshly cleared, then tried to graph something immediately. 1.7.0 04/15/10 \u00b6 Big update. Reports now use skins for their \"look or feel.\" Options specific to the presentation layer have been moved out of the weewx configuration file 'weewx.conf' to a skin configuration file, 'skin.conf'. Other options have remained behind. Because the configuration file weewx.conf was split, the installation script setup.py will NOT merge your old configuration file into the new one. You will have to reedit weewx.conf to put in your customizations. FTP is treated as just another report, albeit with an unusual generator. You can have multiple FTP sessions, each to a different server, or uploading to or from a different area. Rewrote the FTP upload package so that it allows more than one FTP session to be active in the same local directory. This version also does fewer hits on the server, so it is significantly faster. The configuration files weewx.conf and skin.conf now expect UTF-8 characters throughout. The encoding for reports generated from templates can be chosen. By default, the day, week, month, and year HTML files are encoded using HTML entities; the NOAA reports encoded using 'strict ascii.' Optionally, reports can be encoded using UTF-8. Revamped the template formatting. No longer use class ModelView. Went to a simpler system built around classes ValueHelper and UnitInfo. Optional formatting was added to all tags in the templates. There are now optional endings: 'string': Use specified string for None value. 'formatted': No label. 'format': Format using specified string format. 'nolabel': Format using specified string format; no label. 'raw': return the underlying data with no string formatting or label. For the index, week, month, and year template files, added conditional to not include ISS extended types (UV, radiation, ET) unless they exist. Added an RSS feed. Added support for PWSweather.com Both WeatherUnderground and PWSweather posts are now retried up to 3 times before giving up. Now offer a section 'Extras' in the skin configuration file for including tags added by the user. As an example, the tag radar_url has been moved into here. Data files used in reports (such as weewx.css) are copied over to the HTML directory on program startup. Included an example of a low-battery alarm. Rearranged distribution directory structure so that it matches the install directory structure. Moved base temperature for heating and cooling degree days into skin.conf. They now also require a unit. Now require unit to be specified for 'altitude'. 1.5.0 03/07/10 \u00b6 Added support for other units besides the U.S. Customary. Plots and HTML reports can be prepared using any arbitrary combination of units. For example, pressure could be in millibars, while everything else is in U.S. Customary. Because the configuration file weewx.conf changed significantly, the installation script setup.py will NOT merge your old configuration file into the new one. You will have to reedit weewx.conf to put in your customizations. Added an exception handler for exception OSError, which is typically thrown when another piece of software attempts to access the same device port. Weewx catches the exception, waits 10 seconds, then starts again from the top. 1.4.0 02/22/10 \u00b6 Changed the architecture of stats.py to one that uses very late binding. The SQL statements are not run until template evaluation. This reduces the amount of memory required (by about 1/2), reduces memory fragmentation, as well as greatly simplifying the code (file stats.py shed over 150 lines of non-test code). Execution time is slightly slower for NOAA file generation, slightly faster for HTML file generation, the same for image generation, although your actual results will depend on your disk speed. Now possible to tell weewx to reread the configuration file without stopping it. Send signal HUP to the process. Added option week_start, for specifying which day a calendar week starts on. Default is 6 (Sunday). Fixed reporting bug when the reporting time falls on a calendar month or year boundary. 1.3.4 02/08/10 \u00b6 Fixed problem when plotting data where all data points are bad (None). 1.3.3 01/10/10 \u00b6 Fixed reporting bug that shows itself if rain year does not start in January. 1.3.2 12/26/09 \u00b6 LOOP data added to stats database. 1.3.1 12/22/09 \u00b6 Added a call to syslog.openlog() that inadvertently got left out when switching to the engine driven architecture. 1.3.0 12/21/09 \u00b6 Moved to a very different architecture to drive weewx. Consists of an engine, that manages a list of 'services.' At key events, each service is given a chance to participate. Services are easy to add, to allow easy customization. An example is offered of an 'alarm' service. Checking the clock of the weather station for drift is now a service, so the option clock_check was moved from the station specific [VantagePro] section to the more general [Station] section. Added an example service 'MyAlarm', which sends out an email should the outside temperature drop below 40 degrees. In a similar manner, all generated files, images, and reports are the product of a report engine, which can run any number of reports. New reports are easily added. Moved the compass rose used in progressive vector plots into the interior of the plot. Install now deletes public_html/#upstream.last, thus forcing all files to be uploaded to the web server at the next opportunity. 1.2.0 11/22/09 \u00b6 Added progressive vector plots for wind data. Improved axis scaling. The automatic axis scaling routine now does a better job for ranges less than 1.0. The user can also hardwire in min and max values, as well as specify a minimum increment, through parameter 'yscale' in section [Images] in the configuration file. Now allows the same SQL type to be used more than once in a plot. This allows, say, instantaneous and average wind speed to be shown in the same plot. Rain year is now parameterized in file templates/year.tmpl (instead of being hardwired in). Now does LOOP caching by default. When doing backfilling to the stats database, configure now creates the stats database if it doesn't already exist. setup.py now more robust to upgrading the FTP and Wunderground sections 1.1.0 11/14/09 \u00b6 Added the ability to cache LOOP data. This can dramatically reduce the number of writes to the stats database, reducing wear on solid-state disk stores. Introduced module weewx.mainloop. Introduced class weewx.mainloop.MainLoop This class offers many opportunities to customize weewx through subclassing, then overriding an appropriate member function. Refactored module weewx.wunderground so it more closely resembles the (better) logic in wunderfixer. setup.py no longer installs a daemon startup script to /etc/init.d. It must now be done by hand. setup.py now uses the 'home' value in setup.cfg to set WEEWX_ROOT in weewx.conf and in the daemon start up scripts Now uses FTP passive mode by default. 1.0.1 11/09/09 \u00b6 Fixed bug that prevented backfilling the stats database after modifying the main archive. 1.0.0 10/26/09 \u00b6 Took the module weewx.factory back out, as it was too complicated and hard to understand. Added support for generating NOAA monthly and yearly reports. Completely rewrote the filegenerator.py module, to allow easy subclassing and specialization. Completely rewrote the stats.py module. All aggregate quantities are now calculated dynamically. Labels for HTML generation are now held separately from labels used for image generation. This allows entities such as '\u00b0' to be used for the former. LOOP mode now requests only 200 LOOP records (instead of the old 2000). It then renews the request should it run out. This was to get around an (undocumented) limitation in the VP2 that limits the number of LOOP records that can be requested to something like 220. This was a problem when supporting VP2s that use long archive intervals. Cut down the amount of computing that went on before the processing thread was spawned, thus allowing the main thread to get back into LOOP mode more quickly. Added type 'rainRate' to the types decoded from a Davis archive record. For some reason it was left out. Added retries when doing FTP uploads. It will now attempt the upload several times before giving up. Much more extensive DEBUG analysis. Nipped and tucked here and there, trying to simplify. 0.6.5 10/11/09 \u00b6 Ported to Cheetah V2.2.X. Mostly, this is making sure that all strings that cannot be converted with the 'ascii' codec are converted to Unicode first before feeding to Cheetah. 0.6.4 09/22/09 \u00b6 Fixed an error in the calculation of heat index. 0.6.3 08/25/09 \u00b6 FTP transfers now default to ACTIVE mode, but a configuration file option allows PASSIVE mode. This was necessary to support Microsoft FTP servers. 0.6.2 08/01/09 \u00b6 Exception handling in weewx/ftpdata.py used socket.error but failed to declare it. Added 'import socket' to fix. Added more complete check for unused pages in weewx/VantagePro.py. Now the entire record must be filled with 0xff, not just the time field. This fixes a bug where certain time stamps could look like unused records. 0.6.1 06/22/09 \u00b6 Fixed minor ftp bug. 0.6.0 05/20/09 \u00b6 Changed the file, imaging, ftping functions into objects, so they can be more easily specialized by the user. Introduced a StationData object. Introduced module weewx.factory that produces these things, so the user has a place to inject his/her new types. 0.5.1 05/13/09 \u00b6 Weather Underground thread now run as daemon thread, allowing the program to exit even if it is running. WU queue now hold an instance of archive and the time to be published, rather than a record. This allows dailyrain to be published as well. WU date is now given in the format \"2009-05-13+12%3A35%3A00\" rather than \"2009-05-13 12:35:00\". Seems to be more reliable. But, maybe I'm imagining things...","title":"Change log"},{"location":"changes/#weewx-change-history","text":"","title":"WeeWX change history"},{"location":"changes/#500-mmddyyyy","text":"Python 2.7 is no longer supported. You must have Python 3.7 (introduced May 2018) or greater. WeeWX can now be installed using pip . With pip installs, station data is stored in ~/weewx-data by default, instead of /home/weewx . This allows pip installs to be done without root privileges. However, /home/weewx can still be used. The new utility weectl replaces wee_database , wee_debug , wee_device , wee_extension , and wee_config . Try weectl --help to see how to use it. Documentation now uses MkDocs . Package installs now use systemd instead of the old System V /etc/init.d . Removed all references to the deprecated package distutils , which is due to be removed in Python v3.12. Removed the utility wunderfixer . The Weather Underground seems to no longer allow posting past-dated records. Logging handler rotate has been removed. Its need to access the privileged location /var/log/ on start up would cause crashes, even if it was never used. Users can opt to add it back in by following the wiki on Logging . MacOS now logs to syslog like any other system, rather than rotate . Method ImageDraw.textsize() and constants ImageFont.LAYOUT_BASIC , and Image.ANTIALIAS were deprecated in Pillow 9.2 (1-Jul-2022), then removed in Pillow 10.0 (1-Jul-2023). V5.0 replaces them with alternatives. Fixes issue #884 . Fix bug when using Pillow v9.5.0. Fixes issue #862 . The Standard skin now uses the font DejaVuSansMono-Bold and includes a copy. Before, it had to rely on hardwired font paths, which were less reliable. If the uploaders get a response code of 429 (\"TOO MANY REQUESTS\"), they no longer bother trying again. Limit station registration to once a day, max. Station registration now uses HTTP POST, instead of HTTP GET. Station registration is delayed by a random length of time to avoid everyone hitting the server at the same time. Fix problem where aggregation of null wind directions returns 90\u00b0 instead of null. Fixes issue #849 . Fix wrong station type for Vantage weectl device --info query. Add retransmit information for Vantage weectl device --info query. Fix problem when setting Vantage repeater. Fixes issue #863 . Detect \"dash\" values for rain-related measurements on Vantage stations. Change aggregations minsumtime and maxsumtime to return start-of-day, rather than the time of max rainfall during the day. Relax requirement that column dateTime be the first column in the database. Fixes issue #855 . Allow aggregation of xtypes that are not in the database schema. Fixes issue #864 . Tag suffix has_data() now works for xtypes. Fixes issue #877 . Additional shorthand notations for aggregation and trend intervals. For example, 3h for three hours. Accumulator firstlast no longer coerces values to a string. Thanks to user \"Karen\" for spotting this! Fix problem that caused crashes with firstlast accumulator type. Fixes issue #876 . Fixed problem that prevented the astrometric heliocentric longitude of a body from being calculated properly. Default format for azimuth properties (such as wind direction) is now zero padded 3 digits. E.g., 005\u00b0 instead of 5\u00b0 . Most almanac properties are now returned as ValueHelpers , so they will obey local formatting conventions (in particular, decimal separators). To avoid breaking old skins, these properties now have new names. For example, use $almanac.venus.altitude instead of $almanac.venus.alt . Fix problem that prevented database from getting hit when calculating pressure . Fixes issue #875 . Fix problem that prevented option stale_age from being honored in image generation. Thanks to user Ian for PR #879 ! Fix problem that prevented complex aggregates such as max_ge from being used in plots. Fixes issue #881 . Updated humidex formula and reference. Fixes issue #883 . Fix bugs in the \"basic\" skin example. Fix bug that prevented calculating $trend when one of the two records is missing. Fix bug that caused the extension installer to crash if one of the service groups was missing in the configuration file. Fixes issue #886 . New option retry_wait . If weewxd encounters a critical error, it will sleep this long before doing a restart. Change from old Google Analytics UA code to the GA4 tag system in the Standard and Seasons skins. Fixes issue #892 .","title":"5.0.0 MM/DD/YYYY"},{"location":"changes/#4102-02222023","text":"Removed errant \"f-string\" in imagegenerator.py . Added missing .long_form to celestial.inc that would cause total daylight to be given in seconds, instead of long form. Fix problem that a None value in long_form() would raise an exception. PR #843. Thanks to user Karen! The module user.extensions is now imported into wee_reports . Thanks to user jocelynj! PR #842. Fix problem that prevented wee_device --set-retransmit from working on Vantage stations. Using a bad data binding with an aggregation tag no longer results in an exception. Instead, it shows the tag in the results. Related to PR #817.","title":"4.10.2 02/22/2023"},{"location":"changes/#4101-01302023","text":"Logging handler rotate has been removed. Its need to access privileged location /var/log/weewx.log on start up would cause crashes, even if it was never used.","title":"4.10.1 01/30/2023"},{"location":"changes/#4100-01292023","text":"Don't inject txBatteryStatus and consBatteryVoltage into records in the Vantage driver. Let the accumulators do it. Fixes issue #802. Different wake-up strategy for the Vantage console. Do not write config_path and entry_path to updated configuration dictionary. Fixes issue #806. Allow more flexible formatting for delta times. This can break old skins. See Upgrade Guide. PR #807. Fix bug that prevents group_deltatime from being used by timespans. Users who used custom formatting for delta times will be affected. See the Upgrade Guide. Fixes issue #808. Add suffix .length to class TimespanBinder. This allows expressions such as $month.length. PR #809. Thanks to user Karen! Added new unit hertz . PR #812. Again, thanks to user Karen! Calculate *.wind.maxtime out of windGust like *.wind.max Fixes issue #833 Fix bug that prevents group_deltatime from being used by timespans. Users Add suffix .length to class TimespanBinder. This allows expressions such as Option line_gap_fraction can now be used with bar plots. Fixes issue #818.","title":"4.10.0 01/29/2023"},{"location":"changes/#491-10252022","text":"Fix problem with wind for older versions of sqlite.","title":"4.9.1 10/25/2022"},{"location":"changes/#490-10242022","text":"Fix problem that create 'ghost' values for VantageVue stations. Fix problem that causes leafWet3 and leafWet4 to be emitted in VP2 stations that do not have the necessary sensors. Fixes issue #771. Try waking the Vantage console before giving up on LOOP errors. Better Vantage diagnostics. Fixes issue #772. Add missing 30-day barometer graph to Smartphone skin. Fixes issue #774. Fix check for reuse_ssl for Python versions greater than 3.10. Fixes issue #775. The utility wee_reports can now be invoked by specifying a --date and --time . Fixes issue #776. Allow timestamps that are not integers. Fixes issue #779. Add localization file for Traditional Chinese. Thanks to user lyuxingliu! PR #777. Don't swallow syntax errors when wee_config is looking for drivers. Include wind in daily summary if windSpeed is present. Refine translations for French skin. Thanks to user Pascal! Allow a custom cipher to be specified for FTP uploads. See option cipher under [[FTP]] . Ensure that rundir exists and has correct permissions in weewx-multi Allow auto-provisioning feature of Seasons to work when using a SQL expression for option data_type in the ImageGenerator. Fixes issue #782. Allow constants albedo , cn , and cd to be specified when calculating ET. See the User's Guide. Resolves issue #730. Fix problem that prevented wee_reports from using a default location for weewx.conf . Post location of the configuration file and the top-level module to the station registry. Thanks to Vince! PR #705. Fix minor install warning under Python 3.10. Fixes issue #799. Fix problem where xtypes.ArchiveTable.get_series() does not pass option_dict on to get_aggregate() . Fixes issue #797 Added copytruncate option to default log rotation configuration. Thanks to user sastorsl. Addresses PR #791. Update the default and example rules in rsyslog configuration. The output from the weewx daemon goes to weewxd.log whereas the output from wee_xxx utilities goes to weewx.log . Also added examples of how to deal with systemd/journald messing with log output. Addresses PR #788 and PR #790. Thanks to user sastorsl. Allow additional aggregation intervals for observation type $wind . In particular, vecdir and vecavg can be done for aggregation intervals other than multiples of a day. Fixes issue #800.","title":"4.9.0 10/24/2022"},{"location":"changes/#480-04212022","text":"Allow unit to be overridden for a specific plot by using new option unit . Fixes issue #729. Fix problem that prevented wind from appearing in NOAA yearly summaries. Fix honoring global values for log_success and log_failure . Fix issue #757. wee_import CSV imports now allow import of text fields. Addresses issue #732. Explain in the Customization Guide how to include arbitrary SQL expressions in a plot. Reorder font download order, for slightly faster downloads. Fix issue #760. Add observation types highOutTemp and lowOutTemp to group_temperature. Add unit groups for sunshine and rain duration, cloudcover, and pop. PR #765 Do not allow HUP signals (reload is not allowed as of V4.6). PR #766. Do not fork if using systemd. PR #767. Fix problem that prevented wee_config --reconfigure from working when using Python 2.7, if the configuration file contained UTF-8 characters.","title":"4.8.0 04/21/2022"},{"location":"changes/#470-03012022","text":"Introduced new option generate_once . If True , templates will be generated only on the first run of the reporting engine. Thanks to user Rich! PR #748. Added option wee_device --current for Vantage. Fixed two typos in the Standard skin. Fixed spelling mistakes in the Norwegian translations. Thanks to Aslak! PR#746 Supply a sensible default context for group_deltatime when no context has been specified. If windGustDir is missing, extract a value from the accumulators. Fixed typo that shows itself if no [Labels]/[[Generic]] section is supplied. Fixes issue #752. Fixed calculation of field bar_reduction for Vantage type 2 LOOP packets. Fix problem that prevents windSpeed and windDir from being displayed in the RSS feed. Fixes issue #755.","title":"4.7.0 03/01/2022"},{"location":"changes/#462-02102022","text":"Removed diagnostic code that was inadverently left in the titlebar.inc file in Seasons skin.","title":"4.6.2 02/10/2022"},{"location":"changes/#461-02102022","text":"Make the show_rss and show_reports flags work properly. Fixes issue #739. Added $to_list() utility for use in Cheetah templates. Fixed a few more untranslated fields in Seasons skin. Observation types that use the sum extractor are set to None if no LOOP packets contributed to the accumulator. Fixes issue #737. Added ppm as default group_fraction . Added default label string for ppm . Added Norwegian translations. Thanks to user Aslak! PR #742. Fixed problem that caused wee_database --check-strings / --fix-strings to fail on TEXT fields. Fixes issue #738.","title":"4.6.1 02/10/2022"},{"location":"changes/#460-02042022","text":"Easy localization of all skins that come with WeeWX. Big thanks to user Karen, who drove the effort! PR #665. Allow options --date , --from , and --to to be used with wee_database --reweight . PR #659. Thanks to user edi-x! Added Cheetah helper functions $jsonize() , $rnd() , and $to_int() . The tag $alltime , formerly available as an example, is now a part of WeeWX core. New SLE example $colorize() . New document on how to write SLEs. Added conversions for unix_epoch_ms and unix_epoch_ns . Calculations in celestial.inc now explicitly use unix_epoch . Added almanac attribute visible and visible_change . For example, $almanac.sun.visible returns the amount of daylight, $almanac.sun.visible_change the difference since yesterday. Fixed problem that could cause weather xtypes services not to shut down properly. PR #672. Thanks again to user edi-x! Added Cheetah tag $filename , the relative path of the generated file. Useful for setting canonical URLs. PR #671. Thanks again to user Karen! XType get_scalar() and get_series() calls can now take extra keyword arguments. PR #673. Fixed problem where a bad clock packet could crash the WMR100 driver. Davis documentation for LOOP2 10-minute wind gusts is wrong. The Vantage actually emits mph, not tenths of mph. Changed driver so it now decodes the field correctly. Fixes issue #686. Sending a HUP signal to weewxd no longer causes the configuration file to be reread. Logging is not done until after the configuration file has been read. This allows customized logging to start from the very beginning. Fixes issue #699. Simplified the logging of Cheetah exceptions to show only what's relevant. Fixes issue #700. Include a requirements.txt file, for installing using pip. Thanks to user Cl\u00e9ment! PR #691. Fixed problem where ConfigObj interpolation would interfere with setting logging formats. Added option --batch-size to the Vantage version of wee_device . See PR #693. Slightly faster evaluation of the tag suffix has_data . New aggregation type not_null . A string in the database no longer raises an error. Fixes issue #695. Added plot option skip_if_empty . If set to True , and there is no non-null data in the plot, then the plot will not be generated at all. If set to a time domain (such as year ), then it will do the check over that domain. See PR #702. Parameterized the Seasons skin, making it considerably smaller, while requiring less configuration. It now includes all types found in the wview-extended schema. See PR #702. New FTP option ftp_encoding for oddball FTP servers that send their responses back in something other than UTF-8. Availability of the pyephem module and extended almanac data is now logged during startup. Added column for last contact in the sensor status table in the Season skin to help diagnose missing/flaky sensors. Fix the weewx.debian and weewx-multi init scripts to work with non-root user. Added sample tmpfiles configuration to ensure run directory on modern systems when running weewx as non-root user. Fixed bug that prevented the ssh port from being specified when using rsync. Fixes issue #725. Improved alphanumeric sorting of loop packet/archive record fields displayed when WeeWX is run directly. Added sample weewxd init file for 'service' based init on freebsd. Thanks to user ryan. Added i18n-report utility to help check skins for translated strings.","title":"4.6.0 02/04/2022"},{"location":"changes/#451-04022021","text":"Reverted the wview schema back to the V3 style. Fixed problem where setup.py would fail if the station description used UTF-8 characters. Fixed problem where unit labels would not render correctly under Python 2.7 if they were set by a 3rd party extension. Fixes issue #662. Added TCP support to the WS1 driver. Thanks to user Mike Juniper! Fixes issue #664.","title":"4.5.1 04/02/2021"},{"location":"changes/#450-04022021","text":"The utility wee_database has new options --add-column , --rename-column , and --drop-columns for adding, renaming, and deleting columns in the database. New optional tag .series() , for creating and formatting series in templates. See the document Tabs for series in the wiki. This is still experimental and subject to change! Addresses issue #341. New optional tag .json() for formatting results as JSON. New optional tag .round() . Useful for rounding results of .raw and .json options. Improved performance when calculating series using aggregation periods that are multiples of a day. Changed NOAA reports to use the normalized_ascii encoding instead of utf8 (which did not display correctly for most browsers). Fixes issue #646. Plots longer than 2 years use a 6 month time increment. Uploads to PWSWeather and WOW now use HTTPS. Fixes issue #650. Fixed bug that prevented the Vantage driver from waiting before a wakeup retry. Thanks to user Les Niles! Changed the way of expressing the old \"wview\" schema to the new V4 way. Hopefully, this will lead to fewer support issues. Fixes issue #651. Fixed problem where iterating over a time period without an aggregation would wrongly include the record on the left. Fixed bug that caused the incorrect label to be applied to plots where the aggregation type changes the unit. Fixes issue #654. Plots now locate the x-coordinate in the middle of the aggregation interval for all aggregation types (not just min, max, avg). Revisits PR #232. Added new time units unix_epoch_ms and unix_epoch_ns , which are unix epoch time in milliseconds and nanoseconds, respectively. The FTP uploader now calculates and saves a hash value for each uploaded file. If it does not change, the file is not uploaded, resulting in significant time savings. PR #655. Thanks to user Karen! Updated the version of six.py included with WeeWX to 1.15.0. Fixes issue #657. Option aggregate_interval can now be specified by using one of the \"shortcuts\", that is, hour , day , week , month , or year . Options log_success and log_failure are now honored by the StdArchive and StdQC services. Fixes issue #727.","title":"4.5.0 04/02/2021"},{"location":"changes/#440-01302021","text":"StdWXCalculate can now do calculations for only LOOP packets, only archive records, or both. PR #630. Thanks to user g-eddy! Introduced aggregate types avg_ge and avg_le . PR #631. Thanks to user edi-x! NOAA reports now use a utf8 encoding instead of strict_ascii . This will only affect new installations. Fixes issue #644. Introduced new encoding type normalized_ascii , which replaces characters that have accented marks with analogous ascii characters. For example, \u00f6 gets replaced with o. Patching process is more forgiving about records with interval less than or equal to zero. Fixed problem where invalid mintime or maxtime was returned for days with no data. Fixes issue #635. Syntax errors in weewx.conf are now logged. PR #637. Thanks to user Rich Bell! Fixed problem where plots could fail if the data range was outside of a specified axes range. Fixes issue #638. Fixed problem that could cause reporting to fail under Python2.7 if the configuration dictionary contained a comment with a UTF-8 character. Fixes issue #639. Fixed problem that could cause program to crash if asking for deltas of a non- existent key. The version 4.3.0 patch to fix the incorrect calculation of sums in the daily summary tables itself contained a bug. This version includes a patch to fix the problem. It runs once at startup. Fixes issue #642.","title":"4.4.0 01/30/2021"},{"location":"changes/#430-01042020","text":"Version 4.2.0 had a bug, which caused the sums in the daily summary to be incorrectly calculated. This version includes a patch to fix the problem. It runs once at startup. Fixes issue #623. The WMR200 driver is no longer supported. An unsupported version can be found at https://github.com/weewx/weewx-wmr200 . Support for LaCrosse WS23xx and Oregon WMR300 will continue. Service weewx.wxxtypes.StdDelta was inadvertently left out of the list of services to be run. Fortunately, it is not used. Yet. Added it back in. Added the \"old\" NWS algorithm as an option for calculating heat index. Changed how various undocumented parameters in [StdWXCalculate] are specified. The only one people are likely to have used is ignore_zero_wind . Its name has changed to force_null , and it has been moved. See the Upgrading Guide . Documented the various [StdWXCalculate] options. Fixed corner case for windDir when using software record generation, ignore_zero_wind=True , and windSpeed=0 for entire record interval. Now emits last windDir value. Fixed problem when looking up stars with more than one word in their name. Fixes issue #620. Fixed problem where wind gust direction is not available when using software record generation. Added --no-prompt action to wee_import , allowing wee_import to be run unattended. Fixed problem that prevented option observations from being used in the simulator. Thanks to user Graham! Fixed problem where wind chill was calculated incorrectly for METRICWX databases. PR #627. Thanks to user edi-x! Allow wind vectors to be converted to unit of beaufort. Fixes issue #629. Option log_failure under [StdReport] is set to True by the upgrade process. See the Upgrading Guide .","title":"4.3.0 01/04/2020"},{"location":"changes/#420-10262020","text":"CHANGES COMING! This is the last release that will support the LaCrosse WS23xx, Oregon WMR200 and WMR300 stations. In the future, they will be published as unsupported extensions. Made it easier to add new, derived types via StdWXCalculate . Fixes issue #491. Changed the tag system slightly in order to make it possible for the XTypes system to add new aggregations that take an argument. Added the new data types in the extended_wview schema to the WeeWX types system. Fixes issue #613. Added ability to label left, right or both y-axes of graphs. PR #610. Fixes issue #609. Thanks to user Brent Fraser! Added units and labels for the lightning data types. Fixed problem where threads attempt to access non-existent database. Fixes issue #579. Fixed problem that caused reporting units to revert to US if they were in a mixed unit system. Fixes issue #576. Fixed problem that could cause the station registry to fail if given a location with a non-ASCII location name. Changed TE923 bucket size from 0.02589 inches to 1/36 of an inch (0.02777778 in). PR #575. Fixes issue #574. Thanks to user Timothy! Undocumented option retry_certificate has been renamed to retry_ssl , and now covers all SSL errors (not just certificate errors). Fixes issue #569. Thanks to user Eric! Fixed problem caused by specifying a [Logging]/[[formatters]] section in weewx.conf that uses interpolated variables. Fixed problem in the Vantage driver that resulted in incorrect sunrise / sunset being included in loop packets when run under Python 3. Thanks to users Constantine and Jacques! Improved auto-scaling of plot axes. Fixed problem where aggregates of windvec and windgustvec returned the aggregate since start of day, not the start of the aggregation period. Fixes issue #590. New unit beaufort , included in group_speed . Treating beaufort as a separate type has been deprecated. Fixes issue #591. New unit kPa , included in group_pressure . Fixes issue #596. Fixed bug in the simulator. Made it easier to subclass class Simulator . Expressions in StdCalibration are now ordered. Later corrections can depend on earlier corrections. Fixed problem under Python 2, where option none could cause exception. PR #597. Thanks to user Cl\u00e9ment! Fixed problem with ws23xx driver under Python 3 that caused it to crash. Use a more modern formula for heat index. Fixes issue #601. Thanks to user Peter Q! Allow overriding the data binding when using iterators. Fixes issue #580. Fixed problem where old daily summaries may not have a version number. Fixed problem in WMR200 driver where missing UV reports as index 255. Added option force_direction for working around a WU bug. Fixes issue #614. Fixed problem where null bytes in an import data file would cause wee_import to fail.","title":"4.2.0 10/26/2020"},{"location":"changes/#411-06012020","text":"Fixed problem that caused wind speed to be reported to AWEKAS in m/s instead of km/h. Fixed problem that caused FTP attempts not to be retried. Fixed problem that caused monthly and yearly summaries to appear only sporadically. Fixed problem when using the ultimeter driver under Python 2. Fixed problem when using the ws1 driver under Python 2. Fixed problem that prevented remote directories from being created by FTP. New strategy for calculating system uptime under Python 3. Revisits issue #428. Alternative to PR #561.","title":"4.1.1 06/01/2020"},{"location":"changes/#410-05252020","text":"Archive records emitted by the Vantage driver now include the number of wind samples per archive interval in field wind_samples. wee_import can now import WeatherCat monthly .cat files. Changed the logging configuration dictionary to match the Python documents. Thanks to user Graham for figuring this out! Fixed problem that prevented ws1 driver from working under Python 3. PR #556. Eliminate use of logging in wee_config, allowing it to be used for installs without syslog. Allow expressions to be used as a datatype when plotting. Added option 'reuse_ssl' to FTP. This activates a workaround for a bug in the Python ftp library that causes long-lived connections to get closed prematurely. Works only with Python 3.6 and greater. The cc3000 driver will automatically reboot the hardware if it stops sending observations. PR #549. Install using setup.py forgot to set WEEWX_ROOT when installing in non-standard places. Fixes issue #546. Fixed bug in ws28xx driver that prevented it from running under Python 3. Fixes issue #543. Changed query strategy for calculating min and max wind vectors, which should result in much faster plot generation. Fixed bug in wmr9x8 driver that prevented it from running under Python 3. Fixed several bugs in the te923 driver that prevented it from running under Python 3. Added a logging handler for rotating files. See https://bit.ly/2StYSHb for how to use it. It is the default for macOS. More information if an exception is raised while querying for vantage hardware type. wunderfixer: fixed problem under Python 3 where response was not converted to str before attempting to parse the JSON. Option --simulate now requires api_key and password, so it can hit the WU. Fixed problem in te923 driver under Python 3 that caused it to crash.","title":"4.1.0 05/25/2020"},{"location":"changes/#400-04302020","text":"Ported to Python 3. WeeWX should now run under Python 3.5 and greater, as well as Python 2.7. Support for Python 2.5 and 2.6 has been dropped. New facility for creating new user-defined derived types. See the Wiki article https://github.com/weewx/weewx/wiki/WeeWX-V4-user-defined-types WeeWX now uses the Python 'logging' facility. This means log, formats, and other things can now be customized. Fixes issue #353. Strings appearing in the data stream no longer cause a TypeError if they can be converted to a number. Strings can now be accumulated and extracted in the accumulators, making it possible to include them in the database schemas. The utility wee_reports now loads services, allowing it to use user-supplied extensions. Fixes issue #95. New default schema (\"wview_extended\") that offers many new types. The old schema is still supported. Fixes issue #115. Optional, more flexible, way of specifying schemas for the daily summaries. The old way is still supported. The install process now offers to register a user's station with weewx.com. The package MySQL-python, which we used previously, is not always available on Python 3. Ported the MySQL code to use the package mysqlclient as an alternative. The default for WOW no longer throttles posting frequency (the default used to be no more than once every 15 minutes). Added new aggregate types minsum, minsumtime, sum_le. PR #382. Unit group group_distance is now a first-class group. Added new tag $python_version. Ported to Python2-PyMySQL package on OpenSUSE. Added new aggregation types 'first' (similar to 'last'), 'diff' (the difference between last and first value in the aggregation interval), and 'tderiv' (the difference divided by the time difference). Created new unit group 'group_energy2', defined as watt-seconds. Useful for high resolution energy monitors. An observation type known to the system, but not in a record, will now return a proper ValueTuple, rather than UnknownType. Type \"stormStart\" was added to the unit system. Fixes issue #380. Added new aggregation type 'growdeg'. Similar to 'heatdeg', or 'cooldeg', it measures growing degree-days. Basically, cooldeg, but with a different base. Fixes issue #367. Thanks to user Clay Jackson for guidance! Ported OS uptime to OpenBSD. Fixes issue #428. Thanks to user Jeff Ross! Catch SSL certificate errors in uploaders. Retry after an hour. Fixes issue #413. Wunderfixer has been ported to the new WU API. This API requires an API key, which you can get from WU. Put it in weewx.conf. Added option --upload-only. Thanks to user Leon Shaner! Fixes issues #414 and #445. Wee_import can now import Weather Display monthly log files. Fixed problem where sub-sections DegreeDays and Trend were located under the wrong weewx.conf section. Fixes issue #432. Thanks to user mph for spotting this! Added new parameters to the Weather Underground uploader. Fixes issue #435. Added new air quality types pm1_0, pm2_5, and pm10_0 to the unit system. Added new unit microgram_per_meter_cubed. Added new unit group, group_concentration. Plist for the Mac launcher now includes a log file for stderr. Night-day transition in plots now uses shortest travel distance around color wheel to minimize extra colors. Fixes issue #457. Thanks to user Alex Edwards! Fixed bug that causes plots to fail when both min and max are zero. Fixes issue #463. Fixed problem with sqlite driver that can lead to memory growth. See PR #467. Thanks to user Rich Bell! Fixed bug that caused windrun to be calculated wrongly under METRICWX unit system. Fixes issue #452. If a bad value of 'interval' is encountered in a record, the program will simply ignore it, rather than stopping. Address issue #375. Change in how the archive timespan is calculated in the engine. This allows oddball archive intervals. Fixes issue #469. NOAA reports are now more tolerant of missing data. Fixes issue #300. Use of strftime() date and time format codes in template file names is now supported as an alternative to the legacy 'YYYY', 'MM' and 'DD'. The legacy codes continue to be supported for backwards compatibility. Fixes issue #415. New --calc-missing action added to wee_database to calculate and store derived observations. wee_import now calculates missing derived observations once all imported data has been saved to archive. Fixes issue #443. wee_import now tolerates periods that contain no source data. Fixes issue #499. wee_import now accepts strings representing cardinal, intercardinal and secondary intercardinal directions in CSV imports. Partially fixes issue #238. The field delimiter character may now be defined for wee_import CSV imports. Ignore historical records if the timestamp is in the future. Can now recover from MariaDB-specific database connection error 1927. Changed the name of the unit \"litre\" to \"liter\", making its spelling more consistent with \"meter\". The spelling \"litre\" is still accepted. Systemd type changed from \"simple\" to \"forking\". Thanks to user Jaap de Munck for figuring this one out! The configuration file is now an optional argument. This means most users will be able to use the simple command line 'sudo weewxd'. Use correct log path for netbsd and openbsd in logger setup. StdWXCalculate no longer calculates anything by default. Instead, types to be calculated must be listed in weewx.conf. See the Upgrade Guide. setup.py install no longer saves the old 'bin' subdirectory. Instead, it simply overwrites it. Support for the vantage LOOP2 packet format. Fixes issue #374. The vantage driver now allows 3 retries per read, rather than per archive interval.","title":"4.0.0 04/30/2020"},{"location":"changes/#392-07142019","text":"StdPrint now explicitly converts loop and archive fields to UTF-8 before printing. This means unicode strings can now be included in loop and archive fields. Fix WMR300 driver so that it will reject (corrupt) logger records if they have negative interval (similar to issue #375). Added 'rain_warning' option in WMR300 driver to remind station owners to reset the rain counter when the rain counter exceeds a threshold (default is 90%). Thanks to weewx user Leon! Added several other debug tools to the WMR300 driver. PR #402. Wunderfixer now keeps going if a post does not satisfy [[Essentials]]. Fixes issue #329 (again). Fixed problem that prevented the wee_device --history option from working with the CC3000 driver. Fix incorrect log_success operation in ftp, rsync, copy and image generators. PR #373. Partial fix of issue #370. Fixed problem that could cause the WMR200 to crash WeeWX if the record interval is zero. Fixes issue #375. Posts to the Weather Underground now use https, instead of http. Thanks to user mljenkins! PR #378. Fixed problem with handling CWOP connection errors. Commit 0a21a72 Fixed problem that prevented to CopyGenerator from handling nested directories. Fixes issue #379. Fixed problem that prevented humidity calibration from being set on Vantage stations. Improved accuracy of the calculation of Moon phases. Revisits issue #342. When the AWEKAS code augments the record for rainRate, it now checks for a bad timestamp. The ts1 driver now returns 'barometer' instead of 'pressure'. Thanks to user 'windcrusader'! Fixes issue #393. Fixed problem when calculating vector averages. Thanks to user timtsm! PR #396. windrun is now calculated on a per-archive period basis, instead of for the whole day. Thanks to user 'windcrusader'! PR #399. Fixes issue #250. Wunderfixer has new option to set socket timeout. This is to compensate for WU \"capacity issues\". Thanks to user Leon! See PR #403. Fixed bug in WS1 driver that caused crash if rain_total was None. If a file user/schemas.py still exists (a relic from V2.7 and earlier), it is renamed to user/schemas.py.old. Fixes issue #54. V3.x test suites now use same data set as V4.x, minimizing the chance of a false negative when switching versions. Fixed fine offset driver to warn about (and skip) historical data that have zero for interval. Correct rounding problems for rain and other types when posting to CWOP. Fixes issue #431. Thanks to user ls4096! Fixed problem that can cause an exception with restx services that do not use the database manager. See commit 459ccb1. Sending a SIGTERM signal to weewxd now causes it to exit with status 128 + signal#. PR #442. Thanks to user sshambar! Fixed bug that could cause WMR200 packets with a timestamp between startup and the minimum interval to have an interval length of zero. Fixes issue #375 (again!).","title":"3.9.2 07/14/2019"},{"location":"changes/#391-02062019","text":"In genplot, do not attempt to normalize unspecified paths. Introduced option no_catchup. If set to true, a catchup will not be attempted. Fixes issue #368.","title":"3.9.1 02/06/2019"},{"location":"changes/#390-02052019","text":"New skin called Seasons. For new users, it will be installed and enabled. For old users, it will be installed, but not enabled. Fixes issue #75. There are also two new skins for mobile phones: Mobile and Smartphone. These are installed, but not enabled, for all users. Reworked how options get applied for reports. Backstop default values are supplied by a new file weewx/defaults.py. These can get overridden by skin.conf, or in a new section [StdReports] / [[Defaults]] in weewx.conf. See the Customization Guide, section \"How options work\", for details. Fixes issue #248. The skin.conf is optional. It is possible to specify the entire skin configuration in the configuration file weewx.conf. Dropped support of Python 2.5. You must now use either Python 2.6 or 2.7. This is in anticipation of porting to Python 3. The image generator now supports the use of a 'stale_age' option. Thanks to user John Smith. Fixes issue #290. Rose line width can now be specified with option rose_line_width. The Felsius unit of temperature (see https://xkcd.com/1923/ ) is now supported. New tag $almanac.sidereal_time for calculating current sidereal time New tag $almanac.separation() for calculating planet separations. Can now use ephem.readdb() to load arbitrary bodies into the almanac. StdQC now includes an entry for rain again (inexplicably removed in v3.1.0). If software record generation is used, the archive interval is now what is specified in weewx.conf, even if the station supports hardware generation. Fixed problem where records were downloaded on startup, even if software record generation was specified. The tag formatting taxonomy has been simplified. Just use suffix \".format()\" now. Documentation updated to reflect changes. Backwards compatibility with old suffixes is supported. Fixes issue #328. Can now set Rapidfire parameter rtfreq. Thanks to user 'whorfin'. PR #304. Template names can now include the week number. Thanks to user 'stimpy23'. PR #319. New aggregation type for plots: 'cumulative'. Thanks to user 'henrikost'. PR #302. Fixed problem where MySQL error 2013 could crash WeeWX. Fixes issue #327. Posts to the Weather Underground will be skipped if an observation type that is listed in the [[[Essentials]]] subsection is missing. Fixes issue #329. Upgrade process now explicity upgrades version-to-version, instead of doing a merge to the new config file. Fixes issue #217. Example xstats now includes tags for last_year and last_year_todate. Thanks to user evilbunny2008. PR #325. Guard against a negative value for 'interval' in WMR200 stations. Check for missing or negative values for the record field 'interval'. Changed the formula used to calculate percentage illumination of the moon to something more accurate around 2018. This formula is only used if pyephem is not installed. Fixes issue #342. Fixed bug that caused older, \"type A\" Vantage Pro2, to crash. Fixes issue #343. Fixed a bug that caused a divide-by-zero error if a plot range was the same as a specified min or max scale. Fixes issue #344. Fixed bug that prevented an optional data_binding from being used in tags when iterating over records. Fixes issue #345. Examples lowBattery and alarm now try SMTP_SSL connections, then degrade if that's not available. Fixes issue #351. Fixed problem with Brazilian locations at the start of DST. It manifested itself with the error \"NoColumnError: no such column: wind\". Fixes issue #356. Fixed problem that caused sunrise/sunset to be calculated improperly in Sun.py. Improved coverage of test suites. Fixes issue #337. wee_device, when used with the Vantage series, now honors the \"no prompt\" (-y) option. Fixes issue #361. Log watch now correctly logs garbage collection events. Thanks to user buster-one. PR #340.","title":"3.9.0 02/05/2019"},{"location":"changes/#382-08152018","text":"Added flag to weewx-multi init script to prevent systemd from breaking it. Thanks to users Timo, Glenn McKechnie, and Paul Oversmith. Fixed problem that caused wind direction in archive records to always be calculated in software, even with stations that provide it in hardware. Fixes issue #336.","title":"3.8.2 08/15/2018"},{"location":"changes/#381-06272018","text":"Map cc3000 backup battery to consBatteryVoltage and station battery to supplyVoltage to more accurately reflect the battery functions. Update the syntax in the rsyslog configuration sample Significant overhaul to the WMR300 driver. The driver should now work reliably on any version of pyusb and libusb. The driver will now delete history records from the logger before the logger fills up (the WMR300 logger is not a circular buffer). Thanks to users Markus Biewer and Cameron. Fixes issue #288. Added automatic clearing of logger for CC3000 driver to prevent logger overflow (the CC3000 logger is not a circular buffer). The default is to not clear the history, but it is highly recommended that you add a logging threshold once you are confident that all logger data have been captured to the weewx database. Improved the robustness of reading from the CC3000 logger. Better CRC error message in Vantage driver. Parameterize the configuration directory in weewx-multi init script. In StdWXCalculate, use None for an observation only if the variables on which the derived depends are available and None. Fixes issue #291. Fixed bug that prevented specifying an explicit alamanac time from working. Fixed bug that prevented historical records from being downloaded from ws23xx stations. Thanks to user Matt Brown! Fixes issue #295 Fixed bug that crashed program if a sqlite permission error occurred. If wind speed is zero, accumulators now return last known wind direction (instead of None). Thanks to user DigitalDan05. PR #303. Windrun calculations now include the \"current\" record. Fixes issue #294. Fixed bug involving stations that report windGust, but not windGustDir, in their LOOP data (e.g., Fine Offset), which prevented the direction of max wind from appearing in statistics. Fixes issue #320. The engine now waits until the system time is greater than the creation time of the weewx.conf file before starting up. Fixes issue #330.","title":"3.8.1 06/27/2018"},{"location":"changes/#380-11222017","text":"The stats.py example now works with heating and cooling degree days. Fixes issue #224. The ordinal increment between x- and y-axis labels can now be chosen. The increment between x-axis tick marks can now be chosen. Thanks to user paolobenve! PR #226. Bar chart fill colors can now be specified for individual observation types. Fixes issue #227. For aggregation types of avg , min and max , plots now locate the x- coordinate in the middle of the aggregation interval (instead of the end). Thanks again to user paolobenve! PR #232. The nominal number of ticks on the y-axis can now be specified using option y_nticks . Fixed bug that could cause tick crowding when hardwiring y-axis min and max values. The uploader framework in restx.py now allows POSTS with a JSON payload, and allows additional headers to be added to the HTTP request object. MySQL error 2006 (\"MySQL server has gone away\") now gets mapped to weedb.CannotConnectError . PR #246 Whether to use an FTP secure data connection is now set separately from whether to authenticate using TLS. Fixes issue #284. Corrected formatting used to report indoor temp and humidity to the Weather Underground. Added inDewpoint to the observation group dictionary. Added missing aggregation type 'min_ge'. Thanks to user Christopher McAvaney! Plots can now use an aggregate_type of last . Fixes issue #261. When extracting observation type stormRain (Davis Vantage only), the accumulators now extract the last (instead of average) value. Added additional accumulator extractors. Allow reports to be run against a binding other than wx_binding . Do chdir at start of ImageGenerator so that skin.conf paths are treated the same as those of other generators. Changed default value of stale for CWOP from 60 to 600 seconds. PR #277. Vantage driver: Allow user to specify the Vantage Pro model type in weewx.conf. Repeater support added to '-\u2014set-transmitter-type' command. New commands: '\u2014-set-retransmit', '--set-latitude', '--set-longitude' '--set-wind-cup', '--set-temperature-logging' Details explained in hardware.htm. Thanks to user dl1rf! PR #270, #272. Using the set-altitude command in wee_device no longer changes the barometer calibration constant in Vantage devices. See PR #263. Thanks to user dl1rf! Fixed bug in wmr200 driver that resulted in archive records with no interval field and 'NOT NULL constraint failed: archive.interval' errors. Fixed bug in wmr200 driver that caused windDir to always be None when windSpeed is zero. Include rain count in cc3000 status. In the restx posting, catch all types of httplib.HTTPException, not just BadStatusLine and IncompleteRead.","title":"3.8.0 11/22/2017"},{"location":"changes/#371-03222017","text":"Fixed log syntax in wmr100 and wmr9x8 drivers. Emit Rapidfire cache info only when debug is level 3 or higher. Thanks to user Darryn Capes-Davis. Fixed problem that prevented Rapidfire from being used with databases in metric units. Fixes issue #230. Set WOW post_interval in config dict instead of thread arguments so that overrides are possible. Thanks to user Kenneth Baker. Distribute example code and example extensions in a single examples directory. Ensure that the examples directory is included in the rpm and deb packages. Fixed issue that prevented a port from being specified for MySQL installations. MySQL error 2003 (\"Can't connect to MySQL server...\") now gets mapped to weedb.CannotConnectError . PR #234. By default, autocommit is now enabled for the MySQL driver. Fixes issue #237. Highs and lows from LOOP packets were not being used in preference to archive records in daily summaries. Fixed issue #239.","title":"3.7.1 03/22/2017"},{"location":"changes/#370-03112017","text":"The tag $current now uses the record included in the event NEW_ARCHIVE_RECORD , rather than retrieve the last record from the database. This means you can use the tag $current for observation types that are in the record, but not necessarily in the database. Fixes issue #13. Most aggregation periods now allow you to go farther in the past. For example, the tag $week($weeks_ago=1) would give you last week. You can also now specify the start and end of an aggregation period, such as $week.start and $week.end . Can now do SummaryByDay (as well as SummaryByMonth and SummaryByYear ). NB: This can generate lots of files --- one for every day in your database! Leaving this undocumented for now. Fixes issue #185. When doing hardware record generation, the engine now augments the record with any additional observation types it can extract out of the accumulators. Fixes issue #15. It's now possible to iterate over every record within a timespan. Fixes issue #182. Use schema_name = hardware_name pattern in sensor map for drivers that support extensible sensor suites, including the drivers for cc3000, te923, wmr300, wmr100, wmr200, wmr9x8 Simplified sensor mapping implementation for wmr100 and wmr200 drivers. For recent weewx releases, these are the default mappings for wmr200: 3.6.0: in:0, out:1, e2:2, e3:3, ..., e8:8 hard-coded 3.6.1: in:0, out:1, e1:2, e2:3, ..., e7:8 hard-coded 3.7.0: in:0, out:1, e1:2, e2:3, ..., e7:8 sensor_map and these are default mappings for wmr100: 3.6.2: in:0, out:1, e1:2, e2:3, ..., e7:8 hard-coded 3.7.0: in:0, out:1, e1:2, e2:3, ..., e7:8 sensor_map Enabled battery status for every remote T/H and T sensor in wmr100 driver. Enabled heatindex for each remote T/H sensor in wmr200 driver. Fixed inverted battery status indicator in wmr200 driver. Fixed 'Calculatios' typo in wmr100, wmr200, wmr9x8, and wmr300 drivers. Fixed usb initialization issues in the wmr300 driver. Added warning in wmr300 driver when rain counter reaches maximum value. Decode heatindex and windchill from wmr300 sensor outputs. Report the firmware version when initializing the cc3000 driver. Fixed bug in vantage driver that would prevent console wake up during retries when fetching EEPROM vales. Thanks to user Dan Begallie! The vantage driver no longer emits values for non-existent sensors. As a result, LOOP and archive packets are now much smaller. If this works out, other drivers will follow suit. Partial fix of issue #175. The vantage driver now emits the barometer trend in LOOP packets as field trendIcon . The engine now logs locale. Additional information if a TERM signal is received. Removed the site-specific \"Pond\" extensions from the Standard skin. The Standard skin now includes plots of outside humidity. Fixes issue #181. Fixed reference to index.html.tmpl in the xstats example. Changed algorithm for calculating ET to something more appropriate for hourly values (former algorithm assumed daily values). Fixes issue #160. Fixed bug in Celsius to Fahrenheit conversion that affected pressure conversions in uwxutils.py , none of which were actually used. Fixed bug that was introduced in v3.6.0, which prevented wee_reports from working for anything other than the current time. Documented the experimental anti-alias feature, which has been in weewx since v3.1.0. Fixes issue #6. Fixed problem where multiple subsections under [SummaryBy...] stanzas could cause multiple copies of their target date to be included in the Cheetah variable $SummaryByYear and $SummaryByMonth . Fixes issue #187. Moved examples out of bin directory. Eliminated experimental directory. Reinforce the use of user directory, eliminate use of examples directory. Renamed xsearch.py to stats.py . OS uptime now works for freeBSD. Thanks to user Bill Richter! PR #188. Broke out developer's notes into a separate document. Added @media CSS for docs to improve printed/PDF formatting. Thanks to user Tiouck! Added a 0.01 second delay after each read_byte in ws23xx driver to reduce chance of data spikes caused by RS232 line contention. Thanks lionel.sylvie! The observation windGustDir has been removed from wmr100, wmr200, te923, and fousb drivers. These drivers were simply assigning windGustDir to windDir , since none of the hardware reports an actual wind gust. Calculation of aggregates over a period of one day or longer can now respect any change in archive interval. To take advantage of this feature, you will have to apply an update to your daily summaries. This can be done using the tool wee_database , option --update . Refer to the Changes to daily summaries section in the Upgrade Guide to determine whether you should update or not. Fixes issue #61. Max value of windSpeed for the day is now the max archive value of windSpeed . Formerly, it was the max LOOP value. If you wish to patch your older daily summaries to interpret max windSpeed this way, use the tool wee_database with option --update . Fixes issue #195. The types of accumulators, and the strategies to put and extract records out of them, can now be specified by config stanzas. This will be of interest to extension writers. See issue #115. Fixed battery status label in acurite driver: changed from txTempBatteryStatus to outTempBatteryStatus . Thanks to user manos! Made the lowBattery example more robust - it now checks for any known low battery status, not just txBatteryStatus . Thanks to user manos! Added info-level log message to calculate_rain so that any rain counter reset will be logged. Added better logging for cc3000 when the cc3000 loses contact with sensors for extended periods of time. How long to wait before retrying after a bad uploader login is now settable with option retry_login . Fixes issue #212. The test suites now use dedicated users weewx1 and weewx2 . A shell script has been included to setup these users. A more formal exception hierarchy has been adopted for the internal database library weedb . See weedb/NOTES.md . The weedb Connection and Cursor objects can now be used in a \"with\" clause. Slightly more robust mechanism for decoding last time a file was FTP'd.","title":"3.7.0 03/11/2017"},{"location":"changes/#362-11082016","text":"Fixed incorrect WU daily rain field name Fixed bug that crashed Cheetah if the weewx.conf configuration file included a BOM. Fixes issue #172.","title":"3.6.2 11/08/2016"},{"location":"changes/#361-10132016","text":"Fixed bug in wunderfixer. Fixed handling of StdWXCalculate.Calculations in modify_config in the wmr100, wmr200, wmr300, and wmr9x8 drivers. Eliminate the apache2, ftp, and rsync suggested dependencies from the deb package. This keeps the weewx dependencies to a bare minimum. Added retries to usb read in wmr300 driver. Remapped sensor identifiers in wmr200 driver so that extraTemp1 and extraHumid1 are usable. Standardized format to be used for times to YYYY-mm-ddTHH:MM .","title":"3.6.1 10/13/2016"},{"location":"changes/#360-10072016","text":"Added the ability to run reports using a cron-like notation, instead of with every report cycle. See User's Guide for details. Thanks to user Gary Roderick. PR #122. Fixes issue #17. Added the ability to easily import CSV, Weather Underground, and Cumulus data using a new utility, wee_import. Thanks again to \u00fcber-user Gary Roderick. PR #148. Fixes issue #97. Refactored documentation so that executable utilities are now in their own document, utilities.htm. Fixed rpm package so that it will retain any changes to the user directory. Thanks to user Pat OBrien. No ET when beyond the reach of the sun. Software calculated ET now returns the amount of evapotranspiration that occurred during the archive interval. Fixes issue #160 Fixed wee_config to handle config files that have no FTP or RSYNC. Fixed bug in StdWXCalculate that ignored setting of 'None' (#110). Which derived variables are to be calculated are now in a separate subsection of [StdWXCalculate] called [[Calculations]]. Upgrade process takes care of upgrading your config file. Reset weewx launchtime when waiting for sane system clock (thanks to user James Taylor). Fixed anti-alias bug in genplot. Issue #111. Corrected the conversion factor between inHg and mbar. Thanks to user Olivier. Consolidated unit conversions into module weewx.units. Plots longer than two years now use an x-axis increment of one year. Thanks to user Olivier! The WS1 driver now retries connection if it fails. Thanks to user Kevin Caccamo! PR #112. Major update to the CC3000 driver: - reading historical records is more robust - added better error handling and reporting - fixed to handle random NULL characters in historical records - fixed rain units - added ability to get data from logger as fast as it will send it - added support for additional temperature sensors T1 and T2 - added transmitter channel in station diagnostics - added option to set/get channel, baro offset - added option to reset rain counter Fixed brittle reference to USBError.args[0] in wmr200, wmr300, and te923 drivers. Fixed typo in default te923 sensor mapping for h_3. Thanks to user ngulden. Added flag for reports so that reports can be disabled by setting enable=False instead of deleting or commenting entire report sections in weewx.conf. The vantage and ws23xx drivers now include the fix for the policy of \"wind direction is undefined when no wind speed\". This was applied to other drivers in weewx 3.3.0. Fixed te923 driver behavior when reading from logger, especially on stations with large memory configuration. Thanks to users Joep and Nico. Fixed rain counter problems in wmr300 driver. The driver no longer attempts to cache partial packets. Do no process packets with non-loop data when reading loop data. Thanks to user EricG. Made wmr300 driver more robust against empty usb data buffers. Fixed pressure/barometer in wmr300 driver when reading historical records. Fixed problem with the Vantage driver where program could crash if a serial I/O error happens during write. Fixes issue #134. Changed name of command to clear the Vantage memory from --clear to --clear-memory to make it more consistent with other devices. Fixed problem that prevented channel 8 from being set by the Vantage driver. Added solaris .smf configuration. Thanks to user whorfin. Added option post_indoor_observations for weather underground. Added maximum value to radiation and UV plots. In the .deb package, put weewx reports in /var/www/html/weewx instead of /var/www/weewx to match the change of DocumentRoot in debian 8 and later.","title":"3.6.0 10/07/2016"},{"location":"changes/#350-03132016","text":"Fixed bug that prevented rsync uploader from working. Fixed bug in wmr300 driver when receiving empty buffers from the station. The type of MySQL database engine can now be specified. Default is 'INNODB'. Updated userguide with capabilities of the TE923 driver added in 3.4.0. Added aggregation type min_ge(val). Provide better feedback when a driver does not implement a configurator. Added humidex and appTemp to group_temperature. Fixed issue #96. Backfill of the daily summary is now done in \"tranches,\" reducing the memory requirements of MySQL. Thanks to \u00fcber-user Gary Roderick! Fixes issue #83. Made some changes in the Vantage driver to improve performance, particularly with the IP version of the logger. Thanks to user Luc Heijst for nagging me that the driver could be improved, and for figuring out how. Plotting routines now use Unicode internally, but convert to UTF-8 if a font does not support it. Fixes issue #101. Improved readability of documents on mobile devices. Thank you Chris Davies-Barnard! The loop_on_init option can now be specified in weewx.conf When uploading data to CWOP, skip records older than 60 seconds. Fixes issue #106. Added modify_config method to the driver's configuration editor so that drivers can modify the configuration during installation, if necessary. The fousb and ws23xx drivers use modify_config to set record_generation to software. This addresses issue #84. The wmr100, wmr200, wmr9x8, and wmr300 drivers use modify_config to set rainRate, heatindex, windchill, and dewpoint calculations to hardware instead of prefer_hardware since each of these stations has partial packets. This addresses issue #7 (SF #46).","title":"3.5.0 03/13/2016"},{"location":"changes/#340-01162016","text":"The tag $hour has now been added. It's now possible to iterate over hours. Thanks to user Julen! Complete overhaul of the te923 driver. Thanks to user Andrew Miles. The driver now supports the data logger and automatically detects small or large memory models. Added ability to set/get the altitude, lat/lon, and other station parameters. Significant speedup to reading station memory, from 531s to 91s, which is much closer to the 53s for the te923tool written in C (all for a station with the small memory model). The wee_debug utility is now properly installed, not just distributed. Fixed bug in almanac code that caused an incorrect sunrise or sunset to be calculated if it followed a calculation with an explicit horizon value. Localization of tags is now optional. Use function toString() with argument localize set to False. Example: $current.outTemp.toString($localize=False) Fixes issue #88. In the acurite driver, default to use_constants=True. Fixed bug in the rhel and suse rpm packaging that resulted in a configuration file with html, database, and web pages in the setup.py locations instead of the rpm locations. The extension utility wee_extension now recognizes zip archives as well as tar and compressed tar archives. Check for a sane system time when starting up. If time is not reasonable, wait for it. Log the time status while waiting. Added log_success option to cheetah, copy, image, rsync, and ftp generators. Older versions of MySQL (v5.0 and later) are now supported.","title":"3.4.0 01/16/2016"},{"location":"changes/#331-12062015","text":"Fixed bug when posting to WOW. Fixed bug where the subsection for a custom report gets moved to the very end of the [StdReport] section of a configuration file on upgrade. Fixes issue #81.","title":"3.3.1 12/06/2015"},{"location":"changes/#330-12052015","text":"Now really includes wunderfixer. It was inadvertently left out of the install script. Rewrote the almanac so it now supports star ephemeris. For example, $almanac.rigel.next_rising. Fixes issue #79. Uninstalling an extension with a skin now deletes all empty directories. This fixes issue #43. Fixed bug in WMR200 driver that caused it to emit dayRain, when what it was really emitting was the \"rain in the last 24h, excluding current hour.\" Fixes issue #62. Fixed bug in WMR200 driver that caused it to emit gauge pressure for altimeter pressure. Thanks to user Mark Jenks for nagging me that something was wrong. Fixed bug that caused wind direction to be calculated incorrectly, depending on the ordering of a dictionary. Thanks to user Chris Matteri for not only spotting this subtle bug, but offering a solution. StdPrint now prints packets and records in (case-insensitive) alphabetical order. Fixed wind speed decoding in the acurite driver. Thanks to aweatherguy. The StdRESTful service now supports POSTs, as well as GETs. The FTP utility now catches PickleError exceptions, then does a retry. Added unit 'minute' to the conversion dictionary. The vertical position of the bottom label in the plots can now be set in skin.conf with option bottom_label_offset. An optional port number can now be specified with the MySQL database. Added option use_constants in the Acurite driver. Default is false; the calibration constants are ignored, and a linear approximation is used for all types of consoles. Specify use_constants for 01035/01036 consoles to calculate using the constants. The 02032/02064 consoles always use the linear approximation. Fixed test for basic sensor connectivity in the Acurite driver. The policy of \"wind direction is undefined when no wind speed\" is enforced by the StdWXCalculate service. There were a few drivers that were still applying the policy: acurite, cc3000, fousb, ws1, wmr100, wmr200, ultimeter. These have been fixed. Changed logic that decides whether the configuration file includes a custom schema, or the name of an existing schema. Added new command-line utility wee_debug, for generating a troubleshooting information report. Added option --log-label to specify the label that appears in syslog entries. This makes it possible to organize output from multiple weewx instances running on a single system. Fixed problem with the Vantage driver that caused it to decode the console display units incorrectly. Thanks to Luc Heijst! The WMR300 driver is now part of the weewx distribution.","title":"3.3.0 12/05/2015"},{"location":"changes/#321-071815","text":"Fixed problem when using setup.py to install into a non-standard location. Weewx would start a new database in the \"standard\" location, ignoring the old one in the non-standard location.","title":"3.2.1 07/18/15"},{"location":"changes/#320-071515","text":"There are now five command-line utilities, some new, some old wee_config : (New) For configuring weewx.conf, in particular, selecting a new device driver. wee_extension : (New) For adding and removing extensions. wee_database : (Formerly called wee_config_database) wee_device : (Formerly called wee_config_device) wee_reports : No changes. The script setup.py is no longer used to install or uninstall extensions. Instead, use the new utility wee_extension. Wunderfixer is now included with weewx --- no need to download it separately. It now works with MySQL, as well as sqlite, databases. It also supports metric databases. Thanks to user Gary Roderick! Fixed bug in 12-hour temperature lookup for calculating station pressure from sea level pressure when database units are other than US unit system. Added guards for bogus values in various wxformula functions. Added windrun, evapotranspiration, humidex, apparent temperature, maximum theoretical solar radiation, beaufort, and cloudbase to StdWXCalculate. If StdWXCalculate cannot calculate a derived variable when asked to, it now sets the value to null. Fixes issue #10. Added option to specify algorithm in StdWXCalculate. So far this applies only to the altimeter calculation. Added option max_delta_12h in StdWXCalculate, a window in which a record will be accepted as being \"12 hours ago.\" Default is 1800 seconds. Fixed bug in debian install script - 'Acurite' was not in the list of stations. $almanac.sunrise and $almanac.sunset now return ValueHelpers. Fixes issue #26. Added group_distance with units mile and km. Added group_length with units inch and cm. Failure to launch a report thread no longer crashes program. The WU uploader now publishes soil temperature and moisture, as well as leaf wetness. Increased precision of wind and wind gust posts to WU from 0 to 1 decimal point. Increased precision of barometer posts to WOW from 1 to 3 decimal points. A bad CWOP server address no longer crashes the CWOP thread. The \"alarm\" example now includes a try block to catch a NameError exception should the alarm expression include a variable not in the archive record. Fixed bug that shows itself if marker_size is not specified in skin.conf Show URLs in the log for restful uploaders when debug=2 or greater. Fixed problem that could cause an exception in the WMR200 driver when formatting an error string. Added better recovery from USB failures in the ws28xx driver. Added data_format option to FineOffset driver. Thanks to Darryl Dixon. Decoding of data is now more robust in the WS1 driver. Get data from the station as fast as the station can spit it out. Thanks to Michael Walker. Changes to the WS23xx driver include: - Fixed wind speed values when reading from logger. Values were too high by a factor of 10. - wrapped non-fatal errors in WeeWXIO exceptions to improve error handling and failure recovery Changes to the AcuRite driver include: - The AcuRite driver now reports partial packets as soon as it gets them instead of retaining data until it can report a complete packet - Improved timing algorithm for AcuRite data. Thanks to Brett Warden. - Added acurite log entries to logwatch script. Thanks to Andy. - Prevent negative rainfall amounts in acurite driver by detecting counter wraparound - Use 13 bits for rain counter instead of 12 bits - Use only 12 bits for inside temperature in acurite driver when decoding for 02032 stations Changes to the TE923 driver include: - consolidated retries - improved error handling and reporting Changes to the WMR9x8 driver include: - Correct bug that caused yesterday's rain to be decoded as dayRain - LOOP packet type 'battery' is now an int, instead of a bool - The driver can now be run standalone for debugging purposes. The Vantage driver now catches undocumented termios exceptions and converts them to weewx exceptions. This allows retries if flushing input or output buffers fail. Fixes issue #34. Default values for databases are now defined in a new section [DatabaseTypes]. New option \"database_type\" links databases to database type. Installer will automatically update old weewx.conf files. The RESTful services that come with weewx are now turned on and off by option \"enable\". Installer will automatically update old weewx.conf files. Other RESTful services that don't use this method will continue to work. Option bar_gap_fraction is now ignored. Bar plot widths are rendered explicitly since V3.0, making the option unnecessary. Fixes issue #25. Added additional debug logging to main engine loop. FTP uploader now retries several times to connect to a server, instead of giving up after one try. Thanks to user Craig Hunter!","title":"3.2.0 07/15/15"},{"location":"changes/#310-020515","text":"Fixed setup.py bug that caused list-drivers to fail on deb and rpm installs. Added a wait-and-check to the stop option in the weewx.debian rc script. Fixed bug in the Vantage driver that causes below sea-level altitudes to be read as a large positive number. Also, fixed problem with altitude units when doing --info (ticket #42). Fixed bug in wmr100 driver that causes gust wind direction to be null. Fixed bug in wmr200 driver that causes gust wind direction to be null. Fixed ultimeter driver to ensure wind direction is None when no wind speed Thanks to user Steve Sykes. Fixed bug in calculation of inDewpoint. Thanks to user Howard Walter. Assign default units for extraHumid3,4,5,6,7, extraTemp4,5,6,7, leafTemp3,4, and leafWet1,2. Use StdWXCalculate to ensure that wind direction is None if no wind speed. Fixed sign bug in ultimeter driver. Thanks to user Garrett Power. Use a sliding window with default period of 15 minutes to calculate the rainRate for stations that do not provide it. Added support for AcuRite weather stations. Thanks to users Rich of Modern Toil, George Nincehelser, Brett Warden, Preston Moulton, and Andy. The ultimeter driver now reads data as fast as the station can produce it. Typically this results in LOOP data 2 or 3 times per second, instead of once per second. Thanks to user Chris Thompstone. The daily summary for wind now uses type INTEGER for column sumtime, like the other observation types. Utility wee_reports no longer chokes if the optionally-specified timestamp is not in the database. Can also use \"nearest time\" if option 'max_delta' is specified in [CheetahGenerator]. Utility wee_config_device can now dump Vantage loggers to metric databases. Fixes ticket #40. Fixed problem where dumping to database could cause stats to get added to the daily summaries twice. FTP over TLS (FTPS) sessions are now possible, but don't work very well with Microsoft FTP servers. Requires Python v2.7. Will not work with older versions of Python. Fixes ticket #37. WeatherUnderground passwords are now quoted, allowing special characters to be used. Fixes ticket #35. New tag $obs, allowing access to the contents of the skin configuration section [Labels][[Generic]]. Fixes ticket #33. Better error message if there's a parse error in the configuration file. Added wxformulas for evapotranspiration, humidex, apparent temperature, and other calculations. Added --loop-on-init option for weewxd. If set, the engine will keep retrying if the device cannot be loaded. Otherwise, it will exit. Changed the weedb exception model to bring it closer to the MySQL exception model. This will only affect those programming directly to the weedb API.","title":"3.1.0 02/05/15"},{"location":"changes/#301-120714","text":"Fixed bug in setup.py that would forget to insert device-specific options in weewx.conf during new installations.","title":"3.0.1 12/07/14"},{"location":"changes/#300-120414","text":"Big update with lots of changes and lots of new features. The overall goal was to make it easier to write and install extensions. Adding custom databases, units, accumulators and many other little things have been made easier. Skins and skin.conf continue to be 100% backwards compatible (since V1.5!). However, search-list extensions will have to be rewritten. Details in the Upgrading Guide. Previously, configuration options for all possible devices were included in the configuration file, weewx.conf. Now, for new installs, it has been slimmed down to the minimum and, instead, configuration options are added on an \"as needed\" basis, using a new setup.py option \"configure\". Your configuration file, weewx.conf should be automatically updated to V3 by the upgrade process, using your previously chosen hardware. But, check it over. Not sure we got everything correct. See the Upgrading Guide. Specific changes follow. There is no longer a separate \"stats\" database. Instead, statistics are included in the regular database (e.g., 'weewx.sdb') as separate tables, one for each observation type. Total rewrite of how data gets bound to a database. You now specify a \"data binding\" to indicate where data should be going, and where it is coming from. The default binding is \"wx_binding,\" the weather binding, so most users will not have to change a thing. Other database bindings can be used in tags. Example: $current($data_binding=$alt_binding).outTemp Alternate times can also be specified: $current($timestamp=$othertime).outTemp Explicit time differences for trends can now be specified: $trend($time_delta=3600).barometer Introduced a new tag $latest, which uses the last available timestamp in a data binding (which may or may not be the same as the \"current\" timestamp). Introduced a new tag $hours_ago, which returns the stats for X hours ago. So, the max temperature last hour would be $hours_ago($hours_ago=1).outTemp.max. Introduced a shortcut $hour, which returns the stats for this hour. So, the high temperature for this hour would be $hour.outTemp.max Introduced a new tag $days_ago, which returns the stats for X days ago. So, the max temperature the day before yesterday would be $days_ago($days_ago=2).outTemp.max. Included a shortcut $yesterday: The tag $yesterday.outTemp.max would be yesterday's max temperature. Introduced a new aggregation type \".last\", which returns the last value in an aggregation interval. E.g., $week.outTemp.last would return the last temperature seen in the week. Introduced a new aggregation type \".lasttime\" which returns the time of the above. Can now differentiate between the max speed seen in the archive records (e.g., $day.windSpeed.max) and the max gust seen ($day.wind.max or $day.windGust.max). Allow other data bindings to be used in images. Made it easier to add new unit types and unit groups. The archive interval can now change within a database without consequences. Total rewrite of how devices are configured. A single utility wee_config_device replaces each of the device-specific configuration utilities. The Customization Guide was extended with additional examples and option documentation. Removed the no longer needed serviced StdRESTful, obsolete since V2.6 Fixed bug in querying for schemas that prevented older versions of MySQL (V4.X) from working. Improved error handling and retries for ws1, ultimeter, and cc3000 drivers. Fixed missing dew initializations in wmr9x8 driver. Fixed model/_model initialization in wmr9x8 driver. Fixed uninitialized usb interface in wmr200 driver. Fixed wakup/wakeup typo in _getEEPROM_value in vantage driver. Made the ftpupload algorithm a little more robust to corruption of the file that records the last upload time. Added observation type 'snow'. It generally follows the semantics of 'rain'. Fixed possible fatal exception in WS23xx driver. Fixed use of str as variable name in WS23xx driver. Now catches database exceptions raised during commits, converting them to weedb exceptions. Weewx catches these, allowing the program to keep going, even in the face of most database errors. For the fine offset stations, record connection status as rxCheckPercent (either 0 or 100%) and sensor battery status as outTempBatteryStatus (0 indicates ok, 1 indicates low battery). For WS23xx stations, hardware record generation is now enabled and is the default (previously, software record generation was the default). Fixed bug in WS28xx driver the prevented reading of historical records when starting with an empty database. The database schemas are now their own package. The schema that was in user/schemas.py can now be found in weewx/schemas/wview.py.","title":"3.0.0 12/04/14"},{"location":"changes/#270-101114","text":"Added the ability to configure new Vantage sensor types without using the console. This will be useful to Envoy users. Thanks to user Deborah Pickett for this contribution! Allow calibration constants to be set in the Vantage EEPROM. This will particularly be useful to southern hemisphere users who may want to align their ISS to true north (instead of south), then apply a 180 correction. Thanks again to Deborah Pickett! Enabled multiple rsync instances for a single weewx instance. More extensive debug information for rscync users. Added the ability to localize the weewx and server uptime. See the Customization Guide for details. This will also cause a minor backwards incompatibility. See the Upgrading Guide for details. Added catchup to the WS28xx driver, but still no hardware record generation. Changed lux-to-W/m^2 conversion factor in the fine offset driver. Added rain rate calculation to Ultimeter driver. Changed setTime to retrieve system time directly rather than using a value passed by the engine. This greatly improves the accuracy of StdTimeSync, particularly in network based implementations. Thanks to user Denny Page! Moved clock synchronization options clock_check and max_drift back to section [StdTimeSynch]. Fixed ENDPOINT_IN in the te923 driver. This should provide better compatibility with a wider range of pyusb versions. Now catches MySQL exceptions during commits and rollbacks (as well as queries) and converts them to weedb exceptions. Catch and report configobj errors when reading skin.conf during the generation of reports. Ensure correct location, lat, lon, and altitude modifications in the debian postinst installer script. In the debian installer, default to ttyUSB0 instead of ttyS0 for stations with a serial interface. Added CC3000 to debian installer scripts. Fixed bug that can affect hardware that emits floating point timestamps, where the timestamp is within 1 second of the end of an archive interval. Changed UVBatteryStatus to uvBatteryStatus in the WMR100 driver in order to match the convention used by other drivers. Fixed the shebang for te923, ws23xx, ultimeter, ws1, and cc3000 drivers.","title":"2.7.0 10/11/14"},{"location":"changes/#264-061614","text":"The WMR100 driver now calculates SLP in software. This fixes a problem with the WMRS200 station, which does not allow the user to set altitude. The WMR100 driver was incorrectly tagging rain over the last 24 hours as rain since midnight. This caused a problem with WU and CWOP posts. Fix cosmetic problem in wee_config_fousb pressure calibration. Detect both NP (not present) and OFL (outside factory limits) on ws28xx. Added driver for PeetBros Ultimeter stations. Added driver for ADS WS1 stations. Added driver for RainWise Mark III stations and CC3000 data logger. Added automatic power cycling to the FineOffsetUSB driver. Power cycle the station when a USB lockup is detected. Only works with USB hubs that provide per-port power switching. Fix imagegenerator aggregation to permit data tables with no 'interval' column. Prompt for metric/US units for debian installations. For WS28xx stations, return 0 for battery ok and 1 for battery failure. If a connection to the console has been successfully opened, but then on subsequent connection attempts suffers an I/O error, weewx will now attempt a retry (before it would just exit).","title":"2.6.4 06/16/14"},{"location":"changes/#263-041014","text":"Hardened the WMR100 driver against malformed packets. The plot images can now use UTF-8 characters. Fixed a problem where the Ambient threads could crash if there were no rain database entries. Battery status values txBatteryStatus and consBatteryVoltage now appear in the archive record. The last LOOP value seen is used. CWOP posts are now slightly more robust. Fixed pressure calculation in wee_config_fousb. Prevent failures in imagegenerator when no unicode-capable fonts are installed. Provide explicit pairing feedback using wee_config_ws28xx Count wxengine restarts in logwatch. Cleaned up USB initialization for fousb, ws28xx, and te923 drivers.","title":"2.6.3 04/10/14"},{"location":"changes/#262-021614","text":"Fixed bug that crashes WMR200 driver if outTemp is missing. Fixed bug that can crash RESTful threads if there is missing rain data. Sqlite connections can now explicitly specify a timeout and isolation_level. Server uptime now reported for MacOS Fixed bug that prevented Rapidfire posts from being identified as such.","title":"2.6.2 02/16/14"},{"location":"changes/#261-020814","text":"Fixed bug that crashed main thread if a StdQC value fell out of range.","title":"2.6.1 02/08/14"},{"location":"changes/#260-020814","text":"Changed the RESTful architecture so RESTful services are now first-class weewx services. This should simplify the installation of 3rd party extensions that use these services. Broke up service_list, the very long list of services to be run, into five separate lists. This will allow services to be grouped together, according to when they should be run. Defined a structure for packaging customizations into extensions, and added an installer for those extensions to setup.py. Changed the default time and date labels to use locale dependent formatting. The defaults should now work in most locales, provided you set the environment variable LANG before running weewx. Changed default QC barometric low from 28 to 26. Added inTemp, inHumidity, and rain. Ranges in MinMax QC can now include units. When QC rejects values it now logs the rejection. Introduced a new unit system, METRICWX. Similar to METRIC, it uses mm for rain, mm/hr for rain rate, and m/s for speed. Added an option --string-check and --fix to the utility wee_config_database to fix embedded strings found in the sqlite archive database. Font handles are now cached in order to work around a memory leak in PIL. Now does garbage collection every 3 hours through the main loop. Image margins now scale with image and font sizes. Now works with the pure Python version of Cheetah's NameMapper, albeit very slowly. Fixed bug that prevented weewx from working with Python v2.5. Fixed bug in SummaryByMonth and SummaryByYear that would result in duplicate month/year entries when generating from multiple ByMonth or ByYear templates. Consolidated pressure calculation code in ws23xx, ws28xx, te923, and fousb. Catch USB failures when reading Fine Offset archive interval. Added Vantage types stormRain and windSpeed10 to the list of observation types. Simulator now generates types dewpoint, pressure, radiation, and UV. The forecast extension is once again distributed separately from weewx. Minor cleanup to Standard skin for better out-of-the-box behavior: - default to no radar image instead of pointing every station to Oregon - not every WMR100 is a WMR100N Failure to set an archive interval when using bar plots no longer results in an exception. Change to skin directory before invoking Cheetah on any templates.","title":"2.6.0 02/08/14"},{"location":"changes/#251-123013","text":"Added UV plots to the templates. They will be shown automatically if you have any UV data. Fixed bug when reading cooling_base option. Default to sane behavior if skin does not define Labels. Fixed bug in setting of CheetahGenerator options. Fixed qsf and qpf summary values in forecast module. Fixed handling of empty sky cover fields in WU forecasts. Forecast module now considers the fctcode, condition, and wx fields for precipitation and obstructions to visibility. Added options to forecast module to help diagnose parsing failures and new forecast formats. Added retries when saving forecast to database and when reading from database. Fixes to the Fine Offset driver to eliminate spikes caused by reading from memory before the pointer had been updated (not the same thing as an unstable read). Added driver for LaCrosse 2300 series of weather stations. Added driver for Hideki TE923 series of weather stations.","title":"2.5.1 12/30/13"},{"location":"changes/#250-102913","text":"Introduced a new architecture that makes it easier to define search list extensions. The old architecture should be 100% backwards compatible. Added station registry service. This allows weewx to optionally \"phone home\" and put your station location on a map. Added a forecast service and reporting options. The forecast service can generate Zambretti weather or XTide tide forecasts, or it can download Weather Underground or US National Weather Service weather forecasts. These data can then be displayed in reports using the Cheetah template engine. The forecast service is disabled by default. Weewx now allows easier localization to non-English speaking locales. In particular, set the environment variable LANG to your locale, and then weewx date and number formatting will follow local conventions. There are also more labeling options in skin.conf. Details in a new section in the Customization Guide. Added aggregate type \"minmax\" and \"maxmin\". Thank you user Gary Roderick! New option in [StdArchive] called \"loop_hilo\". Setting to True will cause both LOOP and archive data to be used for high/low statistics. This is the default. Setting to False causes only archive data to be used. When a template fails, skip only that template, not everything that the generator is processing. Trend calculations no longer need a record at precisely (for example) 3 hours in the past. It can be within a \"grace\" period. FineOffset driver now uses the 'delay' field instead of the fixed_block 'read_period' for the archive record interval when reading records from console memory. FineOffset driver now support for multiple stations on the same USB. FineOffset driver now reduces logging verbosity when bad magic numbers appear. Log only when the numbers are unrecognized or change. The purpose of the magic numbers is still unknown. WMR100, Vantage, FineOffset, and WS28xx drivers now emit a null wind direction when the wind speed is zero. Same for wind gust. For WMR9x8 stations, wind chill is now retrieved from the console rather than calculated in software. Thank you user Peter Ferencz! For WMR9x8 stations, the first extra temperature sensor (packet code 4) now shows up as extraTemp1 (instead of outTemp). Thanks again to Peter Ferencz. For WMR9x8 stations, packet types 2 and 3 have been separated. Only the latter is used for outside temperature, humidity, dewpoint. The former is used for \"extra\" sensors. Corrected the calculation for channel numbers >=3. Also, extended the number of battery codes. Thanks to Per Edstr\u00f6m for his patience in figuring this out! For WMR200 stations, altitude-corrected pressure is now emitted correctly. ws28xx driver improvements, including: better thread control; better logging for debugging/diagnostics; better timing to reduce dropouts; eliminate writes to disk to reduce wear when used on flash devices. Plus, support for multiple stations on the same USB. Fixed rain units in ws28xx driver. The LOOP value for daily ET on Vantages was too high by a factor of 10. This has been corrected. Fixed a bug that caused values of ET to be miscalculated when using software record generation. Ported to Korora 19 (Fedora 19). Thanks to user zmodemguru! Plots under 16 hours in length, now use 1 hour increments (instead of 3 hours). No longer emits \"deprecation\" warning when working with some versions of the MySQLdb python driver. Added ability to build platform-specific RPMs, e.g., one for RedHat-based distributions and one for SuSE-based distributions. Fixed the 'stop' and 'restart' options in the SuSE rc script. The weewx logwatch script now recognizes more log entries and errors.","title":"2.5.0 10/29/13"},{"location":"changes/#240-080313","text":"The configuration utility wee_config_vantage now allows you to set DST to 'auto', 'off', or 'on'. It also lets you set either a time zone code, or a time zone offset. The service StdTimeSync now catches startup events and syncs the clock on them. It has now been moved to the beginning of the list \"service_list\" in weewx.conf. Users may want to do the same with their old configuration file. A new event, END_ARCHIVE_PERIOD has been added, signaling the end of the archive period. The LOOP packets emitted by the driver for the Davis Vantage series now includes the max wind gust and direction seen since the beginning of the current archive period. Changed the null value from zero (which the Davis documentation specifies) to 0x7fff for the VP2 type 'highRadiation'. Archive record packets with date and time equal to zero or 0xff now terminate dumps. The code that picks a filename for \"summary by\" reports has now been factored out into a separate function (getSummaryByFileName). This allows the logic to be changed by subclassing. Fixed a bug that did not allow plots with aggregations less than 60 minutes across a DST boundary. Fixed bug in the WMR100 driver that prevented UV indexes from being reported. The driver for the LaCrosse WS-28XX weather series continues to evolve and mature. However, you should still consider it experimental.","title":"2.4.0 08/03/13"},{"location":"changes/#233-062113","text":"The option week_start now works. Updated WMR200 driver from Chris Manton. Fixed bug that prevented queries from being run against a MySQL database.","title":"2.3.3 06/21/13"},{"location":"changes/#232-061613","text":"Added support for the temperature-only sensor THWR800. Thanks to user fstuyk! Fixed bug that prevented overriding the FTP directory in section [[FTP]] of the configuration file. Day plots now show 24 hours instead of 27. If you want the old behavior, then change option \"time_length\" to 97200. Plots shorter than 24 hours are now possible. Thanks to user Andrew Tridgell. If one of the sections SummaryByMonth, SummaryByYear, or ToDate is missing, the report engine no longer crashes. If you live at a high latitude and the sun never sets, the Almanac now does the right thing. Fixed bug that caused the first day in the stats database to be left out of calculations of all-time stats.","title":"2.3.2 06/16/13"},{"location":"changes/#231-041513","text":"Fixed bug that prevented Fine Offset stations from downloading archive records if the archive database had no records in it. rsync should now work with Python 2.5 and 2.6 (not just 2.7)","title":"2.3.1 04/15/13"},{"location":"changes/#230-041013","text":"Davis Vantage stations can now produce station pressures (aka, \"absolute pressure\"), altimeter pressures, as well as sea-level pressure. These will be put in the archive database. Along the same line, 'altimeter' pressure is now reported to CWOP, rather than the 'barometer' pressure. If altimeter pressure is not available, no pressure is reported. Fixed bug in CWOP upload that put spaces in the upload string if the pressure was under 1000 millibars. A bad record archive type now causes a catch up to be abandoned, rather than program termination. Fixed bug in trends, when showing changes in temperature. NB: this fix will not work with explicit unit conversion. I.e., $trend.outTemp.degree_C will not work. Modified wee_config_vantage and wee_config_fousb so that the configuration file will be guessed if none is specified. Fixed wxformulas.heatindexC to handle arguments of None type. Fixed bug that causes Corrections to be applied twice to archive records if software record generation is used. rsync now allows a port to be specified. Fixed day/night transition bug. Added gradients to the day/night transitions. Numerous fixes to the WMR200 driver. Now has a \"watchdog\" thread. All of the device drivers have now been put in their own package 'weewx.drivers' to keep them together. Many have also had name changes to make them more consistent: OLD NEW VantagePro.py (Vantage) vantage.py (Vantage) WMR918.py (WMR-918) wmr9x8.py (WMR9x8) wmrx.py (WMR-USB) wmr100.py (WMR100) new (experimental) drivers: wmr200.py (WMR200) ws28xx.py (WS28xx) The interface to the device driver \"loader\" function has changed slightly. It now takes a second parameter, \"engine\". Details are in the Upgrading doc. The FineOffsetUSB driver now supports hardware archive record generation. When starting weewx, the FineOffsetUSB driver will now try to 'catch up' - it will read the console memory for any records that are not yet in the database. Added illuminance-to-radiation conversion in FineOffsetUSB driver. Added pressure calibration option to wee_config_fousb and explicit support for pressure calibration in FineOffsetUSB driver. Fixed windchill calculation in FineOffsetUSB driver. Fixed FineOffsetUSB driver to handle cases where the 'delay' is undefined, resulting in a TypeError that caused weewx to stop. The FineOffsetUSB driver now uses 'max_rain_rate' (measured in cm/hr) instead of 'max_sane_rain' (measured in mm) to filter spurious rain sensor readings. This is done in the driver instead of StdQC so that a single parameter can apply to both LOOP and ARCHIVE records.","title":"2.3.0 04/10/13"},{"location":"changes/#221-021513","text":"Added a function call to the Vantage driver that allows the lamp to be turned on and off. Added a corresponding option to wee_config_vantage. Fixed bug where an undefined wind direction caused an exception when using ordinal wind directions.","title":"2.2.1 02/15/13"},{"location":"changes/#220-021413","text":"Weewx can now be installed using Debian (DEB) or Redhat (RPM) packages, as well as with the old 'setup.py' method. Because they install things in different places, you should stick with one method or another. Don't mix and match. Thanks to Matthew Wall for putting this together! Added plot options line_gap_fraction and bar_gap_fraction, which control how gaps in the data are handled by the plots. Also, added more flexible control of plot colors, using a notation such as 0xBBGGRR, #RRGGBB, or the English name, such as 'yellow'. Finally, added day/night bands to the plots. All contributed by Matthew Wall. Thanks again, Matthew! Ordinal wind directions can now be shown, just by adding the tag suffix \".ordinal_compass\". For example, $current.windDir.ordinal_compass might show 'SSE' The abbreviations are set in the skin configuration file. Fixed bug that caused rain totals to be misreported to Weather Underground when using a metric database. Generalized the weewx machinery so it can be used for applications other than weather applications. Got rid of option stats_types in weewx.conf and put it in bin/user/schemas.py. See upgrading.html if you have a specialized stats database. The stats database now includes an internal table of participating observation types. This allows it to be easily combined with the archive database, should you choose to do so. The table is automatically created for older stats databases. Added rain rate calculation to FineOffsetUSB driver. Added adaptive polling option to FineOffsetUSB driver. Fixed barometric pressure calculation for FineOffsetUSB driver. Changed the name of the utilities, so they will be easier to find in /usr/bin: weewxd.py -> weewxd runreports.py -> wee_reports config_database.py -> wee_config_database config_vp.py -> wee_config_vantage config_fousb.py -> wee_config_fousb","title":"2.2.0 02/14/13"},{"location":"changes/#211-010213","text":"Fixed bug that shows itself when one of the variables is 'None' when calculating a trend.","title":"2.1.1 01/02/13"},{"location":"changes/#210-010213","text":"Now supports the Oregon Scientific WMR918/968 series, courtesy of user William Page. Thanks, William!! Now supports the Fine Offset series of weather stations, thanks to user Matthew Wall. Thanks, Matthew!! Now includes a Redhat init.d script, contributed by Mark Jenks. Thanks, Mark!! Added rsync report type as an alternative to the existing FTP report. Another thanks to William Page! Fill color for bar charts can now be specified separately from the outline color, resulting in much more attractive charts. Another thanks to Matthew Wall!! Added a tag for trends. The barometer trend can now be returned as $trend.barometer. Similar syntax for other observation types. config_vp.py now returns the console version number if available (older consoles do not offer this). Hardware dewpoint calculations with the WMR100 seem to be unreliable below about 20F, so these are now done in software. Thanks to user Mark Jenks for sleuthing this.","title":"2.1.0 01/02/13"},{"location":"changes/#202-112312","text":"Now allows both the archive and stats data to be held in the same database. Improved chances of weewx.Archive being reused by allowing optional table name to be specified.","title":"2.0.2 11/23/12"},{"location":"changes/#201-110512","text":"Fixed problem with reconfiguring databases to a new unit system.","title":"2.0.1 11/05/12"},{"location":"changes/#200-110412","text":"A big release with lots of changes. The two most important are the support of additional weather hardware, and the support of the MySQL database. All skin configurations are backwardly compatible, but the configuration file, weewx.conf, is not. The install utility setup.py will install a fresh version, which you will then have to edit by hand. If you have written a custom service, see the upgrade guide on how to port your service to the new architecture. Added the ability to generate archive records in software, thus opening the door for supporting weather stations that do not have a logger. Support for the Oregon Scientific WMR100, the cheapest weather station I could find, in order to demonstrate the above! Added a software weather station simulator. Introduced weedb, a database-independent Python wrapper around sqlite3 and MySQLdb, which fixes some of their flaws. Ported everything to use weedb, and thus MySQL (as well as sqlite) Internally, the databases can now use either Metric units, or US Customary. NB: you cannot switch systems in the middle of a database. You have to stick to one or other other. However, the utility config_database.py does have a reconfigure option that allows copying the data to a new database, performing the conversion along the way. See the Customization Guide. You can now use \"mmHg\" as a unit of pressure. Added new almanac information, such as first and last quarter moons, and civil twilight. Changed the engine architecture so it is more event driven. It now uses callbacks, making it easier to add new event types. Added utility config_vp.py, for configuring the VantagePro hardware. Added utility config_database.py, for configuring the databases. Made it easier to write custom RESTful protocols. Thanks to user Brad, for the idea and the use case! The stats type 'squarecount' now contains the number of valid wind directions that went into calculating 'xsum' and 'ysum'. It used to be the number of valid wind speeds. Wind direction is now calculated using 'squarecount' (instead of 'count'). Simplified and reduced the memory requirements of the CRC16 calculations. Improved test suites. Lots of little nips and tucks here and there, mostly to reduce the coupling between different modules. In particular, now a service generally gets configured only using its section of weewx.conf. I also worked hard at making sure that cursors, connections, files, and lots of other bits and pieces get properly closed instead of relying on garbage collection. Hopefully, this will reduce the long-term growth of memory usage.","title":"2.0.0 11/04/12"},{"location":"changes/#1141-070612","text":"Hardened retry strategy for the WeatherLink IP. If the port fails to open at all, or a socket error occurs, it will thrown an exception (resulting in a retry in 60 seconds). If a socket returns an incomplete result, it will continue to retry until everything has been read. Fixed minor bug that causes the reporting thread to prematurely terminate if an exception is thrown while doing an FTP.","title":"1.14.1 07/06/12"},{"location":"changes/#1140-061812","text":"Added smartphone formatted mobile webpage, contributed by user Torbj\u00f6rn Einarsson. If you are doing a fresh install, then these pages will be generated automatically. If you are doing an upgrade, then see the upgrade guide on how to have these webpages generated. Thanks, Tobbe! Three changes suggested by user Charlie Spirakis: o Changed umask in daemon.py to 0022; o Allow location of process ID file to be specified on the command line of weewx; o Start script allows daemon to be run as a specific user. Thanks, Charlie! Corrected bug in humidity reports to CWOP that shows itself when the humidity is in the single digits. Now includes software in CWOP APRS equipment field.","title":"1.14.0 06/18/12"},{"location":"changes/#1132-050212","text":"Now allows CWOP stations with prefix 'EW'. Fixed bug that showed itself in the line color with plots with 3 or more lines. Changed debug message when reaching the end of memory in the VP2 to something slightly less alarming.","title":"1.13.2 05/02/12"},{"location":"changes/#1131-032512","text":"Added finer control over the line plots. Can now add optional markers. The marker_type can be 'none' (the default), 'cross', 'box', 'circle', or 'x'. Also, line_type can now either be 'solid' (the default) or 'none' (for scatter plots). Same day I'll add 'dashed', but not now. :-) Conditionally imports sqlite3. If it does not support the \"with\" statement, then imports pysqlite2 as sqlite3.","title":"1.13.1 03/25/12"},{"location":"changes/#1130-031312","text":"The binding to the SQL database to be used now happens much later when running reports. This allows more than one database to be used when running a report. Extra databases can be specified in the option list for a report. I use this to display broadband bandwidth information, which was collected by a separate program. Email me for details on how to do this. Introducing this feature changed the signature of a few functions. See the upgrade guide for details.","title":"1.13.0 03/13/12"},{"location":"changes/#1124-021312","text":"User Alf H\u00f8gemark found an error in the encoding of solar data for CWOP and sent me a fix. Thanks, Alf! Now always uses \"import sqlite3\", resulting in using the version of pysqlite that comes with Python. This means the install instructions have been simplified. Now doesn't choke when using the (rare) Python version of NameMapper used by Cheetah.","title":"1.12.4 02/13/12"},{"location":"changes/#1123-020912","text":"Added start script for FreeBSD, courtesy of user Fabian Abplanalp. Thanks, Fabian! Added the ability to respond to a \"status\" query to the Debian startup script. RESTful posts can now recover from more HTTP errors. Station serial port can now recover from a SerialException error (usually caused when there is a process competing for the serial port). Continue to fiddle with the retry logic when reading LOOP data.","title":"1.12.3 02/09/12"},{"location":"changes/#1122-011812","text":"Added check for FTP error code '521' to the list of possibilities if a directory already exists. Thanks to user Clyde! More complete information when unable to load a module file. Thanks, Jason! Added a few new unit types to the list of possible target units when using explicit conversion. Thanks, Antonio! Discovered and fixed problem caused by the Davis docs giving the wrong \"resend\" code (should be decimal 21, not hex 21). Improved robustness of VantagePro configuration utility. Fixed problem where an exception gets thrown when changing VP archive interval. Simplified some of the logic in the VP2 driver.","title":"1.12.2 01/18/12"},{"location":"changes/#1121-110311","text":"Now corrects for rain bucket size if it is something other than the standard 0.01 inch bucket.","title":"1.12.1 11/03/11"},{"location":"changes/#1120-102911","text":"Added the ability to change bucket type, rain year start, and barometer calibration data in the console using the utility configure.py. Added option \"--info\", which queries the console and returns information about EEPROM settings. Changed configure.py so it can do hardware-specific configurations, in anticipation of supporting hardware besides the Davis series. Reorganized the documentation.","title":"1.12.0 10/29/11"},{"location":"changes/#1110-100611","text":"Added support for the Davis WeatherLinkIP. Thanks, Peter Nock and Travis Pickle! Added support for older Rev A type archive records. Added patch from user Dan Haller that sends UV and radiation data to the WeatherUnderground if available. Thanks, Dan! Added patch from user Marijn Vriens that allows fallback to the version of pysqlite that comes with many versions of Python. Thanks, Marijn! Now does garbage collection after an archive record is obtained and before the main loop is restarted.","title":"1.11.0 10/06/11"},{"location":"changes/#1102-041411","text":"Added RA and declination for the Sun and Moon to the Daily Almanac. Equinox and solstice are now displayed in chronological order. Same with new and full moons. Examples alarm.py and lowBattery.py now include more error checks, allow an optional 'subject' line to the sent email, and allow a comma separated list of recipients.","title":"1.10.2 04/14/11"},{"location":"changes/#1101-033011","text":"Substitutes US Units if a user does not specify anything (instead of exception KeyError). Almanac uses default temperature and pressure if they are 'None'. Prettied up web page almanac data in the case where pyephem has not been installed. Fixed up malformed CSS script weewx.css.","title":"1.10.1 03/30/11"},{"location":"changes/#1100-032911","text":"Added extensive almanac information if the optional package 'pyephem' has been installed Added a weewx \"favorite icon\" favicon.ico that displays in your browser toolbar. Added a mobile formatted HTML page, courtesy of user Vince Skahan (thanks, Vince!!). Tags can now be ended with a unit type to convert to a new unit. For example, say your pressure group (\"group_pressure\") has been set to show inHg. The normal tag notation of \"$day.barometer.avg\" will show something like \"30.05 inHg\". However, the tag \"$day.barometer.avg.mbar\" will show \"1017.5 mbar\". Added special tag \"exists\" to test whether an observation type exists. Example \"$year.foo.exists\" will return False if there is no type \"foo\" in the statistical database. Added special tag \"has_data\" to test whether an observation type exists and has a non-zero number of data points over the aggregation period. For example, \"$year.soilMoist1.has_data\" will return \"True\" if soilMoist1 both exists in the stats database and contains some data (meaning, you have the hardware). Y-axis plot labels (such as \"\u00b0F\") can now be overridden in the plot configuration section of skin.conf by using option \"y_label\". Added executable module \"runreports.py\" for running report generation only. Added package \"user\", which can contain any user extensions. This package will not get overridden in the upgrade process. Added the ability to reconfigure the main database, i.e., add or drop data types. Along the same line, statistical types can also be added or dropped. Email me for details on how to do this. Now makes all of the LOOP and archive data available to services. This includes new keys: LOOP data: 'extraAlarm1' 'extraAlarm2' 'extraAlarm3' 'extraAlarm4' 'extraAlarm5' 'extraAlarm6' 'extraAlarm7' 'extraAlarm8' 'forecastIcon' 'forecastRule' 'insideAlarm' 'outsideAlarm1' 'outsideAlarm2' 'rainAlarm' 'soilLeafAlarm1' 'soilLeafAlarm2' 'soilLeafAlarm3' 'soilLeafAlarm4' 'sunrise' 'sunset' Archive data: 'forecastRule' 'highOutTemp' 'highRadiation' 'highUV' 'lowOutTemp' Started a more formal test suite. There are now tests for the report generators. These are not included in the normal distribution, but can be retrieved from SourceForge via svn.","title":"1.10.0 03/29/11"},{"location":"changes/#193-020411","text":"Now correctly decodes temperatures from LOOP packets as signed shorts (rather than unsigned). Now does a CRC check on LOOP data. Changed VantagePro.accumulateLoop to make it slightly more robust.","title":"1.9.3 02/04/11"},{"location":"changes/#192-112010","text":"Now catches exception of type OverflowError when calculating celsius dewpoint. (Despite the documentation indicating otherwise, math.log() can still throw an OverflowError) Fixed bug that causes crash in VantagePro.accumulateLoop() during fall DST transition in certain situations. VP2 does not store records during the one hour fall DST transition. Improved logic in dealing with this. Changed install so that it backs up the ./bin subdirectory, then overwrites the old one. Also, does not install the ./skins subdirectory at all if one already exists (thus preserving any user customization).","title":"1.9.2 11/20/10"},{"location":"changes/#191-090910","text":"Now catches exceptions of type httplib.BadStatusLine when doing RESTful posts. Added an extra decimal point of precision to dew point reports to the Weather Underground and PWS.","title":"1.9.1 09/09/10"},{"location":"changes/#190-070410","text":"Added a new service, StdQC, that offers a rudimentary data check. Corrected error in rain year total if rain year does not start in January. Moved option max_drift (the max amount of clock drift to tolerate) to section [Station]. Added check for a bad storm start time. Added checks for bad dateTime. Simplified VantagePro module.","title":"1.9.0 07/04/10"},{"location":"changes/#184-060610","text":"Fixed problem that shows itself if weewx starts up at precisely the beginning of an archive interval. Symptom is max recursion depth exceeded. Units for UV in LOOP records corrected. Also, introduced new group for UV, group_uv_index. Thanks to user A. Burriel for this fix!","title":"1.8.4 06/06/10"},{"location":"changes/#183-052010","text":"Problem with configuring archive interval found and fixed by user A. Burriel (thanks, Antonio!)","title":"1.8.3 05/20/10"},{"location":"changes/#182-050910","text":"Added check to skip calibration for a type that doesn't exist in LOOP or archive records. This allows windSpeed and windGust to be calibrated separately.","title":"1.8.2 05/09/10"},{"location":"changes/#181-050110","text":"Ported to Cheetah V2.4.X","title":"1.8.1 05/01/10"},{"location":"changes/#180-042810","text":"Added CWOP support. Storage of LOOP and archive data into the SQL databases is now just another service, StdArchive. Added a calibration service, StdCalibrate, that can correct LOOP and archive data. Average console battery voltage is now calculated from LOOP data, and saved to the archive as 'consBatteryVoltage'. Transmitter battery status is now ORd together from LOOP data, and saved to the archive as 'txBatteryStatus'. Added stack tracebacks for unrecoverable exceptions. Added a wrapper to the serial port in the VantagePro code. When used in a Python \"with\" statement, it automatically releases the serial port if an exception happens, allowing a more orderly shutdown. Offered some hints in the documentation on how to automount your VP2 when using a USB connection. Corrected error in units. getTargetType() that showed itself with when the console memory was freshly cleared, then tried to graph something immediately.","title":"1.8.0 04/28/10"},{"location":"changes/#170-041510","text":"Big update. Reports now use skins for their \"look or feel.\" Options specific to the presentation layer have been moved out of the weewx configuration file 'weewx.conf' to a skin configuration file, 'skin.conf'. Other options have remained behind. Because the configuration file weewx.conf was split, the installation script setup.py will NOT merge your old configuration file into the new one. You will have to reedit weewx.conf to put in your customizations. FTP is treated as just another report, albeit with an unusual generator. You can have multiple FTP sessions, each to a different server, or uploading to or from a different area. Rewrote the FTP upload package so that it allows more than one FTP session to be active in the same local directory. This version also does fewer hits on the server, so it is significantly faster. The configuration files weewx.conf and skin.conf now expect UTF-8 characters throughout. The encoding for reports generated from templates can be chosen. By default, the day, week, month, and year HTML files are encoded using HTML entities; the NOAA reports encoded using 'strict ascii.' Optionally, reports can be encoded using UTF-8. Revamped the template formatting. No longer use class ModelView. Went to a simpler system built around classes ValueHelper and UnitInfo. Optional formatting was added to all tags in the templates. There are now optional endings: 'string': Use specified string for None value. 'formatted': No label. 'format': Format using specified string format. 'nolabel': Format using specified string format; no label. 'raw': return the underlying data with no string formatting or label. For the index, week, month, and year template files, added conditional to not include ISS extended types (UV, radiation, ET) unless they exist. Added an RSS feed. Added support for PWSweather.com Both WeatherUnderground and PWSweather posts are now retried up to 3 times before giving up. Now offer a section 'Extras' in the skin configuration file for including tags added by the user. As an example, the tag radar_url has been moved into here. Data files used in reports (such as weewx.css) are copied over to the HTML directory on program startup. Included an example of a low-battery alarm. Rearranged distribution directory structure so that it matches the install directory structure. Moved base temperature for heating and cooling degree days into skin.conf. They now also require a unit. Now require unit to be specified for 'altitude'.","title":"1.7.0 04/15/10"},{"location":"changes/#150-030710","text":"Added support for other units besides the U.S. Customary. Plots and HTML reports can be prepared using any arbitrary combination of units. For example, pressure could be in millibars, while everything else is in U.S. Customary. Because the configuration file weewx.conf changed significantly, the installation script setup.py will NOT merge your old configuration file into the new one. You will have to reedit weewx.conf to put in your customizations. Added an exception handler for exception OSError, which is typically thrown when another piece of software attempts to access the same device port. Weewx catches the exception, waits 10 seconds, then starts again from the top.","title":"1.5.0 03/07/10"},{"location":"changes/#140-022210","text":"Changed the architecture of stats.py to one that uses very late binding. The SQL statements are not run until template evaluation. This reduces the amount of memory required (by about 1/2), reduces memory fragmentation, as well as greatly simplifying the code (file stats.py shed over 150 lines of non-test code). Execution time is slightly slower for NOAA file generation, slightly faster for HTML file generation, the same for image generation, although your actual results will depend on your disk speed. Now possible to tell weewx to reread the configuration file without stopping it. Send signal HUP to the process. Added option week_start, for specifying which day a calendar week starts on. Default is 6 (Sunday). Fixed reporting bug when the reporting time falls on a calendar month or year boundary.","title":"1.4.0 02/22/10"},{"location":"changes/#134-020810","text":"Fixed problem when plotting data where all data points are bad (None).","title":"1.3.4 02/08/10"},{"location":"changes/#133-011010","text":"Fixed reporting bug that shows itself if rain year does not start in January.","title":"1.3.3 01/10/10"},{"location":"changes/#132-122609","text":"LOOP data added to stats database.","title":"1.3.2 12/26/09"},{"location":"changes/#131-122209","text":"Added a call to syslog.openlog() that inadvertently got left out when switching to the engine driven architecture.","title":"1.3.1 12/22/09"},{"location":"changes/#130-122109","text":"Moved to a very different architecture to drive weewx. Consists of an engine, that manages a list of 'services.' At key events, each service is given a chance to participate. Services are easy to add, to allow easy customization. An example is offered of an 'alarm' service. Checking the clock of the weather station for drift is now a service, so the option clock_check was moved from the station specific [VantagePro] section to the more general [Station] section. Added an example service 'MyAlarm', which sends out an email should the outside temperature drop below 40 degrees. In a similar manner, all generated files, images, and reports are the product of a report engine, which can run any number of reports. New reports are easily added. Moved the compass rose used in progressive vector plots into the interior of the plot. Install now deletes public_html/#upstream.last, thus forcing all files to be uploaded to the web server at the next opportunity.","title":"1.3.0 12/21/09"},{"location":"changes/#120-112209","text":"Added progressive vector plots for wind data. Improved axis scaling. The automatic axis scaling routine now does a better job for ranges less than 1.0. The user can also hardwire in min and max values, as well as specify a minimum increment, through parameter 'yscale' in section [Images] in the configuration file. Now allows the same SQL type to be used more than once in a plot. This allows, say, instantaneous and average wind speed to be shown in the same plot. Rain year is now parameterized in file templates/year.tmpl (instead of being hardwired in). Now does LOOP caching by default. When doing backfilling to the stats database, configure now creates the stats database if it doesn't already exist. setup.py now more robust to upgrading the FTP and Wunderground sections","title":"1.2.0 11/22/09"},{"location":"changes/#110-111409","text":"Added the ability to cache LOOP data. This can dramatically reduce the number of writes to the stats database, reducing wear on solid-state disk stores. Introduced module weewx.mainloop. Introduced class weewx.mainloop.MainLoop This class offers many opportunities to customize weewx through subclassing, then overriding an appropriate member function. Refactored module weewx.wunderground so it more closely resembles the (better) logic in wunderfixer. setup.py no longer installs a daemon startup script to /etc/init.d. It must now be done by hand. setup.py now uses the 'home' value in setup.cfg to set WEEWX_ROOT in weewx.conf and in the daemon start up scripts Now uses FTP passive mode by default.","title":"1.1.0 11/14/09"},{"location":"changes/#101-110909","text":"Fixed bug that prevented backfilling the stats database after modifying the main archive.","title":"1.0.1 11/09/09"},{"location":"changes/#100-102609","text":"Took the module weewx.factory back out, as it was too complicated and hard to understand. Added support for generating NOAA monthly and yearly reports. Completely rewrote the filegenerator.py module, to allow easy subclassing and specialization. Completely rewrote the stats.py module. All aggregate quantities are now calculated dynamically. Labels for HTML generation are now held separately from labels used for image generation. This allows entities such as '\u00b0' to be used for the former. LOOP mode now requests only 200 LOOP records (instead of the old 2000). It then renews the request should it run out. This was to get around an (undocumented) limitation in the VP2 that limits the number of LOOP records that can be requested to something like 220. This was a problem when supporting VP2s that use long archive intervals. Cut down the amount of computing that went on before the processing thread was spawned, thus allowing the main thread to get back into LOOP mode more quickly. Added type 'rainRate' to the types decoded from a Davis archive record. For some reason it was left out. Added retries when doing FTP uploads. It will now attempt the upload several times before giving up. Much more extensive DEBUG analysis. Nipped and tucked here and there, trying to simplify.","title":"1.0.0 10/26/09"},{"location":"changes/#065-101109","text":"Ported to Cheetah V2.2.X. Mostly, this is making sure that all strings that cannot be converted with the 'ascii' codec are converted to Unicode first before feeding to Cheetah.","title":"0.6.5 10/11/09"},{"location":"changes/#064-092209","text":"Fixed an error in the calculation of heat index.","title":"0.6.4 09/22/09"},{"location":"changes/#063-082509","text":"FTP transfers now default to ACTIVE mode, but a configuration file option allows PASSIVE mode. This was necessary to support Microsoft FTP servers.","title":"0.6.3 08/25/09"},{"location":"changes/#062-080109","text":"Exception handling in weewx/ftpdata.py used socket.error but failed to declare it. Added 'import socket' to fix. Added more complete check for unused pages in weewx/VantagePro.py. Now the entire record must be filled with 0xff, not just the time field. This fixes a bug where certain time stamps could look like unused records.","title":"0.6.2 08/01/09"},{"location":"changes/#061-062209","text":"Fixed minor ftp bug.","title":"0.6.1 06/22/09"},{"location":"changes/#060-052009","text":"Changed the file, imaging, ftping functions into objects, so they can be more easily specialized by the user. Introduced a StationData object. Introduced module weewx.factory that produces these things, so the user has a place to inject his/her new types.","title":"0.6.0 05/20/09"},{"location":"changes/#051-051309","text":"Weather Underground thread now run as daemon thread, allowing the program to exit even if it is running. WU queue now hold an instance of archive and the time to be published, rather than a record. This allows dailyrain to be published as well. WU date is now given in the format \"2009-05-13+12%3A35%3A00\" rather than \"2009-05-13 12:35:00\". Seems to be more reliable. But, maybe I'm imagining things...","title":"0.5.1 05/13/09"},{"location":"copyright/","text":"WeeWX Copyright \u00b6 Copyright 2009-2023 by Thomas Keffer ( tkeffer@gmail.com ), Matthew Wall, and Gary Roderick. This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. http://www.gnu.org/licenses The WMR9x8 driver is Copyright Will Page. The FineOffsetUSB driver is Copyright Matthew Wall, based on the open source pywws by Jim Easterbrook. The WS23xx driver is Copyright Matthew Wall, including significant portions from ws2300 by Russel Stuart. The WS28xx driver is Copyright Matthew Wall, based on the original Python implementation by Eddi de Pieri and with significant contributions by LJM Heijst. The TE923 driver is Copyright Matthew Wall with significant contributions from Andrew Miles. The CC3000 driver is Copyright Matthew Wall, thanks to hardware contributed by Annie Brox. The WS1 driver is Copyright Matthew Wall. The Ultimeter driver is Copyright Matthew Wall and Nate Bargmann. The Acurite driver is Copyright Matthew Wall. The WMR300 driver is Copyright Matthew Wall, thanks to hardware contributed by EricG. Some icons are Copyright Tatice ( http://tatice.deviantart.com ), licensed under the terms of Creative Commons Attribution-NonCommercial-NoDerivs 3.0. The debian, redhat, and suse packaging configurations are Copyright Matthew Wall, licensed under the terms of GNU Public License 3.","title":"WeeWX Copyright {#weewx-copyright}"},{"location":"copyright/#weewx-copyright","text":"Copyright 2009-2023 by Thomas Keffer ( tkeffer@gmail.com ), Matthew Wall, and Gary Roderick. This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. http://www.gnu.org/licenses The WMR9x8 driver is Copyright Will Page. The FineOffsetUSB driver is Copyright Matthew Wall, based on the open source pywws by Jim Easterbrook. The WS23xx driver is Copyright Matthew Wall, including significant portions from ws2300 by Russel Stuart. The WS28xx driver is Copyright Matthew Wall, based on the original Python implementation by Eddi de Pieri and with significant contributions by LJM Heijst. The TE923 driver is Copyright Matthew Wall with significant contributions from Andrew Miles. The CC3000 driver is Copyright Matthew Wall, thanks to hardware contributed by Annie Brox. The WS1 driver is Copyright Matthew Wall. The Ultimeter driver is Copyright Matthew Wall and Nate Bargmann. The Acurite driver is Copyright Matthew Wall. The WMR300 driver is Copyright Matthew Wall, thanks to hardware contributed by EricG. Some icons are Copyright Tatice ( http://tatice.deviantart.com ), licensed under the terms of Creative Commons Attribution-NonCommercial-NoDerivs 3.0. The debian, redhat, and suse packaging configurations are Copyright Matthew Wall, licensed under the terms of GNU Public License 3.","title":"WeeWX Copyright"},{"location":"devnotes/","text":"Notes for WeeWX developers \u00b6 This guide is intended for developers contributing to the open source project WeeWX. Goals \u00b6 The primary design goals of WeeWX are: Architectural simplicity. No semaphores, no named pipes, no inter-process communications, no complex multi-threading to manage. Extensibility. Make it easy for the user to add new features or to modify existing features. Fast enough In any design decision, architectural simplicity and elegance trump speed. One code base. A single code base should be used for all platforms, all weather stations, all reports, and any combination of features. Ample configuration and customization options should be provided so the user does not feel tempted to start hacking code. At worse, the user may have to subclass, which is much easier to port to newer versions of the code base, than customizing the base code. Minimal dependencies. The code should rely on a minimal number of external packages, so the user does not have to go chase them down all over the Web before getting started. Simple data model. The implementation should use a very simple data model that is likely to support many different types of hardware. A pythonic code base. The code should be written in a style that others will recognize. Strategies \u00b6 To meet these goals, the following strategies were used: A micro-kernel design. The WeeWX engine actually does very little. Its primary job is to load and run services at runtime, making it easy for users to add or subtract features. A largely stateless design style. For example, many of the processing routines read the data they need directly from the database, rather than caching it and sharing with other routines. While this means the same data may be read multiple times, it also means the only point of possible cache incoherence is through the database, where transactions are easily controlled. This greatly reduces the chances of corrupting the data, making it much easier to understand and modify the code base. Isolated data collection and archiving. The code for collecting and archiving data run in a single thread that is simple enough that it is unlikely to crash. The report processing is where most mistakes are likely to happen, so isolate that in a separate thread. If it crashes, it will not affect the main data thread. A powerful configuration parser. The ConfigObj module, by Michael Foord and Nicola Larosa, was chosen to read the configuration file. This allows many options that might otherwise have to go in the code, to be in a configuration file. A powerful templating engine. The Cheetah module was chosen for generating html and other types of files from templates. Cheetah allows search list extensions to be defined, making it easy to extend WeeWX with new template tags. Pure Python. The code base is 100% Python \u2014 no underlying C libraries need be built to install WeeWX. This also means no Makefiles are needed. While WeeWX is nowhere near as fast at generating images and HTML as its predecessor, wview (this is partially because WeeWX uses fancier fonts and a much more powerful templating engine), it is fast enough for all platforms but the slowest. I run it regularly on a 500 MHz machine where generating the 9 images used in the Current Conditions page takes just under 2 seconds (compared with 0.4 seconds for wview). All writes to the databases are protected by transactions. You can kill the program at any time without fear of corrupting the databases. The code makes ample use of exceptions to insure graceful recovery from problems such as network outages. It also monitors socket and console timeouts, restarting whatever it was working on several times before giving up. In the case of an unrecoverable console error (such as the console not responding at all), the program waits 60 seconds then restarts the program from the top. Any hard exceptions, that is those that do not involve network and console timeouts and are most likely due to a logic error, are logged, reraised, and ultimately cause thread termination. If this happens in the main thread (not likely due to its simplicity), then this causes program termination. If it happens in the report processing thread (much more likely), then only the generation of reports will be affected \u2014 the main thread will continue downloading data off the instrument and putting them in the database. Units \u00b6 In general, there are three different areas where the unit system makes a difference: On the weather station hardware. Different manufacturers use different unit systems for their hardware. The Davis Vantage series use U.S. Customary units exclusively, Fine Offset and LaCrosse stations use metric, while Oregon Scientific, Peet Bros, and Hideki stations use a mishmash of US and metric. In the database. Either US or Metric can be used. In the presentation (i.e., html and image files). The general strategy is that measurements are converted by service StdConvert as they come off the weather station into a target unit system, then stored internally in the database in that unit system. Then, as they come off the database to be used for a report, they are converted into a target unit, specified by a combination of the configuration file weewx.conf and the skin configuration file skin.conf . Value None \u00b6 The Python special value None is used throughout to signal an invalid or bad data point. All functions must be written to expect it. Device drivers should be written to emit None if a data value is bad (perhaps because of a failed checksum). If the hardware simply doesn't support a data type, then the driver should not emit a value at all. The same rule applies to derived values. If the input data for a derived value are missing, then no derived value should be emitted. However, if the input values are present, but have value None , then the derived value should be set to None . However, the time value must never be None . This is because it is used as the primary key in the SQL database. Time \u00b6 WeeWX stores all data in UTC (roughly, Greenwich or Zulu ) time. However, usually one is interested in weather events in local time and want image and HTML generation to reflect that. Furthermore, most weather stations are configured in local time. This requires that many data times be converted back and forth between UTC and local time. To avoid tripping up over time zones and daylight savings time, WeeWX generally uses Python routines to do this conversion. Nowhere in the code base is there any explicit recognition of DST. Instead, its presence is implicit in the conversions. At times, this can cause the code to be relatively inefficient. For example, if one wanted to plot something every 3 hours in UTC time, it would be very simple: to get the next plot point, just add 10,800 to the epoch time: next_ts = last_ts + 10800 But, if one wanted to plot something for every 3 hours in local time (that is, at 0000, 0300, 0600, etc.), despite a possible DST change in the middle, then things get a bit more complicated. One could modify the above to recognize whether a DST transition occurs sometime between last_ts and the next three hours and, if so, make the necessary adjustments. This is generally what wview does. WeeWX takes a different approach and converts from UTC to local, does the arithmetic, then converts back. This is inefficient, but bulletproof against changes in DST algorithms, etc.: time_dt = datetime.datetime.fromtimestamp(last_ts) delta = datetime.timedelta(seconds=10800) next_dt = time_dt + delta next_ts = int(time.mktime(next_dt.timetuple())) Other time conversion problems are handled in a similar manner. For astronomical calculations, WeeWX uses the latitude and longitude specified in the configuration file. If that location does not correspond to the computer's local time, reports with astronomical times will probably be incorrect. Archive records \u00b6 An archive record's timestamp, whether in software or in the database, represents the end time of the record. For example, a record timestamped 05-Feb-2016 09:35, includes data from an instant after 09:30, through 09:35. Another way to think of it is that it is exclusive on the left, inclusive on the right. Schematically: 09:30 < dateTime <= 09:35 Database queries should reflect this. For example, to find the maximum temperature for the hour between timestamps 1454691600 and 1454695200, the query would be: SELECT MAX(outTemp) FROM archive WHERE dateTime > 1454691600 and dateTime <= 1454695200; This ensures that the record at the beginning of the hour (1454691600) does not get included (it belongs to the previous hour), while the record at the end of the hour (1454695200) does. One must be constantly be aware of this convention when working with timestamped data records. Better yet, if you need this kind of information, use an xtypes call: max_temp = weewx.xtypes.get_aggregate('outTemp', (1454691600, 1454695200), 'max', db_manager) It will not only make sure the limits of the query are correct, but will also decide whether the daily summary optimization can be used ( details below ). If not, it will use the regular archive table. Internationalization \u00b6 Generally, WeeWX is locale aware. It will emit reports using the local formatting conventions for date, times, and values. Exceptions \u00b6 In general, your code should not simply swallow an exception. For example, this is bad form: try: os.rename(oldname, newname) except: pass While the odds are that if an exception happens it will be because the file oldname does not exist, that is not guaranteed. It could be because of a keyboard interrupt, or a corrupted file system, or something else. Instead, you should test explicitly for any expected exception, and let the rest go by: try: os.rename(oldname, newname) except OSError: pass WeeWX has a few specialized exception types, used to rationalize all the different types of exceptions that could be thrown by the underlying libraries. In particular, low-level I/O code can raise a myriad of exceptions, such as USB errors, serial errors, network connectivity errors, etc. All device drivers should catch these exceptions and convert them into an exception of type WeeWxIOError or one of its subclasses. Naming conventions \u00b6 How you name variables makes a big difference in code readability. In general, long names are preferable to short names. Instead of this, p = 990.1 use this, pressure = 990.1 or, even better, this: pressure_mbar = 990.1 WeeWX uses a number of conventions to signal the variable type, although they are not used consistently. Variable suffix conventions Suffix Example Description _ts first_ts Variable is a timestamp in unix epoch time . _dt start_dt Variable is an instance of datetime.datetime , usually in local time . _d end_d Variable is an instance of datetime.date , usually in local time . _tt sod_tt Variable is an instance of time.struct_time (a time tuple ) , usually in local time . _vh pressure_vh Variable is an instance of weewx.units.ValueHelper . _vt speed_vt Variable is an instance of weewx.units.ValueTuple . Code style \u00b6 Generally, we try to follow the PEP 8 style guide , but there are many exceptions. In particular, many older WeeWX function names use camelCase, but PEP 8 calls for snake_case. Please use snake_case for new code. Most modern code editors, such as Eclipse, or PyCharm, have the ability to automatically format code. Resist the temptation and don't use this feature! Two reasons: Unless all developers use the same tool, using the same settings, we will just thrash back and forth between slightly different versions. Automatic formatters play a useful role, but some of what they do are really trivial changes, such as removing spaces in otherwise blank lines. Now if someone is trying to figure out what real, syntactic, changes you have made, s/he will have to wade through all those extraneous changed lines, trying to find the important stuff. If you are working with a file where the formatting is so ragged that you really must do a reformat, then do it as a separate commit. This allows the formatting changes to be clearly distinguished from more functional changes. When invoking functions or instantiating classes, use the fully qualified name. Don't do this: from datetime import datetime now = datetime() Instead, do this: import datetime now = datetime.datetime() Git work flow \u00b6 We use Git as the source control system. If Git is still mysterious to you, bookmark this: Pro Git , then read the chapter Git Basics . Also recommended is the article How to Write a Git Commit Message . The code is hosted on GitHub . Their documentation is very extensive and helpful. We generally follow Vincent Driessen's branching model . Ignore the complicated diagram at the beginning of the article, and just focus on the text. In this model, there are two key branches: 'master'. Fixes go into this branch. We tend to use fewer hot fix branches and, instead, just incorporate any fixes directly into the branch. Releases are tagged relative to this branch. 'development' (called develop in Vince's article). This is where new features go. Before a release, they will be merged into the master branch. What this means to you is that if you submit a pull request that includes a new feature, make sure you commit your changes relative to the development branch. If it is just a bug fix, it should be committed against the master branch. Forking the repository \u00b6 The WeeWX GitHub repository is configured to use GitHub Actions to run Continuous Integration (CI) workflows automatically if certain git operations are done on branches under active development. This means that CI workflows will also be run on any forks that you may have made if the configured git action is done. This can be confusing if you get an email from GitHub if these tasks fail for some reason on your fork. To control GitHub Actions for your fork, see the recommended solutions in this GitHub discussion on this topic. Tools \u00b6 Python \u00b6 JetBrain's PyCharm is exellent, and now there's a free Community Edition. It has many advanced features, yet is structured that you need not be exposed to them until you need them. Highly recommended. HTML and Javascript \u00b6 For Javascript, JetBrain's WebStorm is excellent, particularly if you will be using a framework such as Node.js or Express.js. Daily summaries \u00b6 This section builds on the discussion The database in the Customization Guide . Read it first. The big flat table in the database (usually called table archive ) is the definitive table of record. While it includes a lot of information, querying it can be slow. For example, to find the maximum temperature of the year would require scanning the entire table, which might include 100,000 or more records. To speed things up, WeeWX includes daily summaries in the database as an optimization. In the daily summaries, each observation type gets its own table, which holds a statistical summary for the day. For example, for outside temperature observation type outTemp , this table would be named archive_day_outTemp . This is what it would look like: Structure of the archive_day_outTemp daily summary dateTime min mintime max maxtime sum count wsum sumtime 1652425200 44.7 1652511600 56.0 1652477640 38297.0 763 2297820.0 45780 1652511600 44.1 1652531280 66.7 1652572500 76674.4 1433 4600464.0 85980 1652598000 50.3 1652615220 59.8 1652674320 32903.0 611 1974180.0 36660 ... ... ... ... ... ... ... ... ... This is what the table columns mean: Name Meaning dateTime The time of the start of day in unix epoch time . This is the primary key in the database. It must be unique, and it cannot be null. min The minimum temperature seen for the day. The unit is whatever unit system the main archive table uses (generally given by the first record in the table). mintime The time in unix epoch time of the minimum temperature. max The maximum temperature seen for the day. The unit is whatever unit system the main archive table uses (generally given by the first record in the table). maxtime The time in unix epoch time of the maximum temperature. sum The sum of all the temperatures for the day. count The number of records in the day. wsum The weighted sum of all the temperatures for the day. The weight is the archive interval in seconds. That is, for each record, the temperature is multiplied by the length of the archive record in seconds, then summed up. sumtime The sum of all the archive intervals for the day in seconds. If the archive interval didn't change during the day, then this number would be interval * 60 * count . Note how the average temperature for the day can be calculated as wsum / sumtime . This will be true even if the archive interval changes during the day. Now consider an extensive variable such as rain . The total rainfall for the day will be given by the field sum . So, calculating the total rainfall for the year can be done by scanning and summing only 365 records, instead of potentially tens, or even hundreds, of thousands of records. This results in a dramatic speed up for report generation, particularly on slower machines such as the Raspberry Pi, working off an SD card. Wind summaries \u00b6 The daily summary for wind includes six additional fields. This is what they mean: Name Meaning max_dir The direction of the maximum wind seen for the day. xsum The sum of the x-component (east-west) of the wind for the day. ysum The sum of the y-component (north-south) of the wind for the day. dirsumtime The sum of all the archive intervals for the day in seconds, which contributed to xsum and ysum . squaresum The sum of the wind speed squared for the day. wsquaresum The sum of the weighted wind speed squared for the day. That is the wind speed is squared, then multiplied by the archive interval in seconds, then summed for the day. This is useful for calculating RMS wind speed. Note that the RMS wind speed can be calculated as math.sqrt(wsquaresum / sumtime) Glossary \u00b6 This is a glossary of terminology used throughout the code. Terminology used in WeeWX Name Description archive interval WeeWX does not store the raw data that comes off a weather station. Instead, it aggregates the data over a length of time, the archive interval , and then stores that. archive record While packets are raw data that comes off the weather station, records are data aggregated by time. For example, temperature may be the average temperature over an archive interval . These are the data stored in the SQL database config_dict All configuration information used by WeeWX is stored in the configuration file , usually with the name weewx.conf . By convention, when this file is read into the program, it is called config_dict , an instance of the class configobj.ConfigObj . datetime An instance of the Python object datetime.datetime . Variables of type datetime usually have a suffix _dt . db_dict A dictionary with all the data necessary to bind to a database. An example for SQLite would be { 'driver':'db.sqlite', 'SQLITE_ROOT':'/home/weewx/archive', 'database_name':'weewx.sdb' } An example for MySQL would be { 'driver':'db.mysql', 'host':'localhost', 'user':'weewx', 'password':'mypassword', 'database_name':'weewx' } epoch time Sometimes referred to as \"unix time,\" or \"unix epoch time.\" The number of seconds since the epoch, which is 1 Jan 1970 00:00:00 UTC. Hence, it always represents UTC (well... after adding a few leap seconds... but, close enough). This is the time used in the databases and appears as type dateTime in the SQL schema, perhaps an unfortunate name because of the similarity to the completely unrelated Python type datetime . Very easy to manipulate, but it is a big opaque number. LOOP packet The real-time data coming off the weather station. The terminology \"LOOP\" comes from the Davis series of weather stations. A LOOP packet can contain all observation types, or it may contain only some of them (\"Partial packet\"). observation type A physical quantity measured by a weather station ( e.g. , outTemp ) or something derived from it ( e.g. , dewpoint ). skin_dict All configuration information used by a particular skin is stored in the skin configuration file , usually with the name skin.conf . By convention, when this file is read into the program, it is called skin_dict , an instance of the class configobj.ConfigObj . SQL type A type that appears in the SQL database. This usually looks something like outTemp , barometer , extraTemp1 , and so on. standard unit system A complete set of units used together. Either US , METRIC , or METRICWX . time stamp A variable in unix epoch time. Always in UTC. Variables carrying a time stamp usually have a suffix _ts . tuple-time An instance of the Python object time.struct_time . This is a 9-way tuple that represent a time. It could be in either local time or UTC, though usually the former. See module time for more information. Variables carrying tuple time usually have a suffix _tt . value tuple A 3-way tuple. First element is a value, second element the unit type the value is in, the third the unit group. An example would be (21.2, 'degree_C', 'group_temperature') .","title":"Notes for developers"},{"location":"devnotes/#notes-for-weewx-developers","text":"This guide is intended for developers contributing to the open source project WeeWX.","title":"Notes for WeeWX developers"},{"location":"devnotes/#goals","text":"The primary design goals of WeeWX are: Architectural simplicity. No semaphores, no named pipes, no inter-process communications, no complex multi-threading to manage. Extensibility. Make it easy for the user to add new features or to modify existing features. Fast enough In any design decision, architectural simplicity and elegance trump speed. One code base. A single code base should be used for all platforms, all weather stations, all reports, and any combination of features. Ample configuration and customization options should be provided so the user does not feel tempted to start hacking code. At worse, the user may have to subclass, which is much easier to port to newer versions of the code base, than customizing the base code. Minimal dependencies. The code should rely on a minimal number of external packages, so the user does not have to go chase them down all over the Web before getting started. Simple data model. The implementation should use a very simple data model that is likely to support many different types of hardware. A pythonic code base. The code should be written in a style that others will recognize.","title":"Goals"},{"location":"devnotes/#strategies","text":"To meet these goals, the following strategies were used: A micro-kernel design. The WeeWX engine actually does very little. Its primary job is to load and run services at runtime, making it easy for users to add or subtract features. A largely stateless design style. For example, many of the processing routines read the data they need directly from the database, rather than caching it and sharing with other routines. While this means the same data may be read multiple times, it also means the only point of possible cache incoherence is through the database, where transactions are easily controlled. This greatly reduces the chances of corrupting the data, making it much easier to understand and modify the code base. Isolated data collection and archiving. The code for collecting and archiving data run in a single thread that is simple enough that it is unlikely to crash. The report processing is where most mistakes are likely to happen, so isolate that in a separate thread. If it crashes, it will not affect the main data thread. A powerful configuration parser. The ConfigObj module, by Michael Foord and Nicola Larosa, was chosen to read the configuration file. This allows many options that might otherwise have to go in the code, to be in a configuration file. A powerful templating engine. The Cheetah module was chosen for generating html and other types of files from templates. Cheetah allows search list extensions to be defined, making it easy to extend WeeWX with new template tags. Pure Python. The code base is 100% Python \u2014 no underlying C libraries need be built to install WeeWX. This also means no Makefiles are needed. While WeeWX is nowhere near as fast at generating images and HTML as its predecessor, wview (this is partially because WeeWX uses fancier fonts and a much more powerful templating engine), it is fast enough for all platforms but the slowest. I run it regularly on a 500 MHz machine where generating the 9 images used in the Current Conditions page takes just under 2 seconds (compared with 0.4 seconds for wview). All writes to the databases are protected by transactions. You can kill the program at any time without fear of corrupting the databases. The code makes ample use of exceptions to insure graceful recovery from problems such as network outages. It also monitors socket and console timeouts, restarting whatever it was working on several times before giving up. In the case of an unrecoverable console error (such as the console not responding at all), the program waits 60 seconds then restarts the program from the top. Any hard exceptions, that is those that do not involve network and console timeouts and are most likely due to a logic error, are logged, reraised, and ultimately cause thread termination. If this happens in the main thread (not likely due to its simplicity), then this causes program termination. If it happens in the report processing thread (much more likely), then only the generation of reports will be affected \u2014 the main thread will continue downloading data off the instrument and putting them in the database.","title":"Strategies"},{"location":"devnotes/#units","text":"In general, there are three different areas where the unit system makes a difference: On the weather station hardware. Different manufacturers use different unit systems for their hardware. The Davis Vantage series use U.S. Customary units exclusively, Fine Offset and LaCrosse stations use metric, while Oregon Scientific, Peet Bros, and Hideki stations use a mishmash of US and metric. In the database. Either US or Metric can be used. In the presentation (i.e., html and image files). The general strategy is that measurements are converted by service StdConvert as they come off the weather station into a target unit system, then stored internally in the database in that unit system. Then, as they come off the database to be used for a report, they are converted into a target unit, specified by a combination of the configuration file weewx.conf and the skin configuration file skin.conf .","title":"Units"},{"location":"devnotes/#value-none","text":"The Python special value None is used throughout to signal an invalid or bad data point. All functions must be written to expect it. Device drivers should be written to emit None if a data value is bad (perhaps because of a failed checksum). If the hardware simply doesn't support a data type, then the driver should not emit a value at all. The same rule applies to derived values. If the input data for a derived value are missing, then no derived value should be emitted. However, if the input values are present, but have value None , then the derived value should be set to None . However, the time value must never be None . This is because it is used as the primary key in the SQL database.","title":"Value None"},{"location":"devnotes/#time","text":"WeeWX stores all data in UTC (roughly, Greenwich or Zulu ) time. However, usually one is interested in weather events in local time and want image and HTML generation to reflect that. Furthermore, most weather stations are configured in local time. This requires that many data times be converted back and forth between UTC and local time. To avoid tripping up over time zones and daylight savings time, WeeWX generally uses Python routines to do this conversion. Nowhere in the code base is there any explicit recognition of DST. Instead, its presence is implicit in the conversions. At times, this can cause the code to be relatively inefficient. For example, if one wanted to plot something every 3 hours in UTC time, it would be very simple: to get the next plot point, just add 10,800 to the epoch time: next_ts = last_ts + 10800 But, if one wanted to plot something for every 3 hours in local time (that is, at 0000, 0300, 0600, etc.), despite a possible DST change in the middle, then things get a bit more complicated. One could modify the above to recognize whether a DST transition occurs sometime between last_ts and the next three hours and, if so, make the necessary adjustments. This is generally what wview does. WeeWX takes a different approach and converts from UTC to local, does the arithmetic, then converts back. This is inefficient, but bulletproof against changes in DST algorithms, etc.: time_dt = datetime.datetime.fromtimestamp(last_ts) delta = datetime.timedelta(seconds=10800) next_dt = time_dt + delta next_ts = int(time.mktime(next_dt.timetuple())) Other time conversion problems are handled in a similar manner. For astronomical calculations, WeeWX uses the latitude and longitude specified in the configuration file. If that location does not correspond to the computer's local time, reports with astronomical times will probably be incorrect.","title":"Time"},{"location":"devnotes/#archive-records","text":"An archive record's timestamp, whether in software or in the database, represents the end time of the record. For example, a record timestamped 05-Feb-2016 09:35, includes data from an instant after 09:30, through 09:35. Another way to think of it is that it is exclusive on the left, inclusive on the right. Schematically: 09:30 < dateTime <= 09:35 Database queries should reflect this. For example, to find the maximum temperature for the hour between timestamps 1454691600 and 1454695200, the query would be: SELECT MAX(outTemp) FROM archive WHERE dateTime > 1454691600 and dateTime <= 1454695200; This ensures that the record at the beginning of the hour (1454691600) does not get included (it belongs to the previous hour), while the record at the end of the hour (1454695200) does. One must be constantly be aware of this convention when working with timestamped data records. Better yet, if you need this kind of information, use an xtypes call: max_temp = weewx.xtypes.get_aggregate('outTemp', (1454691600, 1454695200), 'max', db_manager) It will not only make sure the limits of the query are correct, but will also decide whether the daily summary optimization can be used ( details below ). If not, it will use the regular archive table.","title":"Archive records"},{"location":"devnotes/#internationalization","text":"Generally, WeeWX is locale aware. It will emit reports using the local formatting conventions for date, times, and values.","title":"Internationalization"},{"location":"devnotes/#exceptions","text":"In general, your code should not simply swallow an exception. For example, this is bad form: try: os.rename(oldname, newname) except: pass While the odds are that if an exception happens it will be because the file oldname does not exist, that is not guaranteed. It could be because of a keyboard interrupt, or a corrupted file system, or something else. Instead, you should test explicitly for any expected exception, and let the rest go by: try: os.rename(oldname, newname) except OSError: pass WeeWX has a few specialized exception types, used to rationalize all the different types of exceptions that could be thrown by the underlying libraries. In particular, low-level I/O code can raise a myriad of exceptions, such as USB errors, serial errors, network connectivity errors, etc. All device drivers should catch these exceptions and convert them into an exception of type WeeWxIOError or one of its subclasses.","title":"Exceptions"},{"location":"devnotes/#naming-conventions","text":"How you name variables makes a big difference in code readability. In general, long names are preferable to short names. Instead of this, p = 990.1 use this, pressure = 990.1 or, even better, this: pressure_mbar = 990.1 WeeWX uses a number of conventions to signal the variable type, although they are not used consistently. Variable suffix conventions Suffix Example Description _ts first_ts Variable is a timestamp in unix epoch time . _dt start_dt Variable is an instance of datetime.datetime , usually in local time . _d end_d Variable is an instance of datetime.date , usually in local time . _tt sod_tt Variable is an instance of time.struct_time (a time tuple ) , usually in local time . _vh pressure_vh Variable is an instance of weewx.units.ValueHelper . _vt speed_vt Variable is an instance of weewx.units.ValueTuple .","title":"Naming conventions"},{"location":"devnotes/#code-style","text":"Generally, we try to follow the PEP 8 style guide , but there are many exceptions. In particular, many older WeeWX function names use camelCase, but PEP 8 calls for snake_case. Please use snake_case for new code. Most modern code editors, such as Eclipse, or PyCharm, have the ability to automatically format code. Resist the temptation and don't use this feature! Two reasons: Unless all developers use the same tool, using the same settings, we will just thrash back and forth between slightly different versions. Automatic formatters play a useful role, but some of what they do are really trivial changes, such as removing spaces in otherwise blank lines. Now if someone is trying to figure out what real, syntactic, changes you have made, s/he will have to wade through all those extraneous changed lines, trying to find the important stuff. If you are working with a file where the formatting is so ragged that you really must do a reformat, then do it as a separate commit. This allows the formatting changes to be clearly distinguished from more functional changes. When invoking functions or instantiating classes, use the fully qualified name. Don't do this: from datetime import datetime now = datetime() Instead, do this: import datetime now = datetime.datetime()","title":"Code style"},{"location":"devnotes/#git-work-flow","text":"We use Git as the source control system. If Git is still mysterious to you, bookmark this: Pro Git , then read the chapter Git Basics . Also recommended is the article How to Write a Git Commit Message . The code is hosted on GitHub . Their documentation is very extensive and helpful. We generally follow Vincent Driessen's branching model . Ignore the complicated diagram at the beginning of the article, and just focus on the text. In this model, there are two key branches: 'master'. Fixes go into this branch. We tend to use fewer hot fix branches and, instead, just incorporate any fixes directly into the branch. Releases are tagged relative to this branch. 'development' (called develop in Vince's article). This is where new features go. Before a release, they will be merged into the master branch. What this means to you is that if you submit a pull request that includes a new feature, make sure you commit your changes relative to the development branch. If it is just a bug fix, it should be committed against the master branch.","title":"Git work flow"},{"location":"devnotes/#forking-the-repository","text":"The WeeWX GitHub repository is configured to use GitHub Actions to run Continuous Integration (CI) workflows automatically if certain git operations are done on branches under active development. This means that CI workflows will also be run on any forks that you may have made if the configured git action is done. This can be confusing if you get an email from GitHub if these tasks fail for some reason on your fork. To control GitHub Actions for your fork, see the recommended solutions in this GitHub discussion on this topic.","title":"Forking the repository"},{"location":"devnotes/#tools","text":"","title":"Tools"},{"location":"devnotes/#python","text":"JetBrain's PyCharm is exellent, and now there's a free Community Edition. It has many advanced features, yet is structured that you need not be exposed to them until you need them. Highly recommended.","title":"Python"},{"location":"devnotes/#html-and-javascript","text":"For Javascript, JetBrain's WebStorm is excellent, particularly if you will be using a framework such as Node.js or Express.js.","title":"HTML and Javascript"},{"location":"devnotes/#daily-summaries","text":"This section builds on the discussion The database in the Customization Guide . Read it first. The big flat table in the database (usually called table archive ) is the definitive table of record. While it includes a lot of information, querying it can be slow. For example, to find the maximum temperature of the year would require scanning the entire table, which might include 100,000 or more records. To speed things up, WeeWX includes daily summaries in the database as an optimization. In the daily summaries, each observation type gets its own table, which holds a statistical summary for the day. For example, for outside temperature observation type outTemp , this table would be named archive_day_outTemp . This is what it would look like: Structure of the archive_day_outTemp daily summary dateTime min mintime max maxtime sum count wsum sumtime 1652425200 44.7 1652511600 56.0 1652477640 38297.0 763 2297820.0 45780 1652511600 44.1 1652531280 66.7 1652572500 76674.4 1433 4600464.0 85980 1652598000 50.3 1652615220 59.8 1652674320 32903.0 611 1974180.0 36660 ... ... ... ... ... ... ... ... ... This is what the table columns mean: Name Meaning dateTime The time of the start of day in unix epoch time . This is the primary key in the database. It must be unique, and it cannot be null. min The minimum temperature seen for the day. The unit is whatever unit system the main archive table uses (generally given by the first record in the table). mintime The time in unix epoch time of the minimum temperature. max The maximum temperature seen for the day. The unit is whatever unit system the main archive table uses (generally given by the first record in the table). maxtime The time in unix epoch time of the maximum temperature. sum The sum of all the temperatures for the day. count The number of records in the day. wsum The weighted sum of all the temperatures for the day. The weight is the archive interval in seconds. That is, for each record, the temperature is multiplied by the length of the archive record in seconds, then summed up. sumtime The sum of all the archive intervals for the day in seconds. If the archive interval didn't change during the day, then this number would be interval * 60 * count . Note how the average temperature for the day can be calculated as wsum / sumtime . This will be true even if the archive interval changes during the day. Now consider an extensive variable such as rain . The total rainfall for the day will be given by the field sum . So, calculating the total rainfall for the year can be done by scanning and summing only 365 records, instead of potentially tens, or even hundreds, of thousands of records. This results in a dramatic speed up for report generation, particularly on slower machines such as the Raspberry Pi, working off an SD card.","title":"Daily summaries"},{"location":"devnotes/#wind-summaries","text":"The daily summary for wind includes six additional fields. This is what they mean: Name Meaning max_dir The direction of the maximum wind seen for the day. xsum The sum of the x-component (east-west) of the wind for the day. ysum The sum of the y-component (north-south) of the wind for the day. dirsumtime The sum of all the archive intervals for the day in seconds, which contributed to xsum and ysum . squaresum The sum of the wind speed squared for the day. wsquaresum The sum of the weighted wind speed squared for the day. That is the wind speed is squared, then multiplied by the archive interval in seconds, then summed for the day. This is useful for calculating RMS wind speed. Note that the RMS wind speed can be calculated as math.sqrt(wsquaresum / sumtime)","title":"Wind summaries"},{"location":"devnotes/#glossary","text":"This is a glossary of terminology used throughout the code. Terminology used in WeeWX Name Description archive interval WeeWX does not store the raw data that comes off a weather station. Instead, it aggregates the data over a length of time, the archive interval , and then stores that. archive record While packets are raw data that comes off the weather station, records are data aggregated by time. For example, temperature may be the average temperature over an archive interval . These are the data stored in the SQL database config_dict All configuration information used by WeeWX is stored in the configuration file , usually with the name weewx.conf . By convention, when this file is read into the program, it is called config_dict , an instance of the class configobj.ConfigObj . datetime An instance of the Python object datetime.datetime . Variables of type datetime usually have a suffix _dt . db_dict A dictionary with all the data necessary to bind to a database. An example for SQLite would be { 'driver':'db.sqlite', 'SQLITE_ROOT':'/home/weewx/archive', 'database_name':'weewx.sdb' } An example for MySQL would be { 'driver':'db.mysql', 'host':'localhost', 'user':'weewx', 'password':'mypassword', 'database_name':'weewx' } epoch time Sometimes referred to as \"unix time,\" or \"unix epoch time.\" The number of seconds since the epoch, which is 1 Jan 1970 00:00:00 UTC. Hence, it always represents UTC (well... after adding a few leap seconds... but, close enough). This is the time used in the databases and appears as type dateTime in the SQL schema, perhaps an unfortunate name because of the similarity to the completely unrelated Python type datetime . Very easy to manipulate, but it is a big opaque number. LOOP packet The real-time data coming off the weather station. The terminology \"LOOP\" comes from the Davis series of weather stations. A LOOP packet can contain all observation types, or it may contain only some of them (\"Partial packet\"). observation type A physical quantity measured by a weather station ( e.g. , outTemp ) or something derived from it ( e.g. , dewpoint ). skin_dict All configuration information used by a particular skin is stored in the skin configuration file , usually with the name skin.conf . By convention, when this file is read into the program, it is called skin_dict , an instance of the class configobj.ConfigObj . SQL type A type that appears in the SQL database. This usually looks something like outTemp , barometer , extraTemp1 , and so on. standard unit system A complete set of units used together. Either US , METRIC , or METRICWX . time stamp A variable in unix epoch time. Always in UTC. Variables carrying a time stamp usually have a suffix _ts . tuple-time An instance of the Python object time.struct_time . This is a 9-way tuple that represent a time. It could be in either local time or UTC, though usually the former. See module time for more information. Variables carrying tuple time usually have a suffix _tt . value tuple A 3-way tuple. First element is a value, second element the unit type the value is in, the third the unit group. An example would be (21.2, 'degree_C', 'group_temperature') .","title":"Glossary"},{"location":"upgrade/","text":"Upgrade guide \u00b6 Warning You must use the same upgrade technique as your initial install! For example, if you used pip to install WeeWX, then you should use pip to upgrade. If you used a DEB or RPM package to install, then you should upgrade using the same package type. Warning If you are upgrading from an old setup.py installation, see the instructions Migrating setup.py installs to Version 5.0 . The instructions for upgrading WeeWX are in the quick start guides: Upgrading using Debian DEB Upgrading using Redhat RPM Upgrading using SUSE RPM Upgrading using pip Upgrading using git The rest of this document describes the changes in each WeeWX release. Upgrading the WeeWX configuration file \u00b6 It does not happen very often, but occasionally a new release will require changes to the WeeWX configuration file. When this happens, the installer takes care of upgrading the file, and you do not need to worry about it. However, there are some occasions when you may need to upgrade the file yourself. In particular, this happens when you run several instances of weewxd on the same machine, each with its own configuration file. The configuration file named weewx.conf will get upgraded, but what about the others? The answer is to use weectl station upgrade with the --config option pointing to the configuration file to be upgraded. For example, this would upgrade the configuration file /etc/weewx/other.conf : sudo weectl station upgrade --config=/etc/weewx/other.conf Upgrading to V5.0 \u00b6 Python 2.7 no longer supported \u00b6 It has now been over 3 years since the end-of-life for Python 2.7. It's time to move on. WeeWX V5.x requires Python 3.7 or greater. These days, all but the most ancient of operating systems offer Python 3, although you may have to install it. setup.py installs no longer possible \u00b6 The package distutils , and the imperative approach on which the WeeWX setup.py install method depends, has been deprecated and will ultimately be removed. The future is clearly pip installs using pyproject.toml . See the wiki article on Version 5 for the technical reasons why. pip installs to new location \u00b6 The default location for a setup.py install was /home/weewx . The new pip install method installs to a directory called weewx-data in home directory of the user doing the install. However, old installations can continue to use /home/weewx by following the guide Migrating setup.py installs to Version 5.0 . New location for user directory \u00b6 This affects users who are using a package installer (such as from Debian or RPM packages). Users who used a setup.py install are not affected. The package installers for previous versions of WeeWX would install any Python code used by extensions alongside other code, usually in /usr/share/weewx/user . However, Version 5 strives to keep user data separate from code. The user directory is now located with other user data in /etc/weewx/ , specifically in /etc/weewx/bin/user . You will have to either reinstall any extensions, or manually copy over the user directory. For example, sudo mkdir /etc/weewx/bin cp -r /usr/share/weewx/user/ /etc/weewx/bin/ New utilities \u00b6 Most of the old utilities have been collected and put under one master utility, weectl . This make it easy to use the --help option to see which one you want. Old utility New utility wee_database weectl database wee_debug weectl debug wee_device weectl device wee_extension weectl extension wee_config weectl station The utilities wee_reports and wee_import have not been changed and should still be invoked under their own names. Utility wunderfixer has been removed. \u00b6 The Weather Underground no longer allows past-dated posts, so the utility is no longer useful. SQLITE_ROOT is now relative to WEEWX_ROOT \u00b6 Previously, SQLITE_ROOT was expected to be an absolute path, but now relative paths are accepted. A relative path is considered relative to WEEWX_ROOT . Because this is less restrictive , it is not expected to affect any users. Class weewx.units.UnknownType has been renamed \u00b6 Its name was too similar to weewx.UnknownType , so it has been renamed to weewx.units.UnknownObsType . It is very unlikely any users would be affected by this. Upgrading to V4.10 \u00b6 Breaking changes for skins that use delta times \u00b6 A \"delta time\" is the difference between two times, for example the amount of uptime (difference between start and current time), or the amount of daylight (difference between sunrise and sunset). In previous versions, delta times were treated as a special case, which limited their flexibility. With PR #807 , a delta time is treated like any other scalar, which gives you access to all the regular formatting tools. However, a side effect is that if you want to format the time in the \"long form\", that is, so the results look like 4 hours, 15 minutes , rather than 15300 seconds , then you will have to say so explicitly. If you use the Seasons skin, you will have to make these four changes. Add the text in green : V4.9 and earlier Seasons skin 4.10 Seasons skin Seasons/about.inc starting at line 31 <tr> <td class=\"label\">$gettext(\"Server uptime\")</td> <td class=\"data\">$station.os_uptime</td> </tr> <tr> <td class=\"label\">$gettext(\"WeeWX uptime\")</td> <td class=\"data\">$station.uptime</td> </tr> <tr> <td class=\"label\">$gettext(\"Server uptime\")</td> <td class=\"data\">$station.os_uptime .long_form </td> </tr> <tr> <td class=\"label\">$gettext(\"WeeWX uptime\")</td> <td class=\"data\">$station.uptime .long_form </td> </tr> Seasons/celestial.inc starting at line 94 <tr> <td class=\"label\">$gettext(\"Total daylight\")</td> <td class=\"data\">$almanac.sun.visible<br/>$sun_visible_change $change_str</td> </tr> <tr> <td class=\"label\">$gettext(\"Total daylight\")</td> <td class=\"data\">$almanac.sun.visible .long_form <br/>$sun_visible_change .long_form $change_str</td> </tr> In a similar manner, if you use the Standard skin, you will have to make these two changes. V4.9 and earlier Standard skin 4.10 Standard skin Standard/index.html.tmpl starting at line 309 <p>$gettext(\"WeeWX uptime\"): $station.uptime<br/> $gettext(\"Server uptime\"): $station.os_uptime<br/> <p>$gettext(\"WeeWX uptime\"): $station.uptime .long_form <br/> $gettext(\"Server uptime\"): $station.os_uptime .long_form <br/> In both cases, the new formatting directive .long_form has been used to explicitly request that the delta time be formatted into its constituent components. The advantage of this approach is that the delta time can be treated like any other scalar. Here are some examples: Tag Results $almanac.sun.visible 45000 seconds $almanac.sun.visible.hour 12.5 hours $almanac.sun.visible.hour.format(\"%.2f\") 12.50 hours $almanac.sun.visible.long_form 12 hours, 30 minutes, 0 seconds Changes for custom delta time formats \u00b6 Fixing issue #808 required introducing a separate dictionary for members of group group_deltatime . This means that if you specified custom formats under [Units]/[[TimeFormats]] , then you will have to move them to the new section [Units]/[[DeltaTimeFormats]] . Very few users should be affected by this change because the ability to set custom delta time formats is an undocumented feature. The good news is that the contexts they now use have more standard names. The table below summarizes: V4.9 and earlier 4.10 [[TimeFormats]] ... current = %x %X ephem_day = %X ephem_year = %x %X brief_delta = \"%(minute)d%(minute_label)s, %(second)d%(second_label)s\" short_delta = \"%(hour)d%(hour_label)s, %(minute)d%(minute_label)s, %(second)d%(second_label)s\" long_delta = \"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\" delta_time = \"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\" [[TimeFormats]] ... current = %x %X ephem_day = %X ephem_year = %x %X [[DeltaTimeFormats]] current = \"%(minute)d%(minute_label)s, %(second)d%(second_label)s\" hour = \"%(minute)d%(minute_label)s, %(second)d%(second_label)s\" day = \"%(hour)d%(hour_label)s, %(minute)d%(minute_label)s, %(second)d%(second_label)s\" week = \"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\" month = \"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\" year = \"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\" Elapsed time calls may have to be changed The fix for Issue #808 also affects the API. V4.9 and earlier 4.10 # Create an elapsed time of 1655 seconds vt = ValueTuple(1655, 'second', 'group_deltatime') vh = ValueHelper(vt, formatter=self.generator.formatter, converter=self.generator.converter, context='short_delta' ) # Create an elapsed time of 1655 seconds vt = ValueTuple(1655, 'second', 'group_deltatime') vh = ValueHelper(vt, formatter=self.generator.formatter, converter=self.generator.converter, context='day' ) In summary, because group_deltatime now uses the same context names as any other time, you will have to change the call to use one of the conventional contexts. Upgrading to V4.9 \u00b6 wee_reports may require --epoch option. \u00b6 In previous versions, the utility wee_reports could take an optional position argument that specified the reporting time in unix epoch time. For example, wee_reports /home/weewx/weewx.conf 1645131600 would specify that the reporting time should be 1645131600, or 17-Feb-2022 13:00 PST. Starting with V4.9, the unix epoch time must be specified using the --epoch flag, so the command becomes wee_reports /home/weewx/weewx.conf --epoch=1645131600 Alternatively, the reporting time can be specified by using --date and --time flags: wee_reports /home/weewx/weewx.conf --date=2022-02-17 --time=13:00 Init function of class WXXTypes has changed \u00b6 In earlier versions, ET was calculated in class WXXTypes . Now it has its own class, ETXType . As a result, some initialization parameters are no longer needed and have been removed. Note also that the parameter heat_index_algo was changed to heatindex_algo in keeping with the rest of the code. Unless you have been writing specialized code that required direct access to WXXTypes you are very unlikely to be affected. V4.8 and earlier 4.9 def __init__(self, altitude_vt, latitude_f, longitude_f, et_period=3600, atc=0.8, nfac=2, wind_height=2.0, force_null=True, maxSolarRad_algo='rs', heat_index_algo ='new') def __init__(self, altitude_vt, latitude_f, longitude_f, atc=0.8, nfac=2, force_null=True, maxSolarRad_algo='rs', heatindex_algo ='new') Calling signature of some archive span functions has changed \u00b6 The calling signature of the following functions has changed. In general, the parameter grace has been removed in favor of a more robust method for figuring out which time span a timestamp belongs to. V4.8 and earlier 4.9 def archiveHoursAgoSpan(time_ts, hours_ago=0 , grace=1 ) def archiveHoursAgoSpan(time_ts, hours_ago=0) def archiveDaySpan(time_ts, grace=1, days_ago=0) def archiveDaySpan(time_ts, days_ago=0) def archiveWeekSpan(time_ts, startOfWeek=6, grace=1, weeks_ago=0) def archiveWeekSpan(time_ts, startOfWeek=6, weeks_ago=0) def archiveMonthSpan(time_ts, grace=1, months_ago=0) def archiveMonthSpan(time_ts, months_ago=0) def archiveYearSpan(time_ts, grace=1, years_ago=0) def archiveYearSpan(time_ts, years_ago=0) def archiveRainYearSpan(time_ts, sory_mon , grace=1 ) def archiveRainYearSpan(time_ts, sory_mon) Upgrading to V4.6 \u00b6 Ordering of search list changed \u00b6 In previous versions, user-supplied search list extensions were appended to the search list. Starting with V4.6, they are now prepended to the list. This means that when Cheetah is evaluating the list, looking for a tag, it will encounter user-supplied extensions first, allowing extensions to override the built-in tags and change their behavior. Tag $alltime \u00b6 The tag $alltime , formerly included as an example, is now a part of the core of WeeWX. This means you may no longer need to include the \"stats\" example as a Cheetah search list extension, although leaving it in will do no harm. Upgrading to V4.5 \u00b6 Version 4.5 changes are unlikely to affect anyone, except extension writers who are deep in the internals of WeeWX. API changes \u00b6 There have been a number of changes in the WeeWX API. None of them are likely to affect end users. Overall, the biggest change is that the data held internally in class ValueHelper is now held in the target unit system, rather than being converted at time of use. Defaults for ValueHelper have changed Before, when constructing a new ValueHelper , if no converter was included in the constructor, a default converter, which converts to US Units, was supplied. Now, if no converter is included in the constructor, no default converter at all is supplied, and the data remain in the original units. This is unlikely to affect most extension writers because the usual case is to supply a converter to the ValueHelper constructor. Function as_value_tuple() may raise KeyError Previously, if the function as_value_tuple() was asked to return a ValueTuple of a non-existent type, it returned a ValueTuple with values (None, None, None) . Now it raises a KeyError exception. Upgrading to V4.4 \u00b6 Auto patch of daily summaries \u00b6 The V4.2 daily summary patch inadvertently introduced a bug which caused the wind daily summary to be incorrectly weighted. See issue #642 . V4.4 includes a patch to automatically fix the defective daily summary. It is run only once on the first use of a database (usually by weewxd ) and takes only a few seconds. Upgrading to V4.3 \u00b6 Auto patch of daily summaries \u00b6 Version 4.2 inadvertently introduced a bug, which prevented the sums that are kept in the daily summaries from being weighted by the archive interval. See issue #623 . V4.3 includes a patch, which will fix any defective daily summaries automatically. It is run only once on the first use of a database (usually by weewxd ) and takes only a few seconds. Option ignore_zero_wind has been renamed and moved \u00b6 Normally, WeeWX sets wind direction to undefined when wind speed is zero. While it was never documented, some users used option ignore_zero_wind to prevent this: if set to False , wind direction will not be set to undefined when wind speed is zero. However, the option's location and name has changed. It is now called force_null , and it is now located under [StdWXCalculate] / [[WXXTypes]] / [[[windDir]]] . The old name and location has been deprecated, but still honored. V4.2 and earlier 4.3 [StdWXCalculate] ignore_zero_wind = False [[Calculations]] ... [StdWXCalculate] [[Calculations]] ... [[WXXTypes]] [[[windDir]]] force_null = False Option log_failure set to True \u00b6 The option log_failure under [StdReport] controls whether to log failures into the system log. It was previously set to False . The upgrade process will set it to True , so that users can better see failure modes. V4.2 and earlier 4.3 [StdReport] ... log_failure = False ... [StdReport] ... log_failure = True ... Upgrading to V4.2 \u00b6 For the most part, V4.2 is backwards compatible with previous versions. There is one small exception. Type beaufort deprecated \u00b6 The type beaufort has been deprecated, although there are no immediate plans to remove it \u2014 using it will put a warning in the log. Instead, it has become a new unit, which can be used as part of group_speed . Here's an example: V4.1 and earlier 4.2 <p> The current wind speed is $current.windSpeed, which is $current.beaufort on the beaufort scale. </p> <p> The current wind speed is $current.windSpeed, which is $current.windSpeed.beaufort on the beaufort scale. </p> Upgrading to V4.0 \u00b6 For the most part, V4.0 is backwards compatible with previous versions. Python 2.5 and 2.6 \u00b6 Support for Python 2.5 and 2.6 has been dropped. It has now been well over 10 years since these versions were introduced, and 6+ years since they were supported by the Python Software Foundation. If you are using Python 2.5 or 2.6, then you should either upgrade your copy of Python, or stay with your old version of WeeWX. [StdWXCalculate] \u00b6 In earlier versions of WeeWX, many derived types were calculated by default by the service StdWXCalculate . By contrast, in WeeWX V4, no derived types are calculated by default \u2014 all desired types must be explicitly listed in weewx.conf . For most users, this will not cause a problem because most types were already listed in weewx.conf . However if you deleted one of the following types in the clause [StdWXCalculate] , and started to depend on the default calculations, then the type will no longer be calculated in V4. pressure barometer altimeter windchill heatindex dewpoint inDewpoint rainRate In this case, you should add the type to [StdWXCalculate] . For example, if for some reason you deleted dewpoint , then you would need to add the following [StdWXCalculate] [[Calculations]] ... dewpoint = prefer_hardware Upgrading to V3.9 \u00b6 New skins \u00b6 Version 3.9 introduces and installs a new skin, Seasons , and promotes two old skins, Mobile and Smartphone , previously part of Standard , to first-class, independent, skins. If you are installing fresh (not an upgrade), then all four skins, Seasons , Standard , Mobile , and Smartphone will be installed, but only Seasons will be activated. If you are upgrading, then the three new skins, Seasons , Mobile , and Smartphone will be installed, but none will be activated. Your existing Standard will be left untouched and activated. For most people, your website will continue to look as expected (the exception is explained below in section Do you need to change anything? ). If you are upgrading, and you wish to try the new skin Seasons , then activate it, but be sure to deactivate Standard . Otherwise, both will get generated, and they will compete with each other for placement in your HTML directory. Skin defaults \u00b6 Version 3.9 introduces a new section, [StdReport]/[[Defaults]] in weewx.conf . Options in this section apply to all reports. For example, if you set a unit group here, it will be applied everywhere. This makes it easy to set the units across all reports, or to ensure that the labels for observations are the same in every report. It also adds a file defaults.py , in which the fallback values for every report parameter are specified. Although the defaults file is currently useful only to developers, in the future it may be extended to facilitate translations and localization. Do you need to change anything? \u00b6 The introduction of the new section, [StdReport]/[[Defaults]] in weewx.conf , can change which units are applied to reports because it has a higher precedence than what is in skin.conf . See the section How to specify options for details of the ordering in which an option is considered. Most users will be unaffected by these changes because they depend on specific report overrides. There is, however, one exception: If your installation does not use overrides, and you changed to metric units in your skin.conf file, you will be affected. Your reports will start appearing in U.S. Customary units. The reason is that the new section, [StdReport]/[[Defaults]] has higher priority than options in skin.conf , and thus will start asserting itself. The fix is simple: modify the [StdReport]/[[Defaults]] to suit your preferences. However, users who specified what unit system to use as part of the automated install using a package installer or setup.py , will have an override section, and therefore will be unaffected. This is because the override section has the highest priority. Upgrading to V3.7 \u00b6 Changes to daily summaries \u00b6 Perhaps the most significant change in V3.7 is a fix for how daily summary values are calculated and stored. Daily summaries were introduced in V3.0 (December 2014), to speed up certain kinds of aggregation calculations. They were designed to \"weight\" values depending on the time length of the archive record that contributed them. For example, shorter intervals contributed less than longer intervals. This was intended to enable changes to the length of the archive interval. Unfortunately, a bug caused the weightings to all be one (1), regardless of what the actual archive interval length might be. This means all archive records, long and short, contribute the same amount, instead of being weighted by their length. So, if the archive interval were to change, averages would be calculated incorrectly. This bug will only affect you if you have changed the length of your archive interval, or if you plan to. If you have not changed your archive interval length, and have no plans to do so, then there is nothing you need to do. Your archive may have interval values of different sizes if... ... you have imported data using wee_import . ... your hardware has a data logger, your configuration uses record_generation=software , and the archive_interval is different from that in the hardware. ... your archive contains data from more than one type of hardware. The weectl database update utility can fix this problem by recalculating the weights in the daily summary, on the basis of the actual archive interval lengths. On a Raspberry Pi 1, model B, it takes about 10 minutes to fix a database with 10 years of data. On faster machines, it takes much less time. weectl database update If you have multiple databases, consider recalculating the weights in each database. Interval weighting will only need to be applied to databases that have daily summaries, i.e., the binding uses manager = weewx.wxmanager.WXDaySummaryManager To apply interval weighting to a database other than the default wx_binding , use the --binding=BINDING_NAME option. weectl database update --binding=cmon_binding Recalculation of windSpeed maximum values \u00b6 Version 3.7 changes how maximum windSpeed is calculated for aggregations of a day or more. Previously, if option use_hilo was set to True (the usual case), maximum windSpeed for a day was set to the maximum value seen in the LOOP packets for the day. In practice this is the same value as windGust . That is, these two tags would supply the same value: $day.windSpeed.max $day.windGust.max In Version 3.7, this has been changed so the maximum windSpeed is now set to the maximum archive value seen during the day \u2014 usually a slightly smaller number. However, older daily max values will still contain the max LOOP packet values. If you wish to update your older values and have them use the max archive record value, use the utility weectl database update . Change in the name and locations of examples \u00b6 In earlier versions, examples were located with the WeeWX code base, and packaged as a Python module. This is categorically and semantically incorrect. The examples now live in their own directory, whose location is dependent on the installation method . If you use an example, you should copy it to the user subdirectory, modify it if necessary, then use it there. Your copy will be retained across version upgrades. 3.6 3.7 examples.alarm.MyAlarm examples.lowBattery.MyAlarm examples.xsearch.MyXSearch user.alarm.MyAlarm user.lowBattery.BatteryAlarm user.stats.MyStats Finally, note that the name of one example has been changed: 3.6 3.7 xsearch.py stats.py Changes to sensor mapping \u00b6 The mapping of sensors to database fields was formalized in Version 3.7, resulting in changes to the configuration for some of the drivers, including cc3000 , te923 , wmr100 , wmr200 , wmr300 , and wmr9x8 . For the wmr200 driver, until Version 3.6, the fields extraTemp1 and extraHumid1 were not usable. Version 3.6.1 shifted the extraTemp and extraHumid mappings down one channel, so that extraTemp1 corresponded to channel 2, extraTemp2 corresponded to channel 3, and so on. The mappings can now be modified by a change to the configuration file, and the default mappings are as follows: 3.6 3.7 ** hard-coded in the driver ** outTemp = temperature_1 # extraTemp1 is not usable extraTemp2 = temperature_2 extraTemp3 = temperature_3 extraTemp4 = temperature_4 extraTemp5 = temperature_5 extraTemp6 = temperature_6 extraTemp7 = temperature_7 extraTemp8 = temperature_8 outHumidity = humidity_1 # extraHumid1 is not usable extraHumid2 = humidity_2 extraHumid3 = humidity_3 extraHumid4 = humidity_4 extraHumid5 = humidity_5 extraHumid6 = humidity_6 extraHumid7 = humidity_7 extraHumid8 = humidity_8 [WMR200] [[sensor_map]] altimeter = altimeter pressure = pressure windSpeed = wind_speed windDir = wind_dir windGust = wind_gust windBatteryStatus = battery_status_wind inTemp = temperature_0 outTemp = temperature_1 extraTemp1 = temperature_2 extraTemp2 = temperature_3 extraTemp3 = temperature_4 extraTemp4 = temperature_5 extraTemp5 = temperature_6 extraTemp6 = temperature_7 extraTemp7 = temperature_8 inHumidity = humidity_0 outHumidity = humidity_1 extraHumid1 = humidity_2 extraHumid2 = humidity_3 extraHumid3 = humidity_4 extraHumid4 = humidity_5 extraHumid5 = humidity_6 extraHumid6 = humidity_7 extraHumid7 = humidity_8 outTempBatteryStatus = battery_status_out rain = rain rainTotal = rain_total rainRate = rain_rate hourRain = rain_hour rain24 = rain_24 rainBatteryStatus = battery_status_rain UV = uv uvBatteryStatus = battery_status_uv windchill = windchill heatindex = heatindex forecastIcon = forecast_icon outTempFault = out_fault windFault = wind_fault uvFault = uv_fault rainFault = rain_fault clockUnsynchronized = clock_unsynchronized For the te923 driver: 3.6 3.7 [TE923] [[map]] link_wind = windLinkStatus bat_wind = windBatteryStatus link_rain = rainLinkStatus bat_rain = rainBatteryStatus link_uv = uvLinkStatus bat_uv = uvBatteryStatus uv = UV t_in = inTemp h_in = inHumidity t_1 = outTemp h_1 = outHumidity bat_1 = outBatteryStatus link_1 = outLinkStatus t_2 = extraTemp1 h_2 = extraHumid1 bat_2 = extraBatteryStatus1 link_2 = extraLinkStatus1 t_3 = extraTemp2 h_3 = extraHumid3 bat_3 = extraBatteryStatus2 link_3 = extraLinkStatus2 t_4 = extraTemp3 h_4 = extraHumid3 bat_4 = extraBatteryStatus3 link_4 = extraLinkStatus3 t_5 = extraTemp4 h_5 = extraHumid4 bat_5 = extraBatteryStatus4 link_5 = extraLinkStatus4 [TE923] [[sensor_map]] windLinkStatus = link_wind windBatteryStatus = bat_wind rainLinkStatus = link_rain rainBatteryStatus = bat_rain uvLinkStatus = link_uv uvBatteryStatus = bat_uv inTemp = t_in inHumidity = h_in outTemp = t_1 outHumidity = h_1 outTempBatteryStatus = bat_1 outLinkStatus = link_1 extraTemp1 = t_2 extraHumid1 = h_2 extraBatteryStatus1 = bat_2 extraLinkStatus1 = link_2 extraTemp2 = t_3 extraHumid2 = h_3 extraBatteryStatus2 = bat_3 extraLinkStatus2 = link_3 extraTemp3 = t_4 extraHumid3 = h_4 extraBatteryStatus3 = bat_4 extraLinkStatus3 = link_4 extraTemp4 = t_5 extraHumid4 = h_5 extraBatteryStatus4 = bat_5 extraLinkStatus4 = link_5 Upgrading to V3.6 \u00b6 Changes to weewx.conf \u00b6 In Version 3.6, the list of options that describe how derived variables are to be calculated have been moved to a new subsection called [[Calculations]] . The upgrade process will automatically make this change for you. 3.5 3.6 [StdWXCalculate] pressure = prefer_hardware barometer = prefer_hardware altimeter = prefer_hardware windchill = prefer_hardware heatindex = prefer_hardware dewpoint = prefer_hardware inDewpoint = prefer_hardware rainRate = prefer_hardware [StdWXCalculate] [[Calculations]] pressure = prefer_hardware barometer = prefer_hardware altimeter = prefer_hardware windchill = prefer_hardware heatindex = prefer_hardware dewpoint = prefer_hardware inDewpoint = prefer_hardware rainRate = prefer_hardware Upgrading to V3.2 \u00b6 New utilities \u00b6 Version 3.2 includes new utilities to facilitate configuration. 3.2 3.1 and earlier wee_config Change driver or other station parameters wee_extension setup.py or wee_setup Install, list, and remove extensions wee_database wee_config_database Manipulate the database wee_device wee_config_device Get and set parameters on the hardware wee_reports wee_reports Run reports Changes to weewx.conf \u00b6 Release 3.2 introduces a new section [DatabaseTypes] . This section defines the default settings for each type of database. For example, the host, user, and password for MySQL databases can be specified once in the DatabaseTypes section instead of repeating in each Database section. The defaults in DatabaseTypes can be overridden in each Database section as needed. 3.1 3.2 [DataBindings] [[wx_binding]] database = archive_sqlite manager = weewx.wxmanager.WXDaySummaryManager table_name = archive schema = schemas.wview.schema [Databases] [[archive_sqlite]] root = %(WEEWX_ROOT)s database = archive/weewx.sdb driver = weedb.sqlite [[archive_mysql]] host = localhost user = weewx password = weewx database = weewx driver = weedb.mysql [DataBindings] [[wx_binding]] database = archive_sqlite manager = weewx.wxmanager.WXDaySummaryManager table_name = archive schema = schemas.wview.schema [Databases] [[archive_sqlite]] database_name = weewx.sdb database_type = SQLite [[archive_mysql]] database_name = weewx database_type = MySQL [DatabaseTypes] [[SQLite]] driver = weedb.sqlite SQLITE_ROOT = %(WEEWX_ROOT)s/archive [[MySQL]] driver = weedb.mysql host = localhost user = weewx password = weewx Upgrading to V3.0 \u00b6 Overview \u00b6 While a lot has changed with Version 3, the upgrade process should take care of most changes for most users. However, if you have installed an extension or, especially, if you have written a custom service, search list extension, or uploader, you will have to make some changes. Database contents \u00b6 With Version 3, there is no longer a separate \"stats\" database. Instead, \"daily summaries\" have been included in the same database as the archive data \u2014 everything is under one name. For example, if you are using sqlite, both the archive data and the daily summaries will be inside file weewx.sdb . With MySQL, everything is inside the database weewx . This makes it easier to keep all data together when working with multiple databases. This change in database structure should be transparent to you. On startup, WeeWX will automatically backfill the new internal daily summaries from the archive data. Your old \"stats\" database will no longer be used and may safely set aside or even deleted. Pressure calibration \u00b6 Since the new StdWXCalculate service is applied after the StdCalibrate services, the pressure_offset parameter is no longer necessary; pressure calibration can be applied just like any other calibration. If your pressure was calibrated using the pressure_offset parameter, move the calibration to the [StdCalibrate] section. This applies only to CC3000, FineOffsetUSB, Ultimeter, WS1, WS23xx, and WS28xx hardware. weewx.conf \u00b6 A version 2.X weewx.conf file is not compatible with Version 3.X. However, the upgrade process should automatically update the file. Nevertheless, the changes are documented below: 2.7 3.0 [StdReport] data_binding = wx_binding [StdArchive] archive_database = archive_sqlite stats_database = stats_sqlite archive_schema = user.schemas.defaultArchiveSchema stats_schema = user.schemas.defaultStatsSchema [StdArchive] data_binding = wx_binding [DataBindings] [[wx_binding]] database = archive_sqlite manager = weewx.wxmanager.WXDaySummaryManager table_name = archive schema = schemas.wview.schema [Databases] [[archive_sqlite]] root = %(WEEWX_ROOT)s database = archive/weewx.sdb driver = weedb.sqlite [[stats_sqlite]] root = %(WEEWX_ROOT)s database = archive/stats.sdb driver = weedb.sqlite [[archive_mysql]] host = localhost user = weewx password = weewx database = weewx driver = weedb.mysql [[stats_mysql]] host = localhost user = weewx password = weewx database = stats driver = weedb.mysql [Databases] [[archive_sqlite]] root = %(WEEWX_ROOT)s database_name = archive/weewx.sdb driver = weedb.sqlite [[archive_mysql]] host = localhost user = weewx password = weewx database_name = weewx driver = weedb.mysql [ Engines ] [[ WxEngine ]] prep_services = \\ weewx. wxengine .StdTimeSynch process_services = \\ weewx. wxengine .StdConvert, \\ weewx. wxengine .StdCalibrate, \\ weewx. wxengine .StdQC archive_services = \\ weewx. wxengine .StdArchive restful_services = \\ weewx.restx.StdStationRegistry, \\ weewx.restx.StdWunderground, \\ weewx.restx.StdPWSweather, \\ weewx.restx.StdCWOP, \\ weewx.restx.StdWOW, \\ weewx.restx.StdAWEKAS report_services = \\ weewx. wxengine .StdPrint, \\ weewx. wxengine .StdReport [ Engine ] [[ Services ]] prep_services = \\ weewx. engine .StdTimeSynch process_services = \\ weewx. engine .StdConvert, \\ weewx. engine .StdCalibrate, \\ weewx. engine .StdQC , \\ weewx.wxservices.StdWXCalculate archive_services = \\ weewx. engine .StdArchive restful_services = \\ weewx.restx.StdStationRegistry, \\ weewx.restx.StdWunderground, \\ weewx.restx.StdPWSweather, \\ weewx.restx.StdCWOP, \\ weewx.restx.StdWOW, \\ weewx.restx.StdAWEKAS report_services = \\ weewx. engine .StdPrint, \\ weewx. engine .StdReport Custom data sources in skins \u00b6 The mechanism for specifying non-default data sources in skins has changed. If you modified the Standard skin, or created or used other skins that draw data from a database other than the weather database, you must change how the other sources are specified. For example, in the cmon extension: 2.7 3.0 [ImageGenerator] ... [[day_images]] ... [[[daycpu]]] archive_database = cmon_sqlite [[[cpu_user]]] [[[cpu_idle]]] [[[cpu_system]]] [ImageGenerator] ... [[day_images]] ... [[[daycpu]]] data_binding = cmon_binding [[[cpu_user]]] [[[cpu_idle]]] [[[cpu_system]]] Extensions \u00b6 Many skins will work in v3 with no modification required. However, every search list extension will have to be upgraded, every restful extension must be upgraded, and some other services must be upgraded. There is no automated upgrade system for extensions; if an extension must be upgraded, you must do it manually. If the extension has any python code, this will mean replacing any v2-compatible code with v3-compatible code. In some cases parts of the configuration file weewx.conf must be modified. For example, to update the pmon extension, replace bin/user/pmon.py with the v3-compatible pmon.py and modify weewx.conf as shown in this table: 2.7 3.0 [ProcessMonitor] database = pmon_sqlite [ProcessMonitor] data_binding = pmon_binding [DataBindings] [[pmon_binding]] database = pmon_sqlite manager = weewx.manager.DaySummaryManager table_name = archive schema = user.pmon.schema [Databases] [[pmon_sqlite]] root = %(WEEWX_ROOT)s database = archive/pmon.sdb driver = weedb.sqlite [Databases] [[pmon_sqlite]] root = %(WEEWX_ROOT)s database_name = archive/pmon.sdb driver = weedb.sqlite For other extensions, see the extension's documentation or contact the author of the extension. Search list extensions \u00b6 The introduction of data bindings has meant a change in the calling signature of search list extensions. By way of example, here's the example from the document Writing search list extensions , but with the differences highlighted. 2.7 3.0 def get_extension (self, timespan, archivedb, statsdb ): all_stats = TimeSpanStats ( timespan, statsdb , formatter=self.generator.formatter, converter=self.generator.converter) week_dt = datetime.date.fromtimestamp(timespan.stop) - \\ datetime.timedelta(weeks=1) week_ts = time.mktime(week_dt.timetuple()) seven_day_stats = TimeSpanStats ( TimeSpan(week_ts, timespan.stop), statsdb , formatter=self.generator.formatter, converter=self.generator.converter) search_list_extension = {'alltime' : all_stats, 'seven_day' : seven_day_stats} return search_list_extension def get_extension_list (self, timespan, db_lookup ): all_stats = TimespanBinder ( timespan, db_lookup , formatter=self.generator.formatter, converter=self.generator.converter) week_dt = datetime.date.fromtimestamp(timespan.stop) - \\ datetime.timedelta(weeks=1) week_ts = time.mktime(week_dt.timetuple()) seven_day_stats = TimespanBinder ( TimeSpan(week_ts, timespan.stop), db_lookup , formatter=self.generator.formatter, converter=self.generator.converter) search_list_extension = {'alltime' : all_stats, 'seven_day' : seven_day_stats} return [ search_list_extension ] A few things to note: The name of the extension function has changed from get_extension to get_extension_list . The calling signature has changed. Instead of an archive database and a stats database being passed in, a single database lookup function is passed in. The name of the top-level class in the tag chain has changed from TimeSpanStats to TimespanBinder . See the Customizing Guide for details. Instead of returning a single search list extension, the function should now return a Python list of extensions. The list will be searched in order. Derived quantities \u00b6 Some calculations that were done in drivers or in hardware are now done consistently by the new StdWXCalculate service. Drivers should no longer calculate derived quantities such as windchill, heatindex, dewpoint, or rain rate. Driver APIs \u00b6 The base class for drivers has been renamed, and new, optional, methods have been defined to provide hooks for configuring hardware and producing default and upgraded configuration stanzas. These changes affect only those who have written custom drivers. 2.7 3.0 import weewx. abstractstation class ACME960(weewx. abstractstation.AbstractStation ): ... import weewx. drivers class ACME960(weewx. drivers.AbstractDevice ): ... Service APIs \u00b6 The base class for services has moved. This affects only those who have written custom services. 2.7 3.0 import weewx. wxengine class BetterMousetrapService(weewx. wxengine .StdService): ... import weewx. engine class BetterMousetrapService(weewx. engine .StdService): ... RESTful APIs \u00b6 Some of the methods internal to RESTful services have changed, specifically those that relate to getting configuration options from weewx.conf and configuring databases. This affects only those who have written custom RESTful services. Here is an example of obtaining the database dictionary for use in the RESTful service thread. 2.7 3.0 site_dict = weewx.restx.get_dict(config_dict, 'Uploader') db_name = config_dict['StdArchive']['archive_database'] db_dict = config_dict['Databases'][db_name] site_dict.setdefault('database_dict', db_dict) site_dict = config_dict['StdRESTful']['Uploader'] site_dict = accumulateLeaves(site_dict, max_level=1) manager_dict = weewx.manager.open_manager_with_config( config_dict, 'wx_binding') Database APIs \u00b6 The methods for obtaining, opening, and querying databases have changed. This affects only those who have written code that accesses databases. The class Manager and its subclasses have replaced the old Archive class. The table name is no longer hard-coded, so developers should use the table name from the database binding. There is no longer a separate StatsDb class, its functions having been subsumed into the Manager class and its subclasses. A new class DBBinder is the preferred way of getting a Manager class, as it will automatically take care of instantiating the right class, as well as caching instances of Manager . An instance of DBBinder is held by the engine as attribute db_binder . Here's an example of making a simple query. 2.7 3.0 db = config_dict['StdArchive']['archive_database'] self.database_dict = config_dict['Databases'][db] with weewx.archive.Archive.open(self.database_dict) as archive: val = archive.getSql(\"SELECT AVG(windSpeed) FROM archive\" \" WHERE dateTime>? AND dateTime<=?\", (start_ts, end_ts)) with self.engine.db_binder.get_manager('wx_binding') as mgr: val = mgr.getSql(\"SELECT AVG(windSpeed) FROM %s\" \" WHERE dateTime>? AND dateTime<=?\" % mgr.table_name, (start_ts, end_ts)) Generator APIs \u00b6 The base class for report generators has changed. The old class CachedReportGenerator no longer exists; its functionality has been replaced by an instance of DBBinder , held by the generator superclass. This affects only those who have written customer generators. Here's an example: 2.7 3.0 class GaugeGenerator(weewx.reportengine. CachedReportGenerator ) def run(self): archive_name = self.config_dict['GaugeGenerator']['archive_name'] archive = self._getArchive(archive_name) results = archive.getSql(...) class GaugeGenerator(weewx.reportengine. ReportGenerator ) def run(self): mgr = self.generator.db_binder.get_manager() results = mgr.getSql(...) Extension installer \u00b6 The setup.py utility is now included in the installation; it is no longer necessary to keep a copy of the WeeWX source tree just for the setup.py utility. For .deb and .rpm installations, the command wee_setup is a symlink to setup.py . The options for installing extensions changed slightly to be more consistent with the rest of the options to setup.py . 2.7 3.0 setup.py --extension --install extensions/basic setup.py --extension --install basic.tar.gz setup.py --extension --uninstall basic setup.py --extension --list setup.py --extension --install basic.tar.gz --dryrun setup.py install --extension extensions/basic setup.py install --extension basic.tar.gz setup.py uninstall --extension basic setup.py list-extensions setup.py install --extension basic.tar.gz --dry-run Upgrading to V2.7 \u00b6 Version 2.7 is backwards compatible with earlier versions with one minor exception. It now includes the ability to localize the WeeWX and server uptimes. Previously, the labels days , hours , and minutes were hardcoded in a Python utility. There was no way of changing them. Now, like any other labels, they are taken from the skin configuration file, skin.conf , section [[Labels]] . Older configuration files had a definition for hour , but none for day , and minute . Also, the old definition for hour used an abbreviation hrs instead of hours . If you do nothing, your WeeWX and station uptimes will look like: Weewx uptime: 1 day, 1 hrs, 41 minutes Server uptime: 2 days, 10 hrs, 22 minutes Note how the label for hours is abbreviated and always uses the plural. If you want the previous behavior, or if you want to localize the labels, you should update your skin configuration file. Remove the old entries for hour and second and replace them with: day = \" day\", \" days\" hour = \" hour\", \" hours\" minute = \" minute\", \" minutes\" second = \" second\", \" seconds\" The first item is the singular spelling, the second the plural. This will result in the desired Weewx uptime: 1 day, 1 hour, 41 minutes Server uptime: 2 days, 10 hours, 22 minutes Upgrading to V2.6 \u00b6 Version 2.6 is backwards compatible with earlier versions, with a couple of small exceptions. If you have written a custom WeeWX service, the install routine will try to insert its name into an appropriate place in one of the five new lists of services to be run. You should check section [Engines][[WxEngine]] to make sure it made a reasonable guess. If you have written a custom RESTful service, the architecture for these services has completely changed. They are now first class services, and are treated like any other WeeWX service. There are some guides to writing RESTful services using the new architecture at the top of the file bin/weewx/restx.py . I can also help you with the transition. Option interval in the CWOP configuration section has become option post_interval . This change should be done automatically by the install routine. The mechanism for specifying RESTful services has changed. To activate a RESTful service, put the driver in the restful_services list in [Engines][[WxEngine]] . The driver parameter is no longer necessary in the RESTful service's configuration stanza. These changes should be done automatically by the install routine. Upgrading to V2.4 \u00b6 The option time_length will now be the exact length of the resultant plot. Before, a plot with time_length equal to 24 hours would result in a plot of 27 hours, now it's 24 hours. If you want the old behavior, set it equal to 27 hours. To do this, change your section in skin.conf from [[day_images]] x_label_format = %H:%M bottom_label_format = %m/%d/%y %H:%M time_length = 86400 # == 24 hours to [[day_images]] x_label_format = %H:%M bottom_label_format = %m/%d/%y %H:%M time_length = 97200 # == 27 hours The service StdTimeSync now synchronizes the console's onboard clock on startup. This is nice because if the clock failed, perhaps because the battery was taken out, the time is corrected first before data is downloaded from the logger's memory. To take advantage of this, you can move service StdTimeSync to the front of the list of services to be run. For example: [[WxEngine]] # The list of services the main weewx engine should run: service_list = weewx.wxengine.StdTimeSynch , weewx.wxengine.StdConvert, weewx.wxengine.StdCalibrate, weewx.wxengine.StdQC, weewx.wxengine.StdArchive, weewx.wxengine.StdPrint, weewx.wxengine.StdRESTful, weewx.wxengine.StdReport Upgrading to V2.3 \u00b6 The signature of the function \" loader \", used to return an instance of the station device driver, has changed slightly. It has changed from loader(config_dict) to loader(config_dict, engine) That is, a second parameter, engine , has been added. This is a reference to the WeeWX engine. This change will affect only those who have written their own device driver. Upgrading to V2.2 \u00b6 Version 2.2 introduces a schema, found in bin/user/schemas.py , for the stats database. This schema is used only when initially creating the database. If you have a specialized stats database, that is, one that saves types other than the default that comes with WeeWX, you should edit this file to reflect your changes before attempting to rebuild the database. Upgrading to V2.0 \u00b6 Version 2.0 introduces many new features, including a revamped internal engine. There are two changes that are not backwards compatible: The configuration file, weewx.conf . When upgrading from V1.X, the setup utility will install a new, fresh copy of weewx.conf , which you will then have to edit by hand. Thereafter, V2.X upgrades should be automatic. Custom services. If you have written a custom service, it will have to be updated to use the new engine. The overall architecture is very similar, except that functions must be bound to events, rather than get called implicitly. See the sections Customizing a Service and Adding a Service in the Customization Guide for details on how to do this. All skins should be completely backwards compatible, so you should not have to change your templates or skin configuration file, skin.conf . If you have written a custom report generator it should also be backwards compatible. Upgrading to V1.14 \u00b6 Version 1.14 introduces some new webpages that have been expressly formatted for the smartphone by using jQuery . The skins shipped with the distribution take advantage of these features. If you do nothing, your old skins will continue to work, but you will not be taking advantage of these new webpages. If you want them, then you have two choices: Rename your old skin directory (call it \" skins.old \") then do the install. This will install the new skin distribution. You can then modify it to reflect any changes you have made, referring to skins.old for guidance. If you have not changed many things, this approach will be the easiest. Alternatively, change the contents of your existing skin directory to include the new webpages. If you take this approach, you will need to copy over the contents of the subdirectory skins/Standard/smartphone from the distribution into your skins/Standard directory. You will then need to modify your skin.conf . After the section that looks like [[[Mobile]]] template = mobile.html.tmpl add the following directives: [[[MobileSmartphone]]] template = smartphone/index.html.tmpl [[[MobileTempOutside]]] template = smartphone/temp_outside.html.tmpl [[[MobileRain]]] template = smartphone/rain.html.tmpl [[[MobileBarometer]]] template = smartphone/barometer.html.tmpl [[[MobileWind]]] template = smartphone/wind.html.tmpl [[[MobileRadar]]] template = smartphone/radar.html.tmpl Then modify section [CopyGenerator] to add the highlighted files: [CopyGenerator] # # This section is used by the generator CopyGenerator # # List of files that are to be copied at the first invocation of the generator only copy_once = backgrounds/*, weewx.css, mobile.css, favicon.ico, smartphone/icons/*, smartphone/custom.js Whichever approach you chose, the generated files will appear in public_html/smartphone . The start of the document root will be at public_html/smartphone/index.html . You may want to add a link to this in the template for your main index page skins/Standard/index.html.tmpl . Upgrading to V1.13 \u00b6 Version 1.13 changed the way binding happens to the databases used in reports so that it happens much later. The upshot is that the signature of a few functions changed. Most you are unlikely to encounter. The exception is if you have written custom template search lists , as described in the Customizing weewx guide . This section has been updated to reflect the new function signatures. As a side effect, the illustrated example actually has become much simpler! No changes to skins. Upgrading to V1.10 \u00b6 Version 1.10 introduced several new features. New almanac features, icon, and mobile template \u00b6 Version 1.10 introduces some extra almanac features, such as the azimuth and elevation of the sun and moon, or when the next solstice will be. It also includes a template formatted for smartphones, as well as an icon (\" favicon.ico \") that displays in your browser toolbar. The skins shipped with the distribution take advantage of these features. If you do nothing, your old skins will continue to work, but you will not take advantage of these new features. If you want these new features then you have two choices: Rename your old skin directory (call it \" skin.old \") then do the install. This will install the new skin distribution. You can modify it to reflect any changes you have made, referring to skin.old for guidance. Alternatively, change the contents of your existing skin directory to take advantage of the new features. If you take this approach, you will need to copy over files favicon.ico, mobile.css , and mobile.html.tmpl from the distribution into your skin/Standard directory. Modify skins/Standard/index.html.tmpl to take advantage of the new almanac features, using the version shipped with the distribution for guidance. You will then need to modify your skin.conf . Add a new [[[Mobile]]] section: [FileGenerator] ... [[ToDate]] ... [[[Mobile]]] template = mobile.html.tmpl Then add mobile.css and favicon.ico to the list of files to be copied on report generation: [CopyGenerator] copy_once = backgrounds/*, weewx.css, mobile.css, favicon.ico Which approach you should take will depend on how extensively you have modified the stock skin distribution. If the modifications are slight, approach #1 will be easier, otherwise use approach #2. Backwards compatibility \u00b6 With the introduction of explicit control of output units in the templates such as $day.outTemp.max.degree_C the calling signature of the following two Python classes was changed weewx.stats.TaggedStats weewx.stats.TimeSpanStats The example of writing a custom generator MyFileGenerator (which produced \"all time\" statistics) has been changed to reflect the new signatures. This will only affect you if you have written a custom generator. Upgrading to V1.8 \u00b6 With the introduction of a standard archiving service, StdArchive , the names of some events have changed. This will not affect you unless you have written a custom service. Upgrading to V1.7 \u00b6 V1.7 introduces skins . The skins live in subdirectory skins . They are not compatible with the old template subdirectory --- you can't simply rename templates to skins . The part of the configuration file dealing with the presentation layer has been split off into a separate file skin.conf . Hence, once again, the installation script setup.py will NOT merge your old weewx.conf configuration file into the new one. You will have to re-edit weewx.conf to put in your customizations. You may also have to edit skin.conf for whatever skin you choose (right now, only one skin, Standard , comes with the distribution). However, a reinstall of V1.7 will merge your changes for weewx.conf . It will also merge any changes you have made to skin.conf as well. Please check the following: Option \" altitude \" in section [Station] now takes a unit. Hence, it should look something like: altitude = 120, meter In a similar manner, options heating_base and cooling_base in skin.conf also take units: heating_base = 65, degree_F cooling_base = 65, degree_F The directory ' templates ' is no longer used; it has been replaced with directory ' skins '. You may delete it if you wish: rm -r templates Upgrading to V1.5 \u00b6 Because the configuration file weewx.conf changed significantly going from V1.4 to V1.5, the installation script setup.py will NOT merge your old configuration file into the new one. You will have to re-edit weewx.conf to put in your customizations. Upgrading to V1.4 \u00b6 Option clock_check , previously found in the [VantagePro] section, is now found in the [Station] section. The install program will put a default value in the new place, but it will not delete nor move your old value over. If you have changed this value or if you cannot stand the thought of clock_check appearing in two different places, you should delete the old one found under [VantagePro] and make sure the new value, found under [Station] is correct. Two Python files are no longer used, so they may be deleted from your installation if you wish: rm bin/weewx/processdata.py rm bin/weewx/mainloop.py In addition, file readme.htm has been moved to subdirectory docs , so the old one can be deleted: rm readme.htm","title":"Upgrade guide"},{"location":"upgrade/#upgrade-guide","text":"Warning You must use the same upgrade technique as your initial install! For example, if you used pip to install WeeWX, then you should use pip to upgrade. If you used a DEB or RPM package to install, then you should upgrade using the same package type. Warning If you are upgrading from an old setup.py installation, see the instructions Migrating setup.py installs to Version 5.0 . The instructions for upgrading WeeWX are in the quick start guides: Upgrading using Debian DEB Upgrading using Redhat RPM Upgrading using SUSE RPM Upgrading using pip Upgrading using git The rest of this document describes the changes in each WeeWX release.","title":"Upgrade guide"},{"location":"upgrade/#upgrading-the-weewx-configuration-file","text":"It does not happen very often, but occasionally a new release will require changes to the WeeWX configuration file. When this happens, the installer takes care of upgrading the file, and you do not need to worry about it. However, there are some occasions when you may need to upgrade the file yourself. In particular, this happens when you run several instances of weewxd on the same machine, each with its own configuration file. The configuration file named weewx.conf will get upgraded, but what about the others? The answer is to use weectl station upgrade with the --config option pointing to the configuration file to be upgraded. For example, this would upgrade the configuration file /etc/weewx/other.conf : sudo weectl station upgrade --config=/etc/weewx/other.conf","title":"Upgrading the WeeWX configuration file"},{"location":"upgrade/#upgrading-to-v50","text":"","title":"Upgrading to V5.0"},{"location":"upgrade/#python-27-no-longer-supported","text":"It has now been over 3 years since the end-of-life for Python 2.7. It's time to move on. WeeWX V5.x requires Python 3.7 or greater. These days, all but the most ancient of operating systems offer Python 3, although you may have to install it.","title":"Python 2.7 no longer supported"},{"location":"upgrade/#setuppy-installs-no-longer-possible","text":"The package distutils , and the imperative approach on which the WeeWX setup.py install method depends, has been deprecated and will ultimately be removed. The future is clearly pip installs using pyproject.toml . See the wiki article on Version 5 for the technical reasons why.","title":"setup.py installs no longer possible"},{"location":"upgrade/#pip-installs-to-new-location","text":"The default location for a setup.py install was /home/weewx . The new pip install method installs to a directory called weewx-data in home directory of the user doing the install. However, old installations can continue to use /home/weewx by following the guide Migrating setup.py installs to Version 5.0 .","title":"pip installs to new location"},{"location":"upgrade/#new-location-for-user-directory","text":"This affects users who are using a package installer (such as from Debian or RPM packages). Users who used a setup.py install are not affected. The package installers for previous versions of WeeWX would install any Python code used by extensions alongside other code, usually in /usr/share/weewx/user . However, Version 5 strives to keep user data separate from code. The user directory is now located with other user data in /etc/weewx/ , specifically in /etc/weewx/bin/user . You will have to either reinstall any extensions, or manually copy over the user directory. For example, sudo mkdir /etc/weewx/bin cp -r /usr/share/weewx/user/ /etc/weewx/bin/","title":"New location for user directory"},{"location":"upgrade/#new-utilities","text":"Most of the old utilities have been collected and put under one master utility, weectl . This make it easy to use the --help option to see which one you want. Old utility New utility wee_database weectl database wee_debug weectl debug wee_device weectl device wee_extension weectl extension wee_config weectl station The utilities wee_reports and wee_import have not been changed and should still be invoked under their own names.","title":"New utilities"},{"location":"upgrade/#utility-wunderfixer-has-been-removed","text":"The Weather Underground no longer allows past-dated posts, so the utility is no longer useful.","title":"Utility wunderfixer has been removed."},{"location":"upgrade/#sqlite_root-is-now-relative-to-weewx_root","text":"Previously, SQLITE_ROOT was expected to be an absolute path, but now relative paths are accepted. A relative path is considered relative to WEEWX_ROOT . Because this is less restrictive , it is not expected to affect any users.","title":"SQLITE_ROOT is now relative to WEEWX_ROOT"},{"location":"upgrade/#class-weewxunitsunknowntype-has-been-renamed","text":"Its name was too similar to weewx.UnknownType , so it has been renamed to weewx.units.UnknownObsType . It is very unlikely any users would be affected by this.","title":"Class weewx.units.UnknownType has been renamed"},{"location":"upgrade/#upgrading-to-v410","text":"","title":"Upgrading to V4.10"},{"location":"upgrade/#breaking-changes-for-skins-that-use-delta-times","text":"A \"delta time\" is the difference between two times, for example the amount of uptime (difference between start and current time), or the amount of daylight (difference between sunrise and sunset). In previous versions, delta times were treated as a special case, which limited their flexibility. With PR #807 , a delta time is treated like any other scalar, which gives you access to all the regular formatting tools. However, a side effect is that if you want to format the time in the \"long form\", that is, so the results look like 4 hours, 15 minutes , rather than 15300 seconds , then you will have to say so explicitly. If you use the Seasons skin, you will have to make these four changes. Add the text in green : V4.9 and earlier Seasons skin 4.10 Seasons skin Seasons/about.inc starting at line 31 <tr> <td class=\"label\">$gettext(\"Server uptime\")</td> <td class=\"data\">$station.os_uptime</td> </tr> <tr> <td class=\"label\">$gettext(\"WeeWX uptime\")</td> <td class=\"data\">$station.uptime</td> </tr> <tr> <td class=\"label\">$gettext(\"Server uptime\")</td> <td class=\"data\">$station.os_uptime .long_form </td> </tr> <tr> <td class=\"label\">$gettext(\"WeeWX uptime\")</td> <td class=\"data\">$station.uptime .long_form </td> </tr> Seasons/celestial.inc starting at line 94 <tr> <td class=\"label\">$gettext(\"Total daylight\")</td> <td class=\"data\">$almanac.sun.visible<br/>$sun_visible_change $change_str</td> </tr> <tr> <td class=\"label\">$gettext(\"Total daylight\")</td> <td class=\"data\">$almanac.sun.visible .long_form <br/>$sun_visible_change .long_form $change_str</td> </tr> In a similar manner, if you use the Standard skin, you will have to make these two changes. V4.9 and earlier Standard skin 4.10 Standard skin Standard/index.html.tmpl starting at line 309 <p>$gettext(\"WeeWX uptime\"): $station.uptime<br/> $gettext(\"Server uptime\"): $station.os_uptime<br/> <p>$gettext(\"WeeWX uptime\"): $station.uptime .long_form <br/> $gettext(\"Server uptime\"): $station.os_uptime .long_form <br/> In both cases, the new formatting directive .long_form has been used to explicitly request that the delta time be formatted into its constituent components. The advantage of this approach is that the delta time can be treated like any other scalar. Here are some examples: Tag Results $almanac.sun.visible 45000 seconds $almanac.sun.visible.hour 12.5 hours $almanac.sun.visible.hour.format(\"%.2f\") 12.50 hours $almanac.sun.visible.long_form 12 hours, 30 minutes, 0 seconds","title":"Breaking changes for skins that use delta times"},{"location":"upgrade/#changes-for-custom-delta-time-formats","text":"Fixing issue #808 required introducing a separate dictionary for members of group group_deltatime . This means that if you specified custom formats under [Units]/[[TimeFormats]] , then you will have to move them to the new section [Units]/[[DeltaTimeFormats]] . Very few users should be affected by this change because the ability to set custom delta time formats is an undocumented feature. The good news is that the contexts they now use have more standard names. The table below summarizes: V4.9 and earlier 4.10 [[TimeFormats]] ... current = %x %X ephem_day = %X ephem_year = %x %X brief_delta = \"%(minute)d%(minute_label)s, %(second)d%(second_label)s\" short_delta = \"%(hour)d%(hour_label)s, %(minute)d%(minute_label)s, %(second)d%(second_label)s\" long_delta = \"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\" delta_time = \"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\" [[TimeFormats]] ... current = %x %X ephem_day = %X ephem_year = %x %X [[DeltaTimeFormats]] current = \"%(minute)d%(minute_label)s, %(second)d%(second_label)s\" hour = \"%(minute)d%(minute_label)s, %(second)d%(second_label)s\" day = \"%(hour)d%(hour_label)s, %(minute)d%(minute_label)s, %(second)d%(second_label)s\" week = \"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\" month = \"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\" year = \"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\"","title":"Changes for custom delta time formats"},{"location":"upgrade/#upgrading-to-v49","text":"","title":"Upgrading to V4.9"},{"location":"upgrade/#wee_reports-may-require-epoch-option","text":"In previous versions, the utility wee_reports could take an optional position argument that specified the reporting time in unix epoch time. For example, wee_reports /home/weewx/weewx.conf 1645131600 would specify that the reporting time should be 1645131600, or 17-Feb-2022 13:00 PST. Starting with V4.9, the unix epoch time must be specified using the --epoch flag, so the command becomes wee_reports /home/weewx/weewx.conf --epoch=1645131600 Alternatively, the reporting time can be specified by using --date and --time flags: wee_reports /home/weewx/weewx.conf --date=2022-02-17 --time=13:00","title":"wee_reports may require --epoch option."},{"location":"upgrade/#init-function-of-class-wxxtypes-has-changed","text":"In earlier versions, ET was calculated in class WXXTypes . Now it has its own class, ETXType . As a result, some initialization parameters are no longer needed and have been removed. Note also that the parameter heat_index_algo was changed to heatindex_algo in keeping with the rest of the code. Unless you have been writing specialized code that required direct access to WXXTypes you are very unlikely to be affected. V4.8 and earlier 4.9 def __init__(self, altitude_vt, latitude_f, longitude_f, et_period=3600, atc=0.8, nfac=2, wind_height=2.0, force_null=True, maxSolarRad_algo='rs', heat_index_algo ='new') def __init__(self, altitude_vt, latitude_f, longitude_f, atc=0.8, nfac=2, force_null=True, maxSolarRad_algo='rs', heatindex_algo ='new')","title":"Init function of class WXXTypes has changed"},{"location":"upgrade/#calling-signature-of-some-archive-span-functions-has-changed","text":"The calling signature of the following functions has changed. In general, the parameter grace has been removed in favor of a more robust method for figuring out which time span a timestamp belongs to. V4.8 and earlier 4.9 def archiveHoursAgoSpan(time_ts, hours_ago=0 , grace=1 ) def archiveHoursAgoSpan(time_ts, hours_ago=0) def archiveDaySpan(time_ts, grace=1, days_ago=0) def archiveDaySpan(time_ts, days_ago=0) def archiveWeekSpan(time_ts, startOfWeek=6, grace=1, weeks_ago=0) def archiveWeekSpan(time_ts, startOfWeek=6, weeks_ago=0) def archiveMonthSpan(time_ts, grace=1, months_ago=0) def archiveMonthSpan(time_ts, months_ago=0) def archiveYearSpan(time_ts, grace=1, years_ago=0) def archiveYearSpan(time_ts, years_ago=0) def archiveRainYearSpan(time_ts, sory_mon , grace=1 ) def archiveRainYearSpan(time_ts, sory_mon)","title":"Calling signature of some archive span functions has changed"},{"location":"upgrade/#upgrading-to-v46","text":"","title":"Upgrading to V4.6"},{"location":"upgrade/#ordering-of-search-list-changed","text":"In previous versions, user-supplied search list extensions were appended to the search list. Starting with V4.6, they are now prepended to the list. This means that when Cheetah is evaluating the list, looking for a tag, it will encounter user-supplied extensions first, allowing extensions to override the built-in tags and change their behavior.","title":"Ordering of search list changed"},{"location":"upgrade/#tag-alltime","text":"The tag $alltime , formerly included as an example, is now a part of the core of WeeWX. This means you may no longer need to include the \"stats\" example as a Cheetah search list extension, although leaving it in will do no harm.","title":"Tag $alltime"},{"location":"upgrade/#upgrading-to-v45","text":"Version 4.5 changes are unlikely to affect anyone, except extension writers who are deep in the internals of WeeWX.","title":"Upgrading to V4.5"},{"location":"upgrade/#api-changes","text":"There have been a number of changes in the WeeWX API. None of them are likely to affect end users. Overall, the biggest change is that the data held internally in class ValueHelper is now held in the target unit system, rather than being converted at time of use.","title":"API changes"},{"location":"upgrade/#upgrading-to-v44","text":"","title":"Upgrading to V4.4"},{"location":"upgrade/#auto-patch-of-daily-summaries","text":"The V4.2 daily summary patch inadvertently introduced a bug which caused the wind daily summary to be incorrectly weighted. See issue #642 . V4.4 includes a patch to automatically fix the defective daily summary. It is run only once on the first use of a database (usually by weewxd ) and takes only a few seconds.","title":"Auto patch of daily summaries"},{"location":"upgrade/#upgrading-to-v43","text":"","title":"Upgrading to V4.3"},{"location":"upgrade/#auto-patch-of-daily-summaries_1","text":"Version 4.2 inadvertently introduced a bug, which prevented the sums that are kept in the daily summaries from being weighted by the archive interval. See issue #623 . V4.3 includes a patch, which will fix any defective daily summaries automatically. It is run only once on the first use of a database (usually by weewxd ) and takes only a few seconds.","title":"Auto patch of daily summaries"},{"location":"upgrade/#option-ignore_zero_wind-has-been-renamed-and-moved","text":"Normally, WeeWX sets wind direction to undefined when wind speed is zero. While it was never documented, some users used option ignore_zero_wind to prevent this: if set to False , wind direction will not be set to undefined when wind speed is zero. However, the option's location and name has changed. It is now called force_null , and it is now located under [StdWXCalculate] / [[WXXTypes]] / [[[windDir]]] . The old name and location has been deprecated, but still honored. V4.2 and earlier 4.3 [StdWXCalculate] ignore_zero_wind = False [[Calculations]] ... [StdWXCalculate] [[Calculations]] ... [[WXXTypes]] [[[windDir]]] force_null = False","title":"Option ignore_zero_wind has been renamed and moved"},{"location":"upgrade/#option-log_failure-set-to-true","text":"The option log_failure under [StdReport] controls whether to log failures into the system log. It was previously set to False . The upgrade process will set it to True , so that users can better see failure modes. V4.2 and earlier 4.3 [StdReport] ... log_failure = False ... [StdReport] ... log_failure = True ...","title":"Option log_failure set to True"},{"location":"upgrade/#upgrading-to-v42","text":"For the most part, V4.2 is backwards compatible with previous versions. There is one small exception.","title":"Upgrading to V4.2"},{"location":"upgrade/#type-beaufort-deprecated","text":"The type beaufort has been deprecated, although there are no immediate plans to remove it \u2014 using it will put a warning in the log. Instead, it has become a new unit, which can be used as part of group_speed . Here's an example: V4.1 and earlier 4.2 <p> The current wind speed is $current.windSpeed, which is $current.beaufort on the beaufort scale. </p> <p> The current wind speed is $current.windSpeed, which is $current.windSpeed.beaufort on the beaufort scale. </p>","title":"Type beaufort deprecated"},{"location":"upgrade/#upgrading-to-v40","text":"For the most part, V4.0 is backwards compatible with previous versions.","title":"Upgrading to V4.0"},{"location":"upgrade/#python-25-and-26","text":"Support for Python 2.5 and 2.6 has been dropped. It has now been well over 10 years since these versions were introduced, and 6+ years since they were supported by the Python Software Foundation. If you are using Python 2.5 or 2.6, then you should either upgrade your copy of Python, or stay with your old version of WeeWX.","title":"Python 2.5 and 2.6"},{"location":"upgrade/#stdwxcalculate","text":"In earlier versions of WeeWX, many derived types were calculated by default by the service StdWXCalculate . By contrast, in WeeWX V4, no derived types are calculated by default \u2014 all desired types must be explicitly listed in weewx.conf . For most users, this will not cause a problem because most types were already listed in weewx.conf . However if you deleted one of the following types in the clause [StdWXCalculate] , and started to depend on the default calculations, then the type will no longer be calculated in V4. pressure barometer altimeter windchill heatindex dewpoint inDewpoint rainRate In this case, you should add the type to [StdWXCalculate] . For example, if for some reason you deleted dewpoint , then you would need to add the following [StdWXCalculate] [[Calculations]] ... dewpoint = prefer_hardware","title":"[StdWXCalculate]"},{"location":"upgrade/#upgrading-to-v39","text":"","title":"Upgrading to V3.9"},{"location":"upgrade/#new-skins","text":"Version 3.9 introduces and installs a new skin, Seasons , and promotes two old skins, Mobile and Smartphone , previously part of Standard , to first-class, independent, skins. If you are installing fresh (not an upgrade), then all four skins, Seasons , Standard , Mobile , and Smartphone will be installed, but only Seasons will be activated. If you are upgrading, then the three new skins, Seasons , Mobile , and Smartphone will be installed, but none will be activated. Your existing Standard will be left untouched and activated. For most people, your website will continue to look as expected (the exception is explained below in section Do you need to change anything? ). If you are upgrading, and you wish to try the new skin Seasons , then activate it, but be sure to deactivate Standard . Otherwise, both will get generated, and they will compete with each other for placement in your HTML directory.","title":"New skins"},{"location":"upgrade/#skin-defaults","text":"Version 3.9 introduces a new section, [StdReport]/[[Defaults]] in weewx.conf . Options in this section apply to all reports. For example, if you set a unit group here, it will be applied everywhere. This makes it easy to set the units across all reports, or to ensure that the labels for observations are the same in every report. It also adds a file defaults.py , in which the fallback values for every report parameter are specified. Although the defaults file is currently useful only to developers, in the future it may be extended to facilitate translations and localization.","title":"Skin defaults"},{"location":"upgrade/#do-you-need-to-change-anything","text":"The introduction of the new section, [StdReport]/[[Defaults]] in weewx.conf , can change which units are applied to reports because it has a higher precedence than what is in skin.conf . See the section How to specify options for details of the ordering in which an option is considered. Most users will be unaffected by these changes because they depend on specific report overrides. There is, however, one exception: If your installation does not use overrides, and you changed to metric units in your skin.conf file, you will be affected. Your reports will start appearing in U.S. Customary units. The reason is that the new section, [StdReport]/[[Defaults]] has higher priority than options in skin.conf , and thus will start asserting itself. The fix is simple: modify the [StdReport]/[[Defaults]] to suit your preferences. However, users who specified what unit system to use as part of the automated install using a package installer or setup.py , will have an override section, and therefore will be unaffected. This is because the override section has the highest priority.","title":"Do you need to change anything?"},{"location":"upgrade/#upgrading-to-v37","text":"","title":"Upgrading to V3.7"},{"location":"upgrade/#changes-to-daily-summaries","text":"Perhaps the most significant change in V3.7 is a fix for how daily summary values are calculated and stored. Daily summaries were introduced in V3.0 (December 2014), to speed up certain kinds of aggregation calculations. They were designed to \"weight\" values depending on the time length of the archive record that contributed them. For example, shorter intervals contributed less than longer intervals. This was intended to enable changes to the length of the archive interval. Unfortunately, a bug caused the weightings to all be one (1), regardless of what the actual archive interval length might be. This means all archive records, long and short, contribute the same amount, instead of being weighted by their length. So, if the archive interval were to change, averages would be calculated incorrectly. This bug will only affect you if you have changed the length of your archive interval, or if you plan to. If you have not changed your archive interval length, and have no plans to do so, then there is nothing you need to do. Your archive may have interval values of different sizes if... ... you have imported data using wee_import . ... your hardware has a data logger, your configuration uses record_generation=software , and the archive_interval is different from that in the hardware. ... your archive contains data from more than one type of hardware. The weectl database update utility can fix this problem by recalculating the weights in the daily summary, on the basis of the actual archive interval lengths. On a Raspberry Pi 1, model B, it takes about 10 minutes to fix a database with 10 years of data. On faster machines, it takes much less time. weectl database update If you have multiple databases, consider recalculating the weights in each database. Interval weighting will only need to be applied to databases that have daily summaries, i.e., the binding uses manager = weewx.wxmanager.WXDaySummaryManager To apply interval weighting to a database other than the default wx_binding , use the --binding=BINDING_NAME option. weectl database update --binding=cmon_binding","title":"Changes to daily summaries"},{"location":"upgrade/#recalculation-of-windspeed-maximum-values","text":"Version 3.7 changes how maximum windSpeed is calculated for aggregations of a day or more. Previously, if option use_hilo was set to True (the usual case), maximum windSpeed for a day was set to the maximum value seen in the LOOP packets for the day. In practice this is the same value as windGust . That is, these two tags would supply the same value: $day.windSpeed.max $day.windGust.max In Version 3.7, this has been changed so the maximum windSpeed is now set to the maximum archive value seen during the day \u2014 usually a slightly smaller number. However, older daily max values will still contain the max LOOP packet values. If you wish to update your older values and have them use the max archive record value, use the utility weectl database update .","title":"Recalculation of windSpeed maximum values"},{"location":"upgrade/#change-in-the-name-and-locations-of-examples","text":"In earlier versions, examples were located with the WeeWX code base, and packaged as a Python module. This is categorically and semantically incorrect. The examples now live in their own directory, whose location is dependent on the installation method . If you use an example, you should copy it to the user subdirectory, modify it if necessary, then use it there. Your copy will be retained across version upgrades. 3.6 3.7 examples.alarm.MyAlarm examples.lowBattery.MyAlarm examples.xsearch.MyXSearch user.alarm.MyAlarm user.lowBattery.BatteryAlarm user.stats.MyStats Finally, note that the name of one example has been changed: 3.6 3.7 xsearch.py stats.py","title":"Change in the name and locations of examples"},{"location":"upgrade/#changes-to-sensor-mapping","text":"The mapping of sensors to database fields was formalized in Version 3.7, resulting in changes to the configuration for some of the drivers, including cc3000 , te923 , wmr100 , wmr200 , wmr300 , and wmr9x8 . For the wmr200 driver, until Version 3.6, the fields extraTemp1 and extraHumid1 were not usable. Version 3.6.1 shifted the extraTemp and extraHumid mappings down one channel, so that extraTemp1 corresponded to channel 2, extraTemp2 corresponded to channel 3, and so on. The mappings can now be modified by a change to the configuration file, and the default mappings are as follows: 3.6 3.7 ** hard-coded in the driver ** outTemp = temperature_1 # extraTemp1 is not usable extraTemp2 = temperature_2 extraTemp3 = temperature_3 extraTemp4 = temperature_4 extraTemp5 = temperature_5 extraTemp6 = temperature_6 extraTemp7 = temperature_7 extraTemp8 = temperature_8 outHumidity = humidity_1 # extraHumid1 is not usable extraHumid2 = humidity_2 extraHumid3 = humidity_3 extraHumid4 = humidity_4 extraHumid5 = humidity_5 extraHumid6 = humidity_6 extraHumid7 = humidity_7 extraHumid8 = humidity_8 [WMR200] [[sensor_map]] altimeter = altimeter pressure = pressure windSpeed = wind_speed windDir = wind_dir windGust = wind_gust windBatteryStatus = battery_status_wind inTemp = temperature_0 outTemp = temperature_1 extraTemp1 = temperature_2 extraTemp2 = temperature_3 extraTemp3 = temperature_4 extraTemp4 = temperature_5 extraTemp5 = temperature_6 extraTemp6 = temperature_7 extraTemp7 = temperature_8 inHumidity = humidity_0 outHumidity = humidity_1 extraHumid1 = humidity_2 extraHumid2 = humidity_3 extraHumid3 = humidity_4 extraHumid4 = humidity_5 extraHumid5 = humidity_6 extraHumid6 = humidity_7 extraHumid7 = humidity_8 outTempBatteryStatus = battery_status_out rain = rain rainTotal = rain_total rainRate = rain_rate hourRain = rain_hour rain24 = rain_24 rainBatteryStatus = battery_status_rain UV = uv uvBatteryStatus = battery_status_uv windchill = windchill heatindex = heatindex forecastIcon = forecast_icon outTempFault = out_fault windFault = wind_fault uvFault = uv_fault rainFault = rain_fault clockUnsynchronized = clock_unsynchronized For the te923 driver: 3.6 3.7 [TE923] [[map]] link_wind = windLinkStatus bat_wind = windBatteryStatus link_rain = rainLinkStatus bat_rain = rainBatteryStatus link_uv = uvLinkStatus bat_uv = uvBatteryStatus uv = UV t_in = inTemp h_in = inHumidity t_1 = outTemp h_1 = outHumidity bat_1 = outBatteryStatus link_1 = outLinkStatus t_2 = extraTemp1 h_2 = extraHumid1 bat_2 = extraBatteryStatus1 link_2 = extraLinkStatus1 t_3 = extraTemp2 h_3 = extraHumid3 bat_3 = extraBatteryStatus2 link_3 = extraLinkStatus2 t_4 = extraTemp3 h_4 = extraHumid3 bat_4 = extraBatteryStatus3 link_4 = extraLinkStatus3 t_5 = extraTemp4 h_5 = extraHumid4 bat_5 = extraBatteryStatus4 link_5 = extraLinkStatus4 [TE923] [[sensor_map]] windLinkStatus = link_wind windBatteryStatus = bat_wind rainLinkStatus = link_rain rainBatteryStatus = bat_rain uvLinkStatus = link_uv uvBatteryStatus = bat_uv inTemp = t_in inHumidity = h_in outTemp = t_1 outHumidity = h_1 outTempBatteryStatus = bat_1 outLinkStatus = link_1 extraTemp1 = t_2 extraHumid1 = h_2 extraBatteryStatus1 = bat_2 extraLinkStatus1 = link_2 extraTemp2 = t_3 extraHumid2 = h_3 extraBatteryStatus2 = bat_3 extraLinkStatus2 = link_3 extraTemp3 = t_4 extraHumid3 = h_4 extraBatteryStatus3 = bat_4 extraLinkStatus3 = link_4 extraTemp4 = t_5 extraHumid4 = h_5 extraBatteryStatus4 = bat_5 extraLinkStatus4 = link_5","title":"Changes to sensor mapping"},{"location":"upgrade/#upgrading-to-v36","text":"","title":"Upgrading to V3.6"},{"location":"upgrade/#changes-to-weewxconf","text":"In Version 3.6, the list of options that describe how derived variables are to be calculated have been moved to a new subsection called [[Calculations]] . The upgrade process will automatically make this change for you. 3.5 3.6 [StdWXCalculate] pressure = prefer_hardware barometer = prefer_hardware altimeter = prefer_hardware windchill = prefer_hardware heatindex = prefer_hardware dewpoint = prefer_hardware inDewpoint = prefer_hardware rainRate = prefer_hardware [StdWXCalculate] [[Calculations]] pressure = prefer_hardware barometer = prefer_hardware altimeter = prefer_hardware windchill = prefer_hardware heatindex = prefer_hardware dewpoint = prefer_hardware inDewpoint = prefer_hardware rainRate = prefer_hardware","title":"Changes to weewx.conf"},{"location":"upgrade/#upgrading-to-v32","text":"","title":"Upgrading to V3.2"},{"location":"upgrade/#new-utilities_1","text":"Version 3.2 includes new utilities to facilitate configuration. 3.2 3.1 and earlier wee_config Change driver or other station parameters wee_extension setup.py or wee_setup Install, list, and remove extensions wee_database wee_config_database Manipulate the database wee_device wee_config_device Get and set parameters on the hardware wee_reports wee_reports Run reports","title":"New utilities"},{"location":"upgrade/#changes-to-weewxconf_1","text":"Release 3.2 introduces a new section [DatabaseTypes] . This section defines the default settings for each type of database. For example, the host, user, and password for MySQL databases can be specified once in the DatabaseTypes section instead of repeating in each Database section. The defaults in DatabaseTypes can be overridden in each Database section as needed. 3.1 3.2 [DataBindings] [[wx_binding]] database = archive_sqlite manager = weewx.wxmanager.WXDaySummaryManager table_name = archive schema = schemas.wview.schema [Databases] [[archive_sqlite]] root = %(WEEWX_ROOT)s database = archive/weewx.sdb driver = weedb.sqlite [[archive_mysql]] host = localhost user = weewx password = weewx database = weewx driver = weedb.mysql [DataBindings] [[wx_binding]] database = archive_sqlite manager = weewx.wxmanager.WXDaySummaryManager table_name = archive schema = schemas.wview.schema [Databases] [[archive_sqlite]] database_name = weewx.sdb database_type = SQLite [[archive_mysql]] database_name = weewx database_type = MySQL [DatabaseTypes] [[SQLite]] driver = weedb.sqlite SQLITE_ROOT = %(WEEWX_ROOT)s/archive [[MySQL]] driver = weedb.mysql host = localhost user = weewx password = weewx","title":"Changes to weewx.conf"},{"location":"upgrade/#upgrading-to-v30","text":"","title":"Upgrading to V3.0"},{"location":"upgrade/#overview","text":"While a lot has changed with Version 3, the upgrade process should take care of most changes for most users. However, if you have installed an extension or, especially, if you have written a custom service, search list extension, or uploader, you will have to make some changes.","title":"Overview"},{"location":"upgrade/#database-contents","text":"With Version 3, there is no longer a separate \"stats\" database. Instead, \"daily summaries\" have been included in the same database as the archive data \u2014 everything is under one name. For example, if you are using sqlite, both the archive data and the daily summaries will be inside file weewx.sdb . With MySQL, everything is inside the database weewx . This makes it easier to keep all data together when working with multiple databases. This change in database structure should be transparent to you. On startup, WeeWX will automatically backfill the new internal daily summaries from the archive data. Your old \"stats\" database will no longer be used and may safely set aside or even deleted.","title":"Database contents"},{"location":"upgrade/#pressure-calibration","text":"Since the new StdWXCalculate service is applied after the StdCalibrate services, the pressure_offset parameter is no longer necessary; pressure calibration can be applied just like any other calibration. If your pressure was calibrated using the pressure_offset parameter, move the calibration to the [StdCalibrate] section. This applies only to CC3000, FineOffsetUSB, Ultimeter, WS1, WS23xx, and WS28xx hardware.","title":"Pressure calibration"},{"location":"upgrade/#weewxconf","text":"A version 2.X weewx.conf file is not compatible with Version 3.X. However, the upgrade process should automatically update the file. Nevertheless, the changes are documented below: 2.7 3.0 [StdReport] data_binding = wx_binding [StdArchive] archive_database = archive_sqlite stats_database = stats_sqlite archive_schema = user.schemas.defaultArchiveSchema stats_schema = user.schemas.defaultStatsSchema [StdArchive] data_binding = wx_binding [DataBindings] [[wx_binding]] database = archive_sqlite manager = weewx.wxmanager.WXDaySummaryManager table_name = archive schema = schemas.wview.schema [Databases] [[archive_sqlite]] root = %(WEEWX_ROOT)s database = archive/weewx.sdb driver = weedb.sqlite [[stats_sqlite]] root = %(WEEWX_ROOT)s database = archive/stats.sdb driver = weedb.sqlite [[archive_mysql]] host = localhost user = weewx password = weewx database = weewx driver = weedb.mysql [[stats_mysql]] host = localhost user = weewx password = weewx database = stats driver = weedb.mysql [Databases] [[archive_sqlite]] root = %(WEEWX_ROOT)s database_name = archive/weewx.sdb driver = weedb.sqlite [[archive_mysql]] host = localhost user = weewx password = weewx database_name = weewx driver = weedb.mysql [ Engines ] [[ WxEngine ]] prep_services = \\ weewx. wxengine .StdTimeSynch process_services = \\ weewx. wxengine .StdConvert, \\ weewx. wxengine .StdCalibrate, \\ weewx. wxengine .StdQC archive_services = \\ weewx. wxengine .StdArchive restful_services = \\ weewx.restx.StdStationRegistry, \\ weewx.restx.StdWunderground, \\ weewx.restx.StdPWSweather, \\ weewx.restx.StdCWOP, \\ weewx.restx.StdWOW, \\ weewx.restx.StdAWEKAS report_services = \\ weewx. wxengine .StdPrint, \\ weewx. wxengine .StdReport [ Engine ] [[ Services ]] prep_services = \\ weewx. engine .StdTimeSynch process_services = \\ weewx. engine .StdConvert, \\ weewx. engine .StdCalibrate, \\ weewx. engine .StdQC , \\ weewx.wxservices.StdWXCalculate archive_services = \\ weewx. engine .StdArchive restful_services = \\ weewx.restx.StdStationRegistry, \\ weewx.restx.StdWunderground, \\ weewx.restx.StdPWSweather, \\ weewx.restx.StdCWOP, \\ weewx.restx.StdWOW, \\ weewx.restx.StdAWEKAS report_services = \\ weewx. engine .StdPrint, \\ weewx. engine .StdReport","title":"weewx.conf"},{"location":"upgrade/#custom-data-sources-in-skins","text":"The mechanism for specifying non-default data sources in skins has changed. If you modified the Standard skin, or created or used other skins that draw data from a database other than the weather database, you must change how the other sources are specified. For example, in the cmon extension: 2.7 3.0 [ImageGenerator] ... [[day_images]] ... [[[daycpu]]] archive_database = cmon_sqlite [[[cpu_user]]] [[[cpu_idle]]] [[[cpu_system]]] [ImageGenerator] ... [[day_images]] ... [[[daycpu]]] data_binding = cmon_binding [[[cpu_user]]] [[[cpu_idle]]] [[[cpu_system]]]","title":"Custom data sources in skins"},{"location":"upgrade/#extensions","text":"Many skins will work in v3 with no modification required. However, every search list extension will have to be upgraded, every restful extension must be upgraded, and some other services must be upgraded. There is no automated upgrade system for extensions; if an extension must be upgraded, you must do it manually. If the extension has any python code, this will mean replacing any v2-compatible code with v3-compatible code. In some cases parts of the configuration file weewx.conf must be modified. For example, to update the pmon extension, replace bin/user/pmon.py with the v3-compatible pmon.py and modify weewx.conf as shown in this table: 2.7 3.0 [ProcessMonitor] database = pmon_sqlite [ProcessMonitor] data_binding = pmon_binding [DataBindings] [[pmon_binding]] database = pmon_sqlite manager = weewx.manager.DaySummaryManager table_name = archive schema = user.pmon.schema [Databases] [[pmon_sqlite]] root = %(WEEWX_ROOT)s database = archive/pmon.sdb driver = weedb.sqlite [Databases] [[pmon_sqlite]] root = %(WEEWX_ROOT)s database_name = archive/pmon.sdb driver = weedb.sqlite For other extensions, see the extension's documentation or contact the author of the extension.","title":"Extensions"},{"location":"upgrade/#search-list-extensions","text":"The introduction of data bindings has meant a change in the calling signature of search list extensions. By way of example, here's the example from the document Writing search list extensions , but with the differences highlighted. 2.7 3.0 def get_extension (self, timespan, archivedb, statsdb ): all_stats = TimeSpanStats ( timespan, statsdb , formatter=self.generator.formatter, converter=self.generator.converter) week_dt = datetime.date.fromtimestamp(timespan.stop) - \\ datetime.timedelta(weeks=1) week_ts = time.mktime(week_dt.timetuple()) seven_day_stats = TimeSpanStats ( TimeSpan(week_ts, timespan.stop), statsdb , formatter=self.generator.formatter, converter=self.generator.converter) search_list_extension = {'alltime' : all_stats, 'seven_day' : seven_day_stats} return search_list_extension def get_extension_list (self, timespan, db_lookup ): all_stats = TimespanBinder ( timespan, db_lookup , formatter=self.generator.formatter, converter=self.generator.converter) week_dt = datetime.date.fromtimestamp(timespan.stop) - \\ datetime.timedelta(weeks=1) week_ts = time.mktime(week_dt.timetuple()) seven_day_stats = TimespanBinder ( TimeSpan(week_ts, timespan.stop), db_lookup , formatter=self.generator.formatter, converter=self.generator.converter) search_list_extension = {'alltime' : all_stats, 'seven_day' : seven_day_stats} return [ search_list_extension ] A few things to note: The name of the extension function has changed from get_extension to get_extension_list . The calling signature has changed. Instead of an archive database and a stats database being passed in, a single database lookup function is passed in. The name of the top-level class in the tag chain has changed from TimeSpanStats to TimespanBinder . See the Customizing Guide for details. Instead of returning a single search list extension, the function should now return a Python list of extensions. The list will be searched in order.","title":"Search list extensions"},{"location":"upgrade/#derived-quantities","text":"Some calculations that were done in drivers or in hardware are now done consistently by the new StdWXCalculate service. Drivers should no longer calculate derived quantities such as windchill, heatindex, dewpoint, or rain rate.","title":"Derived quantities"},{"location":"upgrade/#driver-apis","text":"The base class for drivers has been renamed, and new, optional, methods have been defined to provide hooks for configuring hardware and producing default and upgraded configuration stanzas. These changes affect only those who have written custom drivers. 2.7 3.0 import weewx. abstractstation class ACME960(weewx. abstractstation.AbstractStation ): ... import weewx. drivers class ACME960(weewx. drivers.AbstractDevice ): ...","title":"Driver APIs"},{"location":"upgrade/#service-apis","text":"The base class for services has moved. This affects only those who have written custom services. 2.7 3.0 import weewx. wxengine class BetterMousetrapService(weewx. wxengine .StdService): ... import weewx. engine class BetterMousetrapService(weewx. engine .StdService): ...","title":"Service APIs"},{"location":"upgrade/#restful-apis","text":"Some of the methods internal to RESTful services have changed, specifically those that relate to getting configuration options from weewx.conf and configuring databases. This affects only those who have written custom RESTful services. Here is an example of obtaining the database dictionary for use in the RESTful service thread. 2.7 3.0 site_dict = weewx.restx.get_dict(config_dict, 'Uploader') db_name = config_dict['StdArchive']['archive_database'] db_dict = config_dict['Databases'][db_name] site_dict.setdefault('database_dict', db_dict) site_dict = config_dict['StdRESTful']['Uploader'] site_dict = accumulateLeaves(site_dict, max_level=1) manager_dict = weewx.manager.open_manager_with_config( config_dict, 'wx_binding')","title":"RESTful APIs"},{"location":"upgrade/#database-apis","text":"The methods for obtaining, opening, and querying databases have changed. This affects only those who have written code that accesses databases. The class Manager and its subclasses have replaced the old Archive class. The table name is no longer hard-coded, so developers should use the table name from the database binding. There is no longer a separate StatsDb class, its functions having been subsumed into the Manager class and its subclasses. A new class DBBinder is the preferred way of getting a Manager class, as it will automatically take care of instantiating the right class, as well as caching instances of Manager . An instance of DBBinder is held by the engine as attribute db_binder . Here's an example of making a simple query. 2.7 3.0 db = config_dict['StdArchive']['archive_database'] self.database_dict = config_dict['Databases'][db] with weewx.archive.Archive.open(self.database_dict) as archive: val = archive.getSql(\"SELECT AVG(windSpeed) FROM archive\" \" WHERE dateTime>? AND dateTime<=?\", (start_ts, end_ts)) with self.engine.db_binder.get_manager('wx_binding') as mgr: val = mgr.getSql(\"SELECT AVG(windSpeed) FROM %s\" \" WHERE dateTime>? AND dateTime<=?\" % mgr.table_name, (start_ts, end_ts))","title":"Database APIs"},{"location":"upgrade/#generator-apis","text":"The base class for report generators has changed. The old class CachedReportGenerator no longer exists; its functionality has been replaced by an instance of DBBinder , held by the generator superclass. This affects only those who have written customer generators. Here's an example: 2.7 3.0 class GaugeGenerator(weewx.reportengine. CachedReportGenerator ) def run(self): archive_name = self.config_dict['GaugeGenerator']['archive_name'] archive = self._getArchive(archive_name) results = archive.getSql(...) class GaugeGenerator(weewx.reportengine. ReportGenerator ) def run(self): mgr = self.generator.db_binder.get_manager() results = mgr.getSql(...)","title":"Generator APIs"},{"location":"upgrade/#extension-installer","text":"The setup.py utility is now included in the installation; it is no longer necessary to keep a copy of the WeeWX source tree just for the setup.py utility. For .deb and .rpm installations, the command wee_setup is a symlink to setup.py . The options for installing extensions changed slightly to be more consistent with the rest of the options to setup.py . 2.7 3.0 setup.py --extension --install extensions/basic setup.py --extension --install basic.tar.gz setup.py --extension --uninstall basic setup.py --extension --list setup.py --extension --install basic.tar.gz --dryrun setup.py install --extension extensions/basic setup.py install --extension basic.tar.gz setup.py uninstall --extension basic setup.py list-extensions setup.py install --extension basic.tar.gz --dry-run","title":"Extension installer"},{"location":"upgrade/#upgrading-to-v27","text":"Version 2.7 is backwards compatible with earlier versions with one minor exception. It now includes the ability to localize the WeeWX and server uptimes. Previously, the labels days , hours , and minutes were hardcoded in a Python utility. There was no way of changing them. Now, like any other labels, they are taken from the skin configuration file, skin.conf , section [[Labels]] . Older configuration files had a definition for hour , but none for day , and minute . Also, the old definition for hour used an abbreviation hrs instead of hours . If you do nothing, your WeeWX and station uptimes will look like: Weewx uptime: 1 day, 1 hrs, 41 minutes Server uptime: 2 days, 10 hrs, 22 minutes Note how the label for hours is abbreviated and always uses the plural. If you want the previous behavior, or if you want to localize the labels, you should update your skin configuration file. Remove the old entries for hour and second and replace them with: day = \" day\", \" days\" hour = \" hour\", \" hours\" minute = \" minute\", \" minutes\" second = \" second\", \" seconds\" The first item is the singular spelling, the second the plural. This will result in the desired Weewx uptime: 1 day, 1 hour, 41 minutes Server uptime: 2 days, 10 hours, 22 minutes","title":"Upgrading to V2.7"},{"location":"upgrade/#upgrading-to-v26","text":"Version 2.6 is backwards compatible with earlier versions, with a couple of small exceptions. If you have written a custom WeeWX service, the install routine will try to insert its name into an appropriate place in one of the five new lists of services to be run. You should check section [Engines][[WxEngine]] to make sure it made a reasonable guess. If you have written a custom RESTful service, the architecture for these services has completely changed. They are now first class services, and are treated like any other WeeWX service. There are some guides to writing RESTful services using the new architecture at the top of the file bin/weewx/restx.py . I can also help you with the transition. Option interval in the CWOP configuration section has become option post_interval . This change should be done automatically by the install routine. The mechanism for specifying RESTful services has changed. To activate a RESTful service, put the driver in the restful_services list in [Engines][[WxEngine]] . The driver parameter is no longer necessary in the RESTful service's configuration stanza. These changes should be done automatically by the install routine.","title":"Upgrading to V2.6"},{"location":"upgrade/#upgrading-to-v24","text":"The option time_length will now be the exact length of the resultant plot. Before, a plot with time_length equal to 24 hours would result in a plot of 27 hours, now it's 24 hours. If you want the old behavior, set it equal to 27 hours. To do this, change your section in skin.conf from [[day_images]] x_label_format = %H:%M bottom_label_format = %m/%d/%y %H:%M time_length = 86400 # == 24 hours to [[day_images]] x_label_format = %H:%M bottom_label_format = %m/%d/%y %H:%M time_length = 97200 # == 27 hours The service StdTimeSync now synchronizes the console's onboard clock on startup. This is nice because if the clock failed, perhaps because the battery was taken out, the time is corrected first before data is downloaded from the logger's memory. To take advantage of this, you can move service StdTimeSync to the front of the list of services to be run. For example: [[WxEngine]] # The list of services the main weewx engine should run: service_list = weewx.wxengine.StdTimeSynch , weewx.wxengine.StdConvert, weewx.wxengine.StdCalibrate, weewx.wxengine.StdQC, weewx.wxengine.StdArchive, weewx.wxengine.StdPrint, weewx.wxengine.StdRESTful, weewx.wxengine.StdReport","title":"Upgrading to V2.4"},{"location":"upgrade/#upgrading-to-v23","text":"The signature of the function \" loader \", used to return an instance of the station device driver, has changed slightly. It has changed from loader(config_dict) to loader(config_dict, engine) That is, a second parameter, engine , has been added. This is a reference to the WeeWX engine. This change will affect only those who have written their own device driver.","title":"Upgrading to V2.3"},{"location":"upgrade/#upgrading-to-v22","text":"Version 2.2 introduces a schema, found in bin/user/schemas.py , for the stats database. This schema is used only when initially creating the database. If you have a specialized stats database, that is, one that saves types other than the default that comes with WeeWX, you should edit this file to reflect your changes before attempting to rebuild the database.","title":"Upgrading to V2.2"},{"location":"upgrade/#upgrading-to-v20","text":"Version 2.0 introduces many new features, including a revamped internal engine. There are two changes that are not backwards compatible: The configuration file, weewx.conf . When upgrading from V1.X, the setup utility will install a new, fresh copy of weewx.conf , which you will then have to edit by hand. Thereafter, V2.X upgrades should be automatic. Custom services. If you have written a custom service, it will have to be updated to use the new engine. The overall architecture is very similar, except that functions must be bound to events, rather than get called implicitly. See the sections Customizing a Service and Adding a Service in the Customization Guide for details on how to do this. All skins should be completely backwards compatible, so you should not have to change your templates or skin configuration file, skin.conf . If you have written a custom report generator it should also be backwards compatible.","title":"Upgrading to V2.0"},{"location":"upgrade/#upgrading-to-v114","text":"Version 1.14 introduces some new webpages that have been expressly formatted for the smartphone by using jQuery . The skins shipped with the distribution take advantage of these features. If you do nothing, your old skins will continue to work, but you will not be taking advantage of these new webpages. If you want them, then you have two choices: Rename your old skin directory (call it \" skins.old \") then do the install. This will install the new skin distribution. You can then modify it to reflect any changes you have made, referring to skins.old for guidance. If you have not changed many things, this approach will be the easiest. Alternatively, change the contents of your existing skin directory to include the new webpages. If you take this approach, you will need to copy over the contents of the subdirectory skins/Standard/smartphone from the distribution into your skins/Standard directory. You will then need to modify your skin.conf . After the section that looks like [[[Mobile]]] template = mobile.html.tmpl add the following directives: [[[MobileSmartphone]]] template = smartphone/index.html.tmpl [[[MobileTempOutside]]] template = smartphone/temp_outside.html.tmpl [[[MobileRain]]] template = smartphone/rain.html.tmpl [[[MobileBarometer]]] template = smartphone/barometer.html.tmpl [[[MobileWind]]] template = smartphone/wind.html.tmpl [[[MobileRadar]]] template = smartphone/radar.html.tmpl Then modify section [CopyGenerator] to add the highlighted files: [CopyGenerator] # # This section is used by the generator CopyGenerator # # List of files that are to be copied at the first invocation of the generator only copy_once = backgrounds/*, weewx.css, mobile.css, favicon.ico, smartphone/icons/*, smartphone/custom.js Whichever approach you chose, the generated files will appear in public_html/smartphone . The start of the document root will be at public_html/smartphone/index.html . You may want to add a link to this in the template for your main index page skins/Standard/index.html.tmpl .","title":"Upgrading to V1.14"},{"location":"upgrade/#upgrading-to-v113","text":"Version 1.13 changed the way binding happens to the databases used in reports so that it happens much later. The upshot is that the signature of a few functions changed. Most you are unlikely to encounter. The exception is if you have written custom template search lists , as described in the Customizing weewx guide . This section has been updated to reflect the new function signatures. As a side effect, the illustrated example actually has become much simpler! No changes to skins.","title":"Upgrading to V1.13"},{"location":"upgrade/#upgrading-to-v110","text":"Version 1.10 introduced several new features.","title":"Upgrading to V1.10"},{"location":"upgrade/#new-almanac-features-icon-and-mobile-template","text":"Version 1.10 introduces some extra almanac features, such as the azimuth and elevation of the sun and moon, or when the next solstice will be. It also includes a template formatted for smartphones, as well as an icon (\" favicon.ico \") that displays in your browser toolbar. The skins shipped with the distribution take advantage of these features. If you do nothing, your old skins will continue to work, but you will not take advantage of these new features. If you want these new features then you have two choices: Rename your old skin directory (call it \" skin.old \") then do the install. This will install the new skin distribution. You can modify it to reflect any changes you have made, referring to skin.old for guidance. Alternatively, change the contents of your existing skin directory to take advantage of the new features. If you take this approach, you will need to copy over files favicon.ico, mobile.css , and mobile.html.tmpl from the distribution into your skin/Standard directory. Modify skins/Standard/index.html.tmpl to take advantage of the new almanac features, using the version shipped with the distribution for guidance. You will then need to modify your skin.conf . Add a new [[[Mobile]]] section: [FileGenerator] ... [[ToDate]] ... [[[Mobile]]] template = mobile.html.tmpl Then add mobile.css and favicon.ico to the list of files to be copied on report generation: [CopyGenerator] copy_once = backgrounds/*, weewx.css, mobile.css, favicon.ico Which approach you should take will depend on how extensively you have modified the stock skin distribution. If the modifications are slight, approach #1 will be easier, otherwise use approach #2.","title":"New almanac features, icon, and mobile template"},{"location":"upgrade/#backwards-compatibility","text":"With the introduction of explicit control of output units in the templates such as $day.outTemp.max.degree_C the calling signature of the following two Python classes was changed weewx.stats.TaggedStats weewx.stats.TimeSpanStats The example of writing a custom generator MyFileGenerator (which produced \"all time\" statistics) has been changed to reflect the new signatures. This will only affect you if you have written a custom generator.","title":"Backwards compatibility"},{"location":"upgrade/#upgrading-to-v18","text":"With the introduction of a standard archiving service, StdArchive , the names of some events have changed. This will not affect you unless you have written a custom service.","title":"Upgrading to V1.8"},{"location":"upgrade/#upgrading-to-v17","text":"V1.7 introduces skins . The skins live in subdirectory skins . They are not compatible with the old template subdirectory --- you can't simply rename templates to skins . The part of the configuration file dealing with the presentation layer has been split off into a separate file skin.conf . Hence, once again, the installation script setup.py will NOT merge your old weewx.conf configuration file into the new one. You will have to re-edit weewx.conf to put in your customizations. You may also have to edit skin.conf for whatever skin you choose (right now, only one skin, Standard , comes with the distribution). However, a reinstall of V1.7 will merge your changes for weewx.conf . It will also merge any changes you have made to skin.conf as well. Please check the following: Option \" altitude \" in section [Station] now takes a unit. Hence, it should look something like: altitude = 120, meter In a similar manner, options heating_base and cooling_base in skin.conf also take units: heating_base = 65, degree_F cooling_base = 65, degree_F The directory ' templates ' is no longer used; it has been replaced with directory ' skins '. You may delete it if you wish: rm -r templates","title":"Upgrading to V1.7"},{"location":"upgrade/#upgrading-to-v15","text":"Because the configuration file weewx.conf changed significantly going from V1.4 to V1.5, the installation script setup.py will NOT merge your old configuration file into the new one. You will have to re-edit weewx.conf to put in your customizations.","title":"Upgrading to V1.5"},{"location":"upgrade/#upgrading-to-v14","text":"Option clock_check , previously found in the [VantagePro] section, is now found in the [Station] section. The install program will put a default value in the new place, but it will not delete nor move your old value over. If you have changed this value or if you cannot stand the thought of clock_check appearing in two different places, you should delete the old one found under [VantagePro] and make sure the new value, found under [Station] is correct. Two Python files are no longer used, so they may be deleted from your installation if you wish: rm bin/weewx/processdata.py rm bin/weewx/mainloop.py In addition, file readme.htm has been moved to subdirectory docs , so the old one can be deleted: rm readme.htm","title":"Upgrading to V1.4"},{"location":"custom/cheetah-generator/","text":"The Cheetah generator \u00b6 File generation is done using the Cheetah templating engine, which processes a template , replacing any symbolic tags , then produces an output file. Typically, it runs after each new archive record (usually about every five minutes), but it can also run on demand using the utility wee_reports . The Cheetah engine is very powerful, essentially letting you have the full semantics of Python available in your templates. As this would make the templates incomprehensible to anyone but a Python programmer, WeeWX adopts a very small subset of its power. The Cheetah generator is controlled by the configuration options in the section [CheetahGenerator] of the skin configuration file. Let's take a look at how this works. Which files get processed? \u00b6 Each template file is named something like D/F.E.tmpl , where D is the (optional) directory the template sits in and will also be the directory the results will be put in, and F.E is the generated file name. So, given a template file with name Acme/index.html.tmpl , the results will be put in HTML_ROOT/Acme/index.html . The configuration for a group of templates will look something like this: [CheetahGenerator] [[index]] template = index.html.tmpl [[textfile]] template = filename.txt.tmpl [[xmlfile]] template = filename.xml.tmpl There can be only one template in each block. In most cases, the block name does not matter \u2014 it is used only to isolate each template. However, there are four block names that have special meaning: SummaryByDay , SummaryByMonth , SummaryByYear , and ToDate . Specifying template files \u00b6 By way of example, here is the [CheetahGenerator] section from the skin.conf for the skin Seasons . 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 [CheetahGenerator] # The CheetahGenerator creates files from templates. This section # specifies which files will be generated from which template. # Possible encodings include 'html_entities', 'strict_ascii', 'normalized_ascii', # as well as those listed in https://docs.python.org/3/library/codecs.html#standard-encodings encoding = html_entities [[SummaryByMonth]] # Reports that summarize \"by month\" [[[NOAA_month]]] encoding = normalized_ascii template = NOAA/NOAA-%Y-%m.txt.tmpl [[SummaryByYear]] # Reports that summarize \"by year\" [[[NOAA_year]]] encoding = normalized_ascii template = NOAA/NOAA-%Y.txt.tmpl [[ToDate]] # Reports that show statistics \"to date\", such as day-to-date, # week-to-date, month-to-date, etc. [[[index]]] template = index.html.tmpl [[[statistics]]] template = statistics.html.tmpl [[[telemetry]]] template = telemetry.html.tmpl [[[tabular]]] template = tabular.html.tmpl [[[celestial]]] template = celestial.html.tmpl # Uncomment the following to have WeeWX generate a celestial page only once an hour: # stale_age = 3600 [[[RSS]]] template = rss.xml.tmpl The skin contains three different kinds of generated output: Summary by Month (line 9). The skin uses SummaryByMonth to produce NOAA summaries, one for each month, as a simple text file. Summary by Year (line 15). The skin uses SummaryByYear to produce NOAA summaries, one for each year, as a simple text file. Section \"To Date\" (line 21). The skin produces an HTML index.html page, as well as HTML files for detailed statistics, telemetry, and celestial information. It also includes a master page ( tabular.html ) in which NOAA information is displayed. All these files are HTML. Because the option encoding = html_entities appears directly under [CheetahGenerator] , this will be the default encoding of the generated files unless explicitly overridden. We see an example of this under [SummaryByMonth] and [SummaryByYear] , which override the default by specifying option normalized_ascii (which replaces accented characters with a non-accented analog). Other than SummaryByMonth and SummaryByYear , the section names are arbitrary. The section [[ToDate]] could just as well have been called [[files_to_date]] , and the sections [[[index]]] , [[[statistics]]] , and [[[telemetry]]] could just as well have been called [[[tom]]] , [[[dick]]] , and [[[harry]]] . [[SummaryByYear]] \u00b6 Use SummaryByYear to generate a set of files, one file per year. The name of the template file should contain a strftime() code for the year; this will be replaced with the year of the data in the file. [CheetahGenerator] [[SummaryByYear]] # Reports that summarize \"by year\" [[[NOAA_year]]] encoding = normalized_ascii template = NOAA/NOAA-%Y.txt.tmpl The template NOAA/NOAA-%Y.txt.tmpl might look something like this: SUMMARY FOR YEAR $year.dateTime MONTHLY TEMPERATURES AND HUMIDITIES: #for $record in $year.records $record.dateTime $record.outTemp $record.outHumidity #end for [[SummaryByMonth]] \u00b6 Use SummaryByMonth to generate a set of files, one file per month. The name of the template file should contain a strftime() code for year and month; these will be replaced with the year and month of the data in the file. [CheetahGenerator] [[SummaryByMonth]] # Reports that summarize \"by month\" [[[NOAA_month]]] encoding = normalized_ascii template = NOAA/NOAA-%Y-%m.txt.tmpl The template NOAA/NOAA-%Y-%m.txt.tmpl might look something like this: SUMMARY FOR MONTH $month.dateTime DAILY TEMPERATURES AND HUMIDITIES: #for $record in $month.records $record.dateTime $record.outTemp $record.outHumidity #end for [[SummaryByDay]] \u00b6 While the Seasons skin does not make use of it, there is also a SummaryByDay capability. As the name suggests, this results in one file per day. The name of the template file should contain a strftime() code for the year, month and day; these will be replaced with the year, month, and day of the data in the file. [CheetahGenerator] [[SummaryByDay]] # Reports that summarize \"by day\" [[[NOAA_day]]] encoding = normalized_ascii template = NOAA/NOAA-%Y-%m-%d.txt.tmpl The template NOAA/NOAA-%Y-%m-%d.txt.tmpl might look something like this: SUMMARY FOR DAY $day.dateTime HOURLY TEMPERATURES AND HUMIDITIES: #for $record in $day.records $record.dateTime $record.outTemp $record.outHumidity #end for Note This can create a lot of files \u2014 one per day. If you have 3 years of records, this would be more than 1,000 files! Tags \u00b6 If you look inside a template, you will see it makes heavy use of tags . As the Cheetah generator processes the template, it replaces each tag with an appropriate value and, sometimes, a label. This section discusses the details of how that happens. If there is a tag error during template generation, the error will show up in the log file. Many errors are obvious \u2014 Cheetah will display a line number and list the template file in which the error occurred. Unfortunately, in other cases, the error message can be very cryptic and not very useful. So make small changes and test often. Use the utility wee_reports to speed up the process. Here are some examples of tags: $current.outTemp $month.outTemp.max $month.outTemp.maxtime These code the current outside temperature, the maximum outside temperature for the month, and the time that maximum occurred, respectively. So a template file that contains: < html > < head > < title > Current conditions </ title > </ head > < body > < p > Current temperature = $current.outTemp </ p > < p > Max for the month is $month.outTemp.max, which occurred at $month.outTemp.maxtime </ p > </ body > </ html > would be all you need for a very simple HTML page that would display the text (assuming that the unit group for temperature is degree_F ): Current temperature = 51.0\u00b0F Max for the month is 68.8\u00b0F, which occurred at 07-Oct-2009 15:15 The format that was used to format the temperature ( 51.0 ) is specified in section [Units][[StringFormat]] . The unit label \u00b0F is from section [Units][[Labels]] , while the time format is from [Units][[TimeFormats]] . As we saw above, the tags can be very simple: # Output max outside temperature using an appropriate format and label: $month.outTemp.max Most of the time, tags will \"do the right thing\" and are all you will need. However, WeeWX offers extensive customization of the tags for specialized applications such as XML RSS feeds, or rigidly formatted reports (such as the NOAA reports). This section specifies the various tag options available. There are two different versions of the tags, depending on whether the data is \"current\", or an aggregation over time. However, both versions are similar. Time period $current \u00b6 Time period $current represents a current observation . An example would be the current barometric pressure: $current.barometer Formally, for current observations, WeeWX first looks for the observation type in the record emitted by the NEW_ARCHIVE_RECORD event. This is generally the data emitted by the station console, augmented by any derived variables ( e.g. , wind chill) that you might have specified. If the observation type cannot be found there, the most recent record in the database will be searched. If it still cannot be found, WeeWX will attempt to calculate it using the xtypes system . The most general tag for a \"current\" observation looks like: $current(timestamp=some_time, max_delta=delta_t,data_binding=binding_name) .obstype [.unit_conversion] [.rounding] [.formatting] Where: timestamp is a timestamp that you want to display in unix epoch time. It is optional, The default is to display the value for the current time. max_delta is the largest acceptable time difference (in seconds) between the time specified by timestamp and a record's timestamp in the database. By default, it is zero, which means there must be an exact match with a specified time for a record to be retrieved. If it were 30 , then a record up to 30 seconds away would be acceptable. data_binding is a binding name to a database. An example would be wx_binding . See the section Binding names for more details. obstype is an observation type , such as barometer . This type must appear either in the current record, as a field in the database, or can be derived from some combination of the two as an XType . unit_conversion is an optional unit conversion tag. If provided, the results will be converted into the specified units, otherwise the default units specified in the skin configuration file (in section [Units][[Groups]] ) will be used. See the section Unit conversion options . rounding is an optional rounding tag. If provided, it rounds the result to a fixed number of decimal digits. See the section Rounding options . formatting is an optional formatting tag. If provided, it controls how the value will appear. See the section Formatting options . Time period $latest \u00b6 Time period $latest is very similar to $current , except that it uses the last available timestamp in a database. Usually, $current and $latest are the same, but if a data binding points to a remote database, they may not be. See the section Using multiple bindings for an example where this happened. Aggregation periods \u00b6 Aggregation periods is the other kind of tag. For example, $week.rain.sum represents an aggregation over time , using a certain aggregation type . In this example, the aggregation time is a week, and the aggregation type is summation. So, this tag represents the total rainfall over a week. The most general tag for an aggregation over time looks like: $period(data_binding=binding_name[, ago=delta]) .obstype .aggregation [.unit_conversion] [.rounding] [.formatting] Where: period is the aggregation period over which the aggregation is to be done. Possible choices are listed in the aggregation periods table . data_binding is a binding name to a database. An example would be wx_binding . See the section Binding names for more details. ago is a keyword that depends on the aggregation period. For example, for week, it would be weeks_ago , for day, it would be days_ago , etc. delta is an integer indicating which aggregation period is desired. For example $week(weeks_ago=1) indicates last week, $day(days_ago=2) would be the day-before-yesterday, etc . The default is zero: that is, this aggregation period. obstype is an observation type . This is generally any observation type that appears in the database (such as outTemp or windSpeed ), as well a most XTypes . However, not all aggregations are supported for all types. aggregation is an aggregation type . If you ask for $month.outTemp.avg you are asking for the average outside temperature for the month. Possible aggregation types are given in the reference Aggregation types . unit_conversion is an optional unit conversion tag. If provided, the results will be converted into the specified units, otherwise the default units specified in the skin configuration file (in section [Units][[Groups]] ) will be used. See the section Unit conversion options . rounding is an optional rounding tag. If provided, it rounds the result to a fixed number of decimal digits. See the section Rounding options . formatting is an optional formatting tag. If provided, it controls how the value will appear. See the section Formatting options . There are several aggregation periods that can be used: Aggregation periods Aggregation period Meaning Example Meaning of example $hour This hour. $hour.outTemp.maxtime The time of the max temperature this hour. $day Today (since midnight). $day.outTemp.max The max temperature since midnight $yesterday Yesterday. Synonym for $day($days_ago=1) . $yesterday.outTemp.maxtime The time of the max temperature yesterday. $week This week. The start of the week is set by option week_start . $week.outTemp.max The max temperature this week. $month This month (since the first of the month). $month.outTemp.min The minimum temperature this month. $year This year (since 1-Jan). $year.outTemp.max The max temperature since the start of the year. $rainyear This rain year. The start of the rain year is set by option rain_year_start . $rainyear.rain.sum The total rainfall for this rain year. $alltime All records in the database given by binding_name . $alltime.outTemp.max The maximum outside temperature in the default database. The \" ago \" parameters can be useful for statistics farther in the past. Here are some examples: Aggregation period Example Meaning $hour(hours_ago= h ) $hour(hours_ago=1).outTemp.avg The average temperature last hour (1 hour ago). $day(days_ago= d ) $day(days_ago=2).outTemp.avg The average temperature day before yesterday (2 days ago). $week(weeks_ago= w ) $week(weeks_ago=1).outTemp.max The maximum temperature last week. $month(months_ago= m ) $month(months_ago=1).outTemp.max The maximum temperature last month. $year(years_ago= y ) $year(years_ago=1).outTemp.max The maximum temperature last year. Unit conversion options \u00b6 The option unit_conversion can be used with either current observations or with aggregations. If supplied, the results will be converted to the specified units. For example, if you have set group_pressure to inches of mercury ( inHg ), then the tag Today's average pressure=$day.barometer.avg would normally give a result such as Today's average pressure=30.05 inHg However, if you add mbar to the end of the tag, Today's average pressure=$day.barometer.avg.mbar then the results will be in millibars: Today's average pressure=1017.5 mbar If an inappropriate or nonsense conversion is asked for, e.g. , Today's minimum pressure in mbars: $day.barometer.min.mbar or in degrees C: $day.barometer.min.degree_C or in foobar units: $day.barometer.min.foobar then the offending tag(s) will be put in the output: Today's minimum pressure in mbars: 1015.3 or in degrees C: $day.barometer.min.degree_C or in foobar units: $day.barometer.min.foobar Rounding options \u00b6 The data in the resultant tag can be optionally rounded to a fixed number of decimal digits. This is useful when emitting raw data or JSON strings. It should not be used with formatted data. In that case, using a format string would be a better choice. The structure of the option is .round(ndigits=None) where ndigits is the number of decimal digits to retain. If None (the default), then all digits will be retained. Formatting options \u00b6 A variety of options are available to you to customize the formatting of the final observation value. They can be used whenever a tag results in a ValueHelper , which is almost all the time. This table summarizes the options: Formatting options Formatting option Comment .format( args ) Format the value as a string, according to a set of optional args . .long_form( args ) Format delta times in the \"long form\", according to a set of optional args . .ordinal_compass Format the value as a compass ordinals ( e.g. , \"SW\"), useful for wind directions. The ordinal abbreviations are set by option directions in the skin configuration file. .json Format the value as a JSON string . .raw Return the value \"as is\", without being converted to a string and without any formatting applied. This can be useful for doing arithmetic directly within the templates. You must be prepared to deal with a potential value of None . format() \u00b6 The results of a tag can be optionally formatted using option format() . It has the formal structure: format(format_string=None, None_string=None, add_label=True, localize=True) Here is the meaning of each of the optional arguments: Optional arguments for format() Optional argument Comment format_string If set, use the supplied string to format the value. Otherwise, if set to None , then an appropriate value from [Units][[StringFormats]] will be used. None_string Should the observation value be NONE , then use the supplied string (typically, something like \"N/A\"). If None_string is set to None , then the value for NONE in [Units][[StringFormats]] will be used. add_label If set to True (the default), then a unit label ( e.g. , \u00b0F) from skin.conf will be attached to the end. Otherwise, it will be left out. localize If set to True (the default), then localize the results. Otherwise, do not. If you're willing to honor the ordering of the arguments, the argument name can be omitted. long_form() \u00b6 The option long_form() , can be used to format delta times . A delta time is the difference between two times, for example, the amount of uptime (the difference between start up and the current time). By default, this will be formatted as the number of elapsed seconds. For example, a template with the following <p>WeeWX has been up $station.uptime</p> will result in WeeWX has been up 101100 seconds The \"long form\" breaks the time down into constituent time elements. For example, <p>WeeWX has been up $station.uptime.long_form</p> results in WeeWX has been up 1 day, 4 hours, 5 minutes The option long_form() has the formal structure long_form(format_string=None, None_string=None) Here is the meaning of each of the optional arguments: Optional arguments for long_form() Optional argument Comment format_string Use the supplied string to format the value. None_string Should the observation value be NONE , then use the supplied string to format the value (typically, something like \"N/A\"). The argument format_string uses special symbols to represent its constitutent components. Here's what they mean: Symbol Meaning day The number of days hour The number of hours minute The number of minutes second The number of seconds day_label The label used for days hour_label The label used for hours minute_label The label used for minutes second_label The label used for seconds Putting this together, the example above could be written <p>WeeWX has been up $station.uptime.long_form(format_string=\"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\")</p> Formatting examples \u00b6 This section gives a number of example tags, and their expected output. The following values are assumed: Values used in the formatting examples Observation Value outTemp 45.2\u00b0F UV None windDir 138\u00b0 dateTime 1270250700 uptime 101100 seconds Here are the examples: Formatting options with expected results Tag Result Result type Comment $current.outTemp 45.2\u00b0F str String formatting from [Units][[StringFormats]] . Label from [Units][[Labels]] . $current.outTemp.format 45.2\u00b0F str Same as the $current.outTemp . $current.outTemp.format() 45.2\u00b0F str Same as the $current.outTemp . $current.outTemp.format(format_string=\"%.3f\") 45.200\u00b0F str Specified string format used; label from [Units][[Labels]] . $current.outTemp.format(\"%.3f\") 45.200\u00b0F str As above, except a positional argument, instead of the named argument, is being used. $current.outTemp.format(add_label=False) 45.2 str No label. The string formatting is from [Units][[StringFormats]] . $current.UV N/A str The string specified by option NONE in [Units][[StringFormats]] . $current.UV.format(None_string=\"No UV\") No UV str Specified None_string is used. $current.windDir 138\u00b0 str Formatting is from option degree_compass in [Units][[StringFormats]] . $current.windDir.ordinal_compass SW str Ordinal direction from section [Units][[Ordinates]] is being substituted. $current.dateTime 02-Apr-2010 16:25 str Time formatting from [Units][[TimeFormats]] is being used. $current.dateTime.format(format_string=\"%H:%M\") 16:25 str Specified time format used. $current.dateTime.format(\"%H:%M\") 16:25 str As above, except a positional argument, instead of the named argument, is being used. $current.dateTime.raw 1270250700 int Raw Unix epoch time. The result is an integer . $current.outTemp.raw 45.2 float Raw float value. The result is a float . $current.outTemp.degree_C.raw 7.33333333 float Raw float value in degrees Celsius. The result is a float . $current.outTemp.degree_C.json 7.33333333 str Value in degrees Celsius, converted to a JSON string. $current.outTemp.degree_C.round(2).json 7.33 str Value in degrees Celsius, rounded to two decimal digits, then converted to a JSON string. $station.uptime 101100 seconds str WeeWX uptime. $station.uptime.hour 28.1 hours str WeeWX uptime, with unit conversion to hours. $station.uptime.long_form 1 day, 4 hours, 5 minutes str WeeWX uptime with \"long form\" formatting. start, end, and dateTime \u00b6 While not an observation type, in many ways the time of an observation, dateTime , can be treated as one. A tag such as $current.dateTime represents the current time (more properly, the time as of the end of the last archive interval) and would produce something like 01/09/2010 12:30:00 Like true observation types, explicit formats can be specified, except that they require a strftime() time format , rather than a string format . For example, adding a format descriptor like this: $current.dateTime.format(\"%d-%b-%Y %H:%M\") produces 09-Jan-2010 12:30 For aggregation periods , such as $month , you can request the start , end , or length of the period, by using suffixes .start , .end , or .length , respectively. For example, The current month runs from $month.start to $month.end and has $month.length.format(\"%(day)d %(day_label)s\"). results in The current month runs from 01/01/2010 12:00:00 AM to 02/01/2010 12:00:00 AM and has 31 days. The returned string values will always be in local time . However, if you ask for the raw value $current.dateTime.raw the returned value will be in Unix Epoch Time (number of seconds since 00:00:00 UTC 1 Jan 1970, i.e. , a large number), which you must convert yourself. It is guaranteed to never be None , so you don't worry have to worry about handling a None value. Tag $trend \u00b6 The tag $trend is available for time trends, such as changes in barometric pressure. Here are some examples: Tag Results $trend.barometer -.05 inHg $trend(time_delta=3600).barometer -.02 inHg $trend.outTemp 1.1 \u00b0C $trend.time_delta 10800 secs $trend.time_delta.hour 3 hrs Note how you can explicitly specify a time interval in the tag itself (2nd row in the table above). If you do not specify a value, then a default time interval, set by option time_delta in the skin configuration file, will be used. This value can be retrieved by using the syntax $trend.time_delta (4th row in the table). For example, the template expression The barometer trend over $trend.time_delta.hour is $trend.barometer.format(\"%+.2f\") would result in The barometer trend over 3 hrs is +.03 inHg. Tag $span \u00b6 The tag $span allows aggregation over a user defined period up to and including the current time. Its most general form looks like: $span([data_binding=binding_name][,delta=delta][,boundary=(None|'midnight')]) .obstype .aggregation [.unit_conversion] [.formatting] Where: data_binding is a binding name to a database. An example would be wx_binding . See the section Binding names for more details. delta is one or more comma separated delta settings from the table below. If more than one delta setting is included then the period used for the aggregate is the sum of the individual delta settings. If no delta setting is included, or all included delta settings are zero, the returned aggregate is based on the current obstype only. boundary is an optional specifier that can force the starting time to a time boundary. If set to 'midnight', then the starting time will be at the previous midnight. If left out, then the start time will be the sum of the optional deltas. obstype is an observation type , such as outTemp . aggregation is an aggregation type . If you ask for $month.outTemp.avg you are asking for the average outside temperature for the month. Possible aggregation types are given in the reference Aggregation types . unit_conversion is an optional unit conversion tag. If provided, the results will be converted into the specified units, otherwise the default units specified in the skin configuration file (in section [Units][[Groups]] ) will be used. See the section Unit conversion options . formatting is an optional formatting tag. If provided, it controls how the value will appear. See the section Formatting options . There are several delta settings that can be used: Delta Setting Example Meaning time_delta= seconds $span(time_delta=1800).outTemp.avg The average temperature over the last immediate 30 minutes (1800 seconds). hour_delta= hours $span(hour_delta=6).outTemp.avg The average temperature over the last immediate 6 hours. day_delta= days $span(day_delta=1).rain.sum The total rainfall over the last immediate 24 hours. week_delta= weeks $span(week_delta=2).barometer.max The maximum barometric pressure over the last immediate 2 weeks. For example, the template expressions The total rainfall over the last 30 hours is $span($hour_delta=30).rain.sum and The total rainfall over the last 30 hours is $span($hour_delta=6, $day_delta=1).rain.sum would both result in The total rainfall over the last 30 hours is 1.24 in Tag $unit \u00b6 The type, label, and string formats for all units are also available, allowing you to do highly customized labels: Tag Results $unit.unit_type.outTemp degree_C $unit.label.outTemp \u00b0C $unit.format.outTemp %.1f For example, the tag $day.outTemp.max.format(add_label=False)$unit.label.outTemp would result in 21.2\u00b0C (assuming metric values have been specified for group_temperature ), essentially reproducing the results of the simpler tag $day.outTemp.max . Tag $obs \u00b6 The labels used for the various observation types are available using tag $obs . These are basically the values given in the skin dictionary, section [Labels][[Generic]] . Tag Results $obs.label.outTemp Outside Temperature $obs.label.UV UV Index Iteration \u00b6 It is possible to iterate over the following: Tag suffix Results .records Iterate over every record .hours Iterate by hours .days Iterate by days .months Iterate by months .years Iterate by years .spans(interval= seconds ) Iterate by custom length spans. The default interval is 10800 seconds (3 hours). The spans will align to local time boundaries. The following template uses a Cheetah for loop to iterate over all months in a year, printing out each month's min and max temperature. The iteration loop is highlighted . Min, max temperatures by month #for $month in $year.months $month.dateTime.format(\"%B\"): Min, max temperatures: $month.outTemp.min $month.outTemp.max #end for The result is: Min, max temperatures by month January: Min, max temperatures: 30.1\u00b0F 51.5\u00b0F February: Min, max temperatures: 24.4\u00b0F 58.6\u00b0F March: Min, max temperatures: 27.3\u00b0F 64.1\u00b0F April: Min, max temperatures: 33.2\u00b0F 52.5\u00b0F May: Min, max temperatures: N/A N/A June: Min, max temperatures: N/A N/A July: Min, max temperatures: N/A N/A August: Min, max temperatures: N/A N/A September: Min, max temperatures: N/A N/A October: Min, max temperatures: N/A N/A November: Min, max temperatures: N/A N/A December: Min, max temperatures: N/A N/A The following template again uses a Cheetah for loop, this time to iterate over 3-hour spans over the last 24 hours, displaying the averages in each span. The iteration loop is highlighted . < p > 3 hour averages over the last 24 hours </ p > < table > < tr > < td > Date/time </ td >< td > outTemp </ td >< td > outHumidity </ td > </ tr > #for $time_band in $span($day_delta=1).spans(interval=10800) < tr > < td > $time_band.start.format(\"%d/%m %H:%M\") </ td > < td > $time_band.outTemp.avg </ td > < td > $time_band.outHumidity.avg </ td > </ tr > #end for </ table > The result is: 3 hour averages over the last 24 hours Date/time outTemp outHumidity 21/01 18:50 33.4\u00b0F 95% 21/01 21:50 32.8\u00b0F 96% 22/01 00:50 33.2\u00b0F 96% 22/01 03:50 33.2\u00b0F 96% 22/01 06:50 33.8\u00b0F 96% 22/01 09:50 36.8\u00b0F 95% 22/01 12:50 39.4\u00b0F 91% 22/01 15:50 35.4\u00b0F 93% See the NOAA template files NOAA/NOAA-YYYY.txt.tmpl and NOAA/NOAA-YYYY-MM.txt.tmpl , both included in the Seasons skin, for other examples using iteration and explicit formatting. Comprehensive example \u00b6 This example is designed to put together a lot of the elements described above, including iteration, aggregation period starts and ends, formatting, and overriding units. Click here for the results. < html > < head > < style > td { border : 1 px solid #cccccc ; padding : 5 px ; } </ style > </ head > < body > < table border = 1 style = \"border-collapse:collapse;\" > < tr style = \"font-weight:bold\" > < td > Time interval </ td > < td > Max temperature </ td > < td > Time </ td > </ tr > #for $hour in $day($days_ago=1).hours < tr > < td > $hour.start.format(\"%H:%M\")-$hour.end.format(\"%H:%M\") </ td > < td > $hour.outTemp.max ($hour.outTemp.max.degree_C) </ td > < td > $hour.outTemp.maxtime.format(\"%H:%M\") </ td > </ tr > #end for < caption > < p > Hourly max temperatures yesterday < br /> $day($days_ago=1).start.format(\"%d-%b-%Y\") </ p > </ caption > </ table > </ body > </ html > Support for series \u00b6 Note This is an experimental API that could change. WeeWX V4.5 introduced some experimental tags for producing series of data, possibly aggregated. This can be useful for creating the JSON data needed for JavaScript plotting packages, such as HighCharts , Google Charts , or C3.js . For example, suppose you need the maximum temperature for each day of the month. This tag $month.outTemp.series(aggregate_type='max', aggregate_interval='1d', time_series='start').json would produce the following: [[1614585600, 58.2], [1614672000, 55.8], [1614758400, 59.6], [1614844800, 57.8], ... ] This is a list of (time, temperature) for each day of the month, in JSON, easily consumed by many of these plotting packages. Many other combinations are possible. See the Wiki article Tags for series . Helper functions \u00b6 WeeWX includes a number of helper functions that may be useful when writing templates. $rnd(x, ndigits=None) \u00b6 Round x to ndigits decimal digits. The argument x can be a float or a list of floats . Values of None are passed through. $jsonize(seq) \u00b6 Convert the iterable seq to a JSON string. $to_int(x) \u00b6 Convert x to an integer. The argument x can be of type float or str . Values of None are passed through. $to_bool(x) \u00b6 Convert x to a boolean. The argument x can be of type int , float , or str . If lowercase x is 'true', 'yes', or 'y' the function returns True . If it is 'false', 'no', or 'n' it returns False . Other string values raise a ValueError . In case of a numeric argument, 0 means False , all other values True . $to_list(x) \u00b6 Convert x to a list. If x is already a list, nothing changes. If it is a single value it is converted to a list with this value as the only list element. Values of None are passed through. $getobs(plot_name) \u00b6 For a given plot name, this function will return the set of all observation types used by the plot. For example, consider a plot that is defined in [ImageGenerator] as [[[daytempleaf]]] [[[[leafTemp1]]]] [[[[leafTemp2]]]] [[[[temperature]]]] data_type = outTemp The tag $getobs('daytempleaf') would return the set {'leafTemp1', 'leafTemp2', 'outTemp'} . General tags \u00b6 There are some general tags that do not reflect observation data, but technical information about the template files. They are frequently useful in #if expressions to control how Cheetah processes the template. $encoding \u00b6 Character encoding, to which the file is converted after creation. Possible values are html_entities , strict_ascii , normalized_ascii , and utf-8 . $filename \u00b6 Name of the file to be created including relative path. Can be used to set the canonical URL for search engines. <link rel=\"canonical\" href=\"$station.station_url/$filename\" /> $lang \u00b6 Language code set by the lang option for the report. For example, fr , or gr . $month_name \u00b6 For templates listed under SummaryByMonth , this will contain the localized month name ( e.g. , \" Sep \"). $page \u00b6 The section name from skin.conf where the template is described. $skin \u00b6 The value of option skin in weewx.conf . $SKIN_NAME \u00b6 All skin included with WeeWX, version 4.6 or later, include the tag $SKIN_NAME . For example, for the Seasons skin, $SKIN_NAME would return Seasons . $SKIN_VERSION \u00b6 All skin included with WeeWX, version 4.6 or later, include the tag $SKIN_VERSION , which returns the WeeWX version number of when the skin was installed. Because skins are not touched during the upgrade process, this shows the origin of the skin. $SummaryByDay \u00b6 A list of year-month-day strings ( e.g. , [\"2018-12-31\", \"2019-01-01\"] ) for which a summary-by-day has been generated. The [[SummaryByDay]] section must have been processed before this tag will be valid, otherwise it will be empty. $SummaryByMonth \u00b6 A list of year-month strings ( e.g. , [\"2018-12\", \"2019-01\"] ) for which a summary-by-month has been generated. The [[SummaryByMonth]] section must have been processed before this tag will be valid, otherwise it will be empty. $SummaryByYear \u00b6 A list of year strings ( e.g. , [\"2018\", \"2019\"] ) for which a summary-by-year has been generated. The [[SummaryByYear]] section must have been processed before this tag will be valid, otherwise it will be empty. $year_name \u00b6 For templates listed under SummaryByMonth or SummaryByYear , this will contain the year ( e.g. , \"2018\"). $gettext - Internationalization \u00b6 Pages generated by WeeWX not only contain observation data, but also static text. The WeeWX tag $gettext provides internationalization support for these kinds of texts. It is structured very similarly to the GNU gettext facility , but its implementation is very different. To support internationalization of your template, do not use static text in your templates, but rather use $gettext . Here's how. Suppose you write a skin called \"YourSkin\", and you want to include a headline labelled \"Current Conditions\" in English, \"aktuelle Werte\" in German, \"Conditions actuelles\" in French, etc. Then the template file could contain: <h1>$gettext(\"Current Conditions\")</h1> The section of weewx.conf configuring your skin would look something like this: [StdReport] [[YourSkinReport]] skin = YourSkin lang = fr With lang = fr the report is in French. To get it in English, replace the language code fr by the code for English en . And to get it in German use de . To make this all work, a language file has to be created for each supported language. The language files reside in the lang subdirectory of the skin directory that is defined by the skin option. The file name of the language file is the language code appended by .conf , for example en.conf , de.conf , or fr.conf . The language file has the same layout as skin.conf , i.e. you can put language specific versions of the labels there. Additionally, a section [Texts] can be defined to hold the static texts used in the skin. For the example above the language files would contain the following: en.conf [Texts] \"Current Conditions\" = Current Conditions de.conf [Texts] \"Current Conditions\" = Aktuelle Werte fr.conf [Texts] \"Current Conditions\" = Conditions actuelles While it is not technically necessary, we recommend using the whole English text for the key. This makes the template easier to read, and easier for the translator. In the absence of a translation, it will also be the default, so the skin will still be usable, even if a translation is not available. See the subdirectory SKIN_ROOT/Seasons/lang for examples of language files. $pgettext - Context sensitive lookups \u00b6 A common problem is that the same string may have different translations, depending on its context. For example, in English, the word \"Altitude\" is used to mean both height above sea level, and the angle of a heavenly body from the horizon, but that's not necessarily true in other languages. For example, in Thai, \"\u0e23\u0e30\u0e14\u0e31\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e2a\u0e39\u0e07\" is used to mean the former, \"\u0e2d\u0e31\u0e25\u0e15\u0e34\u0e08\u0e39\u0e14\" the latter. The function pgettext() (the \"p\" stands for particular ) allows you to distinguish between the two. Its semantics are very similar to the GNU and Python versions of the function. Here's an example: <p>$pgettext(\"Geographical\",\"Altitude\"): $station.altitude</p> <p>$pgettext(\"Astronomical\",\"Altitude\"): $almanac.moon.alt</p> The [Texts] section of the language file should then contain a subsection for each context. For example, the Thai language file would include: th.conf [Texts] [[Geographical]] \"Altitude\" = \"\u0e23\u0e30\u0e14\u0e31\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e2a\u0e39\u0e07\" # As in height above sea level [[Astronomical]] \"Altitude\" = \"\u0e2d\u0e31\u0e25\u0e15\u0e34\u0e08\u0e39\u0e14\" # As in angle above the horizon Almanac \u00b6 If module ephem has been installed, then WeeWX can generate extensive almanac information for the Sun, Moon, Venus, Mars, Jupiter, and other heavenly bodies, including their rise, transit and set times, as well as their azimuth and altitude. Other information is also available. Here is an example template: Current time is $current.dateTime #if $almanac.hasExtras Sunrise, transit, sunset: $almanac.sun.rise $almanac.sun.transit $almanac.sun.set Moonrise, transit, moonset: $almanac.moon.rise $almanac.moon.transit $almanac.moon.set Mars rise, transit, set: $almanac.mars.rise $almanac.mars.transit $almanac.mars.set Azimuth, altitude of Mars: $almanac.mars.azimuth $almanac.mars.altitude Next new, full moon: $almanac.next_new_moon; $almanac.next_full_moon Next summer, winter solstice: $almanac.next_summer_solstice; $almanac.next_winter_solstice #else Sunrise, sunset: $almanac.sunrise $almanac.sunset #end if If ephem is installed this would result in: Current time is 03-Sep-2010 11:00 Sunrise, transit, sunset: 06:29 13:05 19:40 Moonrise, transit, moonset: 00:29 08:37 16:39 Mars rise, transit, set: 10:12 15:38 21:04 Azimuth, altitude of Mars: 111\u00b0 08\u00b0 Next new, full moon: 08-Sep-2010 03:29; 23-Sep-2010 02:17 Next summer, winter solstice: 21-Jun-2011 10:16; 21-Dec-2010 15:38 Otherwise, a fallback of basic calculations is used, resulting in: Current time is 29-Mar-2011 09:20 Sunrise, sunset: 06:51 19:30 As shown in the example, you can test whether this extended almanac information is available with the value $almanac.hasExtras . The almanac information falls into three categories: Calendar events Heavenly bodies Functions We will cover each of these separately. Calendar events \u00b6 \"Calendar events\" do not require a heavenly body. They cover things such as the time of the next solstice or next first quarter moon, or the sidereal time. The syntax is: $almanac.next_solstice or $almanac.next_first_quarter_moon or $almanac.sidereal_angle Here is a table of the information that falls into this category: Calendar events previous_equinox next_equinox previous_solstice next_solstice previous_autumnal_equinox next_autumnal_equinox previous_vernal_equinox next_vernal_equinox previous_winter_solstice next_winter_solstice previous_summer_solstice next_summer_solstice previous_new_moon next_new_moon previous_first_quarter_moon next_first_quarter_moon previous_full_moon next_full_moon previous_last_quarter_moon next_last_quarter_moon sidereal_angle Note The tag $almanac.sidereal_angle returns a value in decimal degrees rather than a more customary value from 0 to 24 hours. Heavenly bodies \u00b6 The second category does require a heavenly body. This covers queries such as, \"When does Jupiter rise?\" or, \"When does the sun transit?\" Examples are $almanac.jupiter.rise or $almanac.sun.transit To accurately calculate these times, WeeWX automatically uses the present temperature and pressure to calculate refraction effects. However, you can override these values, which will be necessary if you wish to match the almanac times published by the Naval Observatory as explained in the PyEphem documentation . For example, to match the sunrise time as published by the Observatory, instead of $almanac.sun.rise use $almanac(pressure=0, horizon=-34.0/60.0).sun.rise By setting pressure to zero we are bypassing the refraction calculations and manually setting the horizon to be 34 arcminutes lower than the normal horizon. This is what the Navy uses. If you wish to calculate the start of civil twilight, you can set the horizon to -6 degrees, and also tell WeeWX to use the center of the sun (instead of the upper limb, which it normally uses) to do the calcuation: $almanac(pressure=0, horizon=-6).sun(use_center=1).rise The general syntax is: $almanac(almanac_time=time, ## Unix epoch time lat=latitude, lon=longitude, ## degrees altitude=altitude, ## meters pressure=pressure, ## mbars horizon=horizon, ## degrees temperature=temperature_C ## degrees C ).heavenly_body(use_center=[01]).attribute As you can see, many other properties can be overridden besides pressure and the horizon angle. PyEphem offers an extensive list of objects that can be used for the heavenly_body tag. All the planets and many stars are in the list. The possible values for the attribute tag are listed in the following table, along with the corresponding name used in the PyEphem documentation. Attributes that can be used with heavenly bodies WeeWX name PyEphem name Meaning azimuth az Azimuth altitude alt Altitude astro_ra a_ra Astrometric geocentric right ascension astro_dec a_dec Astrometric geocentric declination geo_ra g_ra Apparent geocentric right ascension topo_ra ra Apparent topocentric right ascension geo_dec g_dec Apparent geocentric declination topo_dec dec Apparent topocentric declination elongation elong Angle with sun radius_size radius Size as an angle hlongitude hlon Astrometric heliocentric longitude hlatitude hlat Astrometric heliocentric latitude sublatitude sublat Geocentric latitude sublongitude sublon Geocentric longitude next_rising next_rising Time body will rise next next_setting next_setting Time body will set next next_transit next_transit Time body will transit next next_antitransit next_antitransit Time body will anti-transit next previous_rising previous_rising Previous time the body rose previous_setting previous_setting Previous time the body sat previous_transit previous_transit Previous time the body transited previous_antitransit previous_antitransit Previous time the body anti-transited rise next_rising Time body will rise next set next_setting Time body will set next transit next_transit Time body will transit next visible N/A How long body will be visible visible_change N/A Change in visibility from previous day Note The tags topo_ra , astro__ra and geo_ra return values in decimal degrees rather than customary values from 0 to 24 hours. Functions \u00b6 There is actually one function in this category: separation . It returns the angular separation between two heavenly bodies. For example, to calculate the angular separation between Venus and Mars you would use: <p>The separation between Venus and Mars is $almanac.separation(($almanac.venus.alt,$almanac.venus.az), ($almanac.mars.alt,$almanac.mars.az))</p> This would result in: The separation between Venus and Mars is 55:55:31.8 Adding new bodies \u00b6 It is possible to extend the WeeWX almanac, adding new bodies that it was not previously aware of. For example, say we wanted to add 433 Eros , the first asteroid visited by a spacecraft. Here is the process: Put the following in the file user/extensions.py : import ephem eros = ephem.readdb(\"433 Eros,e,10.8276,304.3222,178.8165,1.457940,0.5598795,0.22258902,71.2803,09/04.0/2017,2000,H11.16,0.46\") ephem.Eros = eros This does two things: it adds orbital information about 433 Eros to the internal PyEphem database, and it makes that data available under the name Eros (note the capital letter). You can then use 433 Eros like any other body in your templates. For example, to display when it will rise above the horizon: $almanac.eros.rise Wind \u00b6 Wind deserves a few comments because it is stored in the database in two different ways: as a set of scalars, and as a vector of speed and direction. Here are the four wind-related scalars stored in the main archive database: Archive type Meaning Valid contexts windSpeed The average wind speed seen during the archive period. $current, $latest, $hour, $day, $week, $month, $year, $rainyear windDir If software record generation is used, this is the vector average over the archive period. If hardware record generation is used, the value is hardware dependent. windGust The maximum (gust) wind speed seen during the archive period. windGustDir The direction of the wind when the gust was observed. Some wind aggregation types, notably vecdir and vecavg , require wind speed and direction. For these, WeeWX provides a composite observation type called wind . It is stored directly in the daily summaries, but synthesized for aggregations other than multiples of a day. Daily summary type Meaning Valid contexts wind A vector composite of the wind. $hour , $day , $week , $month , $year , $rainyear Any of these can be used in your tags. Here are some examples: Tag Meaning $current.windSpeed The average wind speed over the most recent archive interval. $current.windDir If software record generation is used, this is the vector average over the archive interval. If hardware record generation is used, the value is hardware dependent. $current.windGust The maximum wind speed (gust) over the most recent archive interval. $current.windGustDir The direction of the gust. $day.windSpeed.avg $day.wind.avg The average wind speed since midnight. If the wind blows east at 5 m/s for 2 hours, then west at 5 m/s for 2 hours, the average wind speed is 5 m/s. $day.wind.vecavg The vector average wind speed since midnight. If the wind blows east at 5 m/s for 2 hours, then west at 5 m/s for 2 hours, the vector average wind speed is zero. $day.wind.vecdir The direction of the vector averaged wind speed. If the wind blows northwest at 5 m/s for two hours, then southwest at 5 m/s for two hours, the vector averaged direction is west. $day.windGust.max $day.wind.max The maximum wind gust since midnight. $day.wind.gustdir The direction of the maximum wind gust. $day.windGust.maxtime $day.wind.maxtime The time of the maximum wind gust. $day.windSpeed.max The max average wind speed. The wind is averaged over each of the archive intervals. Then the maximum of these values is taken. Note that this is not the same as the maximum wind gust. $day.windDir.avg Not a very useful quantity. This is the strict, arithmetic average of all the compass wind directions. If the wind blows at 350\u00b0 for two hours then at 10\u00b0 for two hours, then the scalar average wind direction will be 180\u00b0 \u2014 probably not what you expect, nor want. Defining new tags \u00b6 We have seen how you can change a template and make use of the various tags available such as $day.outTemp.max for the maximum outside temperature for the day. But, what if you want to introduce some new data for which no tag is available? If you wish to introduce a static tag, that is, one that will not change with time (such as a Google Analytics tracker ID, or your name), then this is very easy: put it in section [Extras] in the skin configuration file. More information on how to do this can be found there. But, what if you wish to introduce a more dynamic tag, one that requires some calculation, or perhaps uses the database? Simply putting it in the [Extras] section won't do, because then it cannot change. The answer is to write a search list extension . Complete directioins on how to do this are in the document Writing search list extensions .","title":"The Cheetah generator"},{"location":"custom/cheetah-generator/#the-cheetah-generator","text":"File generation is done using the Cheetah templating engine, which processes a template , replacing any symbolic tags , then produces an output file. Typically, it runs after each new archive record (usually about every five minutes), but it can also run on demand using the utility wee_reports . The Cheetah engine is very powerful, essentially letting you have the full semantics of Python available in your templates. As this would make the templates incomprehensible to anyone but a Python programmer, WeeWX adopts a very small subset of its power. The Cheetah generator is controlled by the configuration options in the section [CheetahGenerator] of the skin configuration file. Let's take a look at how this works.","title":"The Cheetah generator"},{"location":"custom/cheetah-generator/#which-files-get-processed","text":"Each template file is named something like D/F.E.tmpl , where D is the (optional) directory the template sits in and will also be the directory the results will be put in, and F.E is the generated file name. So, given a template file with name Acme/index.html.tmpl , the results will be put in HTML_ROOT/Acme/index.html . The configuration for a group of templates will look something like this: [CheetahGenerator] [[index]] template = index.html.tmpl [[textfile]] template = filename.txt.tmpl [[xmlfile]] template = filename.xml.tmpl There can be only one template in each block. In most cases, the block name does not matter \u2014 it is used only to isolate each template. However, there are four block names that have special meaning: SummaryByDay , SummaryByMonth , SummaryByYear , and ToDate .","title":"Which files get processed?"},{"location":"custom/cheetah-generator/#specifying-template-files","text":"By way of example, here is the [CheetahGenerator] section from the skin.conf for the skin Seasons . 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 [CheetahGenerator] # The CheetahGenerator creates files from templates. This section # specifies which files will be generated from which template. # Possible encodings include 'html_entities', 'strict_ascii', 'normalized_ascii', # as well as those listed in https://docs.python.org/3/library/codecs.html#standard-encodings encoding = html_entities [[SummaryByMonth]] # Reports that summarize \"by month\" [[[NOAA_month]]] encoding = normalized_ascii template = NOAA/NOAA-%Y-%m.txt.tmpl [[SummaryByYear]] # Reports that summarize \"by year\" [[[NOAA_year]]] encoding = normalized_ascii template = NOAA/NOAA-%Y.txt.tmpl [[ToDate]] # Reports that show statistics \"to date\", such as day-to-date, # week-to-date, month-to-date, etc. [[[index]]] template = index.html.tmpl [[[statistics]]] template = statistics.html.tmpl [[[telemetry]]] template = telemetry.html.tmpl [[[tabular]]] template = tabular.html.tmpl [[[celestial]]] template = celestial.html.tmpl # Uncomment the following to have WeeWX generate a celestial page only once an hour: # stale_age = 3600 [[[RSS]]] template = rss.xml.tmpl The skin contains three different kinds of generated output: Summary by Month (line 9). The skin uses SummaryByMonth to produce NOAA summaries, one for each month, as a simple text file. Summary by Year (line 15). The skin uses SummaryByYear to produce NOAA summaries, one for each year, as a simple text file. Section \"To Date\" (line 21). The skin produces an HTML index.html page, as well as HTML files for detailed statistics, telemetry, and celestial information. It also includes a master page ( tabular.html ) in which NOAA information is displayed. All these files are HTML. Because the option encoding = html_entities appears directly under [CheetahGenerator] , this will be the default encoding of the generated files unless explicitly overridden. We see an example of this under [SummaryByMonth] and [SummaryByYear] , which override the default by specifying option normalized_ascii (which replaces accented characters with a non-accented analog). Other than SummaryByMonth and SummaryByYear , the section names are arbitrary. The section [[ToDate]] could just as well have been called [[files_to_date]] , and the sections [[[index]]] , [[[statistics]]] , and [[[telemetry]]] could just as well have been called [[[tom]]] , [[[dick]]] , and [[[harry]]] .","title":"Specifying template files"},{"location":"custom/cheetah-generator/#summarybyyear","text":"Use SummaryByYear to generate a set of files, one file per year. The name of the template file should contain a strftime() code for the year; this will be replaced with the year of the data in the file. [CheetahGenerator] [[SummaryByYear]] # Reports that summarize \"by year\" [[[NOAA_year]]] encoding = normalized_ascii template = NOAA/NOAA-%Y.txt.tmpl The template NOAA/NOAA-%Y.txt.tmpl might look something like this: SUMMARY FOR YEAR $year.dateTime MONTHLY TEMPERATURES AND HUMIDITIES: #for $record in $year.records $record.dateTime $record.outTemp $record.outHumidity #end for","title":"[[SummaryByYear]]"},{"location":"custom/cheetah-generator/#summarybymonth","text":"Use SummaryByMonth to generate a set of files, one file per month. The name of the template file should contain a strftime() code for year and month; these will be replaced with the year and month of the data in the file. [CheetahGenerator] [[SummaryByMonth]] # Reports that summarize \"by month\" [[[NOAA_month]]] encoding = normalized_ascii template = NOAA/NOAA-%Y-%m.txt.tmpl The template NOAA/NOAA-%Y-%m.txt.tmpl might look something like this: SUMMARY FOR MONTH $month.dateTime DAILY TEMPERATURES AND HUMIDITIES: #for $record in $month.records $record.dateTime $record.outTemp $record.outHumidity #end for","title":"[[SummaryByMonth]]"},{"location":"custom/cheetah-generator/#summarybyday","text":"While the Seasons skin does not make use of it, there is also a SummaryByDay capability. As the name suggests, this results in one file per day. The name of the template file should contain a strftime() code for the year, month and day; these will be replaced with the year, month, and day of the data in the file. [CheetahGenerator] [[SummaryByDay]] # Reports that summarize \"by day\" [[[NOAA_day]]] encoding = normalized_ascii template = NOAA/NOAA-%Y-%m-%d.txt.tmpl The template NOAA/NOAA-%Y-%m-%d.txt.tmpl might look something like this: SUMMARY FOR DAY $day.dateTime HOURLY TEMPERATURES AND HUMIDITIES: #for $record in $day.records $record.dateTime $record.outTemp $record.outHumidity #end for Note This can create a lot of files \u2014 one per day. If you have 3 years of records, this would be more than 1,000 files!","title":"[[SummaryByDay]]"},{"location":"custom/cheetah-generator/#tags","text":"If you look inside a template, you will see it makes heavy use of tags . As the Cheetah generator processes the template, it replaces each tag with an appropriate value and, sometimes, a label. This section discusses the details of how that happens. If there is a tag error during template generation, the error will show up in the log file. Many errors are obvious \u2014 Cheetah will display a line number and list the template file in which the error occurred. Unfortunately, in other cases, the error message can be very cryptic and not very useful. So make small changes and test often. Use the utility wee_reports to speed up the process. Here are some examples of tags: $current.outTemp $month.outTemp.max $month.outTemp.maxtime These code the current outside temperature, the maximum outside temperature for the month, and the time that maximum occurred, respectively. So a template file that contains: < html > < head > < title > Current conditions </ title > </ head > < body > < p > Current temperature = $current.outTemp </ p > < p > Max for the month is $month.outTemp.max, which occurred at $month.outTemp.maxtime </ p > </ body > </ html > would be all you need for a very simple HTML page that would display the text (assuming that the unit group for temperature is degree_F ): Current temperature = 51.0\u00b0F Max for the month is 68.8\u00b0F, which occurred at 07-Oct-2009 15:15 The format that was used to format the temperature ( 51.0 ) is specified in section [Units][[StringFormat]] . The unit label \u00b0F is from section [Units][[Labels]] , while the time format is from [Units][[TimeFormats]] . As we saw above, the tags can be very simple: # Output max outside temperature using an appropriate format and label: $month.outTemp.max Most of the time, tags will \"do the right thing\" and are all you will need. However, WeeWX offers extensive customization of the tags for specialized applications such as XML RSS feeds, or rigidly formatted reports (such as the NOAA reports). This section specifies the various tag options available. There are two different versions of the tags, depending on whether the data is \"current\", or an aggregation over time. However, both versions are similar.","title":"Tags"},{"location":"custom/cheetah-generator/#time-period-current","text":"Time period $current represents a current observation . An example would be the current barometric pressure: $current.barometer Formally, for current observations, WeeWX first looks for the observation type in the record emitted by the NEW_ARCHIVE_RECORD event. This is generally the data emitted by the station console, augmented by any derived variables ( e.g. , wind chill) that you might have specified. If the observation type cannot be found there, the most recent record in the database will be searched. If it still cannot be found, WeeWX will attempt to calculate it using the xtypes system . The most general tag for a \"current\" observation looks like: $current(timestamp=some_time, max_delta=delta_t,data_binding=binding_name) .obstype [.unit_conversion] [.rounding] [.formatting] Where: timestamp is a timestamp that you want to display in unix epoch time. It is optional, The default is to display the value for the current time. max_delta is the largest acceptable time difference (in seconds) between the time specified by timestamp and a record's timestamp in the database. By default, it is zero, which means there must be an exact match with a specified time for a record to be retrieved. If it were 30 , then a record up to 30 seconds away would be acceptable. data_binding is a binding name to a database. An example would be wx_binding . See the section Binding names for more details. obstype is an observation type , such as barometer . This type must appear either in the current record, as a field in the database, or can be derived from some combination of the two as an XType . unit_conversion is an optional unit conversion tag. If provided, the results will be converted into the specified units, otherwise the default units specified in the skin configuration file (in section [Units][[Groups]] ) will be used. See the section Unit conversion options . rounding is an optional rounding tag. If provided, it rounds the result to a fixed number of decimal digits. See the section Rounding options . formatting is an optional formatting tag. If provided, it controls how the value will appear. See the section Formatting options .","title":"Time period $current"},{"location":"custom/cheetah-generator/#time-period-latest","text":"Time period $latest is very similar to $current , except that it uses the last available timestamp in a database. Usually, $current and $latest are the same, but if a data binding points to a remote database, they may not be. See the section Using multiple bindings for an example where this happened.","title":"Time period $latest"},{"location":"custom/cheetah-generator/#aggregation-periods","text":"Aggregation periods is the other kind of tag. For example, $week.rain.sum represents an aggregation over time , using a certain aggregation type . In this example, the aggregation time is a week, and the aggregation type is summation. So, this tag represents the total rainfall over a week. The most general tag for an aggregation over time looks like: $period(data_binding=binding_name[, ago=delta]) .obstype .aggregation [.unit_conversion] [.rounding] [.formatting] Where: period is the aggregation period over which the aggregation is to be done. Possible choices are listed in the aggregation periods table . data_binding is a binding name to a database. An example would be wx_binding . See the section Binding names for more details. ago is a keyword that depends on the aggregation period. For example, for week, it would be weeks_ago , for day, it would be days_ago , etc. delta is an integer indicating which aggregation period is desired. For example $week(weeks_ago=1) indicates last week, $day(days_ago=2) would be the day-before-yesterday, etc . The default is zero: that is, this aggregation period. obstype is an observation type . This is generally any observation type that appears in the database (such as outTemp or windSpeed ), as well a most XTypes . However, not all aggregations are supported for all types. aggregation is an aggregation type . If you ask for $month.outTemp.avg you are asking for the average outside temperature for the month. Possible aggregation types are given in the reference Aggregation types . unit_conversion is an optional unit conversion tag. If provided, the results will be converted into the specified units, otherwise the default units specified in the skin configuration file (in section [Units][[Groups]] ) will be used. See the section Unit conversion options . rounding is an optional rounding tag. If provided, it rounds the result to a fixed number of decimal digits. See the section Rounding options . formatting is an optional formatting tag. If provided, it controls how the value will appear. See the section Formatting options . There are several aggregation periods that can be used: Aggregation periods Aggregation period Meaning Example Meaning of example $hour This hour. $hour.outTemp.maxtime The time of the max temperature this hour. $day Today (since midnight). $day.outTemp.max The max temperature since midnight $yesterday Yesterday. Synonym for $day($days_ago=1) . $yesterday.outTemp.maxtime The time of the max temperature yesterday. $week This week. The start of the week is set by option week_start . $week.outTemp.max The max temperature this week. $month This month (since the first of the month). $month.outTemp.min The minimum temperature this month. $year This year (since 1-Jan). $year.outTemp.max The max temperature since the start of the year. $rainyear This rain year. The start of the rain year is set by option rain_year_start . $rainyear.rain.sum The total rainfall for this rain year. $alltime All records in the database given by binding_name . $alltime.outTemp.max The maximum outside temperature in the default database. The \" ago \" parameters can be useful for statistics farther in the past. Here are some examples: Aggregation period Example Meaning $hour(hours_ago= h ) $hour(hours_ago=1).outTemp.avg The average temperature last hour (1 hour ago). $day(days_ago= d ) $day(days_ago=2).outTemp.avg The average temperature day before yesterday (2 days ago). $week(weeks_ago= w ) $week(weeks_ago=1).outTemp.max The maximum temperature last week. $month(months_ago= m ) $month(months_ago=1).outTemp.max The maximum temperature last month. $year(years_ago= y ) $year(years_ago=1).outTemp.max The maximum temperature last year.","title":"Aggregation periods"},{"location":"custom/cheetah-generator/#unit-conversion-options","text":"The option unit_conversion can be used with either current observations or with aggregations. If supplied, the results will be converted to the specified units. For example, if you have set group_pressure to inches of mercury ( inHg ), then the tag Today's average pressure=$day.barometer.avg would normally give a result such as Today's average pressure=30.05 inHg However, if you add mbar to the end of the tag, Today's average pressure=$day.barometer.avg.mbar then the results will be in millibars: Today's average pressure=1017.5 mbar If an inappropriate or nonsense conversion is asked for, e.g. , Today's minimum pressure in mbars: $day.barometer.min.mbar or in degrees C: $day.barometer.min.degree_C or in foobar units: $day.barometer.min.foobar then the offending tag(s) will be put in the output: Today's minimum pressure in mbars: 1015.3 or in degrees C: $day.barometer.min.degree_C or in foobar units: $day.barometer.min.foobar","title":"Unit conversion options"},{"location":"custom/cheetah-generator/#rounding-options","text":"The data in the resultant tag can be optionally rounded to a fixed number of decimal digits. This is useful when emitting raw data or JSON strings. It should not be used with formatted data. In that case, using a format string would be a better choice. The structure of the option is .round(ndigits=None) where ndigits is the number of decimal digits to retain. If None (the default), then all digits will be retained.","title":"Rounding options"},{"location":"custom/cheetah-generator/#formatting-options","text":"A variety of options are available to you to customize the formatting of the final observation value. They can be used whenever a tag results in a ValueHelper , which is almost all the time. This table summarizes the options: Formatting options Formatting option Comment .format( args ) Format the value as a string, according to a set of optional args . .long_form( args ) Format delta times in the \"long form\", according to a set of optional args . .ordinal_compass Format the value as a compass ordinals ( e.g. , \"SW\"), useful for wind directions. The ordinal abbreviations are set by option directions in the skin configuration file. .json Format the value as a JSON string . .raw Return the value \"as is\", without being converted to a string and without any formatting applied. This can be useful for doing arithmetic directly within the templates. You must be prepared to deal with a potential value of None .","title":"Formatting options"},{"location":"custom/cheetah-generator/#format","text":"The results of a tag can be optionally formatted using option format() . It has the formal structure: format(format_string=None, None_string=None, add_label=True, localize=True) Here is the meaning of each of the optional arguments: Optional arguments for format() Optional argument Comment format_string If set, use the supplied string to format the value. Otherwise, if set to None , then an appropriate value from [Units][[StringFormats]] will be used. None_string Should the observation value be NONE , then use the supplied string (typically, something like \"N/A\"). If None_string is set to None , then the value for NONE in [Units][[StringFormats]] will be used. add_label If set to True (the default), then a unit label ( e.g. , \u00b0F) from skin.conf will be attached to the end. Otherwise, it will be left out. localize If set to True (the default), then localize the results. Otherwise, do not. If you're willing to honor the ordering of the arguments, the argument name can be omitted.","title":"format()"},{"location":"custom/cheetah-generator/#long_form","text":"The option long_form() , can be used to format delta times . A delta time is the difference between two times, for example, the amount of uptime (the difference between start up and the current time). By default, this will be formatted as the number of elapsed seconds. For example, a template with the following <p>WeeWX has been up $station.uptime</p> will result in WeeWX has been up 101100 seconds The \"long form\" breaks the time down into constituent time elements. For example, <p>WeeWX has been up $station.uptime.long_form</p> results in WeeWX has been up 1 day, 4 hours, 5 minutes The option long_form() has the formal structure long_form(format_string=None, None_string=None) Here is the meaning of each of the optional arguments: Optional arguments for long_form() Optional argument Comment format_string Use the supplied string to format the value. None_string Should the observation value be NONE , then use the supplied string to format the value (typically, something like \"N/A\"). The argument format_string uses special symbols to represent its constitutent components. Here's what they mean: Symbol Meaning day The number of days hour The number of hours minute The number of minutes second The number of seconds day_label The label used for days hour_label The label used for hours minute_label The label used for minutes second_label The label used for seconds Putting this together, the example above could be written <p>WeeWX has been up $station.uptime.long_form(format_string=\"%(day)d%(day_label)s, %(hour)d%(hour_label)s, %(minute)d%(minute_label)s\")</p>","title":"long_form()"},{"location":"custom/cheetah-generator/#formatting-examples","text":"This section gives a number of example tags, and their expected output. The following values are assumed: Values used in the formatting examples Observation Value outTemp 45.2\u00b0F UV None windDir 138\u00b0 dateTime 1270250700 uptime 101100 seconds Here are the examples: Formatting options with expected results Tag Result Result type Comment $current.outTemp 45.2\u00b0F str String formatting from [Units][[StringFormats]] . Label from [Units][[Labels]] . $current.outTemp.format 45.2\u00b0F str Same as the $current.outTemp . $current.outTemp.format() 45.2\u00b0F str Same as the $current.outTemp . $current.outTemp.format(format_string=\"%.3f\") 45.200\u00b0F str Specified string format used; label from [Units][[Labels]] . $current.outTemp.format(\"%.3f\") 45.200\u00b0F str As above, except a positional argument, instead of the named argument, is being used. $current.outTemp.format(add_label=False) 45.2 str No label. The string formatting is from [Units][[StringFormats]] . $current.UV N/A str The string specified by option NONE in [Units][[StringFormats]] . $current.UV.format(None_string=\"No UV\") No UV str Specified None_string is used. $current.windDir 138\u00b0 str Formatting is from option degree_compass in [Units][[StringFormats]] . $current.windDir.ordinal_compass SW str Ordinal direction from section [Units][[Ordinates]] is being substituted. $current.dateTime 02-Apr-2010 16:25 str Time formatting from [Units][[TimeFormats]] is being used. $current.dateTime.format(format_string=\"%H:%M\") 16:25 str Specified time format used. $current.dateTime.format(\"%H:%M\") 16:25 str As above, except a positional argument, instead of the named argument, is being used. $current.dateTime.raw 1270250700 int Raw Unix epoch time. The result is an integer . $current.outTemp.raw 45.2 float Raw float value. The result is a float . $current.outTemp.degree_C.raw 7.33333333 float Raw float value in degrees Celsius. The result is a float . $current.outTemp.degree_C.json 7.33333333 str Value in degrees Celsius, converted to a JSON string. $current.outTemp.degree_C.round(2).json 7.33 str Value in degrees Celsius, rounded to two decimal digits, then converted to a JSON string. $station.uptime 101100 seconds str WeeWX uptime. $station.uptime.hour 28.1 hours str WeeWX uptime, with unit conversion to hours. $station.uptime.long_form 1 day, 4 hours, 5 minutes str WeeWX uptime with \"long form\" formatting.","title":"Formatting examples"},{"location":"custom/cheetah-generator/#start-end-and-datetime","text":"While not an observation type, in many ways the time of an observation, dateTime , can be treated as one. A tag such as $current.dateTime represents the current time (more properly, the time as of the end of the last archive interval) and would produce something like 01/09/2010 12:30:00 Like true observation types, explicit formats can be specified, except that they require a strftime() time format , rather than a string format . For example, adding a format descriptor like this: $current.dateTime.format(\"%d-%b-%Y %H:%M\") produces 09-Jan-2010 12:30 For aggregation periods , such as $month , you can request the start , end , or length of the period, by using suffixes .start , .end , or .length , respectively. For example, The current month runs from $month.start to $month.end and has $month.length.format(\"%(day)d %(day_label)s\"). results in The current month runs from 01/01/2010 12:00:00 AM to 02/01/2010 12:00:00 AM and has 31 days. The returned string values will always be in local time . However, if you ask for the raw value $current.dateTime.raw the returned value will be in Unix Epoch Time (number of seconds since 00:00:00 UTC 1 Jan 1970, i.e. , a large number), which you must convert yourself. It is guaranteed to never be None , so you don't worry have to worry about handling a None value.","title":"start, end, and dateTime"},{"location":"custom/cheetah-generator/#tag-trend","text":"The tag $trend is available for time trends, such as changes in barometric pressure. Here are some examples: Tag Results $trend.barometer -.05 inHg $trend(time_delta=3600).barometer -.02 inHg $trend.outTemp 1.1 \u00b0C $trend.time_delta 10800 secs $trend.time_delta.hour 3 hrs Note how you can explicitly specify a time interval in the tag itself (2nd row in the table above). If you do not specify a value, then a default time interval, set by option time_delta in the skin configuration file, will be used. This value can be retrieved by using the syntax $trend.time_delta (4th row in the table). For example, the template expression The barometer trend over $trend.time_delta.hour is $trend.barometer.format(\"%+.2f\") would result in The barometer trend over 3 hrs is +.03 inHg.","title":"Tag $trend"},{"location":"custom/cheetah-generator/#tag-span","text":"The tag $span allows aggregation over a user defined period up to and including the current time. Its most general form looks like: $span([data_binding=binding_name][,delta=delta][,boundary=(None|'midnight')]) .obstype .aggregation [.unit_conversion] [.formatting] Where: data_binding is a binding name to a database. An example would be wx_binding . See the section Binding names for more details. delta is one or more comma separated delta settings from the table below. If more than one delta setting is included then the period used for the aggregate is the sum of the individual delta settings. If no delta setting is included, or all included delta settings are zero, the returned aggregate is based on the current obstype only. boundary is an optional specifier that can force the starting time to a time boundary. If set to 'midnight', then the starting time will be at the previous midnight. If left out, then the start time will be the sum of the optional deltas. obstype is an observation type , such as outTemp . aggregation is an aggregation type . If you ask for $month.outTemp.avg you are asking for the average outside temperature for the month. Possible aggregation types are given in the reference Aggregation types . unit_conversion is an optional unit conversion tag. If provided, the results will be converted into the specified units, otherwise the default units specified in the skin configuration file (in section [Units][[Groups]] ) will be used. See the section Unit conversion options . formatting is an optional formatting tag. If provided, it controls how the value will appear. See the section Formatting options . There are several delta settings that can be used: Delta Setting Example Meaning time_delta= seconds $span(time_delta=1800).outTemp.avg The average temperature over the last immediate 30 minutes (1800 seconds). hour_delta= hours $span(hour_delta=6).outTemp.avg The average temperature over the last immediate 6 hours. day_delta= days $span(day_delta=1).rain.sum The total rainfall over the last immediate 24 hours. week_delta= weeks $span(week_delta=2).barometer.max The maximum barometric pressure over the last immediate 2 weeks. For example, the template expressions The total rainfall over the last 30 hours is $span($hour_delta=30).rain.sum and The total rainfall over the last 30 hours is $span($hour_delta=6, $day_delta=1).rain.sum would both result in The total rainfall over the last 30 hours is 1.24 in","title":"Tag $span"},{"location":"custom/cheetah-generator/#tag-unit","text":"The type, label, and string formats for all units are also available, allowing you to do highly customized labels: Tag Results $unit.unit_type.outTemp degree_C $unit.label.outTemp \u00b0C $unit.format.outTemp %.1f For example, the tag $day.outTemp.max.format(add_label=False)$unit.label.outTemp would result in 21.2\u00b0C (assuming metric values have been specified for group_temperature ), essentially reproducing the results of the simpler tag $day.outTemp.max .","title":"Tag $unit"},{"location":"custom/cheetah-generator/#tag-obs","text":"The labels used for the various observation types are available using tag $obs . These are basically the values given in the skin dictionary, section [Labels][[Generic]] . Tag Results $obs.label.outTemp Outside Temperature $obs.label.UV UV Index","title":"Tag $obs"},{"location":"custom/cheetah-generator/#iteration","text":"It is possible to iterate over the following: Tag suffix Results .records Iterate over every record .hours Iterate by hours .days Iterate by days .months Iterate by months .years Iterate by years .spans(interval= seconds ) Iterate by custom length spans. The default interval is 10800 seconds (3 hours). The spans will align to local time boundaries. The following template uses a Cheetah for loop to iterate over all months in a year, printing out each month's min and max temperature. The iteration loop is highlighted . Min, max temperatures by month #for $month in $year.months $month.dateTime.format(\"%B\"): Min, max temperatures: $month.outTemp.min $month.outTemp.max #end for The result is: Min, max temperatures by month January: Min, max temperatures: 30.1\u00b0F 51.5\u00b0F February: Min, max temperatures: 24.4\u00b0F 58.6\u00b0F March: Min, max temperatures: 27.3\u00b0F 64.1\u00b0F April: Min, max temperatures: 33.2\u00b0F 52.5\u00b0F May: Min, max temperatures: N/A N/A June: Min, max temperatures: N/A N/A July: Min, max temperatures: N/A N/A August: Min, max temperatures: N/A N/A September: Min, max temperatures: N/A N/A October: Min, max temperatures: N/A N/A November: Min, max temperatures: N/A N/A December: Min, max temperatures: N/A N/A The following template again uses a Cheetah for loop, this time to iterate over 3-hour spans over the last 24 hours, displaying the averages in each span. The iteration loop is highlighted . < p > 3 hour averages over the last 24 hours </ p > < table > < tr > < td > Date/time </ td >< td > outTemp </ td >< td > outHumidity </ td > </ tr > #for $time_band in $span($day_delta=1).spans(interval=10800) < tr > < td > $time_band.start.format(\"%d/%m %H:%M\") </ td > < td > $time_band.outTemp.avg </ td > < td > $time_band.outHumidity.avg </ td > </ tr > #end for </ table > The result is: 3 hour averages over the last 24 hours Date/time outTemp outHumidity 21/01 18:50 33.4\u00b0F 95% 21/01 21:50 32.8\u00b0F 96% 22/01 00:50 33.2\u00b0F 96% 22/01 03:50 33.2\u00b0F 96% 22/01 06:50 33.8\u00b0F 96% 22/01 09:50 36.8\u00b0F 95% 22/01 12:50 39.4\u00b0F 91% 22/01 15:50 35.4\u00b0F 93% See the NOAA template files NOAA/NOAA-YYYY.txt.tmpl and NOAA/NOAA-YYYY-MM.txt.tmpl , both included in the Seasons skin, for other examples using iteration and explicit formatting.","title":"Iteration"},{"location":"custom/cheetah-generator/#comprehensive-example","text":"This example is designed to put together a lot of the elements described above, including iteration, aggregation period starts and ends, formatting, and overriding units. Click here for the results. < html > < head > < style > td { border : 1 px solid #cccccc ; padding : 5 px ; } </ style > </ head > < body > < table border = 1 style = \"border-collapse:collapse;\" > < tr style = \"font-weight:bold\" > < td > Time interval </ td > < td > Max temperature </ td > < td > Time </ td > </ tr > #for $hour in $day($days_ago=1).hours < tr > < td > $hour.start.format(\"%H:%M\")-$hour.end.format(\"%H:%M\") </ td > < td > $hour.outTemp.max ($hour.outTemp.max.degree_C) </ td > < td > $hour.outTemp.maxtime.format(\"%H:%M\") </ td > </ tr > #end for < caption > < p > Hourly max temperatures yesterday < br /> $day($days_ago=1).start.format(\"%d-%b-%Y\") </ p > </ caption > </ table > </ body > </ html >","title":"Comprehensive example"},{"location":"custom/cheetah-generator/#support-for-series","text":"Note This is an experimental API that could change. WeeWX V4.5 introduced some experimental tags for producing series of data, possibly aggregated. This can be useful for creating the JSON data needed for JavaScript plotting packages, such as HighCharts , Google Charts , or C3.js . For example, suppose you need the maximum temperature for each day of the month. This tag $month.outTemp.series(aggregate_type='max', aggregate_interval='1d', time_series='start').json would produce the following: [[1614585600, 58.2], [1614672000, 55.8], [1614758400, 59.6], [1614844800, 57.8], ... ] This is a list of (time, temperature) for each day of the month, in JSON, easily consumed by many of these plotting packages. Many other combinations are possible. See the Wiki article Tags for series .","title":"Support for series"},{"location":"custom/cheetah-generator/#helper-functions","text":"WeeWX includes a number of helper functions that may be useful when writing templates.","title":"Helper functions"},{"location":"custom/cheetah-generator/#rndx-ndigitsnone","text":"Round x to ndigits decimal digits. The argument x can be a float or a list of floats . Values of None are passed through.","title":"$rnd(x, ndigits=None)"},{"location":"custom/cheetah-generator/#jsonizeseq","text":"Convert the iterable seq to a JSON string.","title":"$jsonize(seq)"},{"location":"custom/cheetah-generator/#to_intx","text":"Convert x to an integer. The argument x can be of type float or str . Values of None are passed through.","title":"$to_int(x)"},{"location":"custom/cheetah-generator/#to_boolx","text":"Convert x to a boolean. The argument x can be of type int , float , or str . If lowercase x is 'true', 'yes', or 'y' the function returns True . If it is 'false', 'no', or 'n' it returns False . Other string values raise a ValueError . In case of a numeric argument, 0 means False , all other values True .","title":"$to_bool(x)"},{"location":"custom/cheetah-generator/#to_listx","text":"Convert x to a list. If x is already a list, nothing changes. If it is a single value it is converted to a list with this value as the only list element. Values of None are passed through.","title":"$to_list(x)"},{"location":"custom/cheetah-generator/#getobsplot_name","text":"For a given plot name, this function will return the set of all observation types used by the plot. For example, consider a plot that is defined in [ImageGenerator] as [[[daytempleaf]]] [[[[leafTemp1]]]] [[[[leafTemp2]]]] [[[[temperature]]]] data_type = outTemp The tag $getobs('daytempleaf') would return the set {'leafTemp1', 'leafTemp2', 'outTemp'} .","title":"$getobs(plot_name)"},{"location":"custom/cheetah-generator/#general-tags","text":"There are some general tags that do not reflect observation data, but technical information about the template files. They are frequently useful in #if expressions to control how Cheetah processes the template.","title":"General tags"},{"location":"custom/cheetah-generator/#encoding","text":"Character encoding, to which the file is converted after creation. Possible values are html_entities , strict_ascii , normalized_ascii , and utf-8 .","title":"$encoding"},{"location":"custom/cheetah-generator/#filename","text":"Name of the file to be created including relative path. Can be used to set the canonical URL for search engines. <link rel=\"canonical\" href=\"$station.station_url/$filename\" />","title":"$filename"},{"location":"custom/cheetah-generator/#lang","text":"Language code set by the lang option for the report. For example, fr , or gr .","title":"$lang"},{"location":"custom/cheetah-generator/#month_name","text":"For templates listed under SummaryByMonth , this will contain the localized month name ( e.g. , \" Sep \").","title":"$month_name"},{"location":"custom/cheetah-generator/#page","text":"The section name from skin.conf where the template is described.","title":"$page"},{"location":"custom/cheetah-generator/#skin","text":"The value of option skin in weewx.conf .","title":"$skin"},{"location":"custom/cheetah-generator/#skin_name","text":"All skin included with WeeWX, version 4.6 or later, include the tag $SKIN_NAME . For example, for the Seasons skin, $SKIN_NAME would return Seasons .","title":"$SKIN_NAME"},{"location":"custom/cheetah-generator/#skin_version","text":"All skin included with WeeWX, version 4.6 or later, include the tag $SKIN_VERSION , which returns the WeeWX version number of when the skin was installed. Because skins are not touched during the upgrade process, this shows the origin of the skin.","title":"$SKIN_VERSION"},{"location":"custom/cheetah-generator/#summarybyday_1","text":"A list of year-month-day strings ( e.g. , [\"2018-12-31\", \"2019-01-01\"] ) for which a summary-by-day has been generated. The [[SummaryByDay]] section must have been processed before this tag will be valid, otherwise it will be empty.","title":"$SummaryByDay"},{"location":"custom/cheetah-generator/#summarybymonth_1","text":"A list of year-month strings ( e.g. , [\"2018-12\", \"2019-01\"] ) for which a summary-by-month has been generated. The [[SummaryByMonth]] section must have been processed before this tag will be valid, otherwise it will be empty.","title":"$SummaryByMonth"},{"location":"custom/cheetah-generator/#summarybyyear_1","text":"A list of year strings ( e.g. , [\"2018\", \"2019\"] ) for which a summary-by-year has been generated. The [[SummaryByYear]] section must have been processed before this tag will be valid, otherwise it will be empty.","title":"$SummaryByYear"},{"location":"custom/cheetah-generator/#year_name","text":"For templates listed under SummaryByMonth or SummaryByYear , this will contain the year ( e.g. , \"2018\").","title":"$year_name"},{"location":"custom/cheetah-generator/#gettext-internationalization","text":"Pages generated by WeeWX not only contain observation data, but also static text. The WeeWX tag $gettext provides internationalization support for these kinds of texts. It is structured very similarly to the GNU gettext facility , but its implementation is very different. To support internationalization of your template, do not use static text in your templates, but rather use $gettext . Here's how. Suppose you write a skin called \"YourSkin\", and you want to include a headline labelled \"Current Conditions\" in English, \"aktuelle Werte\" in German, \"Conditions actuelles\" in French, etc. Then the template file could contain: <h1>$gettext(\"Current Conditions\")</h1> The section of weewx.conf configuring your skin would look something like this: [StdReport] [[YourSkinReport]] skin = YourSkin lang = fr With lang = fr the report is in French. To get it in English, replace the language code fr by the code for English en . And to get it in German use de . To make this all work, a language file has to be created for each supported language. The language files reside in the lang subdirectory of the skin directory that is defined by the skin option. The file name of the language file is the language code appended by .conf , for example en.conf , de.conf , or fr.conf . The language file has the same layout as skin.conf , i.e. you can put language specific versions of the labels there. Additionally, a section [Texts] can be defined to hold the static texts used in the skin. For the example above the language files would contain the following: en.conf [Texts] \"Current Conditions\" = Current Conditions de.conf [Texts] \"Current Conditions\" = Aktuelle Werte fr.conf [Texts] \"Current Conditions\" = Conditions actuelles While it is not technically necessary, we recommend using the whole English text for the key. This makes the template easier to read, and easier for the translator. In the absence of a translation, it will also be the default, so the skin will still be usable, even if a translation is not available. See the subdirectory SKIN_ROOT/Seasons/lang for examples of language files.","title":"$gettext - Internationalization"},{"location":"custom/cheetah-generator/#pgettext-context-sensitive-lookups","text":"A common problem is that the same string may have different translations, depending on its context. For example, in English, the word \"Altitude\" is used to mean both height above sea level, and the angle of a heavenly body from the horizon, but that's not necessarily true in other languages. For example, in Thai, \"\u0e23\u0e30\u0e14\u0e31\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e2a\u0e39\u0e07\" is used to mean the former, \"\u0e2d\u0e31\u0e25\u0e15\u0e34\u0e08\u0e39\u0e14\" the latter. The function pgettext() (the \"p\" stands for particular ) allows you to distinguish between the two. Its semantics are very similar to the GNU and Python versions of the function. Here's an example: <p>$pgettext(\"Geographical\",\"Altitude\"): $station.altitude</p> <p>$pgettext(\"Astronomical\",\"Altitude\"): $almanac.moon.alt</p> The [Texts] section of the language file should then contain a subsection for each context. For example, the Thai language file would include: th.conf [Texts] [[Geographical]] \"Altitude\" = \"\u0e23\u0e30\u0e14\u0e31\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e2a\u0e39\u0e07\" # As in height above sea level [[Astronomical]] \"Altitude\" = \"\u0e2d\u0e31\u0e25\u0e15\u0e34\u0e08\u0e39\u0e14\" # As in angle above the horizon","title":"$pgettext - Context sensitive lookups"},{"location":"custom/cheetah-generator/#almanac","text":"If module ephem has been installed, then WeeWX can generate extensive almanac information for the Sun, Moon, Venus, Mars, Jupiter, and other heavenly bodies, including their rise, transit and set times, as well as their azimuth and altitude. Other information is also available. Here is an example template: Current time is $current.dateTime #if $almanac.hasExtras Sunrise, transit, sunset: $almanac.sun.rise $almanac.sun.transit $almanac.sun.set Moonrise, transit, moonset: $almanac.moon.rise $almanac.moon.transit $almanac.moon.set Mars rise, transit, set: $almanac.mars.rise $almanac.mars.transit $almanac.mars.set Azimuth, altitude of Mars: $almanac.mars.azimuth $almanac.mars.altitude Next new, full moon: $almanac.next_new_moon; $almanac.next_full_moon Next summer, winter solstice: $almanac.next_summer_solstice; $almanac.next_winter_solstice #else Sunrise, sunset: $almanac.sunrise $almanac.sunset #end if If ephem is installed this would result in: Current time is 03-Sep-2010 11:00 Sunrise, transit, sunset: 06:29 13:05 19:40 Moonrise, transit, moonset: 00:29 08:37 16:39 Mars rise, transit, set: 10:12 15:38 21:04 Azimuth, altitude of Mars: 111\u00b0 08\u00b0 Next new, full moon: 08-Sep-2010 03:29; 23-Sep-2010 02:17 Next summer, winter solstice: 21-Jun-2011 10:16; 21-Dec-2010 15:38 Otherwise, a fallback of basic calculations is used, resulting in: Current time is 29-Mar-2011 09:20 Sunrise, sunset: 06:51 19:30 As shown in the example, you can test whether this extended almanac information is available with the value $almanac.hasExtras . The almanac information falls into three categories: Calendar events Heavenly bodies Functions We will cover each of these separately.","title":"Almanac"},{"location":"custom/cheetah-generator/#calendar-events","text":"\"Calendar events\" do not require a heavenly body. They cover things such as the time of the next solstice or next first quarter moon, or the sidereal time. The syntax is: $almanac.next_solstice or $almanac.next_first_quarter_moon or $almanac.sidereal_angle Here is a table of the information that falls into this category: Calendar events previous_equinox next_equinox previous_solstice next_solstice previous_autumnal_equinox next_autumnal_equinox previous_vernal_equinox next_vernal_equinox previous_winter_solstice next_winter_solstice previous_summer_solstice next_summer_solstice previous_new_moon next_new_moon previous_first_quarter_moon next_first_quarter_moon previous_full_moon next_full_moon previous_last_quarter_moon next_last_quarter_moon sidereal_angle Note The tag $almanac.sidereal_angle returns a value in decimal degrees rather than a more customary value from 0 to 24 hours.","title":"Calendar events"},{"location":"custom/cheetah-generator/#heavenly-bodies","text":"The second category does require a heavenly body. This covers queries such as, \"When does Jupiter rise?\" or, \"When does the sun transit?\" Examples are $almanac.jupiter.rise or $almanac.sun.transit To accurately calculate these times, WeeWX automatically uses the present temperature and pressure to calculate refraction effects. However, you can override these values, which will be necessary if you wish to match the almanac times published by the Naval Observatory as explained in the PyEphem documentation . For example, to match the sunrise time as published by the Observatory, instead of $almanac.sun.rise use $almanac(pressure=0, horizon=-34.0/60.0).sun.rise By setting pressure to zero we are bypassing the refraction calculations and manually setting the horizon to be 34 arcminutes lower than the normal horizon. This is what the Navy uses. If you wish to calculate the start of civil twilight, you can set the horizon to -6 degrees, and also tell WeeWX to use the center of the sun (instead of the upper limb, which it normally uses) to do the calcuation: $almanac(pressure=0, horizon=-6).sun(use_center=1).rise The general syntax is: $almanac(almanac_time=time, ## Unix epoch time lat=latitude, lon=longitude, ## degrees altitude=altitude, ## meters pressure=pressure, ## mbars horizon=horizon, ## degrees temperature=temperature_C ## degrees C ).heavenly_body(use_center=[01]).attribute As you can see, many other properties can be overridden besides pressure and the horizon angle. PyEphem offers an extensive list of objects that can be used for the heavenly_body tag. All the planets and many stars are in the list. The possible values for the attribute tag are listed in the following table, along with the corresponding name used in the PyEphem documentation. Attributes that can be used with heavenly bodies WeeWX name PyEphem name Meaning azimuth az Azimuth altitude alt Altitude astro_ra a_ra Astrometric geocentric right ascension astro_dec a_dec Astrometric geocentric declination geo_ra g_ra Apparent geocentric right ascension topo_ra ra Apparent topocentric right ascension geo_dec g_dec Apparent geocentric declination topo_dec dec Apparent topocentric declination elongation elong Angle with sun radius_size radius Size as an angle hlongitude hlon Astrometric heliocentric longitude hlatitude hlat Astrometric heliocentric latitude sublatitude sublat Geocentric latitude sublongitude sublon Geocentric longitude next_rising next_rising Time body will rise next next_setting next_setting Time body will set next next_transit next_transit Time body will transit next next_antitransit next_antitransit Time body will anti-transit next previous_rising previous_rising Previous time the body rose previous_setting previous_setting Previous time the body sat previous_transit previous_transit Previous time the body transited previous_antitransit previous_antitransit Previous time the body anti-transited rise next_rising Time body will rise next set next_setting Time body will set next transit next_transit Time body will transit next visible N/A How long body will be visible visible_change N/A Change in visibility from previous day Note The tags topo_ra , astro__ra and geo_ra return values in decimal degrees rather than customary values from 0 to 24 hours.","title":"Heavenly bodies"},{"location":"custom/cheetah-generator/#functions","text":"There is actually one function in this category: separation . It returns the angular separation between two heavenly bodies. For example, to calculate the angular separation between Venus and Mars you would use: <p>The separation between Venus and Mars is $almanac.separation(($almanac.venus.alt,$almanac.venus.az), ($almanac.mars.alt,$almanac.mars.az))</p> This would result in: The separation between Venus and Mars is 55:55:31.8","title":"Functions"},{"location":"custom/cheetah-generator/#adding-new-bodies","text":"It is possible to extend the WeeWX almanac, adding new bodies that it was not previously aware of. For example, say we wanted to add 433 Eros , the first asteroid visited by a spacecraft. Here is the process: Put the following in the file user/extensions.py : import ephem eros = ephem.readdb(\"433 Eros,e,10.8276,304.3222,178.8165,1.457940,0.5598795,0.22258902,71.2803,09/04.0/2017,2000,H11.16,0.46\") ephem.Eros = eros This does two things: it adds orbital information about 433 Eros to the internal PyEphem database, and it makes that data available under the name Eros (note the capital letter). You can then use 433 Eros like any other body in your templates. For example, to display when it will rise above the horizon: $almanac.eros.rise","title":"Adding new bodies"},{"location":"custom/cheetah-generator/#wind","text":"Wind deserves a few comments because it is stored in the database in two different ways: as a set of scalars, and as a vector of speed and direction. Here are the four wind-related scalars stored in the main archive database: Archive type Meaning Valid contexts windSpeed The average wind speed seen during the archive period. $current, $latest, $hour, $day, $week, $month, $year, $rainyear windDir If software record generation is used, this is the vector average over the archive period. If hardware record generation is used, the value is hardware dependent. windGust The maximum (gust) wind speed seen during the archive period. windGustDir The direction of the wind when the gust was observed. Some wind aggregation types, notably vecdir and vecavg , require wind speed and direction. For these, WeeWX provides a composite observation type called wind . It is stored directly in the daily summaries, but synthesized for aggregations other than multiples of a day. Daily summary type Meaning Valid contexts wind A vector composite of the wind. $hour , $day , $week , $month , $year , $rainyear Any of these can be used in your tags. Here are some examples: Tag Meaning $current.windSpeed The average wind speed over the most recent archive interval. $current.windDir If software record generation is used, this is the vector average over the archive interval. If hardware record generation is used, the value is hardware dependent. $current.windGust The maximum wind speed (gust) over the most recent archive interval. $current.windGustDir The direction of the gust. $day.windSpeed.avg $day.wind.avg The average wind speed since midnight. If the wind blows east at 5 m/s for 2 hours, then west at 5 m/s for 2 hours, the average wind speed is 5 m/s. $day.wind.vecavg The vector average wind speed since midnight. If the wind blows east at 5 m/s for 2 hours, then west at 5 m/s for 2 hours, the vector average wind speed is zero. $day.wind.vecdir The direction of the vector averaged wind speed. If the wind blows northwest at 5 m/s for two hours, then southwest at 5 m/s for two hours, the vector averaged direction is west. $day.windGust.max $day.wind.max The maximum wind gust since midnight. $day.wind.gustdir The direction of the maximum wind gust. $day.windGust.maxtime $day.wind.maxtime The time of the maximum wind gust. $day.windSpeed.max The max average wind speed. The wind is averaged over each of the archive intervals. Then the maximum of these values is taken. Note that this is not the same as the maximum wind gust. $day.windDir.avg Not a very useful quantity. This is the strict, arithmetic average of all the compass wind directions. If the wind blows at 350\u00b0 for two hours then at 10\u00b0 for two hours, then the scalar average wind direction will be 180\u00b0 \u2014 probably not what you expect, nor want.","title":"Wind"},{"location":"custom/cheetah-generator/#defining-new-tags","text":"We have seen how you can change a template and make use of the various tags available such as $day.outTemp.max for the maximum outside temperature for the day. But, what if you want to introduce some new data for which no tag is available? If you wish to introduce a static tag, that is, one that will not change with time (such as a Google Analytics tracker ID, or your name), then this is very easy: put it in section [Extras] in the skin configuration file. More information on how to do this can be found there. But, what if you wish to introduce a more dynamic tag, one that requires some calculation, or perhaps uses the database? Simply putting it in the [Extras] section won't do, because then it cannot change. The answer is to write a search list extension . Complete directioins on how to do this are in the document Writing search list extensions .","title":"Defining new tags"},{"location":"custom/custom-reports/","text":"Customizing reports \u00b6 There are two general mechanisms for customizing reports: change options in one or more configuration files, or change the template files. The former is generally easier, but occasionally the latter is necessary. How to specify options \u00b6 Options are used to control how reports will look and what they will contain. For example, they determine which units to use, how to format dates and times, which data should be in each plot, the colors of plot elements, etc . Options are read from three different types of configuration files: Configuration files File Use weewx.conf This is the application configuration file. It contains general configuration information, such which drivers and services to load, as well as which reports to run. Report options can also be specified in this file. skin.conf This is the skin configuration file. It contains information specific to a skin , in particular, which template files to process, and which plots to generate. Typically, this file is supplied by the skin author. en.conf de.conf fr.conf etc. These are internationalization files. They contain language and locale information for a specific skin . Configuration files are read and processed using the Python utility ConfigObj , using a format similar to the MS-DOS \"INI\" format . Here's a simple example: [Section1] # A comment key1 = value1 [[SubSectionA]] key2 = value2 [Section2] key3 = value3 This example uses two sections at root level (sections Section1 and Section2 ), and one subsection ( SubSectionA ), which is nested under Section1 . The option key1 is nested under Section1 , option key3 is nested under Section2 , while option key2 is nested under subsection SubSectionA . Note that while this example indents subsections and options, this is strictly for readability \u2014 this isn't Python! It's the number of brackets that counts in determining nesting, not the indentation! It would torture your readers, but the above example could be written [Section1] # A comment key1 = value1 [[SubSectionA]] key2 = value2 [Section2] key3 = value3 Configuration files take advantage of ConfigObj's ability to organize options hierarchically into stanzas . For example, the [Labels] stanza contains the text that should be displayed for each observation. The [Units] stanza contains other stanzas, each of which contains parameters that control the display of units. Processing order \u00b6 Configuration files and their sections are processed in a specific order. Generally, the values from the skin configuration file ( skin.conf ) are processed first, then options in the WeeWX configuration file (nominally weewx.conf ) are applied last. This order allows skin authors to specify the basic look and feel of a report, while ensuring that users of the skin have the final say. To illustrate the processing order, here are the steps for the skin Seasons : First, a set of options defined in the Python module weewx.defaults serve as the starting point. Next, options from the configuration file for Seasons , located in skins/Seasons/skin.conf , are merged. Next, any options that apply to all skins, specified in the [StdReport] / [[Defaults]] section of the WeeWX configuration file, are merged. Finally, any skin-specific options, specified in the [StdReport] / [[Seasons]] section of the WeeWX configuration, are merged. These options have the final say. At all four steps, if a language specification is encountered (option lang ), then the corresponding language file will be read and merged. If a unit specification (option unit_system ) is encountered, then the appropriate unit groups are set. For example, if unit_system=metricwx , then the unit for group_pressure will be set to mbar , etc. The result is the following option hierarchy, listed in order of increasing precedence. Option hierarchy, lowest to highest File Example Comments weewx/defaults.py [Units] [[Labels]] mbar=\" mbar\" These are the hard-coded default values for every option. They are used when an option is not specified anywhere else. These should not be modified unless you propose a change to the WeeWX code; any changes made here will be lost when the software is updated. skin.conf [Units] [[Labels]] mbar=\" hPa\" Supplied by the skin author, the skin configuration file, skin.conf , contains options that define the baseline behavior of the skin. In this example, for whatever reason, the skin author has decided that the label for units in millibars should be \" hPa\" (which is equivalent). weewx.conf [StdReport] [[Defaults]] [[[Labels]]] [[[[Generic]]]] rain=Rainfall Options specified under [[Defaults]] apply to all reports. This example indicates that the label Rainfall should be used for the observation rain , in all reports. weewx.conf [StdReport] [[SeasonsReport]] [[[Labels]]] [[[[Generic]]]] inTemp=Kitchen temperature Highest precedence. Has the final say. Options specified here apply to a single report. This example indicates that the label Kitchen temperature should be used for the observation inTemp , but only for the report SeasonsReport . Note When specifying options, you must pay attention to the number of brackets! In the table above, there are two different nesting depths used: one for weewx.conf , and one for weewx/defaults.py and skin.conf . This is because the stanzas defined in weewx.conf start two levels down in the hierarchy [StdReport] , whereas the stanzas defined in skin.conf and defaults.py are at the root level. Therefore, options specified in weewx.conf must use two extra sets of brackets. Other skins are processed in a similar manner although, of course, their name will be something other than Seasons . Although it is possible to modify the options at any level, as the user of a skin, it is usually best to keep your modifications in the WeeWX configuration file ( weewx.conf ) if you can. That way you can apply any fixes or changes when the skin author updates the skin, and your customizations will not be overwritten. If you are a skin author, then you should provide the skin configuration file ( skin.conf ), and put in it only the options necessary to make the skin render the way you intend it. Any options that are likely to be localized for a specific language (in particular, text), should be put in the appropriate language file. Changing languages \u00b6 By default, the skins that come with WeeWX are set up for the English language, but suppose you wish to switch to another language. How you do so will depend on whether the skin you are using has been internationalized and, if so, whether it offers your local language. Internationalized skins \u00b6 All the skins included with WeeWX have been internationalized, so if you're working with one of them, this is the section you want. Next, you need to check whether there is a localization file for your particular language. To check, look in the contents of subdirectory lang in the skin's directory. For example, if you used a package installer and are using the Seasons skin, you will want to look in /etc/weewx/skins/Seasons/lang . Inside, you will see something like this: ls -l /etc/weewx/skins/Seasons/lang total 136 -rw-rw-r-- 1 tkeffer tkeffer 9447 Jul 1 11:11 cn.conf -rw-rw-r-- 1 tkeffer tkeffer 9844 Mar 13 12:31 cz.conf -rw-rw-r-- 1 tkeffer tkeffer 9745 Mar 13 12:31 de.conf -rw-rw-r-- 1 tkeffer tkeffer 9459 Mar 13 12:31 en.conf -rw-rw-r-- 1 tkeffer tkeffer 10702 Mar 13 12:31 es.conf -rw-rw-r-- 1 tkeffer tkeffer 10673 May 31 07:50 fr.conf -rw-rw-r-- 1 tkeffer tkeffer 11838 Mar 13 12:31 gr.conf -rw-rw-r-- 1 tkeffer tkeffer 9947 Mar 13 12:31 it.conf -rw-rw-r-- 1 tkeffer tkeffer 9548 Mar 13 12:31 nl.conf -rw-rw-r-- 1 tkeffer tkeffer 10722 Apr 15 14:52 no.conf -rw-rw-r-- 1 tkeffer tkeffer 15356 Mar 13 12:31 th.conf This means that the Seasons skin has been localized for the following languages: File Language cn.conf Traditional Chinese cz.conf Czeck de.conf German en.conf English es.conf Spanish fr.conf French it.conf Italian gr.conf Greek nl.conf Dutch th.conf Thai If you want to use the Seasons skin and are working with one of these languages, then you are in luck: you can simply override the lang option. For example, to change the language displayed by the Seasons skin from English to German, edit weewx.conf , and change the highlighted line: [StdReport] ... [[SeasonsReport]] # The SeasonsReport uses the 'Seasons' skin, which contains the # images, templates and plots for the report. skin = Seasons enable = true lang = de By contrast, if the skin has been internationalized, but there is no localization file for your language, then you will have to supply one. See the section Internationalized, but your language is missing . Changing date and time formats \u00b6 Date and time formats are specified using the same format strings used by strftime() . For example, %Y indicates the 4-digit year, and %H:%M indicates the time in hours:minutes. The default values for date and time formats are generally %x %X , which indicates \"use the format for the locale of the computer\". Since date formats default to the locale of the computer, a date might appear with the format of \"month/day/year\". What if you prefer dates to have the format \"year.month.day\"? How do you indicate 24-hour time format versus 12-hour? Dates and times generally appear in two places: in plots and in tags. Date and time formats in images \u00b6 Most plots have a label on the horizontal axis that indicates when the plot was generated. By default, the format for this label uses the locale of the computer on which WeeWX is running, but you can modify the format by specifying the option bottom_label_format . For example, this would result in a date/time string such as \"2021.12.13 12:45\" no matter what the computer's locale: [StdReport] ... [[Defaults]] [[[ImageGenerator]]] [[[[day_images]]]] bottom_label_format = %Y.%m.%d %H:%M [[[[week_images]]]] bottom_label_format = %Y.%m.%d %H:%M [[[[month_images]]]] bottom_label_format = %Y.%m.%d %H:%M [[[[year_images]]]] bottom_label_format = %Y.%m.%d %H:%M Date and time formats for tags \u00b6 Each aggregation period has a format for the times associated with that period. These formats are defined in the TimeFormats section. The default formats use the date and/or time for the computer of the locale on which WeeWX is running. For example, this would result in a date/time string such as \"2021.12.13 12:45\" no matter what the computer's locale: [StdReport] ... [[Defaults]] [[[Units]]] [[[[TimeFormats]]]] hour = %H:%M day = %Y.%m.%d week = %Y.%m.%d (%A) month = %Y.%m.%d %H:%M year = %Y.%m.%d %H:%M rainyear = %Y.%m.%d %H:%M current = %Y.%m.%d %H:%M ephem_day = %H:%M ephem_year = %Y.%m.%d %H:%M Changing unit systems \u00b6 Each unit system is a set of units. For example, the METRIC unit system uses centimeters for rain, kilometers per hour for wind speed, and degree Celsius for temperature. The option unit_system controls which unit system will be used in your reports. The available choices are US , METRIC , or METRICWX . The option is case-insensitive. See Units for the units defined in each of these unit systems. By default, WeeWX uses US (US Customary) system. Suppose you would rather use the METRICWX system for all your reports? Then change this [StdReport] ... [[Defaults]] # Which unit system to use for all reports. Choices are 'us', 'metric', or 'metricwx'. # You can override this for individual reports. unit_system = us to this [StdReport] ... [[Defaults]] # Which unit system to use for all reports. Choices are 'us', 'metric', or 'metricwx'. # You can override this for individual reports. unit_system = metricwx Mixed units \u00b6 However, what if you want a mix? For example, suppose you generally want US Customary units, but you want barometric pressures to be in millibars? This can be done by overriding the appropriate unit group. [StdReport] ... [[Defaults]] # Which unit system to use for all reports. Choices are 'us', 'metric', or 'metricwx'. # You can override this for individual reports. unit_system = us # Override the units used for pressure: [[[Units]]] [[[[Groups]]]] group_pressure = mbar This says that you generally want the US systems of units for all reports, but want pressure to be reported in millibars . Other units can be overridden in a similar manner. Multiple unit systems \u00b6 Another example. Suppose we want to generate two reports, one in the US system, the other using the METRICWX system. The first, call it SeasonsUSReport , will go in the regular directory HTML_ROOT . However, the latter, call it SeasonsMetricReport , will go in a subdirectory, HTML_ROOT/metric . Here's how you would do it [StdReport] # Where the skins reside, relative to WEEWX_ROOT SKIN_ROOT = skins # Where the generated reports should go, relative to WEEWX_ROOT HTML_ROOT = public_html # The database binding indicates which data should be used in reports. data_binding = wx_binding [[SeasonsUSReport]] skin = Seasons unit_system = us enable = true [[SeasonsMetricReport]] skin = Seasons unit_system = metricwx HTML_ROOT = public_html/metric enable = true Note how both reports use the same skin (that is, skin Seasons ), but different unit systems, and different destinations. The first, SeasonsUSReport sets option unit_system to us , and uses the default destination. By contrast, the second, SeasonsMetricReport , uses unit system metricwx , and a different destination, public_html/metric . Changing labels \u00b6 Every observation type is associated with a default label . For example, in the English language, the default label for observation type outTemp is generally \"Outside Temperature\". You can change this label by overriding the default. How you do so will depend on whether the skin you are using has been internationalized and, if so, whether it offers your local language. Let's look at an example. If you take a look inside the file skins/Seasons/lang/en.conf , you will see it contains what looks like a big configuration file. Among other things, it has two entries that look like this: ... [Labels] ... [[Generic]] ... inTemp = Inside Temperature outTemp = Outside Temperature ... This tells the report generators that when it comes time to label the observation variables inTemp and outTemp , use the strings \"Inside Temperature\" and \"Outside Temperature\", respectively. However, let's say that we have actually located our outside temperature sensor in the barn, and wish to label it accordingly. We need to override the label that comes in the localization file. We could just change the localization file en.conf , but then if the author of the skin came out with a new version, our change could get lost. Better to override the default by making the change in weewx.conf . To do this, make the following changes in weewx.conf : [[SeasonsReport]] # The SeasonsReport uses the 'Seasons' skin, which contains the # images, templates and plots for the report. skin = Seasons lang = en unit_system = US enable = true [[[Labels]]] [[[[Generic]]]] outTemp = Barn Temperature This will cause the default label Outside Temperature to be replaced with the new label \"Barn Temperature\" everywhere in your report. The label for type inTemp will be untouched.","title":"Customizing reports"},{"location":"custom/custom-reports/#customizing-reports","text":"There are two general mechanisms for customizing reports: change options in one or more configuration files, or change the template files. The former is generally easier, but occasionally the latter is necessary.","title":"Customizing reports"},{"location":"custom/custom-reports/#how-to-specify-options","text":"Options are used to control how reports will look and what they will contain. For example, they determine which units to use, how to format dates and times, which data should be in each plot, the colors of plot elements, etc . Options are read from three different types of configuration files: Configuration files File Use weewx.conf This is the application configuration file. It contains general configuration information, such which drivers and services to load, as well as which reports to run. Report options can also be specified in this file. skin.conf This is the skin configuration file. It contains information specific to a skin , in particular, which template files to process, and which plots to generate. Typically, this file is supplied by the skin author. en.conf de.conf fr.conf etc. These are internationalization files. They contain language and locale information for a specific skin . Configuration files are read and processed using the Python utility ConfigObj , using a format similar to the MS-DOS \"INI\" format . Here's a simple example: [Section1] # A comment key1 = value1 [[SubSectionA]] key2 = value2 [Section2] key3 = value3 This example uses two sections at root level (sections Section1 and Section2 ), and one subsection ( SubSectionA ), which is nested under Section1 . The option key1 is nested under Section1 , option key3 is nested under Section2 , while option key2 is nested under subsection SubSectionA . Note that while this example indents subsections and options, this is strictly for readability \u2014 this isn't Python! It's the number of brackets that counts in determining nesting, not the indentation! It would torture your readers, but the above example could be written [Section1] # A comment key1 = value1 [[SubSectionA]] key2 = value2 [Section2] key3 = value3 Configuration files take advantage of ConfigObj's ability to organize options hierarchically into stanzas . For example, the [Labels] stanza contains the text that should be displayed for each observation. The [Units] stanza contains other stanzas, each of which contains parameters that control the display of units.","title":"How to specify options"},{"location":"custom/custom-reports/#processing-order","text":"Configuration files and their sections are processed in a specific order. Generally, the values from the skin configuration file ( skin.conf ) are processed first, then options in the WeeWX configuration file (nominally weewx.conf ) are applied last. This order allows skin authors to specify the basic look and feel of a report, while ensuring that users of the skin have the final say. To illustrate the processing order, here are the steps for the skin Seasons : First, a set of options defined in the Python module weewx.defaults serve as the starting point. Next, options from the configuration file for Seasons , located in skins/Seasons/skin.conf , are merged. Next, any options that apply to all skins, specified in the [StdReport] / [[Defaults]] section of the WeeWX configuration file, are merged. Finally, any skin-specific options, specified in the [StdReport] / [[Seasons]] section of the WeeWX configuration, are merged. These options have the final say. At all four steps, if a language specification is encountered (option lang ), then the corresponding language file will be read and merged. If a unit specification (option unit_system ) is encountered, then the appropriate unit groups are set. For example, if unit_system=metricwx , then the unit for group_pressure will be set to mbar , etc. The result is the following option hierarchy, listed in order of increasing precedence. Option hierarchy, lowest to highest File Example Comments weewx/defaults.py [Units] [[Labels]] mbar=\" mbar\" These are the hard-coded default values for every option. They are used when an option is not specified anywhere else. These should not be modified unless you propose a change to the WeeWX code; any changes made here will be lost when the software is updated. skin.conf [Units] [[Labels]] mbar=\" hPa\" Supplied by the skin author, the skin configuration file, skin.conf , contains options that define the baseline behavior of the skin. In this example, for whatever reason, the skin author has decided that the label for units in millibars should be \" hPa\" (which is equivalent). weewx.conf [StdReport] [[Defaults]] [[[Labels]]] [[[[Generic]]]] rain=Rainfall Options specified under [[Defaults]] apply to all reports. This example indicates that the label Rainfall should be used for the observation rain , in all reports. weewx.conf [StdReport] [[SeasonsReport]] [[[Labels]]] [[[[Generic]]]] inTemp=Kitchen temperature Highest precedence. Has the final say. Options specified here apply to a single report. This example indicates that the label Kitchen temperature should be used for the observation inTemp , but only for the report SeasonsReport . Note When specifying options, you must pay attention to the number of brackets! In the table above, there are two different nesting depths used: one for weewx.conf , and one for weewx/defaults.py and skin.conf . This is because the stanzas defined in weewx.conf start two levels down in the hierarchy [StdReport] , whereas the stanzas defined in skin.conf and defaults.py are at the root level. Therefore, options specified in weewx.conf must use two extra sets of brackets. Other skins are processed in a similar manner although, of course, their name will be something other than Seasons . Although it is possible to modify the options at any level, as the user of a skin, it is usually best to keep your modifications in the WeeWX configuration file ( weewx.conf ) if you can. That way you can apply any fixes or changes when the skin author updates the skin, and your customizations will not be overwritten. If you are a skin author, then you should provide the skin configuration file ( skin.conf ), and put in it only the options necessary to make the skin render the way you intend it. Any options that are likely to be localized for a specific language (in particular, text), should be put in the appropriate language file.","title":"Processing order"},{"location":"custom/custom-reports/#changing-languages","text":"By default, the skins that come with WeeWX are set up for the English language, but suppose you wish to switch to another language. How you do so will depend on whether the skin you are using has been internationalized and, if so, whether it offers your local language.","title":"Changing languages"},{"location":"custom/custom-reports/#internationalized-skins","text":"All the skins included with WeeWX have been internationalized, so if you're working with one of them, this is the section you want. Next, you need to check whether there is a localization file for your particular language. To check, look in the contents of subdirectory lang in the skin's directory. For example, if you used a package installer and are using the Seasons skin, you will want to look in /etc/weewx/skins/Seasons/lang . Inside, you will see something like this: ls -l /etc/weewx/skins/Seasons/lang total 136 -rw-rw-r-- 1 tkeffer tkeffer 9447 Jul 1 11:11 cn.conf -rw-rw-r-- 1 tkeffer tkeffer 9844 Mar 13 12:31 cz.conf -rw-rw-r-- 1 tkeffer tkeffer 9745 Mar 13 12:31 de.conf -rw-rw-r-- 1 tkeffer tkeffer 9459 Mar 13 12:31 en.conf -rw-rw-r-- 1 tkeffer tkeffer 10702 Mar 13 12:31 es.conf -rw-rw-r-- 1 tkeffer tkeffer 10673 May 31 07:50 fr.conf -rw-rw-r-- 1 tkeffer tkeffer 11838 Mar 13 12:31 gr.conf -rw-rw-r-- 1 tkeffer tkeffer 9947 Mar 13 12:31 it.conf -rw-rw-r-- 1 tkeffer tkeffer 9548 Mar 13 12:31 nl.conf -rw-rw-r-- 1 tkeffer tkeffer 10722 Apr 15 14:52 no.conf -rw-rw-r-- 1 tkeffer tkeffer 15356 Mar 13 12:31 th.conf This means that the Seasons skin has been localized for the following languages: File Language cn.conf Traditional Chinese cz.conf Czeck de.conf German en.conf English es.conf Spanish fr.conf French it.conf Italian gr.conf Greek nl.conf Dutch th.conf Thai If you want to use the Seasons skin and are working with one of these languages, then you are in luck: you can simply override the lang option. For example, to change the language displayed by the Seasons skin from English to German, edit weewx.conf , and change the highlighted line: [StdReport] ... [[SeasonsReport]] # The SeasonsReport uses the 'Seasons' skin, which contains the # images, templates and plots for the report. skin = Seasons enable = true lang = de By contrast, if the skin has been internationalized, but there is no localization file for your language, then you will have to supply one. See the section Internationalized, but your language is missing .","title":"Internationalized skins"},{"location":"custom/custom-reports/#changing-date-and-time-formats","text":"Date and time formats are specified using the same format strings used by strftime() . For example, %Y indicates the 4-digit year, and %H:%M indicates the time in hours:minutes. The default values for date and time formats are generally %x %X , which indicates \"use the format for the locale of the computer\". Since date formats default to the locale of the computer, a date might appear with the format of \"month/day/year\". What if you prefer dates to have the format \"year.month.day\"? How do you indicate 24-hour time format versus 12-hour? Dates and times generally appear in two places: in plots and in tags.","title":"Changing date and time formats"},{"location":"custom/custom-reports/#date-and-time-formats-in-images","text":"Most plots have a label on the horizontal axis that indicates when the plot was generated. By default, the format for this label uses the locale of the computer on which WeeWX is running, but you can modify the format by specifying the option bottom_label_format . For example, this would result in a date/time string such as \"2021.12.13 12:45\" no matter what the computer's locale: [StdReport] ... [[Defaults]] [[[ImageGenerator]]] [[[[day_images]]]] bottom_label_format = %Y.%m.%d %H:%M [[[[week_images]]]] bottom_label_format = %Y.%m.%d %H:%M [[[[month_images]]]] bottom_label_format = %Y.%m.%d %H:%M [[[[year_images]]]] bottom_label_format = %Y.%m.%d %H:%M","title":"Date and time formats in images"},{"location":"custom/custom-reports/#date-and-time-formats-for-tags","text":"Each aggregation period has a format for the times associated with that period. These formats are defined in the TimeFormats section. The default formats use the date and/or time for the computer of the locale on which WeeWX is running. For example, this would result in a date/time string such as \"2021.12.13 12:45\" no matter what the computer's locale: [StdReport] ... [[Defaults]] [[[Units]]] [[[[TimeFormats]]]] hour = %H:%M day = %Y.%m.%d week = %Y.%m.%d (%A) month = %Y.%m.%d %H:%M year = %Y.%m.%d %H:%M rainyear = %Y.%m.%d %H:%M current = %Y.%m.%d %H:%M ephem_day = %H:%M ephem_year = %Y.%m.%d %H:%M","title":"Date and time formats for tags"},{"location":"custom/custom-reports/#changing-unit-systems","text":"Each unit system is a set of units. For example, the METRIC unit system uses centimeters for rain, kilometers per hour for wind speed, and degree Celsius for temperature. The option unit_system controls which unit system will be used in your reports. The available choices are US , METRIC , or METRICWX . The option is case-insensitive. See Units for the units defined in each of these unit systems. By default, WeeWX uses US (US Customary) system. Suppose you would rather use the METRICWX system for all your reports? Then change this [StdReport] ... [[Defaults]] # Which unit system to use for all reports. Choices are 'us', 'metric', or 'metricwx'. # You can override this for individual reports. unit_system = us to this [StdReport] ... [[Defaults]] # Which unit system to use for all reports. Choices are 'us', 'metric', or 'metricwx'. # You can override this for individual reports. unit_system = metricwx","title":"Changing unit systems"},{"location":"custom/custom-reports/#mixed-units","text":"However, what if you want a mix? For example, suppose you generally want US Customary units, but you want barometric pressures to be in millibars? This can be done by overriding the appropriate unit group. [StdReport] ... [[Defaults]] # Which unit system to use for all reports. Choices are 'us', 'metric', or 'metricwx'. # You can override this for individual reports. unit_system = us # Override the units used for pressure: [[[Units]]] [[[[Groups]]]] group_pressure = mbar This says that you generally want the US systems of units for all reports, but want pressure to be reported in millibars . Other units can be overridden in a similar manner.","title":"Mixed units"},{"location":"custom/custom-reports/#multiple-unit-systems","text":"Another example. Suppose we want to generate two reports, one in the US system, the other using the METRICWX system. The first, call it SeasonsUSReport , will go in the regular directory HTML_ROOT . However, the latter, call it SeasonsMetricReport , will go in a subdirectory, HTML_ROOT/metric . Here's how you would do it [StdReport] # Where the skins reside, relative to WEEWX_ROOT SKIN_ROOT = skins # Where the generated reports should go, relative to WEEWX_ROOT HTML_ROOT = public_html # The database binding indicates which data should be used in reports. data_binding = wx_binding [[SeasonsUSReport]] skin = Seasons unit_system = us enable = true [[SeasonsMetricReport]] skin = Seasons unit_system = metricwx HTML_ROOT = public_html/metric enable = true Note how both reports use the same skin (that is, skin Seasons ), but different unit systems, and different destinations. The first, SeasonsUSReport sets option unit_system to us , and uses the default destination. By contrast, the second, SeasonsMetricReport , uses unit system metricwx , and a different destination, public_html/metric .","title":"Multiple unit systems"},{"location":"custom/custom-reports/#changing-labels","text":"Every observation type is associated with a default label . For example, in the English language, the default label for observation type outTemp is generally \"Outside Temperature\". You can change this label by overriding the default. How you do so will depend on whether the skin you are using has been internationalized and, if so, whether it offers your local language. Let's look at an example. If you take a look inside the file skins/Seasons/lang/en.conf , you will see it contains what looks like a big configuration file. Among other things, it has two entries that look like this: ... [Labels] ... [[Generic]] ... inTemp = Inside Temperature outTemp = Outside Temperature ... This tells the report generators that when it comes time to label the observation variables inTemp and outTemp , use the strings \"Inside Temperature\" and \"Outside Temperature\", respectively. However, let's say that we have actually located our outside temperature sensor in the barn, and wish to label it accordingly. We need to override the label that comes in the localization file. We could just change the localization file en.conf , but then if the author of the skin came out with a new version, our change could get lost. Better to override the default by making the change in weewx.conf . To do this, make the following changes in weewx.conf : [[SeasonsReport]] # The SeasonsReport uses the 'Seasons' skin, which contains the # images, templates and plots for the report. skin = Seasons lang = en unit_system = US enable = true [[[Labels]]] [[[[Generic]]]] outTemp = Barn Temperature This will cause the default label Outside Temperature to be replaced with the new label \"Barn Temperature\" everywhere in your report. The label for type inTemp will be untouched.","title":"Changing labels"},{"location":"custom/database/","text":"Customizing the database \u00b6 For most users the database defaults will work just fine. However, there may be occasions when you may want to add a new observation type to your database, or change its unit system. This section shows you how to do this. Every relational database depends on a schema to specify which types to include in the database. When a WeeWX database is first created, it uses a Python version of the schema to initialize the database. However, once the database has been created, the schema is read directly from the database and the Python version is not used again \u2014 any changes to it will have no effect. This means that the strategy for modifying the schema depends on whether the database already exists. Specifying a schema for a new database \u00b6 If the database does not exist yet, then you will want to pick an appropriate starting schema. If it's not exactly what you want, you can modify it to fit your needs before creating the database. Picking a starting schema \u00b6 WeeWX gives you a choice of three different schemas to choose from when creating a new database: Name Number of observation types Comment schemas.wview.schema 49 The original schema that came with wview. schemas.wview_extended.schema 111 A version of the wview schema, which has been extended with many new types. This is the default version. schemas.wview_small.schema 20 A minimalist version of the wview schema. For most users, the default database schema, schemas.wview_extended.schema , will work just fine. To specify which schema to use when creating a database, modify option schema in section [DataBindings] in weewx.conf . For example, suppose you wanted to use the classic (and smaller) schema schemas.wview.schema instead of the default schemas.wview_extended.schema . Then the section [DataBindings] would look like: [DataBindings] [[wx_binding]] database = archive_sqlite table_name = archive manager = weewx.manager.DaySummaryManager schema = schemas.wview.schema Now, when you start WeeWX, it will use this new choice instead of the default. Note This only works when the database is first created . Thereafter, WeeWX reads the schema directly from the database. Changing this option will have no effect! Modifying a starting schema \u00b6 If none of the three starting schemas that come with WeeWX suits your purposes, you can easily create your own. Just pick one of the three schemas as a starting point, then modify it. Put the results in the user subdirectory, where it will be safe from upgrades. For example, suppose you like the schemas.wview_small schema, but you need to store the type electricity from the example Adding a second data source . The type electricity does not appear in the schema, so you'll have to add it before starting up WeeWX. We will call the resulting new schema user.myschema.schema . If you did a Debian install, here's how you would do this: # Copy the wview_small schema over to the user subdirectory and rename it myschema: sudo cp /usr/share/weewx/schemas/wview_small.py /usr/share/weewx/user/myschema.py # Edit it using your favorite text editor sudo nano /usr/share/weewx/user/myschema.py If you did a pip install, it can be difficult to find the starting schema because it can be buried deep in the Python library tree. It's easier to just download from the git repository and start with that: # Download the wview_small schema and rename it to myschema.py cd ~/weewx-data/bin/user wget https://raw.githubusercontent.com/weewx/weewx/master/bin/schemas/wview_small.py mv wview_small.py myschema.py # Edit it using your favorite text editor nano myschema.py In myschema.py change this: ... ('windchill', 'REAL'), ('windDir', 'REAL'), ('windGust', 'REAL'), ('windGustDir', 'REAL'), ('windSpeed', 'REAL'), ] to this ... ('windchill', 'REAL'), ('windDir', 'REAL'), ('windGust', 'REAL'), ('windGustDir', 'REAL'), ('windSpeed', 'REAL'), ('electricity', 'REAL'), ] The only change was the addition ( highlighted ) of electricity to the list of observation names. Now change option schema under [DataBindings] in weewx.conf to use your new schema: [DataBindings] [[wx_binding]] database = archive_sqlite table_name = archive manager = weewx.manager.DaySummaryManager schema = user.myschema.schema Start WeeWX. When the new database is created, it will use your modified schema instead of the default. Note This will only work when the database is first created! Thereafter, WeeWX reads the schema directly from the database and your changes will have no effect! Modify the schema of an existing database \u00b6 The previous section covers the case where you do not have an existing database, so you modify a starting schema, then use it to initialize the database. But, what if you already have a database, and you want to modify its schema, perhaps by adding a column or two? Creating a new starting schema is not going to work because it is only used when the database is first created. Here is where the command weectl database can be useful. There are two ways to do this. Both are covered below. Modify the database in situ . This choice works best for small changes. Reconfigure the old database to a new one while modifying it along the way, This choice is best for large modifications. Warning Before using weectl database , MAKE A BACKUP FIRST! Be sure to stop weewxd first. Modify the database in situ \u00b6 If you want to make some minor modifications to an existing database, perhaps adding or removing a column, then this can easily be done using the command weectl database with an appropriate action. We will cover the cases of adding, removing, and renaming a type. See the documentation for weectl database for more details. Adding a type \u00b6 Suppose you have an existing database, to which you want to add a type, such as the type electricity from the example Adding a second data source . This can be done in one easy step using the action weectl database add-column : weectl database add-column electricity The tool not only adds electricity to the main archive table, but also to the daily summaries. Removing a type \u00b6 In a similar manner, the tool can remove any unneeded types from an existing database. For example, suppose you are using the schemas.wview schema, but you're pretty sure you're not going to need to store soil moisture. You can drop the unnecessary types this way: weectl database drop-columns soilMoist1 soilMoist2 soilMoist3 soilMoist4 Unlike the action add-column , the action drop-columns can take more than one type. This is done in the interest of efficiency: adding new columns is easy and fast with the SQLite database, but dropping columns requires copying the whole database. By specifying more than one type, you can amortize the cost over a single invocation of the utility. Warning Dropping types from a database means you will lose any data associated with them! The data cannot be recovered. Renaming a type \u00b6 Suppose you just want to rename a type? This can be done using the action rename-column . Here's an example where you rename soilMoist1 to soilMoistGarden : weectl database rename-column soilMoist1 soilMoistGarden Note how the action rename-column requires two positional arguments: the column being renamed, and its final name. Reconfigure database using a new schema \u00b6 If you are making major changes to your database, you may find it easier to create a brand-new database using the schema you want, then transfer all data from the old database into the new one. This approach is more work, and takes more processing time than the in situ strategies outlines above, but has the advantage that it leaves behind a record of exactly the schema you are using. Here is the general strategy to do this. Create a new schema that includes exactly the types that you want. Specify this schema as the starting schema for the database. Make sure you have the necessary permissions to create the new database. Use the action weectl database reconfigure to create the new database and populate it with data from the old database. Shuffle databases around so WeeWX will use the new database. Here are the details: Create a new schema. First step is to create a new schema with exactly the types you want. See the instructions above Modify a starting schema . As an example, suppose your new schema is called user.myschema.schema . Set as starting schema. Set your new schema as the starting schema with whatever database binding you are working with (generally, wx_binding ). For example: [DataBindings] [[wx_binding]] database = archive_sqlite table_name = archive manager = weewx.manager.DaySummaryManager schema = user.myschema.schema Check permissions. The transfer action will create a new database with the same name as the old, except with the suffix _new attached to the end. Make sure you have the necessary permissions to do this. In particular, if you are using MySQL, you will need CREATE privileges. Create and populate the new database. Use the command weectl database with the reconfigure action. weectl database reconfigure This will create a new database (nominally, weewx.sdb_new if you are using SQLite, weewx_new if you are using MySQL), using the schema found in user.myschema.schema , and populate it with data from the old database. Shuffle the databases. Now arrange things so WeeWX can find the new database. Warning Make a backup of the data before doing any of the next steps! You can either shuffle the databases around so the new database has the same name as the old database, or edit weewx.conf to use the new database name. To do the former: SQLite MySQL cd ~/weewx-data/archive mv weewx.sdb_new weewx.sdb mysql -u <username> --password = <mypassword> mysql> DROP DATABASE weewx ; # Delete the old database mysql> CREATE DATABASE weewx ; # Create a new one with the same name mysql> RENAME TABLE weewx_new.archive TO weewx.archive ; # Rename to the nominal name It's worth noting that there's actually a hidden, last step: rebuilding the daily summaries inside the new database. This will be done automatically by weewxd at the next startup. Alternatively, it can be done manually using the weectl database rebuild-daily action: weectl database rebuild-daily Changing the unit system in an existing database \u00b6 Normally, data are stored in the databases using US Customary units, and you shouldn't care; it is an \"implementation detail\". Data can always be displayed using any set of units you want \u2014 the section Changing unit systems explains how to change the reporting units. Nevertheless, there may be special situations where you wish to store the data in Metric units. For example, you may need to allow direct programmatic access to the database from another piece of software that expects metric units. You should not change the database unit system midstream. That is, do not start with one unit system then, some time later, switch to another. WeeWX cannot handle databases with mixed unit systems \u2014 see the section [StdConvert] in the WeeWX User's Guide. However, you can reconfigure the database by copying it to a new database, performing the unit conversion along the way. You then use this new database. The general strategy is identical to the strategy outlined above in the section Reconfigure database using new schema . The only difference is that instead of specifying a new starting schema, you specify a different database unit system. This means that instead of steps 1 and 2 above, you edit the configuration file and change option target_unit in section [StdConvert] to reflect your choice. For example, if you are switching to metric units, the option will look like: [StdConvert] target_unit = METRICWX After changing target_unit , you then go ahead with the rest of the steps. That is run the action weectl database reconfigure , then shuffle the databases. Rebuilding the daily summaries \u00b6 The weectl database command can also be used to rebuild the daily summaries: weectl database rebuild-daily In most cases this will be sufficient; however, if anomalies remain in the daily summaries the daily summary tables may be dropped first before rebuilding: weectl database drop-daily Then try again with weectl database rebuild-daily .","title":"Customizing the database"},{"location":"custom/database/#customizing-the-database","text":"For most users the database defaults will work just fine. However, there may be occasions when you may want to add a new observation type to your database, or change its unit system. This section shows you how to do this. Every relational database depends on a schema to specify which types to include in the database. When a WeeWX database is first created, it uses a Python version of the schema to initialize the database. However, once the database has been created, the schema is read directly from the database and the Python version is not used again \u2014 any changes to it will have no effect. This means that the strategy for modifying the schema depends on whether the database already exists.","title":"Customizing the database"},{"location":"custom/database/#specifying-a-schema-for-a-new-database","text":"If the database does not exist yet, then you will want to pick an appropriate starting schema. If it's not exactly what you want, you can modify it to fit your needs before creating the database.","title":"Specifying a schema for a new database"},{"location":"custom/database/#picking-a-starting-schema","text":"WeeWX gives you a choice of three different schemas to choose from when creating a new database: Name Number of observation types Comment schemas.wview.schema 49 The original schema that came with wview. schemas.wview_extended.schema 111 A version of the wview schema, which has been extended with many new types. This is the default version. schemas.wview_small.schema 20 A minimalist version of the wview schema. For most users, the default database schema, schemas.wview_extended.schema , will work just fine. To specify which schema to use when creating a database, modify option schema in section [DataBindings] in weewx.conf . For example, suppose you wanted to use the classic (and smaller) schema schemas.wview.schema instead of the default schemas.wview_extended.schema . Then the section [DataBindings] would look like: [DataBindings] [[wx_binding]] database = archive_sqlite table_name = archive manager = weewx.manager.DaySummaryManager schema = schemas.wview.schema Now, when you start WeeWX, it will use this new choice instead of the default. Note This only works when the database is first created . Thereafter, WeeWX reads the schema directly from the database. Changing this option will have no effect!","title":"Picking a starting schema"},{"location":"custom/database/#modify-starting-schema","text":"If none of the three starting schemas that come with WeeWX suits your purposes, you can easily create your own. Just pick one of the three schemas as a starting point, then modify it. Put the results in the user subdirectory, where it will be safe from upgrades. For example, suppose you like the schemas.wview_small schema, but you need to store the type electricity from the example Adding a second data source . The type electricity does not appear in the schema, so you'll have to add it before starting up WeeWX. We will call the resulting new schema user.myschema.schema . If you did a Debian install, here's how you would do this: # Copy the wview_small schema over to the user subdirectory and rename it myschema: sudo cp /usr/share/weewx/schemas/wview_small.py /usr/share/weewx/user/myschema.py # Edit it using your favorite text editor sudo nano /usr/share/weewx/user/myschema.py If you did a pip install, it can be difficult to find the starting schema because it can be buried deep in the Python library tree. It's easier to just download from the git repository and start with that: # Download the wview_small schema and rename it to myschema.py cd ~/weewx-data/bin/user wget https://raw.githubusercontent.com/weewx/weewx/master/bin/schemas/wview_small.py mv wview_small.py myschema.py # Edit it using your favorite text editor nano myschema.py In myschema.py change this: ... ('windchill', 'REAL'), ('windDir', 'REAL'), ('windGust', 'REAL'), ('windGustDir', 'REAL'), ('windSpeed', 'REAL'), ] to this ... ('windchill', 'REAL'), ('windDir', 'REAL'), ('windGust', 'REAL'), ('windGustDir', 'REAL'), ('windSpeed', 'REAL'), ('electricity', 'REAL'), ] The only change was the addition ( highlighted ) of electricity to the list of observation names. Now change option schema under [DataBindings] in weewx.conf to use your new schema: [DataBindings] [[wx_binding]] database = archive_sqlite table_name = archive manager = weewx.manager.DaySummaryManager schema = user.myschema.schema Start WeeWX. When the new database is created, it will use your modified schema instead of the default. Note This will only work when the database is first created! Thereafter, WeeWX reads the schema directly from the database and your changes will have no effect!","title":"Modifying a starting schema"},{"location":"custom/database/#modify-the-schema-of-an-existing-database","text":"The previous section covers the case where you do not have an existing database, so you modify a starting schema, then use it to initialize the database. But, what if you already have a database, and you want to modify its schema, perhaps by adding a column or two? Creating a new starting schema is not going to work because it is only used when the database is first created. Here is where the command weectl database can be useful. There are two ways to do this. Both are covered below. Modify the database in situ . This choice works best for small changes. Reconfigure the old database to a new one while modifying it along the way, This choice is best for large modifications. Warning Before using weectl database , MAKE A BACKUP FIRST! Be sure to stop weewxd first.","title":"Modify the schema of an existing database"},{"location":"custom/database/#modify-the-database-in-situ","text":"If you want to make some minor modifications to an existing database, perhaps adding or removing a column, then this can easily be done using the command weectl database with an appropriate action. We will cover the cases of adding, removing, and renaming a type. See the documentation for weectl database for more details.","title":"Modify the database in situ"},{"location":"custom/database/#add-archive-type","text":"Suppose you have an existing database, to which you want to add a type, such as the type electricity from the example Adding a second data source . This can be done in one easy step using the action weectl database add-column : weectl database add-column electricity The tool not only adds electricity to the main archive table, but also to the daily summaries.","title":"Adding a type"},{"location":"custom/database/#remove-archive-type","text":"In a similar manner, the tool can remove any unneeded types from an existing database. For example, suppose you are using the schemas.wview schema, but you're pretty sure you're not going to need to store soil moisture. You can drop the unnecessary types this way: weectl database drop-columns soilMoist1 soilMoist2 soilMoist3 soilMoist4 Unlike the action add-column , the action drop-columns can take more than one type. This is done in the interest of efficiency: adding new columns is easy and fast with the SQLite database, but dropping columns requires copying the whole database. By specifying more than one type, you can amortize the cost over a single invocation of the utility. Warning Dropping types from a database means you will lose any data associated with them! The data cannot be recovered.","title":"Removing a type"},{"location":"custom/database/#rename-archive-type","text":"Suppose you just want to rename a type? This can be done using the action rename-column . Here's an example where you rename soilMoist1 to soilMoistGarden : weectl database rename-column soilMoist1 soilMoistGarden Note how the action rename-column requires two positional arguments: the column being renamed, and its final name.","title":"Renaming a type"},{"location":"custom/database/#reconfigure-using-new-schema","text":"If you are making major changes to your database, you may find it easier to create a brand-new database using the schema you want, then transfer all data from the old database into the new one. This approach is more work, and takes more processing time than the in situ strategies outlines above, but has the advantage that it leaves behind a record of exactly the schema you are using. Here is the general strategy to do this. Create a new schema that includes exactly the types that you want. Specify this schema as the starting schema for the database. Make sure you have the necessary permissions to create the new database. Use the action weectl database reconfigure to create the new database and populate it with data from the old database. Shuffle databases around so WeeWX will use the new database. Here are the details: Create a new schema. First step is to create a new schema with exactly the types you want. See the instructions above Modify a starting schema . As an example, suppose your new schema is called user.myschema.schema . Set as starting schema. Set your new schema as the starting schema with whatever database binding you are working with (generally, wx_binding ). For example: [DataBindings] [[wx_binding]] database = archive_sqlite table_name = archive manager = weewx.manager.DaySummaryManager schema = user.myschema.schema Check permissions. The transfer action will create a new database with the same name as the old, except with the suffix _new attached to the end. Make sure you have the necessary permissions to do this. In particular, if you are using MySQL, you will need CREATE privileges. Create and populate the new database. Use the command weectl database with the reconfigure action. weectl database reconfigure This will create a new database (nominally, weewx.sdb_new if you are using SQLite, weewx_new if you are using MySQL), using the schema found in user.myschema.schema , and populate it with data from the old database. Shuffle the databases. Now arrange things so WeeWX can find the new database. Warning Make a backup of the data before doing any of the next steps! You can either shuffle the databases around so the new database has the same name as the old database, or edit weewx.conf to use the new database name. To do the former: SQLite MySQL cd ~/weewx-data/archive mv weewx.sdb_new weewx.sdb mysql -u <username> --password = <mypassword> mysql> DROP DATABASE weewx ; # Delete the old database mysql> CREATE DATABASE weewx ; # Create a new one with the same name mysql> RENAME TABLE weewx_new.archive TO weewx.archive ; # Rename to the nominal name It's worth noting that there's actually a hidden, last step: rebuilding the daily summaries inside the new database. This will be done automatically by weewxd at the next startup. Alternatively, it can be done manually using the weectl database rebuild-daily action: weectl database rebuild-daily","title":"Reconfigure database using a new schema"},{"location":"custom/database/#change-unit-system","text":"Normally, data are stored in the databases using US Customary units, and you shouldn't care; it is an \"implementation detail\". Data can always be displayed using any set of units you want \u2014 the section Changing unit systems explains how to change the reporting units. Nevertheless, there may be special situations where you wish to store the data in Metric units. For example, you may need to allow direct programmatic access to the database from another piece of software that expects metric units. You should not change the database unit system midstream. That is, do not start with one unit system then, some time later, switch to another. WeeWX cannot handle databases with mixed unit systems \u2014 see the section [StdConvert] in the WeeWX User's Guide. However, you can reconfigure the database by copying it to a new database, performing the unit conversion along the way. You then use this new database. The general strategy is identical to the strategy outlined above in the section Reconfigure database using new schema . The only difference is that instead of specifying a new starting schema, you specify a different database unit system. This means that instead of steps 1 and 2 above, you edit the configuration file and change option target_unit in section [StdConvert] to reflect your choice. For example, if you are switching to metric units, the option will look like: [StdConvert] target_unit = METRICWX After changing target_unit , you then go ahead with the rest of the steps. That is run the action weectl database reconfigure , then shuffle the databases.","title":"Changing the unit system in an existing database"},{"location":"custom/database/#rebuilding-the-daily-summaries","text":"The weectl database command can also be used to rebuild the daily summaries: weectl database rebuild-daily In most cases this will be sufficient; however, if anomalies remain in the daily summaries the daily summary tables may be dropped first before rebuilding: weectl database drop-daily Then try again with weectl database rebuild-daily .","title":"Rebuilding the daily summaries"},{"location":"custom/derived/","text":"Adding new, derived types \u00b6 In the section Adding a second data source , we saw an example of how to create a new type for a new data source. But, what if you just want to add a type that is a derivation of existing types? The WeeWX type dewpoint is an example of this: it's a function of two observables, outTemp , and outHumidity . WeeWX calculates it automatically for you. Calculating new, derived types is the job of the WeeWX XTypes system. It can also allow you to add new aggregation types. See the Wiki article Extensible types (XTypes) for complete details on how the XTypes system works.","title":"Derived types"},{"location":"custom/derived/#adding-new-derived-types","text":"In the section Adding a second data source , we saw an example of how to create a new type for a new data source. But, what if you just want to add a type that is a derivation of existing types? The WeeWX type dewpoint is an example of this: it's a function of two observables, outTemp , and outHumidity . WeeWX calculates it automatically for you. Calculating new, derived types is the job of the WeeWX XTypes system. It can also allow you to add new aggregation types. See the Wiki article Extensible types (XTypes) for complete details on how the XTypes system works.","title":"Adding new, derived types"},{"location":"custom/drivers/","text":"Porting to new hardware \u00b6 Naturally, this is an advanced topic but, nevertheless, I'd like to encourage any Python wizards out there to give it a try. Of course, I have selfish reasons for this: I don't want to have to buy every weather station ever invented, and I don't want my roof to look like a weather station farm! A driver communicates with hardware. Each driver is a single python file that contains the code that is the interface between a device and WeeWX. A driver may communicate directly with hardware using a MODBus, USB, serial, or other physical interface. Or it may communicate over a network to a physical device or a web service. General guidelines \u00b6 The driver should emit data as it receives it from the hardware (no caching). The driver should emit only data it receives from the hardware (no \"filling in the gaps\"). The driver should not modify the data unless the modification is directly related to the hardware ( e.g. , decoding a hardware-specific sensor value). If the hardware flags \"bad data\", then the driver should emit a null value for that datum (Python None ). The driver should not calculate any derived variables (such as dewpoint). The service StdWXService will do that. However, if the hardware emits a derived variable, then the driver should emit it. Implement the driver \u00b6 Create a file in the user directory, say mydriver.py . This file will contain the driver class as well as any hardware-specific code. Do not put it in the weewx/drivers directory, or it will be deleted when you upgrade WeeWX. Inherit from the abstract base class weewx.drivers.AbstractDevice . Try to implement as many of its methods as you can. At the very minimum, you must implement the first three methods, loader , hardware_name , and genLoopPackets . loader() \u00b6 This is a factory function that returns an instance of your driver. It has two arguments: the configuration dictionary, and a reference to the WeeWX engine. hardware_name \u00b6 This is an attribute that should return a string with a short nickname for the hardware, such as \"ACME X90\" genLoopPackets() \u00b6 This should be a Python generator function that yields loop packets, one after another. Don't worry about stopping it: the engine will do this when an archive record is due. A \"loop packet\" is a dictionary. At the very minimum it must contain keys for the observation time and for the units used within the packet. Required keys dateTime The time of the observation in unix epoch time. usUnits The unit system used. weewx.US for US customary, weewx.METRICWX , or weewx.METRIC for metric. See the Units for their exact definitions. The dictionaries USUnits , MetricWXUnits , and MetricUnits in file units.py , can also be useful. Then include any observation types you have in the dictionary. Every packet need not contain the same set of observation types. Different packets can use different unit systems, but all observations within a packet must use the same unit system. If your hardware is capable of measuring an observation type but, for whatever reason, its value is bad (maybe a bad checksum?), then set its value to None . If your hardware is incapable of measuring an observation type, then leave it out of the dictionary. A couple of observation types are tricky, in particular, rain . The field rain in a LOOP packet should be the amount of rain that has fallen since the last packet . Because LOOP packets are emitted fairly frequently, this is likely to be a small number. If your hardware does not provide this value, you might have to infer it from changes in whatever value it provides, for example changes in the daily or monthly rainfall. Wind is another tricky one. It is actually broken up into four different observations: windSpeed , windDir , windGust , and windGustDir . Supply as many as you can. The directions should be compass directions in degrees (0=North, 90=East, etc.). Be careful when reporting pressure. There are three observations related to pressure. Some stations report only the station pressure, others calculate and report sea level pressures. Pressure types pressure The Station Pressure (SP), which is the raw, absolute pressure measured by the station. This is the true barometric pressure for the station. barometer The Sea Level Pressure (SLP) obtained by correcting the Station Pressure for altitude and local temperature. This is the pressure reading most commonly used by meteorologist to track weather systems at the surface, and this is the pressure that is uploaded to weather services by WeeWX. It is the station pressure reduced to mean sea level using local altitude and local temperature. altimeter The Altimeter Setting (AS) obtained by correcting the Station Pressure for altitude. This is the pressure reading most commonly heard in weather reports. It is not the true barometric pressure of a station, but rather the station pressure reduced to mean sea level using altitude and an assumed temperature average. genArchiveRecords() \u00b6 If your hardware does not have an archive record logger, then WeeWX can do the record generation for you. It will automatically collect all the types it sees in your loop packets then emit a record with the averages (in some cases the sum or max value) of all those types. If it doesn't see a type, then it won't appear in the emitted record. However, if your hardware does have a logger, then you should implement method genArchiveRecords() as well. It should be a generator function that returns all the records since a given time. archive_interval \u00b6 If you implement function genArchiveRecords() , then you should also implement archive_interval as either an attribute, or as a property function . It should return the archive interval in seconds. getTime() \u00b6 If your hardware has an onboard clock and supports reading the time from it, then you may want to implement this method. It takes no argument. It should return the time in Unix Epoch Time. setTime() \u00b6 If your hardware has an onboard clock and supports setting it, then you may want to implement this method. It takes no argument and does not need to return anything. closePort() \u00b6 If the driver needs to close a serial port, terminate a thread, close a database, or perform any other activity before the application terminates, then you must supply this function. WeeWX will call it if it needs to shut down your console (usually in the case of an error). Define the configuration \u00b6 You then include a new section in the configuration file weewx.conf that includes any options your driver needs. It should also include an entry driver that points to where your driver can be found. Set option station_type to your new section type and your driver will be loaded. Examples \u00b6 The fileparse driver is perhaps the simplest example of a WeeWX driver. It reads name-value pairs from a file and uses the values as sensor 'readings'. The code is actually packaged as an extension, located in examples/fileparse , making it a good example of not only writing a device driver, but also of how to package an extension. The actual driver itself is in examples/fileparse/bin/user/fileparse.py . Another good example is the simulator code located in weewx/drivers/simulator.py . It's dirt simple, and you can easily play with it. Many people have successfully used it as a starting point for writing their own custom driver. The Ultimeter ( ultimeter.py ) and WMR100 ( wmr100.py ) drivers illustrate how to communicate with serial and USB hardware, respectively. They also show different approaches for decoding data. Nevertheless, they are pretty straightforward. The driver for the Vantage series is by far the most complicated. It actually multi-inherits from not only AbstractDevice , but also StdService . That is, it also participates in the engine as a service. Naturally, there are a lot of subtleties that have been glossed over in this high-level description. If you run into trouble, look for help in the weewx-development group.","title":"Drivers"},{"location":"custom/drivers/#porting","text":"Naturally, this is an advanced topic but, nevertheless, I'd like to encourage any Python wizards out there to give it a try. Of course, I have selfish reasons for this: I don't want to have to buy every weather station ever invented, and I don't want my roof to look like a weather station farm! A driver communicates with hardware. Each driver is a single python file that contains the code that is the interface between a device and WeeWX. A driver may communicate directly with hardware using a MODBus, USB, serial, or other physical interface. Or it may communicate over a network to a physical device or a web service.","title":"Porting to new hardware"},{"location":"custom/drivers/#general-guidelines","text":"The driver should emit data as it receives it from the hardware (no caching). The driver should emit only data it receives from the hardware (no \"filling in the gaps\"). The driver should not modify the data unless the modification is directly related to the hardware ( e.g. , decoding a hardware-specific sensor value). If the hardware flags \"bad data\", then the driver should emit a null value for that datum (Python None ). The driver should not calculate any derived variables (such as dewpoint). The service StdWXService will do that. However, if the hardware emits a derived variable, then the driver should emit it.","title":"General guidelines"},{"location":"custom/drivers/#implement-the-driver","text":"Create a file in the user directory, say mydriver.py . This file will contain the driver class as well as any hardware-specific code. Do not put it in the weewx/drivers directory, or it will be deleted when you upgrade WeeWX. Inherit from the abstract base class weewx.drivers.AbstractDevice . Try to implement as many of its methods as you can. At the very minimum, you must implement the first three methods, loader , hardware_name , and genLoopPackets .","title":"Implement the driver"},{"location":"custom/drivers/#loader","text":"This is a factory function that returns an instance of your driver. It has two arguments: the configuration dictionary, and a reference to the WeeWX engine.","title":"loader()"},{"location":"custom/drivers/#hardware_name","text":"This is an attribute that should return a string with a short nickname for the hardware, such as \"ACME X90\"","title":"hardware_name"},{"location":"custom/drivers/#genlooppackets","text":"This should be a Python generator function that yields loop packets, one after another. Don't worry about stopping it: the engine will do this when an archive record is due. A \"loop packet\" is a dictionary. At the very minimum it must contain keys for the observation time and for the units used within the packet. Required keys dateTime The time of the observation in unix epoch time. usUnits The unit system used. weewx.US for US customary, weewx.METRICWX , or weewx.METRIC for metric. See the Units for their exact definitions. The dictionaries USUnits , MetricWXUnits , and MetricUnits in file units.py , can also be useful. Then include any observation types you have in the dictionary. Every packet need not contain the same set of observation types. Different packets can use different unit systems, but all observations within a packet must use the same unit system. If your hardware is capable of measuring an observation type but, for whatever reason, its value is bad (maybe a bad checksum?), then set its value to None . If your hardware is incapable of measuring an observation type, then leave it out of the dictionary. A couple of observation types are tricky, in particular, rain . The field rain in a LOOP packet should be the amount of rain that has fallen since the last packet . Because LOOP packets are emitted fairly frequently, this is likely to be a small number. If your hardware does not provide this value, you might have to infer it from changes in whatever value it provides, for example changes in the daily or monthly rainfall. Wind is another tricky one. It is actually broken up into four different observations: windSpeed , windDir , windGust , and windGustDir . Supply as many as you can. The directions should be compass directions in degrees (0=North, 90=East, etc.). Be careful when reporting pressure. There are three observations related to pressure. Some stations report only the station pressure, others calculate and report sea level pressures. Pressure types pressure The Station Pressure (SP), which is the raw, absolute pressure measured by the station. This is the true barometric pressure for the station. barometer The Sea Level Pressure (SLP) obtained by correcting the Station Pressure for altitude and local temperature. This is the pressure reading most commonly used by meteorologist to track weather systems at the surface, and this is the pressure that is uploaded to weather services by WeeWX. It is the station pressure reduced to mean sea level using local altitude and local temperature. altimeter The Altimeter Setting (AS) obtained by correcting the Station Pressure for altitude. This is the pressure reading most commonly heard in weather reports. It is not the true barometric pressure of a station, but rather the station pressure reduced to mean sea level using altitude and an assumed temperature average.","title":"genLoopPackets()"},{"location":"custom/drivers/#genarchiverecords","text":"If your hardware does not have an archive record logger, then WeeWX can do the record generation for you. It will automatically collect all the types it sees in your loop packets then emit a record with the averages (in some cases the sum or max value) of all those types. If it doesn't see a type, then it won't appear in the emitted record. However, if your hardware does have a logger, then you should implement method genArchiveRecords() as well. It should be a generator function that returns all the records since a given time.","title":"genArchiveRecords()"},{"location":"custom/drivers/#archive_interval","text":"If you implement function genArchiveRecords() , then you should also implement archive_interval as either an attribute, or as a property function . It should return the archive interval in seconds.","title":"archive_interval"},{"location":"custom/drivers/#gettime","text":"If your hardware has an onboard clock and supports reading the time from it, then you may want to implement this method. It takes no argument. It should return the time in Unix Epoch Time.","title":"getTime()"},{"location":"custom/drivers/#settime","text":"If your hardware has an onboard clock and supports setting it, then you may want to implement this method. It takes no argument and does not need to return anything.","title":"setTime()"},{"location":"custom/drivers/#closeport","text":"If the driver needs to close a serial port, terminate a thread, close a database, or perform any other activity before the application terminates, then you must supply this function. WeeWX will call it if it needs to shut down your console (usually in the case of an error).","title":"closePort()"},{"location":"custom/drivers/#define-the-configuration","text":"You then include a new section in the configuration file weewx.conf that includes any options your driver needs. It should also include an entry driver that points to where your driver can be found. Set option station_type to your new section type and your driver will be loaded.","title":"Define the configuration"},{"location":"custom/drivers/#examples","text":"The fileparse driver is perhaps the simplest example of a WeeWX driver. It reads name-value pairs from a file and uses the values as sensor 'readings'. The code is actually packaged as an extension, located in examples/fileparse , making it a good example of not only writing a device driver, but also of how to package an extension. The actual driver itself is in examples/fileparse/bin/user/fileparse.py . Another good example is the simulator code located in weewx/drivers/simulator.py . It's dirt simple, and you can easily play with it. Many people have successfully used it as a starting point for writing their own custom driver. The Ultimeter ( ultimeter.py ) and WMR100 ( wmr100.py ) drivers illustrate how to communicate with serial and USB hardware, respectively. They also show different approaches for decoding data. Nevertheless, they are pretty straightforward. The driver for the Vantage series is by far the most complicated. It actually multi-inherits from not only AbstractDevice , but also StdService . That is, it also participates in the engine as a service. Naturally, there are a lot of subtleties that have been glossed over in this high-level description. If you run into trouble, look for help in the weewx-development group.","title":"Examples"},{"location":"custom/extensions/","text":"Extensions \u00b6 A key feature of WeeWX is its ability to be extended by installing 3rd party extensions . Extensions are a way to package one or more customizations so that they can be installed and distributed as a functional group. Customizations typically fall into one of these categories: search list extension template skin service generator driver Take a look at the WeeWX wiki for a sampling of some of the extensions that are available. Creating an extension \u00b6 Now that you have made some customizations, you might want to share those changes with other WeeWX users. Put your customizations into an extension to make installation, removal, and distribution easier. Here are a few guidelines for creating extensions: Extensions should not modify or depend upon existing skins. An extension should include its own, standalone skin to illustrate any templates, search list extension, or generator features. Extensions should not modify the database schemas. If it requires data not found in the default databases, an extension should provide its own database and schema. Although one extension might use another extension, take care to write the dependent extension so that it fails gracefully. For example, a skin might use data from the forecast extension, but what happens if the forecast extension is not installed? Make the skin display a message about \"forecast not installed\" but otherwise continue to function. Packaging an extension \u00b6 The structure of an extension mirrors that of WeeWX itself. If the customizations include a skin, the extension will have a skins directory. If the customizations include python code, the extension will have a bin/user directory. Each extension should also include: readme.txt or readme.md - a summary of what the extension does, a list of pre-requisites (if any), and instructions for installing the extension manually changelog - an enumeration of changes in each release install.py - python code used by the WeeWX ExtensionInstaller For example, here is the structure of an extension called basic , which installs a skin called Basic . You can find it in the examples subdirectory. basic \u251c\u2500\u2500 changelog \u251c\u2500\u2500 install.py \u251c\u2500\u2500 readme.md \u2514\u2500\u2500 skins \u2514\u2500\u2500 Basic \u251c\u2500\u2500 basic.css \u251c\u2500\u2500 current.inc \u251c\u2500\u2500 favicon.ico \u251c\u2500\u2500 hilo.inc \u251c\u2500\u2500 index.html.tmpl \u251c\u2500\u2500 lang \u2502 \u251c\u2500\u2500 en.conf \u2502 \u2514\u2500\u2500 fr.conf \u2514\u2500\u2500 skin.conf Here is the structure of an extension called xstats , which implements a search list extension, as well as a simple skin. You can also find it in the examples subdirectory. xstats \u251c\u2500\u2500 bin \u2502 \u2514\u2500\u2500 user \u2502 \u2514\u2500\u2500 xstats.py \u251c\u2500\u2500 changelog \u251c\u2500\u2500 install.py \u251c\u2500\u2500 readme.txt \u2514\u2500\u2500 skins \u2514\u2500\u2500 xstats \u251c\u2500\u2500 index.html.tmpl \u2514\u2500\u2500 skin.conf To distribute an extension, simply create a compressed archive of the extension directory. For example, create the compressed archive for the basic skin like this: tar cvfz basic.tar.gz basic Once an extension has been packaged, it can be installed using weectl : weectl extension install EXTENSION-LOCATION Default values \u00b6 Whenever possible, an extension should just work , with a minimum of input from the user. At the same time, parameters for the most frequently requested options should be easily accessible and easy to modify. For skins, this might mean parameterizing strings into [Labels] for easier customization. Or it might mean providing parameters in [Extras] to control skin behavior or to parameterize links. Some parameters must be specified, and no default value would be appropriate. For example, an uploader may require a username and password, or a driver might require a serial number or IP address. In these cases, use a default value in the configuration that will obviously require modification. The username might default to REPLACE_ME . Also be sure to add a log entry that indicates the feature is disabled until the value has been specified. In the case of drivers, use the configuration editor to prompt for this type of required value.","title":"Extensions"},{"location":"custom/extensions/#extensions","text":"A key feature of WeeWX is its ability to be extended by installing 3rd party extensions . Extensions are a way to package one or more customizations so that they can be installed and distributed as a functional group. Customizations typically fall into one of these categories: search list extension template skin service generator driver Take a look at the WeeWX wiki for a sampling of some of the extensions that are available.","title":"Extensions"},{"location":"custom/extensions/#creating-an-extension","text":"Now that you have made some customizations, you might want to share those changes with other WeeWX users. Put your customizations into an extension to make installation, removal, and distribution easier. Here are a few guidelines for creating extensions: Extensions should not modify or depend upon existing skins. An extension should include its own, standalone skin to illustrate any templates, search list extension, or generator features. Extensions should not modify the database schemas. If it requires data not found in the default databases, an extension should provide its own database and schema. Although one extension might use another extension, take care to write the dependent extension so that it fails gracefully. For example, a skin might use data from the forecast extension, but what happens if the forecast extension is not installed? Make the skin display a message about \"forecast not installed\" but otherwise continue to function.","title":"Creating an extension"},{"location":"custom/extensions/#packaging-an-extension","text":"The structure of an extension mirrors that of WeeWX itself. If the customizations include a skin, the extension will have a skins directory. If the customizations include python code, the extension will have a bin/user directory. Each extension should also include: readme.txt or readme.md - a summary of what the extension does, a list of pre-requisites (if any), and instructions for installing the extension manually changelog - an enumeration of changes in each release install.py - python code used by the WeeWX ExtensionInstaller For example, here is the structure of an extension called basic , which installs a skin called Basic . You can find it in the examples subdirectory. basic \u251c\u2500\u2500 changelog \u251c\u2500\u2500 install.py \u251c\u2500\u2500 readme.md \u2514\u2500\u2500 skins \u2514\u2500\u2500 Basic \u251c\u2500\u2500 basic.css \u251c\u2500\u2500 current.inc \u251c\u2500\u2500 favicon.ico \u251c\u2500\u2500 hilo.inc \u251c\u2500\u2500 index.html.tmpl \u251c\u2500\u2500 lang \u2502 \u251c\u2500\u2500 en.conf \u2502 \u2514\u2500\u2500 fr.conf \u2514\u2500\u2500 skin.conf Here is the structure of an extension called xstats , which implements a search list extension, as well as a simple skin. You can also find it in the examples subdirectory. xstats \u251c\u2500\u2500 bin \u2502 \u2514\u2500\u2500 user \u2502 \u2514\u2500\u2500 xstats.py \u251c\u2500\u2500 changelog \u251c\u2500\u2500 install.py \u251c\u2500\u2500 readme.txt \u2514\u2500\u2500 skins \u2514\u2500\u2500 xstats \u251c\u2500\u2500 index.html.tmpl \u2514\u2500\u2500 skin.conf To distribute an extension, simply create a compressed archive of the extension directory. For example, create the compressed archive for the basic skin like this: tar cvfz basic.tar.gz basic Once an extension has been packaged, it can be installed using weectl : weectl extension install EXTENSION-LOCATION","title":"Packaging an extension"},{"location":"custom/extensions/#default-values","text":"Whenever possible, an extension should just work , with a minimum of input from the user. At the same time, parameters for the most frequently requested options should be easily accessible and easy to modify. For skins, this might mean parameterizing strings into [Labels] for easier customization. Or it might mean providing parameters in [Extras] to control skin behavior or to parameterize links. Some parameters must be specified, and no default value would be appropriate. For example, an uploader may require a username and password, or a driver might require a serial number or IP address. In these cases, use a default value in the configuration that will obviously require modification. The username might default to REPLACE_ME . Also be sure to add a log entry that indicates the feature is disabled until the value has been specified. In the case of drivers, use the configuration editor to prompt for this type of required value.","title":"Default values"},{"location":"custom/image-generator/","text":"The Image generator \u00b6 WeeWX is configured to generate a set of useful plots. But, what if you don't like how they look, or you want to generate different plots, perhaps with different aggregation types? The Image generator is controlled by the configuration options in the reference [ImageGenerator] . These options are specified in the [ImageGenerator] section of a skin configuration file. Let's take a look at the beginning part of this section. It looks like this: [ImageGenerator] ... image_width = 500 image_height = 180 image_background_color = #f5f5f5 chart_background_color = #d8d8d8 chart_gridline_color = #a0a0a0 ... The options directly under the section name [ImageGenerator] will apply to all plots, unless overridden in subsections. So, unless otherwise changed, all plots will be 500 pixels in width, 180 pixels in height, and will have an RGB background color of #f5f5f5 , a very light gray (HTML color \"WhiteSmoke\"). The chart itself will have a background color of #d8d8d8 (a little darker gray), and the gridlines will be #a0a0a0 (still darker). The other options farther down (not shown) will also apply to all plots. Time periods \u00b6 After the \"global\" options at the top of section [ImageGenerator] , comes a set of subsections, one for each time period (day, week, month, and year). These subsections define the nature of aggregation and plot types for that time period. For example, here is a typical set of options for subsection [[month_images]] . It controls which \"monthly\" images will get generated, and what they will look like: [[month_images]] x_label_format = %d bottom_label_format = %m/%d/%y %H:%M time_length = 2592000 # == 30 days aggregate_type = avg aggregate_interval = 3h show_daynight = false The option x_label_format gives a strftime() type format for the x-axis. In this example, it will only show days (format option %d ). The bottom_label_format is the format used to time stamp the image at the bottom. In this example, it will show the time as something like 10/25/09 15:35 . A plot will cover a nominal 30 days, and all items included in it will use an aggregate type of averaging over 3 hours. Finally, by setting option show_daynight to false , we are requesting that day-night, shaded bands not be shown. Image files \u00b6 Within each time period subsection is another nesting, one for each image to be generated. The title of each sub-sub-section is the filename to be used for the image. Finally, at one additional nesting level (!) are the logical names of all the line types to be drawn in the image. Like elsewhere, the values specified in the level above can be overridden. For example, here is a typical set of options for sub-sub-section [[[monthrain]]] : [[[monthrain]]] plot_type = bar yscale = None, None, 0.02 [[[[rain]]]] aggregate_type = sum aggregate_interval = 1d label = Rain (daily total) This will generate an image file with name monthrain.png . It will be a bar plot. Option yscale controls the y-axis scaling \u2014 if left out, the scale will be chosen automatically. However, in this example we are choosing to exercise some degree of control by specifying values explicitly. The option is a 3-way tuple ( ylow , yhigh , min_interval ), where ylow and yhigh are the minimum and maximum y-axis values, respectively, and min_interval is the minimum tick interval. If set to None , the corresponding value will be automatically chosen. So, in this example, the setting yscale = None, None, 0.02 will cause WeeWX to pick sensible y minimum and maximum values, but require that the tick increment ( min_interval ) be at least 0.02. Continuing on with the example above, there will be only one plot \"line\" (it will actually be a series of bars) and it will have logical name rain . Because we have not said otherwise, the database column name to be used for this line will be the same as its logical name, that is, rain , but this can be overridden. The aggregation type will be summing (overriding the averaging specified in subsection [[month_images]] ), so you get the total rain over the aggregate period (rather than the average) over an aggregation interval of 86,400 seconds (one day). The plot line will be titled with the indicated label of 'Rain (daily total)'. The result of all this is the following plot: Including more than one type in a plot \u00b6 More than one observation can be included in a plot. For example, here is how to generate a plot with the week's outside temperature as well as dewpoint: [[[monthtempdew]]] [[[[outTemp]]]] [[[[dewpoint]]]] This would create an image in file monthtempdew.png that includes a line plot of both outside temperature and dewpoint: Including a type more than once in a plot \u00b6 Another example. Suppose that you want a plot of the day's temperature, overlaid with hourly averages. Here, you are using the same data type ( outTemp ) for both plot lines, the first with averages, the second without. If you do the obvious it won't work: # WRONG ## [[[daytemp_with_avg]]] [[[[outTemp]]]] aggregate_type = avg aggregate_interval = 1h [[[[outTemp]]]] # OOPS! The same section name appears more than once! The option parser does not allow the same section name ( outTemp in this case) to appear more than once at a given level in the configuration file, so an error will be declared (technical reason: formally, the sections are an unordered dictionary). If you wish for the same observation to appear more than once in a plot then there is a trick you must know: use option data_type . This will override the default action that the logical line name is used for the database column. So, our example would look like this: [[[daytemp_with_avg]]] [[[[avgTemp]]]] data_type = outTemp aggregate_type = avg aggregate_interval = 1h label = Avg. Temp. [[[[outTemp]]]] Here, the first plot line has been given the name avgTemp to distinguish it from the second line outTemp . Any name will do \u2014 it just has to be different. We have specified that the first line will use data type outTemp and that it will use averaging over a one-hour period. The second also uses outTemp , but will not use averaging. The result is a nice plot of the day's temperature, overlaid with a one-hour smoothed average: One more example. This one shows daily high and low temperatures for a year: [[year_images]] [[[yearhilow]]] [[[[hi]]]] data_type = outTemp aggregate_type = max label = High [[[[low]]]] data_type = outTemp aggregate_type = min label = Low Temperature This results in the plot yearhilow.png : Including arbitrary expressions \u00b6 The option data_type can actually be any arbitrary SQL expression that is valid in the context of the available types in the schema. For example, say you wanted to plot the difference between inside and outside temperature for the year. This could be done with: [[year_images]] [[[yeardiff]]] [[[[diff]]]] data_type = inTemp-outTemp label = Inside - Outside Note that the option data_type is now an expression representing the difference between inTemp and outTemp , the inside and outside temperature, respectively. This results in a plot yeardiff.png : Changing the unit used in a plot \u00b6 Normally, the unit used in a plot is set by the unit group of the observation types in the plot. For example, consider this plot of today's outside temperature and dewpoint: [[day_images]] ... [[[daytempdew]]] [[[[outTemp]]]] [[[[dewpoint]]]] Both outTemp and dewpoint belong to unit group group_temperature , so this plot will use whatever unit has been specified for that group. See the section Mixed units for details. However, supposed you'd like to offer both Metric and US Customary versions of the same plot? You can do this by using option unit to override the unit used for individual plots: [[day_images]] ... [[[daytempdewUS]]] unit = degree_F [[[[outTemp]]]] [[[[dewpoint]]]] [[[daytempdewMetric]]] unit = degree_C [[[[outTemp]]]] [[[[dewpoint]]]] This will produce two plots: file daytempdewUS.png will be in degrees Fahrenheit, while file dayTempMetric.png will use degrees Celsius. Line gaps \u00b6 If there is a time gap in the data, the option line_gap_fraction controls how line plots will be drawn. Here's what a plot looks like without and with this option being specified: No line_gap_fraction specified With line_gap_fraction=0.01 . Note how each line has been split into two lines. Progressive vector plots \u00b6 WeeWX can produce progressive vector plots as well as the more conventional x-y plots. To produce these, use plot type vector . You need a vector type to produce this kind of plot. There are two: windvec , and windgustvec . While they do not actually appear in the database, WeeWX understands that they represent special vector-types. The first, windvec , represents the average wind in an archive period, the second, windgustvec the max wind in an archive period. Here's how to produce a progressive vector for one week that shows the hourly biggest wind gusts, along with hourly averages: [[[weekgustoverlay]]] aggregate_interval = 1h [[[[windvec]]]] label = Hourly Wind plot_type = vector aggregate_type = avg [[[[windgustvec]]]] label = Gust Wind plot_type = vector aggregate_type = max This will produce an image file with name weekgustoverlay.png . It will consist of two progressive vector plots, both using hourly aggregation (3,600 seconds). For the first set of vectors, the hourly average will be used. In the second, the max of the gusts will be used: By default, the sticks in the progressive wind plots point towards the wind source. That is, the stick for a wind from the west will point left. If you have a chronic wind direction (as I do), you may want to rotate the default direction so that all the vectors do not line up over the x-axis, overlaying each other. Do this by using option vector_rotate . For example, with my chronic westerlies, I set vector_rotate to 90.0 for the plot above, so winds out of the west point straight up. If you use this kind of plot (the out-of-the-box version of WeeWX includes daily, weekly, monthly, and yearly progressive wind plots), a small compass rose will be put in the lower-left corner of the image to show the orientation of North. Overriding values \u00b6 Remember that values at any level can override values specified at a higher level. For example, say you want to generate the standard plots, but for a few key observation types such as barometer, you want to also generate some oversized plots to give you extra detail, perhaps for an HTML popup. The standard skin.conf file specifies plot size of 300x180 pixels, which will be used for all plots unless overridden: [ImageGenerator] ... image_width = 300 image_height = 180 The standard plot of barometric pressure will appear in daybarometer.png : [[[daybarometer]]] [[[[barometer]]]] We now add our special plot of barometric pressure, but specify a larger image size. This image will be put in file daybarometer_big.png . [[[daybarometer_big]]] image_width = 600 image_height = 360 [[[[barometer]]]]","title":"The Image generator"},{"location":"custom/image-generator/#the-image-generator","text":"WeeWX is configured to generate a set of useful plots. But, what if you don't like how they look, or you want to generate different plots, perhaps with different aggregation types? The Image generator is controlled by the configuration options in the reference [ImageGenerator] . These options are specified in the [ImageGenerator] section of a skin configuration file. Let's take a look at the beginning part of this section. It looks like this: [ImageGenerator] ... image_width = 500 image_height = 180 image_background_color = #f5f5f5 chart_background_color = #d8d8d8 chart_gridline_color = #a0a0a0 ... The options directly under the section name [ImageGenerator] will apply to all plots, unless overridden in subsections. So, unless otherwise changed, all plots will be 500 pixels in width, 180 pixels in height, and will have an RGB background color of #f5f5f5 , a very light gray (HTML color \"WhiteSmoke\"). The chart itself will have a background color of #d8d8d8 (a little darker gray), and the gridlines will be #a0a0a0 (still darker). The other options farther down (not shown) will also apply to all plots.","title":"The Image generator"},{"location":"custom/image-generator/#time-periods","text":"After the \"global\" options at the top of section [ImageGenerator] , comes a set of subsections, one for each time period (day, week, month, and year). These subsections define the nature of aggregation and plot types for that time period. For example, here is a typical set of options for subsection [[month_images]] . It controls which \"monthly\" images will get generated, and what they will look like: [[month_images]] x_label_format = %d bottom_label_format = %m/%d/%y %H:%M time_length = 2592000 # == 30 days aggregate_type = avg aggregate_interval = 3h show_daynight = false The option x_label_format gives a strftime() type format for the x-axis. In this example, it will only show days (format option %d ). The bottom_label_format is the format used to time stamp the image at the bottom. In this example, it will show the time as something like 10/25/09 15:35 . A plot will cover a nominal 30 days, and all items included in it will use an aggregate type of averaging over 3 hours. Finally, by setting option show_daynight to false , we are requesting that day-night, shaded bands not be shown.","title":"Time periods"},{"location":"custom/image-generator/#image-files","text":"Within each time period subsection is another nesting, one for each image to be generated. The title of each sub-sub-section is the filename to be used for the image. Finally, at one additional nesting level (!) are the logical names of all the line types to be drawn in the image. Like elsewhere, the values specified in the level above can be overridden. For example, here is a typical set of options for sub-sub-section [[[monthrain]]] : [[[monthrain]]] plot_type = bar yscale = None, None, 0.02 [[[[rain]]]] aggregate_type = sum aggregate_interval = 1d label = Rain (daily total) This will generate an image file with name monthrain.png . It will be a bar plot. Option yscale controls the y-axis scaling \u2014 if left out, the scale will be chosen automatically. However, in this example we are choosing to exercise some degree of control by specifying values explicitly. The option is a 3-way tuple ( ylow , yhigh , min_interval ), where ylow and yhigh are the minimum and maximum y-axis values, respectively, and min_interval is the minimum tick interval. If set to None , the corresponding value will be automatically chosen. So, in this example, the setting yscale = None, None, 0.02 will cause WeeWX to pick sensible y minimum and maximum values, but require that the tick increment ( min_interval ) be at least 0.02. Continuing on with the example above, there will be only one plot \"line\" (it will actually be a series of bars) and it will have logical name rain . Because we have not said otherwise, the database column name to be used for this line will be the same as its logical name, that is, rain , but this can be overridden. The aggregation type will be summing (overriding the averaging specified in subsection [[month_images]] ), so you get the total rain over the aggregate period (rather than the average) over an aggregation interval of 86,400 seconds (one day). The plot line will be titled with the indicated label of 'Rain (daily total)'. The result of all this is the following plot:","title":"Image files"},{"location":"custom/image-generator/#including-more-than-one-type-in-a-plot","text":"More than one observation can be included in a plot. For example, here is how to generate a plot with the week's outside temperature as well as dewpoint: [[[monthtempdew]]] [[[[outTemp]]]] [[[[dewpoint]]]] This would create an image in file monthtempdew.png that includes a line plot of both outside temperature and dewpoint:","title":"Including more than one type in a plot"},{"location":"custom/image-generator/#inclue-same-sql-type-2x","text":"Another example. Suppose that you want a plot of the day's temperature, overlaid with hourly averages. Here, you are using the same data type ( outTemp ) for both plot lines, the first with averages, the second without. If you do the obvious it won't work: # WRONG ## [[[daytemp_with_avg]]] [[[[outTemp]]]] aggregate_type = avg aggregate_interval = 1h [[[[outTemp]]]] # OOPS! The same section name appears more than once! The option parser does not allow the same section name ( outTemp in this case) to appear more than once at a given level in the configuration file, so an error will be declared (technical reason: formally, the sections are an unordered dictionary). If you wish for the same observation to appear more than once in a plot then there is a trick you must know: use option data_type . This will override the default action that the logical line name is used for the database column. So, our example would look like this: [[[daytemp_with_avg]]] [[[[avgTemp]]]] data_type = outTemp aggregate_type = avg aggregate_interval = 1h label = Avg. Temp. [[[[outTemp]]]] Here, the first plot line has been given the name avgTemp to distinguish it from the second line outTemp . Any name will do \u2014 it just has to be different. We have specified that the first line will use data type outTemp and that it will use averaging over a one-hour period. The second also uses outTemp , but will not use averaging. The result is a nice plot of the day's temperature, overlaid with a one-hour smoothed average: One more example. This one shows daily high and low temperatures for a year: [[year_images]] [[[yearhilow]]] [[[[hi]]]] data_type = outTemp aggregate_type = max label = High [[[[low]]]] data_type = outTemp aggregate_type = min label = Low Temperature This results in the plot yearhilow.png :","title":"Including a type more than once in a plot"},{"location":"custom/image-generator/#arbitrary-expressions","text":"The option data_type can actually be any arbitrary SQL expression that is valid in the context of the available types in the schema. For example, say you wanted to plot the difference between inside and outside temperature for the year. This could be done with: [[year_images]] [[[yeardiff]]] [[[[diff]]]] data_type = inTemp-outTemp label = Inside - Outside Note that the option data_type is now an expression representing the difference between inTemp and outTemp , the inside and outside temperature, respectively. This results in a plot yeardiff.png :","title":"Including arbitrary expressions"},{"location":"custom/image-generator/#changing-the-unit-used-in-a-plot","text":"Normally, the unit used in a plot is set by the unit group of the observation types in the plot. For example, consider this plot of today's outside temperature and dewpoint: [[day_images]] ... [[[daytempdew]]] [[[[outTemp]]]] [[[[dewpoint]]]] Both outTemp and dewpoint belong to unit group group_temperature , so this plot will use whatever unit has been specified for that group. See the section Mixed units for details. However, supposed you'd like to offer both Metric and US Customary versions of the same plot? You can do this by using option unit to override the unit used for individual plots: [[day_images]] ... [[[daytempdewUS]]] unit = degree_F [[[[outTemp]]]] [[[[dewpoint]]]] [[[daytempdewMetric]]] unit = degree_C [[[[outTemp]]]] [[[[dewpoint]]]] This will produce two plots: file daytempdewUS.png will be in degrees Fahrenheit, while file dayTempMetric.png will use degrees Celsius.","title":"Changing the unit used in a plot"},{"location":"custom/image-generator/#line-gaps","text":"If there is a time gap in the data, the option line_gap_fraction controls how line plots will be drawn. Here's what a plot looks like without and with this option being specified: No line_gap_fraction specified With line_gap_fraction=0.01 . Note how each line has been split into two lines.","title":"Line gaps"},{"location":"custom/image-generator/#progressive-vector-plots","text":"WeeWX can produce progressive vector plots as well as the more conventional x-y plots. To produce these, use plot type vector . You need a vector type to produce this kind of plot. There are two: windvec , and windgustvec . While they do not actually appear in the database, WeeWX understands that they represent special vector-types. The first, windvec , represents the average wind in an archive period, the second, windgustvec the max wind in an archive period. Here's how to produce a progressive vector for one week that shows the hourly biggest wind gusts, along with hourly averages: [[[weekgustoverlay]]] aggregate_interval = 1h [[[[windvec]]]] label = Hourly Wind plot_type = vector aggregate_type = avg [[[[windgustvec]]]] label = Gust Wind plot_type = vector aggregate_type = max This will produce an image file with name weekgustoverlay.png . It will consist of two progressive vector plots, both using hourly aggregation (3,600 seconds). For the first set of vectors, the hourly average will be used. In the second, the max of the gusts will be used: By default, the sticks in the progressive wind plots point towards the wind source. That is, the stick for a wind from the west will point left. If you have a chronic wind direction (as I do), you may want to rotate the default direction so that all the vectors do not line up over the x-axis, overlaying each other. Do this by using option vector_rotate . For example, with my chronic westerlies, I set vector_rotate to 90.0 for the plot above, so winds out of the west point straight up. If you use this kind of plot (the out-of-the-box version of WeeWX includes daily, weekly, monthly, and yearly progressive wind plots), a small compass rose will be put in the lower-left corner of the image to show the orientation of North.","title":"Progressive vector plots"},{"location":"custom/image-generator/#overriding-values","text":"Remember that values at any level can override values specified at a higher level. For example, say you want to generate the standard plots, but for a few key observation types such as barometer, you want to also generate some oversized plots to give you extra detail, perhaps for an HTML popup. The standard skin.conf file specifies plot size of 300x180 pixels, which will be used for all plots unless overridden: [ImageGenerator] ... image_width = 300 image_height = 180 The standard plot of barometric pressure will appear in daybarometer.png : [[[daybarometer]]] [[[[barometer]]]] We now add our special plot of barometric pressure, but specify a larger image size. This image will be put in file daybarometer_big.png . [[[daybarometer_big]]] image_width = 600 image_height = 360 [[[[barometer]]]]","title":"Overriding values"},{"location":"custom/introduction/","text":"Customization Guide \u00b6 This document covers the customization of WeeWX. It assumes that you have read, and are reasonably familiar with, the Users Guide . The introduction contains an overview of the architecture. If you are only interested in customizing the generated reports you can probably skip the introduction and proceed directly to the section Customizing reports . With this approach you can easily add new plot images, change the titles of images, change the units used in the reports, and so on. However, if your goal is a specialized application, such as adding alarms, RSS feeds, etc. , then it would be worth your while to read about the internal architecture. Most of the guide applies to any hardware, but the exact data types are hardware-specific. See the WeeWX Hardware Guide for details of how different observation types are handled by different types hardware. Warning WeeWX is still an experimental system and, as such, its internal design is subject to change. Future upgrades may break any customizations you have done, particularly if they involve the API (skin customizations tend to be more stable). Overall system architecture \u00b6 Below is a brief overview of the WeeWX system architecture, which is covered in much more detail in the rest of this document. A typical WeeWX pipeline. The actual pipeline depends on what extensions are in use. Data, in the form of LOOP packets and archive records, flows from top to bottom. A WeeWX process normally handles the monitoring of one station \u2014 e.g. a weather station. The process is configured using options in a configuration file, typically called weewx.conf . A WeeWX process has at most one \"driver\" to communicate with the station hardware and receive \"high resolution\" ( i.e. every few seconds) measurement data in the form of LOOP packets. The driver is single-threaded and blocking, so no more than one driver can run in a WeeWX process. LOOP packets may contain arbitrary data from the station/driver in the form of a Python dictionary. Each LOOP packet must contain a time stamp and a unit system, in addition to any number of observations, such as temperature or humidity. For extensive types, such as rain, the packet contains the total amount of rain that fell during the observation period. WeeWX then compiles these LOOP packets into regularly spaced \"archive records\". For most types, the archive record contains the average value seen in all the LOOP packets over the archive interval (typically 5 minutes). For extensive types, such as rain, it is the sum of all values over the archive interval. Internally, the WeeWX engine uses a pipeline architecture, consisting of many services . Services bind to events of interest, such as new LOOP packets, or new archive records. Events are then run down the pipeline in order \u2014 services at the top of the pipeline act on the data before services farther down the pipe. Services can do things such as check the data quality, apply corrections, or save data to a database. Users can easily add new services. WeeWX includes an ability to customize behavior by installing extensions . Extensions may consist of one or more drivers, services, and/or skins, all in an easy-to-install package. Data architecture \u00b6 WeeWX is data-driven. When the sensors spit out some data, WeeWX does something. The \"something\" might be to print out the data, or to generate an HTML report, or to use FTP to copy a report to a web server, or to perform some calculations using the data. A driver is Python code that communicates with the hardware. The driver reads data from a serial port or a device on the USB or a network interface. It handles any decoding of raw bits and bytes, and puts the resulting data into LOOP packets. The drivers for some kinds of hardware (most notably, Davis Vantage) are capable of emitting archive records as well. In addition to the primary observation types such as temperature, humidity, or solar radiation, there are also many useful dependent types, such as wind chill, heat index, or ET, which are calculated from the primary data. The firmware in some weather stations are capable of doing many of these calculations on their own. For the rest, should you choose to do so, the WeeWX service StdWXCalculate can fill in the gaps. Sometimes the firmware simply does it wrong, and you may choose to have WeeWX do the calculation, despite the type's presence in LOOP packets. LOOP packets vs. archive records \u00b6 Generally, there are two types of data that flow through WeeWX: LOOP packets, and archive records. Both are represented as Python dictionaries. LOOP packets \u00b6 LOOP packets are the raw data generated by the device driver. They get their name from the Davis Instruments documentation. For some devices they are generated at rigid intervals, such as every 2 seconds for the Davis Vantage series, for others, irregularly, every 20 or 30 seconds or so. LOOP packets may or may not contain all the data types an instrument is capable of measuring. For example, a packet may contain only temperature data, another only barometric data, etc . These kinds of packet are called partial record packets . By contrast, other types of hardware (notably the Vantage series) include every data type in every LOOP packet. In summary, LOOP packets can be highly irregular in time and in what they contain, but they come in frequently. Archive records \u00b6 By contrast, archive records are highly regular. They are generated at regular intervals (typically every 5 to 30 minutes), and all contain the same data types. They represent an aggregation of the LOOP packets over the archive interval. The exact kind of aggregation depends on the data type. For example, for temperature, it's generally the average temperature over the interval. For rain, it's the sum of rain over the interval. For battery status it's the last value in the interval. Some hardware is capable of generating their own archive records (the Davis Vantage and Oregon Scientific WMR200, for example), but for hardware that cannot, WeeWX generates them. It is the archive data that is put in the SQL database, although, occasionally, the LOOP packets can be useful (such as for the Weather Underground's \"Rapidfire\" mode). What to customize \u00b6 For configuration changes, such as which skins to use, or enabling posts to the Weather Underground, simply modify the WeeWX configuration file, nominally weewx.conf . Any changes you make will be preserved during an upgrade. Customization of reports may require changes to a skin configuration file skin.conf or template files ending in .tmpl or .inc . Anything in the skins subdirectory is also preserved across upgrades. You may choose to install one of the many third-party extensions that are available for WeeWX. These are typically installed in either the skins or user subdirectories, both of which are preserved across upgrades. More advanced customizations may require new Python code or modifications of example code. These should be placed in the user directory, where they will be preserved across upgrades. For example, if you wish to modify one of the examples that comes with WeeWX, copy it from the examples directory to the user directory, then modify it there. This way, your modifications will not be touched if you upgrade. For code that must run before anything else in WeeWX runs (for example, to set up an environment), put it in the file extensions.py in the user directory. It is always run before the WeeWX engine starts up. Because it is in the user subdirectory, it is preserved between upgrades. Do I need to restart WeeWX? \u00b6 If you make a change in weewx.conf , you will need to restart weewxd . If you modify Python code in the user directory or elsewhere, you will need to restart weewxd . If you install an extension, you will need to restart weewxd . If you make a change to a template or to a skin.conf file, then you do not need to restart weewxd . The change will be adopted at the next reporting cycle, typically at the end of an archive interval. The utility wee_reports \u00b6 If you make changes, how do you know what the results will look like? You could just run weewxd and wait until the next reporting cycle kicks off but, depending on your archive interval, that could be a 30-minute wait or more. The utility wee_reports allows you to run a report whenever you like. To use it, just run it from a command line, with the location of your configuration file weewx.conf as the first argument. Optionally, you can tell it what to use as the \"Current\" time, using either option --epoch , or some combination of --date and --time . For more information about wee_reports , see the Utilities Guide The WeeWX service architecture \u00b6 At a high-level, WeeWX consists of an engine class called StdEngine . It is responsible for loading services , then arranging for them to be called when key events occur, such as the arrival of LOOP or archive data. The default install of WeeWX includes the following services: The standard WeeWX services Service Function weewx.engine.StdTimeSynch Arrange to have the clock on the station synchronized at regular intervals. weewx.engine.StdConvert Converts the units of the input to a target unit system (such as US or Metric). weewx.engine.StdCalibrate Adjust new LOOP and archive packets using calibration expressions. weewx.engine.StdQC Check quality of incoming data, making sure values fall within a specified range. weewx.wxservices.StdWXCalculate Decide which derived observation types need to be calculated. weewx.wxxtypes.StdWXXTypes weewx.wxxtypes.StdPressureCooker weewx.wxxtypes.StdRainRater weewx.wxxtypes.StdDelta Calculate derived variables, such as ET , dewpoint , or rainRate . weewx.engine.StdArchive Archive any new data to the SQL databases. weewx.restx.StdStationRegistry weewx.restx.StdWunderground weewx.restx.StdPWSweather weewx.restx.StdCWOP weewx.restx.StdWOW weewx.restx.StdAWEKAS Various RESTful services (simple stateless client-server protocols), such as the Weather Underground, CWOP, etc. Each launches its own, independent thread, which manages the post. weewx.engine.StdPrint Print out new LOOP and archive packets on the console. weewx.engine.StdReport Launch a new thread to do report processing after a new archive record arrives. Reports do things such as generate HTML or CSV files, generate images, or transfer files using FTP/rsync. It is easy to extend old services or to add new ones. The source distribution includes an example new service called MyAlarm, which sends an email when an arbitrary expression evaluates True. These advanced topics are covered later in the section Customizing the WeeWX service engine . The standard reporting service StdReport \u00b6 For the moment, let us focus on the last service, weewx.engine.StdReport , the standard service for creating reports. This will be what most users will want to customize, even if it means just changing a few options. Reports \u00b6 The standard reporting service, StdReport , runs zero or more reports . The specific reports which get run are set in the configuration file weewx.conf , in section [StdReport] . The default distribution of WeeWX includes six reports: Report Default functionality SeasonsReport Introduced with WeeWX V3.9, this report generates a single HTML file with day, week, month and year \"to-date\" summaries, as well as the plot images to go along with them. Buttons select which timescale the user wants. It also generates HTML files with more details on celestial bodies and statistics. Also generates NOAA monthly and yearly summaries. SmartphoneReport A simple report that generates an HTML file, which allows \"drill down\" to show more detail about observations. Suitable for smaller devices, such as smartphones. MobileReport A super simple HTML file that just shows the basics. Suitable for low-powere d or bandwidth-constrained devices. StandardReport This is an older report that has been used for many years in WeeWX. It generates day, week, month and year \"to-date\" summaries in HTML, as well as the plot images to go along with them. Also generates NOAA monthly and yearly summaries. It typically loads faster than the SeasonsReport . FTP Transfer everything in the HTML_ROOT directory to a remote server using ftp. RSYNC Transfer everything in the HTML_ROOT directory to a remote server using the utility rsync . Note that the FTP and RSYNC \"reports\" are a funny kind of report in that they do not actually generate anything. Instead, they use the reporting service engine to transfer files and folders to a remote server. Skins \u00b6 Each report has a skin associated with it. For most reports, the relationship with the skin is an obvious one: the skin contains the templates, any auxiliary files such as background GIFs or CSS style sheets, files with localization data, and a skin configuration file , skin.conf . If you will, the skin controls the look and feel of the report. Note that more than one report can use the same skin. For example, you might want to run a report that uses US Customary units, then run another report against the same skin, but using metric units and put the results in a different place. All this is possible by either overriding configuration options in the WeeWX configuration file or the skin configuration file. Like all reports, the FTP and RSYNC \"reports\" also use a skin, and include a skin configuration file, although they are quite minimal. Skins live in their own directory called skins , whose location is referred to as SKIN_ROOT . Note The symbol SKIN_ROOT is a symbolic name to the location of the directory where your skins are located. It is not to be taken literally. Consult the section Where to find things in the User's Guide for its exact location, dependent on how you installed WeeWX and what operating system you are using Generators \u00b6 To create their output, skins rely on one or more generators , which are what do the actual work, such as creating HTML files or plot images. Generators can also copy files around or FTP/rsync them to remote locations. The default install of WeeWX includes the following generators: Generator Function weewx.cheetahgenerator.CheetahGenerator Generates files from templates, using the Cheetah template engine. Used to generate HTML and text files. weewx.imagegenerator.ImageGenerator Generates graph plots. weewx.reportengine.FtpGenerator Uploads data to a remote server using FTP. weewx.reportengine.RsyncGenerator Uploads data to a remote server using rsync. weewx.reportengine.CopyGenerator Copies files locally. Note that the three generators FtpGenerator , RsyncGenerator , and CopyGenerator do not actually generate anything having to do with the presentation layer. Instead, they just move files around. Which generators are to be run for a given skin is specified in the skin's configuration file, in the section [Generators] . Templates \u00b6 A template is a text file that is processed by a template engine to create a new file. WeeWX uses the Cheetah template engine. The generator weewx.cheetahgenerator.CheetahGenerator is responsible for running Cheetah at appropriate times. A template may be used to generate HTML, XML, CSV, Javascript, or any other type of text file. A template typically contains variables that are replaced when creating the new file. Templates may also contain simple programming logic. Each template file lives in the skin directory of the skin that uses it. By convention, a template file ends with the .tmpl extension. There are also template files that end with the .inc extension. These templates are included in other templates. The database \u00b6 WeeWX uses a single database to store and retrieve the records it needs. It can be implemented by using either SQLite , an open-source, lightweight SQL database, or MySQL , an open-source, full-featured database server. Structure \u00b6 Inside this database are several tables. The most important is the archive table , a big flat table, holding one record for each archive interval, keyed by dateTime , the time at the end of the archive interval. It looks something like this: Structure of the archive database table dateTime usUnits interval barometer pressure altimeter inTemp outTemp ... 1413937800 1 5 29.938 null null 71.2 56.0 ... 1413938100 1 5 29.941 null null 71.2 55.9 ... ... ... ... ... ... ... ... ... ... The first three columns are required. Here's what they mean: Name Meaning dateTime The time at the end of the archive interval in unix epoch time . This is the primary key in the database. It must be unique, and it cannot be null. usUnits The unit system the record is in. It cannot be null. See the Units for how these systems are encoded. interval The length of the archive interval in minutes . It cannot be null. In addition to the archive table, there are a number of smaller tables inside the database, one for each observation type, which hold daily summaries of the type, such as the minimum and maximum value seen during the day, and at what time. These tables have names such as archive_day_outTemp or archive_day_barometer . They are there to optimize certain types of queries \u2014 their existence is generally transparent to the user. For more details, see the section Daily summaries in the Developer's Notes . Binding names \u00b6 While most users will only need the one weather database that comes with WeeWX, the reporting engine allows you to use multiple databases in the same report. For example, if you have installed the cmon computer monitoring package , which uses its own database, you may want to include some statistics or graphs about your server in your reports, using that database. An additional complication is that WeeWX can use more than one database implementation: SQLite or MySQL. Making users specify in the templates not only which database to use, but also which implementation, would be unreasonable. The solution, like so many other problems in computer science, is to introduce another level of indirection, a database binding . Rather than specify which database to use, you specify which binding . Bindings do not change with the database implementation, so, for example, you know that wx_binding will always point to the weather database, no matter if its implementation is a sqlite database or a MySQL database. Bindings are listed in section [DataBindings] in the WeeWX configuration file. The standard weather database binding that WeeWX uses is wx_binding . This is the binding that you will be using most of the time and, indeed, it is the default. You rarely have to specify it explicitly. Programming interface \u00b6 WeeWX includes a module called weedb that provides a single interface for many of the differences between database implementations such as SQLite and MySQL. However, it is not uncommon to make direct SQL queries within services or search list extensions. In such cases, the SQL should be generic so that it will work with every type of database. The database manager class provides methods to create, open, and query a database. These are the canonical forms for obtaining a database manager. If you are opening a database from within a WeeWX service: db_manager = self . engine . db_binder . get_manager ( data_binding = 'name_of_binding' , initialize = True ) # Sample query: db_manager . getSql ( \"SELECT SUM(rain) FROM %s \" \\\\ \"WHERE dateTime>? AND dateTime<=?\" % db_manager . table_name , ( start_ts , stop_ts )) If you are opening a database from within a WeeWX search list extension, you will be passed in a function db_lookup() as a parameter, which can then be used to bind to a database. By default, it returns a manager bound to wx_binding : wx_manager = db_lookup () # Get default binding other_manager = db_lookup ( data_binding = 'some_other_binding' ) # Get an explicit binding # Sample queries: wx_manager . getSql ( \"SELECT SUM(rain) FROM %s \" \\\\ \"WHERE dateTime>? AND dateTime<=?\" % wx_manager . table_name , ( start_ts , stop_ts )) other_manager . getSql ( \"SELECT SUM(power) FROM %s \" \\\\ \"WHERE dateTime>? AND dateTime<=?\" % other_manager . table_name , ( start_ts , stop_ts )) If opening a database from somewhere other than a service, and there is no DBBinder available: db_manager = weewx . manager . open_manager_with_config ( config_dict , data_binding = 'name_of_binding' ) # Sample query: db_manager . getSql ( \"SELECT SUM(rain) FROM %s \" \\\\ \"WHERE dateTime>? AND dateTime<=?\" % db_manager . table_name , ( start_ts , stop_ts )) The DBBinder caches managers, and thus database connections. It cannot be shared between threads. Units \u00b6 The unit architecture in WeeWX is designed to make basic unit conversions and display of units easy. It is not designed to provide dimensional analysis, arbitrary conversions, and indications of compatibility. The driver reads observations from an instrument and converts them, as necessary, into a standard set of units. The actual units used by each instrument vary widely; some instruments use Metric units, others use US Customary units, and many use a mixture. The driver can emit measurements in any unit system, but it must use the same unit system for all values in a LOOP packet or archive record. By default, and to maintain compatibility with wview, the default database units are US Customary, although this can be changed. Note that whatever unit system is used in the database, data can be displayed using any unit system. So, in practice, it does not matter what unit system is used in the database. Each observation type , such as outTemp or pressure , is associated with a unit group , such as group_temperature or group_pressure . Each unit group is associated with a unit type such as degree_F or mbar . The reporting service uses this architecture to convert observations into a target unit system, to be displayed in your reports. With this architecture one can easily create reports with, say, wind measured in knots, rain measured in mm, and temperatures in degree Celsius. Or one can create a single set of templates, but display data in different unit systems with only a few stanzas in a configuration file.","title":"Introduction"},{"location":"custom/introduction/#customization-guide","text":"This document covers the customization of WeeWX. It assumes that you have read, and are reasonably familiar with, the Users Guide . The introduction contains an overview of the architecture. If you are only interested in customizing the generated reports you can probably skip the introduction and proceed directly to the section Customizing reports . With this approach you can easily add new plot images, change the titles of images, change the units used in the reports, and so on. However, if your goal is a specialized application, such as adding alarms, RSS feeds, etc. , then it would be worth your while to read about the internal architecture. Most of the guide applies to any hardware, but the exact data types are hardware-specific. See the WeeWX Hardware Guide for details of how different observation types are handled by different types hardware. Warning WeeWX is still an experimental system and, as such, its internal design is subject to change. Future upgrades may break any customizations you have done, particularly if they involve the API (skin customizations tend to be more stable).","title":"Customization Guide"},{"location":"custom/introduction/#overall-system-architecture","text":"Below is a brief overview of the WeeWX system architecture, which is covered in much more detail in the rest of this document. A typical WeeWX pipeline. The actual pipeline depends on what extensions are in use. Data, in the form of LOOP packets and archive records, flows from top to bottom. A WeeWX process normally handles the monitoring of one station \u2014 e.g. a weather station. The process is configured using options in a configuration file, typically called weewx.conf . A WeeWX process has at most one \"driver\" to communicate with the station hardware and receive \"high resolution\" ( i.e. every few seconds) measurement data in the form of LOOP packets. The driver is single-threaded and blocking, so no more than one driver can run in a WeeWX process. LOOP packets may contain arbitrary data from the station/driver in the form of a Python dictionary. Each LOOP packet must contain a time stamp and a unit system, in addition to any number of observations, such as temperature or humidity. For extensive types, such as rain, the packet contains the total amount of rain that fell during the observation period. WeeWX then compiles these LOOP packets into regularly spaced \"archive records\". For most types, the archive record contains the average value seen in all the LOOP packets over the archive interval (typically 5 minutes). For extensive types, such as rain, it is the sum of all values over the archive interval. Internally, the WeeWX engine uses a pipeline architecture, consisting of many services . Services bind to events of interest, such as new LOOP packets, or new archive records. Events are then run down the pipeline in order \u2014 services at the top of the pipeline act on the data before services farther down the pipe. Services can do things such as check the data quality, apply corrections, or save data to a database. Users can easily add new services. WeeWX includes an ability to customize behavior by installing extensions . Extensions may consist of one or more drivers, services, and/or skins, all in an easy-to-install package.","title":"Overall system architecture"},{"location":"custom/introduction/#data-architecture","text":"WeeWX is data-driven. When the sensors spit out some data, WeeWX does something. The \"something\" might be to print out the data, or to generate an HTML report, or to use FTP to copy a report to a web server, or to perform some calculations using the data. A driver is Python code that communicates with the hardware. The driver reads data from a serial port or a device on the USB or a network interface. It handles any decoding of raw bits and bytes, and puts the resulting data into LOOP packets. The drivers for some kinds of hardware (most notably, Davis Vantage) are capable of emitting archive records as well. In addition to the primary observation types such as temperature, humidity, or solar radiation, there are also many useful dependent types, such as wind chill, heat index, or ET, which are calculated from the primary data. The firmware in some weather stations are capable of doing many of these calculations on their own. For the rest, should you choose to do so, the WeeWX service StdWXCalculate can fill in the gaps. Sometimes the firmware simply does it wrong, and you may choose to have WeeWX do the calculation, despite the type's presence in LOOP packets.","title":"Data architecture"},{"location":"custom/introduction/#loop-packets-vs-archive-records","text":"Generally, there are two types of data that flow through WeeWX: LOOP packets, and archive records. Both are represented as Python dictionaries.","title":"LOOP packets vs. archive records"},{"location":"custom/introduction/#loop-packets","text":"LOOP packets are the raw data generated by the device driver. They get their name from the Davis Instruments documentation. For some devices they are generated at rigid intervals, such as every 2 seconds for the Davis Vantage series, for others, irregularly, every 20 or 30 seconds or so. LOOP packets may or may not contain all the data types an instrument is capable of measuring. For example, a packet may contain only temperature data, another only barometric data, etc . These kinds of packet are called partial record packets . By contrast, other types of hardware (notably the Vantage series) include every data type in every LOOP packet. In summary, LOOP packets can be highly irregular in time and in what they contain, but they come in frequently.","title":"LOOP packets"},{"location":"custom/introduction/#archive-records","text":"By contrast, archive records are highly regular. They are generated at regular intervals (typically every 5 to 30 minutes), and all contain the same data types. They represent an aggregation of the LOOP packets over the archive interval. The exact kind of aggregation depends on the data type. For example, for temperature, it's generally the average temperature over the interval. For rain, it's the sum of rain over the interval. For battery status it's the last value in the interval. Some hardware is capable of generating their own archive records (the Davis Vantage and Oregon Scientific WMR200, for example), but for hardware that cannot, WeeWX generates them. It is the archive data that is put in the SQL database, although, occasionally, the LOOP packets can be useful (such as for the Weather Underground's \"Rapidfire\" mode).","title":"Archive records"},{"location":"custom/introduction/#what-to-customize","text":"For configuration changes, such as which skins to use, or enabling posts to the Weather Underground, simply modify the WeeWX configuration file, nominally weewx.conf . Any changes you make will be preserved during an upgrade. Customization of reports may require changes to a skin configuration file skin.conf or template files ending in .tmpl or .inc . Anything in the skins subdirectory is also preserved across upgrades. You may choose to install one of the many third-party extensions that are available for WeeWX. These are typically installed in either the skins or user subdirectories, both of which are preserved across upgrades. More advanced customizations may require new Python code or modifications of example code. These should be placed in the user directory, where they will be preserved across upgrades. For example, if you wish to modify one of the examples that comes with WeeWX, copy it from the examples directory to the user directory, then modify it there. This way, your modifications will not be touched if you upgrade. For code that must run before anything else in WeeWX runs (for example, to set up an environment), put it in the file extensions.py in the user directory. It is always run before the WeeWX engine starts up. Because it is in the user subdirectory, it is preserved between upgrades.","title":"What to customize"},{"location":"custom/introduction/#do-i-need-to-restart-weewx","text":"If you make a change in weewx.conf , you will need to restart weewxd . If you modify Python code in the user directory or elsewhere, you will need to restart weewxd . If you install an extension, you will need to restart weewxd . If you make a change to a template or to a skin.conf file, then you do not need to restart weewxd . The change will be adopted at the next reporting cycle, typically at the end of an archive interval.","title":"Do I need to restart WeeWX?"},{"location":"custom/introduction/#the-utility-wee_reports","text":"If you make changes, how do you know what the results will look like? You could just run weewxd and wait until the next reporting cycle kicks off but, depending on your archive interval, that could be a 30-minute wait or more. The utility wee_reports allows you to run a report whenever you like. To use it, just run it from a command line, with the location of your configuration file weewx.conf as the first argument. Optionally, you can tell it what to use as the \"Current\" time, using either option --epoch , or some combination of --date and --time . For more information about wee_reports , see the Utilities Guide","title":"The utility wee_reports"},{"location":"custom/introduction/#the-weewx-service-architecture","text":"At a high-level, WeeWX consists of an engine class called StdEngine . It is responsible for loading services , then arranging for them to be called when key events occur, such as the arrival of LOOP or archive data. The default install of WeeWX includes the following services: The standard WeeWX services Service Function weewx.engine.StdTimeSynch Arrange to have the clock on the station synchronized at regular intervals. weewx.engine.StdConvert Converts the units of the input to a target unit system (such as US or Metric). weewx.engine.StdCalibrate Adjust new LOOP and archive packets using calibration expressions. weewx.engine.StdQC Check quality of incoming data, making sure values fall within a specified range. weewx.wxservices.StdWXCalculate Decide which derived observation types need to be calculated. weewx.wxxtypes.StdWXXTypes weewx.wxxtypes.StdPressureCooker weewx.wxxtypes.StdRainRater weewx.wxxtypes.StdDelta Calculate derived variables, such as ET , dewpoint , or rainRate . weewx.engine.StdArchive Archive any new data to the SQL databases. weewx.restx.StdStationRegistry weewx.restx.StdWunderground weewx.restx.StdPWSweather weewx.restx.StdCWOP weewx.restx.StdWOW weewx.restx.StdAWEKAS Various RESTful services (simple stateless client-server protocols), such as the Weather Underground, CWOP, etc. Each launches its own, independent thread, which manages the post. weewx.engine.StdPrint Print out new LOOP and archive packets on the console. weewx.engine.StdReport Launch a new thread to do report processing after a new archive record arrives. Reports do things such as generate HTML or CSV files, generate images, or transfer files using FTP/rsync. It is easy to extend old services or to add new ones. The source distribution includes an example new service called MyAlarm, which sends an email when an arbitrary expression evaluates True. These advanced topics are covered later in the section Customizing the WeeWX service engine .","title":"The WeeWX service architecture"},{"location":"custom/introduction/#the-standard-reporting-service-stdreport","text":"For the moment, let us focus on the last service, weewx.engine.StdReport , the standard service for creating reports. This will be what most users will want to customize, even if it means just changing a few options.","title":"The standard reporting service StdReport"},{"location":"custom/introduction/#reports","text":"The standard reporting service, StdReport , runs zero or more reports . The specific reports which get run are set in the configuration file weewx.conf , in section [StdReport] . The default distribution of WeeWX includes six reports: Report Default functionality SeasonsReport Introduced with WeeWX V3.9, this report generates a single HTML file with day, week, month and year \"to-date\" summaries, as well as the plot images to go along with them. Buttons select which timescale the user wants. It also generates HTML files with more details on celestial bodies and statistics. Also generates NOAA monthly and yearly summaries. SmartphoneReport A simple report that generates an HTML file, which allows \"drill down\" to show more detail about observations. Suitable for smaller devices, such as smartphones. MobileReport A super simple HTML file that just shows the basics. Suitable for low-powere d or bandwidth-constrained devices. StandardReport This is an older report that has been used for many years in WeeWX. It generates day, week, month and year \"to-date\" summaries in HTML, as well as the plot images to go along with them. Also generates NOAA monthly and yearly summaries. It typically loads faster than the SeasonsReport . FTP Transfer everything in the HTML_ROOT directory to a remote server using ftp. RSYNC Transfer everything in the HTML_ROOT directory to a remote server using the utility rsync . Note that the FTP and RSYNC \"reports\" are a funny kind of report in that they do not actually generate anything. Instead, they use the reporting service engine to transfer files and folders to a remote server.","title":"Reports"},{"location":"custom/introduction/#skins","text":"Each report has a skin associated with it. For most reports, the relationship with the skin is an obvious one: the skin contains the templates, any auxiliary files such as background GIFs or CSS style sheets, files with localization data, and a skin configuration file , skin.conf . If you will, the skin controls the look and feel of the report. Note that more than one report can use the same skin. For example, you might want to run a report that uses US Customary units, then run another report against the same skin, but using metric units and put the results in a different place. All this is possible by either overriding configuration options in the WeeWX configuration file or the skin configuration file. Like all reports, the FTP and RSYNC \"reports\" also use a skin, and include a skin configuration file, although they are quite minimal. Skins live in their own directory called skins , whose location is referred to as SKIN_ROOT . Note The symbol SKIN_ROOT is a symbolic name to the location of the directory where your skins are located. It is not to be taken literally. Consult the section Where to find things in the User's Guide for its exact location, dependent on how you installed WeeWX and what operating system you are using","title":"Skins"},{"location":"custom/introduction/#generators","text":"To create their output, skins rely on one or more generators , which are what do the actual work, such as creating HTML files or plot images. Generators can also copy files around or FTP/rsync them to remote locations. The default install of WeeWX includes the following generators: Generator Function weewx.cheetahgenerator.CheetahGenerator Generates files from templates, using the Cheetah template engine. Used to generate HTML and text files. weewx.imagegenerator.ImageGenerator Generates graph plots. weewx.reportengine.FtpGenerator Uploads data to a remote server using FTP. weewx.reportengine.RsyncGenerator Uploads data to a remote server using rsync. weewx.reportengine.CopyGenerator Copies files locally. Note that the three generators FtpGenerator , RsyncGenerator , and CopyGenerator do not actually generate anything having to do with the presentation layer. Instead, they just move files around. Which generators are to be run for a given skin is specified in the skin's configuration file, in the section [Generators] .","title":"Generators"},{"location":"custom/introduction/#templates","text":"A template is a text file that is processed by a template engine to create a new file. WeeWX uses the Cheetah template engine. The generator weewx.cheetahgenerator.CheetahGenerator is responsible for running Cheetah at appropriate times. A template may be used to generate HTML, XML, CSV, Javascript, or any other type of text file. A template typically contains variables that are replaced when creating the new file. Templates may also contain simple programming logic. Each template file lives in the skin directory of the skin that uses it. By convention, a template file ends with the .tmpl extension. There are also template files that end with the .inc extension. These templates are included in other templates.","title":"Templates"},{"location":"custom/introduction/#the-database","text":"WeeWX uses a single database to store and retrieve the records it needs. It can be implemented by using either SQLite , an open-source, lightweight SQL database, or MySQL , an open-source, full-featured database server.","title":"The database"},{"location":"custom/introduction/#structure","text":"Inside this database are several tables. The most important is the archive table , a big flat table, holding one record for each archive interval, keyed by dateTime , the time at the end of the archive interval. It looks something like this: Structure of the archive database table dateTime usUnits interval barometer pressure altimeter inTemp outTemp ... 1413937800 1 5 29.938 null null 71.2 56.0 ... 1413938100 1 5 29.941 null null 71.2 55.9 ... ... ... ... ... ... ... ... ... ... The first three columns are required. Here's what they mean: Name Meaning dateTime The time at the end of the archive interval in unix epoch time . This is the primary key in the database. It must be unique, and it cannot be null. usUnits The unit system the record is in. It cannot be null. See the Units for how these systems are encoded. interval The length of the archive interval in minutes . It cannot be null. In addition to the archive table, there are a number of smaller tables inside the database, one for each observation type, which hold daily summaries of the type, such as the minimum and maximum value seen during the day, and at what time. These tables have names such as archive_day_outTemp or archive_day_barometer . They are there to optimize certain types of queries \u2014 their existence is generally transparent to the user. For more details, see the section Daily summaries in the Developer's Notes .","title":"Structure"},{"location":"custom/introduction/#binding-names","text":"While most users will only need the one weather database that comes with WeeWX, the reporting engine allows you to use multiple databases in the same report. For example, if you have installed the cmon computer monitoring package , which uses its own database, you may want to include some statistics or graphs about your server in your reports, using that database. An additional complication is that WeeWX can use more than one database implementation: SQLite or MySQL. Making users specify in the templates not only which database to use, but also which implementation, would be unreasonable. The solution, like so many other problems in computer science, is to introduce another level of indirection, a database binding . Rather than specify which database to use, you specify which binding . Bindings do not change with the database implementation, so, for example, you know that wx_binding will always point to the weather database, no matter if its implementation is a sqlite database or a MySQL database. Bindings are listed in section [DataBindings] in the WeeWX configuration file. The standard weather database binding that WeeWX uses is wx_binding . This is the binding that you will be using most of the time and, indeed, it is the default. You rarely have to specify it explicitly.","title":"Binding names"},{"location":"custom/introduction/#programming-interface","text":"WeeWX includes a module called weedb that provides a single interface for many of the differences between database implementations such as SQLite and MySQL. However, it is not uncommon to make direct SQL queries within services or search list extensions. In such cases, the SQL should be generic so that it will work with every type of database. The database manager class provides methods to create, open, and query a database. These are the canonical forms for obtaining a database manager. If you are opening a database from within a WeeWX service: db_manager = self . engine . db_binder . get_manager ( data_binding = 'name_of_binding' , initialize = True ) # Sample query: db_manager . getSql ( \"SELECT SUM(rain) FROM %s \" \\\\ \"WHERE dateTime>? AND dateTime<=?\" % db_manager . table_name , ( start_ts , stop_ts )) If you are opening a database from within a WeeWX search list extension, you will be passed in a function db_lookup() as a parameter, which can then be used to bind to a database. By default, it returns a manager bound to wx_binding : wx_manager = db_lookup () # Get default binding other_manager = db_lookup ( data_binding = 'some_other_binding' ) # Get an explicit binding # Sample queries: wx_manager . getSql ( \"SELECT SUM(rain) FROM %s \" \\\\ \"WHERE dateTime>? AND dateTime<=?\" % wx_manager . table_name , ( start_ts , stop_ts )) other_manager . getSql ( \"SELECT SUM(power) FROM %s \" \\\\ \"WHERE dateTime>? AND dateTime<=?\" % other_manager . table_name , ( start_ts , stop_ts )) If opening a database from somewhere other than a service, and there is no DBBinder available: db_manager = weewx . manager . open_manager_with_config ( config_dict , data_binding = 'name_of_binding' ) # Sample query: db_manager . getSql ( \"SELECT SUM(rain) FROM %s \" \\\\ \"WHERE dateTime>? AND dateTime<=?\" % db_manager . table_name , ( start_ts , stop_ts )) The DBBinder caches managers, and thus database connections. It cannot be shared between threads.","title":"Programming interface"},{"location":"custom/introduction/#units","text":"The unit architecture in WeeWX is designed to make basic unit conversions and display of units easy. It is not designed to provide dimensional analysis, arbitrary conversions, and indications of compatibility. The driver reads observations from an instrument and converts them, as necessary, into a standard set of units. The actual units used by each instrument vary widely; some instruments use Metric units, others use US Customary units, and many use a mixture. The driver can emit measurements in any unit system, but it must use the same unit system for all values in a LOOP packet or archive record. By default, and to maintain compatibility with wview, the default database units are US Customary, although this can be changed. Note that whatever unit system is used in the database, data can be displayed using any unit system. So, in practice, it does not matter what unit system is used in the database. Each observation type , such as outTemp or pressure , is associated with a unit group , such as group_temperature or group_pressure . Each unit group is associated with a unit type such as degree_F or mbar . The reporting service uses this architecture to convert observations into a target unit system, to be displayed in your reports. With this architecture one can easily create reports with, say, wind measured in knots, rain measured in mm, and temperatures in degree Celsius. Or one can create a single set of templates, but display data in different unit systems with only a few stanzas in a configuration file.","title":"Units"},{"location":"custom/localization/","text":"Localization \u00b6 This section provides suggestions for localization, including translation to different languages and display of data in formats specific to a locale. If the skin has been internationalized \u00b6 All the skins that come with WeeWX have been internationalized , that is, they are capable of being localized , although there may or may not be a localization available for your specific language. See the section Internationalized skins for how to tell. Internationalized, your language is available \u00b6 This is the easy case: the skin has been internationalized, and your locale is available. In this case, all you need to do is to select your locale in weewx.conf . For example, to select German (code de ) for the Seasons skin, just add the highlighted line (or change, if it's already there): [StdReport] [[SeasonsReport]] # The SeasonsReport uses the 'Seasons' skin, which contains the # images, templates and plots for the report. skin = Seasons enable = true lang = de Internationalized, but your language is missing \u00b6 If the lang subdirectory is present in the skin directory, then the skin has been internationalized. However, if your language code is not included in the subdirectory, then you will have to localize it to your language. To do so, copy the file en.conf and name it according to the language code of your language. Then translate all the strings on the right side of the equal signs to your language. For example, say you want to localize the skin in the French language. Then copy en.conf to fr.conf cp en.conf fr.conf Then change things that look like this: [Texts] \"Language\" = \"English\" \"7-day\" = \"7-day\" \"24h\" = \"24h\" \"About this weather station\" = \"About this weather station\" to something that looks like this: [Texts] Language = French \"7-day\" = \"7-jours\" \"24h\" = \"24h\" \"About this weather station\" = \"A propos de cette station\" And so on. When you're done, the skin author may be interested in your localization file to ship it together with the skin for the use of other users. If the skin is one that came with WeeWX, contact the WeeWX team via a post to the weewx-user group and, with your permission, we may include your localization file in a future WeeWX release. Finally, set the option lang in weewx.conf to your language code ( fr in this example) as described in the User's Guide . How to internationalize a skin \u00b6 What happens when you come across a skin that you like, but it has not been internationalized? This section explains how to convert the report to local formats and language. Internationalization of WeeWX templates uses a pattern very similar to the well-known GNU \" gettext \" approach. The only difference is that we have leveraged the ConfigObj configuration library used throughout WeeWX. Create the localization file \u00b6 Create a subdirectory called lang in the skin directory. Then create a file named by the language code with the suffix .conf in this subdirectory. For example, if you want to translate to Spanish, name the file lang/es.conf . Include the following in the file: [Units] [[Labels]] # These are singular, plural meter = \" meter\", \" meters\" day = \" day\", \" days\" hour = \" hour\", \" hours\" minute = \" minute\", \" minutes\" second = \" second\", \" seconds\" [[Ordinates]] # Ordinal directions. The last one should be for no wind direction directions = N, NNE, NE, ENE, E, ESE, SE, SSE, S, SSW, SW, WSW, W, WNW, NW, NNW, N/A [Labels] # Set to hemisphere abbreviations suitable for your location: hemispheres = N, S, E, W # Generic labels, keyed by an observation type. [[Generic]] altimeter = Altimeter # QNH altimeterRate = Altimeter Change Rate appTemp = Apparent Temperature appTemp1 = Apparent Temperature barometer = Barometer # QFF barometerRate = Barometer Change Rate cloudbase = Cloud Base dateTime = Time dewpoint = Dew Point ET = ET extraTemp1 = Temperature1 extraTemp2 = Temperature2 extraTemp3 = Temperature3 heatindex = Heat Index inDewpoint = Inside Dew Point inHumidity = Inside Humidity inTemp = Inside Temperature interval = Interval lightning_distance = Lightning Distance lightning_strike_count = Lightning Strikes outHumidity = Outside Humidity outTemp = Outside Temperature pressure = Pressure # QFE pressureRate = Pressure Change Rate radiation = Radiation rain = Rain rainRate = Rain Rate THSW = THSW Index UV = UV Index wind = Wind windchill = Wind Chill windDir = Wind Direction windGust = Gust Speed windGustDir = Gust Direction windgustvec = Gust Vector windrun = Wind Run windSpeed = Wind Speed windvec = Wind Vector [Almanac] # The labels to be used for the phases of the moon: moon_phases = New, Waxing crescent, First quarter, Waxing gibbous, Full, Waning gibbous, Last quarter, Waning crescent [Texts] Language = Espa\u00f1ol # Replace with the language you are targeting Go through the file, translating all phrases on the right-hand side of the equal signs to your target language (Spanish in this example). Internationalize the template \u00b6 You will need to internationalize every HTML template (these typically have a file suffix of .html.tmpl ). This is most easily done by opening the template and the language file in different editor windows. It is much easier if you can change both files simultaneously. Change the HTML lang attribute \u00b6 At the top of the template, change the HTML lang attribute to a configurable value, $lang . <!DOCTYPE html> < html lang = \"$lang\" > < head > < meta charset = \"UTF-8\" > ... The value $lang will get replaced by the actual language to be used. For reference, here are the ISO language and country codes: language codes country codes Change the body text \u00b6 The next step is to go through the templates and change all natural language phrases into lookups using $gettext . For example, suppose your skin has a section that looks like this: < div > Current Conditions < table > < tr > < td > Outside Temperature </ td > < td > $current.outTemp </ td > </ tr > </ table > </ div > There are two natural language phrases here: Current Conditions and Outside Temperature . They would be changed to: < div > $gettext(\"Current Conditions\") < table > < tr > < td > $obs.label.outTemp </ td > < td > $current.outTemp </ td > </ tr > </ table > </ div > We have done two replacements here. For the phrase Current Conditions , we substituted $gettext(\"Current Conditions\") . This will cause the Cheetah Generator to look up the localized version of \"Current Conditions\" in the localization file and substitute it. We could have done something similar for Outside Temperature , but in this case, we chose to use the localized name for type outTemp , which you should have provided in your localization file, under section [Labels] / [[Generic]] . In the localization file, include the translation for Current Conditions under the [Texts] section: ... [Texts] \"Language\" = \"Espa\u00f1ol\" \"Current Conditions\" = \"Condiciones Actuales\" ... Repeat this process for all the strings that you find. Make sure not to replace HTML tags and HTML options. Think about time \u00b6 Whenever a time is used in a template, it will need a format. WeeWX comes with the following set of defaults: [Units] [[TimeFormats]] day = %X week = %X (%A) month = %x %X year = %x %X rainyear = %x %X current = %x %X ephem_day = %X ephem_year = %x %X The times for images are defined with the following defaults: [ImageGenerator] [[day_images]] bottom_label_format = %x %X [[week_images]] bottom_label_format = %x %X [[month_images]] bottom_label_format = %x %X [[year_images]] bottom_label_format = %x %X These defaults will give something readable in every locale, but they may not be very pretty. Therefore, you may want to change them to something more suitable for the locale you are targeting, using the Python strftime() specific directives . Example: the default time formatting for \"Current\" conditions is %x %x , which will show today's date as \"14/05/21 10:00:00\" in the Spanish locale. Suppose you would rather see \"14-mayo-2021 10:00\". You would add the following to your Spanish localization file es.conf : [Units] [[TimeFormats]] current = %d-%B-%Y %H:%M Set the environment variable LANG \u00b6 Finally, you will need to set the environment variable LANG to reflect your locale. For example, assuming you set $ export LANG = es_ES.UTF-8 before running WeeWX, then the local Spanish names for days of the week and months of the year will be used. The decimal point for numbers will also be modified appropriately.","title":"Localization"},{"location":"custom/localization/#localization","text":"This section provides suggestions for localization, including translation to different languages and display of data in formats specific to a locale.","title":"Localization"},{"location":"custom/localization/#if-the-skin-has-been-internationalized","text":"All the skins that come with WeeWX have been internationalized , that is, they are capable of being localized , although there may or may not be a localization available for your specific language. See the section Internationalized skins for how to tell.","title":"If the skin has been internationalized"},{"location":"custom/localization/#internationalized-your-language-is-available","text":"This is the easy case: the skin has been internationalized, and your locale is available. In this case, all you need to do is to select your locale in weewx.conf . For example, to select German (code de ) for the Seasons skin, just add the highlighted line (or change, if it's already there): [StdReport] [[SeasonsReport]] # The SeasonsReport uses the 'Seasons' skin, which contains the # images, templates and plots for the report. skin = Seasons enable = true lang = de","title":"Internationalized, your language is available"},{"location":"custom/localization/#missing-language","text":"If the lang subdirectory is present in the skin directory, then the skin has been internationalized. However, if your language code is not included in the subdirectory, then you will have to localize it to your language. To do so, copy the file en.conf and name it according to the language code of your language. Then translate all the strings on the right side of the equal signs to your language. For example, say you want to localize the skin in the French language. Then copy en.conf to fr.conf cp en.conf fr.conf Then change things that look like this: [Texts] \"Language\" = \"English\" \"7-day\" = \"7-day\" \"24h\" = \"24h\" \"About this weather station\" = \"About this weather station\" to something that looks like this: [Texts] Language = French \"7-day\" = \"7-jours\" \"24h\" = \"24h\" \"About this weather station\" = \"A propos de cette station\" And so on. When you're done, the skin author may be interested in your localization file to ship it together with the skin for the use of other users. If the skin is one that came with WeeWX, contact the WeeWX team via a post to the weewx-user group and, with your permission, we may include your localization file in a future WeeWX release. Finally, set the option lang in weewx.conf to your language code ( fr in this example) as described in the User's Guide .","title":"Internationalized, but your language is missing"},{"location":"custom/localization/#how-to-internationalize-a-skin","text":"What happens when you come across a skin that you like, but it has not been internationalized? This section explains how to convert the report to local formats and language. Internationalization of WeeWX templates uses a pattern very similar to the well-known GNU \" gettext \" approach. The only difference is that we have leveraged the ConfigObj configuration library used throughout WeeWX.","title":"How to internationalize a skin"},{"location":"custom/localization/#create-the-localization-file","text":"Create a subdirectory called lang in the skin directory. Then create a file named by the language code with the suffix .conf in this subdirectory. For example, if you want to translate to Spanish, name the file lang/es.conf . Include the following in the file: [Units] [[Labels]] # These are singular, plural meter = \" meter\", \" meters\" day = \" day\", \" days\" hour = \" hour\", \" hours\" minute = \" minute\", \" minutes\" second = \" second\", \" seconds\" [[Ordinates]] # Ordinal directions. The last one should be for no wind direction directions = N, NNE, NE, ENE, E, ESE, SE, SSE, S, SSW, SW, WSW, W, WNW, NW, NNW, N/A [Labels] # Set to hemisphere abbreviations suitable for your location: hemispheres = N, S, E, W # Generic labels, keyed by an observation type. [[Generic]] altimeter = Altimeter # QNH altimeterRate = Altimeter Change Rate appTemp = Apparent Temperature appTemp1 = Apparent Temperature barometer = Barometer # QFF barometerRate = Barometer Change Rate cloudbase = Cloud Base dateTime = Time dewpoint = Dew Point ET = ET extraTemp1 = Temperature1 extraTemp2 = Temperature2 extraTemp3 = Temperature3 heatindex = Heat Index inDewpoint = Inside Dew Point inHumidity = Inside Humidity inTemp = Inside Temperature interval = Interval lightning_distance = Lightning Distance lightning_strike_count = Lightning Strikes outHumidity = Outside Humidity outTemp = Outside Temperature pressure = Pressure # QFE pressureRate = Pressure Change Rate radiation = Radiation rain = Rain rainRate = Rain Rate THSW = THSW Index UV = UV Index wind = Wind windchill = Wind Chill windDir = Wind Direction windGust = Gust Speed windGustDir = Gust Direction windgustvec = Gust Vector windrun = Wind Run windSpeed = Wind Speed windvec = Wind Vector [Almanac] # The labels to be used for the phases of the moon: moon_phases = New, Waxing crescent, First quarter, Waxing gibbous, Full, Waning gibbous, Last quarter, Waning crescent [Texts] Language = Espa\u00f1ol # Replace with the language you are targeting Go through the file, translating all phrases on the right-hand side of the equal signs to your target language (Spanish in this example).","title":"Create the localization file"},{"location":"custom/localization/#internationalize-the-template","text":"You will need to internationalize every HTML template (these typically have a file suffix of .html.tmpl ). This is most easily done by opening the template and the language file in different editor windows. It is much easier if you can change both files simultaneously.","title":"Internationalize the template"},{"location":"custom/localization/#change-the-html-lang-attribute","text":"At the top of the template, change the HTML lang attribute to a configurable value, $lang . <!DOCTYPE html> < html lang = \"$lang\" > < head > < meta charset = \"UTF-8\" > ... The value $lang will get replaced by the actual language to be used. For reference, here are the ISO language and country codes: language codes country codes","title":"Change the HTML lang attribute"},{"location":"custom/localization/#change-the-body-text","text":"The next step is to go through the templates and change all natural language phrases into lookups using $gettext . For example, suppose your skin has a section that looks like this: < div > Current Conditions < table > < tr > < td > Outside Temperature </ td > < td > $current.outTemp </ td > </ tr > </ table > </ div > There are two natural language phrases here: Current Conditions and Outside Temperature . They would be changed to: < div > $gettext(\"Current Conditions\") < table > < tr > < td > $obs.label.outTemp </ td > < td > $current.outTemp </ td > </ tr > </ table > </ div > We have done two replacements here. For the phrase Current Conditions , we substituted $gettext(\"Current Conditions\") . This will cause the Cheetah Generator to look up the localized version of \"Current Conditions\" in the localization file and substitute it. We could have done something similar for Outside Temperature , but in this case, we chose to use the localized name for type outTemp , which you should have provided in your localization file, under section [Labels] / [[Generic]] . In the localization file, include the translation for Current Conditions under the [Texts] section: ... [Texts] \"Language\" = \"Espa\u00f1ol\" \"Current Conditions\" = \"Condiciones Actuales\" ... Repeat this process for all the strings that you find. Make sure not to replace HTML tags and HTML options.","title":"Change the body text"},{"location":"custom/localization/#think-about-time","text":"Whenever a time is used in a template, it will need a format. WeeWX comes with the following set of defaults: [Units] [[TimeFormats]] day = %X week = %X (%A) month = %x %X year = %x %X rainyear = %x %X current = %x %X ephem_day = %X ephem_year = %x %X The times for images are defined with the following defaults: [ImageGenerator] [[day_images]] bottom_label_format = %x %X [[week_images]] bottom_label_format = %x %X [[month_images]] bottom_label_format = %x %X [[year_images]] bottom_label_format = %x %X These defaults will give something readable in every locale, but they may not be very pretty. Therefore, you may want to change them to something more suitable for the locale you are targeting, using the Python strftime() specific directives . Example: the default time formatting for \"Current\" conditions is %x %x , which will show today's date as \"14/05/21 10:00:00\" in the Spanish locale. Suppose you would rather see \"14-mayo-2021 10:00\". You would add the following to your Spanish localization file es.conf : [Units] [[TimeFormats]] current = %d-%B-%Y %H:%M","title":"Think about time"},{"location":"custom/localization/#environment-variable-LANG","text":"Finally, you will need to set the environment variable LANG to reflect your locale. For example, assuming you set $ export LANG = es_ES.UTF-8 before running WeeWX, then the local Spanish names for days of the week and months of the year will be used. The decimal point for numbers will also be modified appropriately.","title":"Set the environment variable LANG"},{"location":"custom/multiple-bindings/","text":"Using multiple bindings \u00b6 It's easy to use more than one database in your reports. Here's an example. In my office I have two consoles: a VantagePro2 connected to a Dell Optiplex, and a WMR100N, connected to a Raspberry Pi. Each is running WeeWX. The Dell is using SQLite, the RPi, MySQL. Suppose I wish to compare the inside temperatures of the two consoles. How would I do that? It's easier to access MySQL across a network than SQLite, so let's run the reports on the Dell, but access the RPi's MySQL database remotely. Here's how the bindings and database sections of weewx.conf would look on the Dell: [DataBindings] # This section binds a data store to an actual database [[wx_binding]] # The database to be used - it should match one of the sections in [Databases] database = archive_sqlite # The name of the table within the database table_name = archive # The class to manage the database manager = weewx.manager.DaySummaryManager # The schema defines to structure of the database contents schema = schemas.wview_extended.schema [[wmr100_binding]] # Binding for my WMR100 on the RPi database = rpi_mysql # The name of the table within the database table_name = archive # The class to manage the database manager = weewx.manager.DaySummaryManager # The schema defines to structure of the database contents schema = schemas.wview_extended.schema [Databases] # This section binds to the actual database to be used [[archive_sqlite]] database_type = SQLite database_name = weewx.sdb [[rpi_mysql]] database_type = MySQL database_name = weewx host = rpi-bug [DatabaseTypes] # This section defines defaults for the different types of databases. [[SQLite]] driver = weedb.sqlite # Directory in which the database files are located SQLITE_ROOT = archive [[MySQL]] driver = weedb.mysql # The host where the database is located host = localhost # The user name for logging in to the host user = weewx # The password for the user name password = weewx The two additions have been highlighted . The first, [[wmr100_binding]] , adds a new binding called wmr100_binding . It links (\"binds\") to the new database, called rpi_mysql , through the option database . It also defines some characteristics of the binding, such as which manager is to be used and what its schema looks like. The second addition, [[rpi-mysql]] , defines the new database. Option database_type is set to MySQL , indicating that it is a MySQL database. Defaults for MySQL databases are defined in the section [[MySQL]] . The new database accepts all of them, except for host , which as been set to the remote host rpi-bug , the name of my Raspberry Pi. Explicit binding in tags \u00b6 How do we use this new binding? First, let's do a text comparison, using tags. Here's what our template looks like: < table > < tr > < td class = \"stats_label\" > Inside Temperature, Vantage </ td > < td class = \"stats_data\" > $current.inTemp </ td > </ tr > < tr > < td class = \"stats_label\" > Inside Temperature, WMR100 </ td > < td class = \"stats_data\" > $latest($data_binding='wmr100_binding').inTemp </ td > </ tr > </ table > The explicit binding to wmr100_binding is highlighted. This tells the reporting engine to override the default binding specifed in [StdReport] , generally wx_binding , and use wmr100_binding instead. Inside Temperature, Vantage 68.7\u00b0F Inside Temperature, WMR100 68.9\u00b0F Explicit binding in images \u00b6 How would we produce a graph of the two different temperatures? Here's what the relevant section of the skin.conf file would look like. [[[daycompare]]] [[[[inTemp]]]] label = Vantage inTemp [[[[WMR100Temp]]]] data_type = inTemp data_binding = wmr100_binding label = WMR100 inTemp This will produce an image with name daycompare.png , with two plot lines. The first will be of the temperature from the Vantage. It uses the default binding, wx_binding , and will be labeled Vantage inTemp . The second line explicitly uses the wmr100_binding . Because it uses the same variable name ( inTemp ) as the first line, we had to explicitly specify it using option data_type , in order to avoid using the same subsection name twice (see the section Including a type more than once in a plot for details). It will be labeled WMR100 inTemp . The results look like this: Stupid detail \u00b6 At first, I could not get this example to work. The problem turned out to be that the RPi was processing things just a beat behind the Dell, so the temperature for the \"current\" time wasn't ready when the Dell needed it. I kept getting N/A . To avoid this, I introduced the tag $latest , which uses the last available timestamp in the binding, which may or may not be the same as what $current uses. That's why the example above uses $latest instead of $current .","title":"Multiple data bindings"},{"location":"custom/multiple-bindings/#using-multiple-bindings","text":"It's easy to use more than one database in your reports. Here's an example. In my office I have two consoles: a VantagePro2 connected to a Dell Optiplex, and a WMR100N, connected to a Raspberry Pi. Each is running WeeWX. The Dell is using SQLite, the RPi, MySQL. Suppose I wish to compare the inside temperatures of the two consoles. How would I do that? It's easier to access MySQL across a network than SQLite, so let's run the reports on the Dell, but access the RPi's MySQL database remotely. Here's how the bindings and database sections of weewx.conf would look on the Dell: [DataBindings] # This section binds a data store to an actual database [[wx_binding]] # The database to be used - it should match one of the sections in [Databases] database = archive_sqlite # The name of the table within the database table_name = archive # The class to manage the database manager = weewx.manager.DaySummaryManager # The schema defines to structure of the database contents schema = schemas.wview_extended.schema [[wmr100_binding]] # Binding for my WMR100 on the RPi database = rpi_mysql # The name of the table within the database table_name = archive # The class to manage the database manager = weewx.manager.DaySummaryManager # The schema defines to structure of the database contents schema = schemas.wview_extended.schema [Databases] # This section binds to the actual database to be used [[archive_sqlite]] database_type = SQLite database_name = weewx.sdb [[rpi_mysql]] database_type = MySQL database_name = weewx host = rpi-bug [DatabaseTypes] # This section defines defaults for the different types of databases. [[SQLite]] driver = weedb.sqlite # Directory in which the database files are located SQLITE_ROOT = archive [[MySQL]] driver = weedb.mysql # The host where the database is located host = localhost # The user name for logging in to the host user = weewx # The password for the user name password = weewx The two additions have been highlighted . The first, [[wmr100_binding]] , adds a new binding called wmr100_binding . It links (\"binds\") to the new database, called rpi_mysql , through the option database . It also defines some characteristics of the binding, such as which manager is to be used and what its schema looks like. The second addition, [[rpi-mysql]] , defines the new database. Option database_type is set to MySQL , indicating that it is a MySQL database. Defaults for MySQL databases are defined in the section [[MySQL]] . The new database accepts all of them, except for host , which as been set to the remote host rpi-bug , the name of my Raspberry Pi.","title":"Using multiple bindings"},{"location":"custom/multiple-bindings/#explicit-binding-in-tags","text":"How do we use this new binding? First, let's do a text comparison, using tags. Here's what our template looks like: < table > < tr > < td class = \"stats_label\" > Inside Temperature, Vantage </ td > < td class = \"stats_data\" > $current.inTemp </ td > </ tr > < tr > < td class = \"stats_label\" > Inside Temperature, WMR100 </ td > < td class = \"stats_data\" > $latest($data_binding='wmr100_binding').inTemp </ td > </ tr > </ table > The explicit binding to wmr100_binding is highlighted. This tells the reporting engine to override the default binding specifed in [StdReport] , generally wx_binding , and use wmr100_binding instead. Inside Temperature, Vantage 68.7\u00b0F Inside Temperature, WMR100 68.9\u00b0F","title":"Explicit binding in tags"},{"location":"custom/multiple-bindings/#explicit-binding-in-images","text":"How would we produce a graph of the two different temperatures? Here's what the relevant section of the skin.conf file would look like. [[[daycompare]]] [[[[inTemp]]]] label = Vantage inTemp [[[[WMR100Temp]]]] data_type = inTemp data_binding = wmr100_binding label = WMR100 inTemp This will produce an image with name daycompare.png , with two plot lines. The first will be of the temperature from the Vantage. It uses the default binding, wx_binding , and will be labeled Vantage inTemp . The second line explicitly uses the wmr100_binding . Because it uses the same variable name ( inTemp ) as the first line, we had to explicitly specify it using option data_type , in order to avoid using the same subsection name twice (see the section Including a type more than once in a plot for details). It will be labeled WMR100 inTemp . The results look like this:","title":"Explicit binding in images"},{"location":"custom/multiple-bindings/#stupid-detail","text":"At first, I could not get this example to work. The problem turned out to be that the RPi was processing things just a beat behind the Dell, so the temperature for the \"current\" time wasn't ready when the Dell needed it. I kept getting N/A . To avoid this, I introduced the tag $latest , which uses the last available timestamp in the binding, which may or may not be the same as what $current uses. That's why the example above uses $latest instead of $current .","title":"Stupid detail"},{"location":"custom/report-scheduling/","text":"Scheduling report generation \u00b6 Normal WeeWX operation is to run each report defined in weewx.conf every archive period. While this may suit most situations, there may be occasions when it is desirable to run a report less frequently than every archive period. For example, the archive interval might be 5 minutes, but you only want to FTP files every 30 minutes, once per day, or at a set time each day. There are two options to [StdReport] that provide the ability to control when files are generated. The stale_age option allows control over the age of a file before it is regenerated, and the report_timing option allows precise control over when individual reports are run. WeeWX also includes a utility wee_reports for those times when you need to run a report independent of the interval timing. For example, you might not want to wait for an archive interval to see if your customizations worked. Note Although report_timing specifies when a given report should be generated, the generation of reports is still controlled by the WeeWX report cycle, so reports can never be generated more frequently than once every archive period. If your reports contain data that change more frequently that each archive interval, then you could run wee_reports separately, or consider uploading data to a real-time reporting solution such as MQTT. The stale_age option \u00b6 The stale_age option applies to each file in a report. When stale_age is specified, the file will be (re)generaed only when it is older than the indicated age. The age is specified in seconds. Details for the stale_age option are in the [CheetahGenerator] reference. The report_timing option \u00b6 The report_timing option applies to each report. It uses a CRON-like format to control when a report is to be run. While a CRON-like format is used, the control of WeeWX report generation using the report_timing option is confined completely to WeeWX and has no interraction with the system CRON service. The report_timing option consists of five parameters separated by white-space: report_timing = minutes hours day_of_month months day_of_week The parameters are summarised in the following table: Parameter Function Allowable values minutes Specifies the minutes of the hour when the report will be run *, or numbers in the range 0..59 inclusive hours Specifies the hours of the day when the report will be run *, or numbers in the range 0..23 inclusive day_of_month Specifies the days of the month when the report will be run *, or numbers in the range 1..31 inclusive months Specifies the months of the year when the report will be run *, or numbers in the range 1..12 inclusive, or abbreviated names in the range jan..dec inclusive day_of_week Specifies the days of the week when the report will be run *, or numbers in the range 0..7 inclusive (0,7 = Sunday, 1 = Monday etc.), or abbreviated names in the range sun..sat inclusive The report_timing option may only be used in weewx.conf . When set in the [StdReport] section, the option will apply to all reports listed under [StdReport] . When specified within a report section, the option will override any setting in [StdReport] , for that report. In this manner it is possible to have different reports run at different times. The following excerpt illustrates this: [StdReport] report_timing = 0 * * * * [[AReport]] skin = SomeSkin [[AnotherReport]] skin = SomeOtherSkin report_timing = */10 * * * * In this case, the report AReport would be run under control of the 0 * * * * setting (on the hour) and the report AnotherReport would be run under control of the */10 * * * * setting (every 10 minutes). How report_timing controls reporting \u00b6 The syntax and interpretation of the report_timing parameters are largely the same as those of the CRON service in many Unix and Unix-like operating systems. The syntax and interpretation are outlined below. When the report_timing option is in use WeeWX will run a report when the minute, hour and month of year parameters match the report time, and at least one of the two-day parameters (day of month or day of week) match the report time. This means that non-existent times, such as \"missing hours\" during daylight savings changeover, will never match, causing reports scheduled during the \"missing times\" not to be run. Similarly, times that occur more than once (again, during daylight savings changeover) will cause matching reports to be run more than once. Note Report time does not refer to the time at which the report is run, but rather the date and time of the latest data the report is based upon. If you like, it is the effective date and time of the report. For normal WeeWX operation, the report time aligns with the dateTime of the most recent archive record. When reports are run using the wee_reports utility, the report time is either the dateTime of the most recent archive record (the default) or the optional timestamp command line argument. Note The day a report is to be run can be specified by two parameters; day of month and/or day of week. If both parameters are restricted (i.e., not an asterisk), the report will be run when either field matches the current time. For example, report_timing = 30 4 1,15 * 5 would cause the report to be run at 4:30am on the 1st and 15th of each month as well as 4:30am every Friday. The relationship between report_timing and archive period \u00b6 A traditional CRON service has a resolution of one minute, meaning that the CRON service checks each minute whether to execute any commands. On the other hand, the WeeWX report system checks which reports are to be run once per archive period, where the archive period may be one minute, five minutes, or some other user defined period. Consequently, the report_timing option may specify a report to be run at some time that does not align with the WeeWX archive period. In such cases the report_timing option does not cause a report to be run outside the normal WeeWX report cycle, rather it will cause the report to be run during the next report cycle. At the start of each report cycle, and provided a report_timing option is set, WeeWX will check each minute boundary from the current report time back until the report time of the previous report cycle. If a match is found on any of these one minute boundaries the report will be run during the report cycle. This may be best described through some examples: report_timing Archive period When the report will be run 0 * * * * 5 minutes The report will be run only during the report cycle commencing on the hour. 5 * * * * 5 minutes The report will be run only during the report cycle commencing at 5 minutes past the hour. 3 * * * * 5 minutes The report will be run only during the report cycle commencing at 5 minutes past the hour. 10 * * * * 15 minutes The report will be run only during the report cycle commencing at 15 minutes past the hour 10,40 * * * * 15 minutes The report will be run only during the report cycles commencing at 15 minutes past the hour and 45 minutes past the hour. 5,10 * * * * 15 minutes The report will be run once only during the report cycle commencing at 15 minutes past the hour. Lists, ranges and steps \u00b6 The report_timing option supports lists, ranges, and steps for all parameters. Lists, ranges, and steps may be used as follows: Lists . A list is a set of numbers (or ranges) separated by commas, for example 1, 2, 5, 9 or 0-4, 8-12 . A match with any of the elements of the list will result in a match for that particular parameter. If the examples were applied to the minutes parameter, and subject to other parameters in the report_timing option, the report would be run at minutes 1, 2, 5, and 9 and 0, 1, 2, 3, 4, 8, 9, 10, 11, and 12 respectively. Abbreviated month and day names cannot be used in a list. Ranges . Ranges are two numbers separated with a hyphen, for example 8-11 . The specified range is inclusive. A match with any of the values included in the range will result in a match for that particular parameter. If the example was applied to the hours parameter, and subject to other parameters in the report_timing option, the report would be run at hours 8, 9, 10, and A range may be included as an element of a list. Abbreviated month and day names cannot be used in a range. Steps . A step can be used in conjunction with a range or asterisk and are denoted by a '/' followed by a number. Following a range with a step specifies skips of the step number's value through the range. For example, 0-12/2 used in the hours parameter would, subject to other parameter in the report_timing option, run the report at hours 0, 2, 4, 6, 8, and 12. Steps are also permitted after an asterisk in which case the skips of the step number's value occur through the all possible values of the parameter. For example, */3 can be used in the hours parameter to, subject to other parameter in the report_timing option, run the report at hours 0, 3, 6, 9, 12, 15, 18, and 21. Nicknames \u00b6 The report_timing option supports a number of time specification 'nicknames'. These nicknames are prefixed by the '@' character and replace the five parameters in the report_timing option. The nicknames supported are: Nickname Equivalent setting When the report will be run @yearly @annually 0 0 1 1 * Once per year at midnight on 1 January. @monthly 0 0 1 * * Monthly at midnight on the 1st of the month. @weekly 0 0 * * 0 Every week at midnight on Sunday. @daily 0 0 * * * Every day at midnight. @hourly 0 * * * * Every hour on the hour. Examples of report_timing \u00b6 Numeric settings for report_timing can be at times difficult to understand due to the complex combinations of parameters. The following table shows a number of example report_timing options and the corresponding times when the report would be run. report_timing When the report will be run * * * * * Every archive period. This setting is effectively the default WeeWX method of operation. 25 * * * * 25 minutes past every hour. 0 * * * * Every hour on the hour. 5 0 * * * 00:05 daily. 25 16 * * * 16:25 daily. 25 16 1 * * 16:25 on the 1st of each month. 25 16 1 2 * 16:25 on the 1st of February. 25 16 * * 0 1:25 each Sunday. */10 * * * * On the hour and 10, 20, 30, 40 and 50 mnutes past the hour. */9 * * * * On the hour and 9, 18, 27, 36, 45 and 54 minutes past the hour. */10 */2 * * * 0, 10, 20, 30, 40 and 50 minutes after the even hour. * 6-17 * * * Every archive period from 06:00 (inclusive) up until, but excluding, 18:00. * 1,4,14 * * * Every archive period in the hour starting 01:00 to 01:59, 04:00 to 04:59 amd 14:00 to 14:59 (Note excludes report times at 02:00, 05:00 and 15:00). 0 * 1 * 0,3 On the hour on the first of the month and on the hour every Sunday and Wednesday. * * 21,1-10/3 6 * Every archive period on the 1st, 4th, 7th, 10th and 21st of June. @monthly Midnight on the 1st of the month. The wee_reports utility and the report_timing option \u00b6 The report_timing option is ignored when using the wee_reports utility.","title":"Scheduling reports"},{"location":"custom/report-scheduling/#scheduling-report-generation","text":"Normal WeeWX operation is to run each report defined in weewx.conf every archive period. While this may suit most situations, there may be occasions when it is desirable to run a report less frequently than every archive period. For example, the archive interval might be 5 minutes, but you only want to FTP files every 30 minutes, once per day, or at a set time each day. There are two options to [StdReport] that provide the ability to control when files are generated. The stale_age option allows control over the age of a file before it is regenerated, and the report_timing option allows precise control over when individual reports are run. WeeWX also includes a utility wee_reports for those times when you need to run a report independent of the interval timing. For example, you might not want to wait for an archive interval to see if your customizations worked. Note Although report_timing specifies when a given report should be generated, the generation of reports is still controlled by the WeeWX report cycle, so reports can never be generated more frequently than once every archive period. If your reports contain data that change more frequently that each archive interval, then you could run wee_reports separately, or consider uploading data to a real-time reporting solution such as MQTT.","title":"Scheduling report generation"},{"location":"custom/report-scheduling/#the-stale_age-option","text":"The stale_age option applies to each file in a report. When stale_age is specified, the file will be (re)generaed only when it is older than the indicated age. The age is specified in seconds. Details for the stale_age option are in the [CheetahGenerator] reference.","title":"The stale_age option"},{"location":"custom/report-scheduling/#the-report_timing-option","text":"The report_timing option applies to each report. It uses a CRON-like format to control when a report is to be run. While a CRON-like format is used, the control of WeeWX report generation using the report_timing option is confined completely to WeeWX and has no interraction with the system CRON service. The report_timing option consists of five parameters separated by white-space: report_timing = minutes hours day_of_month months day_of_week The parameters are summarised in the following table: Parameter Function Allowable values minutes Specifies the minutes of the hour when the report will be run *, or numbers in the range 0..59 inclusive hours Specifies the hours of the day when the report will be run *, or numbers in the range 0..23 inclusive day_of_month Specifies the days of the month when the report will be run *, or numbers in the range 1..31 inclusive months Specifies the months of the year when the report will be run *, or numbers in the range 1..12 inclusive, or abbreviated names in the range jan..dec inclusive day_of_week Specifies the days of the week when the report will be run *, or numbers in the range 0..7 inclusive (0,7 = Sunday, 1 = Monday etc.), or abbreviated names in the range sun..sat inclusive The report_timing option may only be used in weewx.conf . When set in the [StdReport] section, the option will apply to all reports listed under [StdReport] . When specified within a report section, the option will override any setting in [StdReport] , for that report. In this manner it is possible to have different reports run at different times. The following excerpt illustrates this: [StdReport] report_timing = 0 * * * * [[AReport]] skin = SomeSkin [[AnotherReport]] skin = SomeOtherSkin report_timing = */10 * * * * In this case, the report AReport would be run under control of the 0 * * * * setting (on the hour) and the report AnotherReport would be run under control of the */10 * * * * setting (every 10 minutes).","title":"The report_timing option"},{"location":"custom/report-scheduling/#how-report_timing-controls-reporting","text":"The syntax and interpretation of the report_timing parameters are largely the same as those of the CRON service in many Unix and Unix-like operating systems. The syntax and interpretation are outlined below. When the report_timing option is in use WeeWX will run a report when the minute, hour and month of year parameters match the report time, and at least one of the two-day parameters (day of month or day of week) match the report time. This means that non-existent times, such as \"missing hours\" during daylight savings changeover, will never match, causing reports scheduled during the \"missing times\" not to be run. Similarly, times that occur more than once (again, during daylight savings changeover) will cause matching reports to be run more than once. Note Report time does not refer to the time at which the report is run, but rather the date and time of the latest data the report is based upon. If you like, it is the effective date and time of the report. For normal WeeWX operation, the report time aligns with the dateTime of the most recent archive record. When reports are run using the wee_reports utility, the report time is either the dateTime of the most recent archive record (the default) or the optional timestamp command line argument. Note The day a report is to be run can be specified by two parameters; day of month and/or day of week. If both parameters are restricted (i.e., not an asterisk), the report will be run when either field matches the current time. For example, report_timing = 30 4 1,15 * 5 would cause the report to be run at 4:30am on the 1st and 15th of each month as well as 4:30am every Friday.","title":"How report_timing controls reporting"},{"location":"custom/report-scheduling/#the-relationship-between-report_timing-and-archive-period","text":"A traditional CRON service has a resolution of one minute, meaning that the CRON service checks each minute whether to execute any commands. On the other hand, the WeeWX report system checks which reports are to be run once per archive period, where the archive period may be one minute, five minutes, or some other user defined period. Consequently, the report_timing option may specify a report to be run at some time that does not align with the WeeWX archive period. In such cases the report_timing option does not cause a report to be run outside the normal WeeWX report cycle, rather it will cause the report to be run during the next report cycle. At the start of each report cycle, and provided a report_timing option is set, WeeWX will check each minute boundary from the current report time back until the report time of the previous report cycle. If a match is found on any of these one minute boundaries the report will be run during the report cycle. This may be best described through some examples: report_timing Archive period When the report will be run 0 * * * * 5 minutes The report will be run only during the report cycle commencing on the hour. 5 * * * * 5 minutes The report will be run only during the report cycle commencing at 5 minutes past the hour. 3 * * * * 5 minutes The report will be run only during the report cycle commencing at 5 minutes past the hour. 10 * * * * 15 minutes The report will be run only during the report cycle commencing at 15 minutes past the hour 10,40 * * * * 15 minutes The report will be run only during the report cycles commencing at 15 minutes past the hour and 45 minutes past the hour. 5,10 * * * * 15 minutes The report will be run once only during the report cycle commencing at 15 minutes past the hour.","title":"The relationship between report_timing and archive period"},{"location":"custom/report-scheduling/#lists-ranges-and-steps","text":"The report_timing option supports lists, ranges, and steps for all parameters. Lists, ranges, and steps may be used as follows: Lists . A list is a set of numbers (or ranges) separated by commas, for example 1, 2, 5, 9 or 0-4, 8-12 . A match with any of the elements of the list will result in a match for that particular parameter. If the examples were applied to the minutes parameter, and subject to other parameters in the report_timing option, the report would be run at minutes 1, 2, 5, and 9 and 0, 1, 2, 3, 4, 8, 9, 10, 11, and 12 respectively. Abbreviated month and day names cannot be used in a list. Ranges . Ranges are two numbers separated with a hyphen, for example 8-11 . The specified range is inclusive. A match with any of the values included in the range will result in a match for that particular parameter. If the example was applied to the hours parameter, and subject to other parameters in the report_timing option, the report would be run at hours 8, 9, 10, and A range may be included as an element of a list. Abbreviated month and day names cannot be used in a range. Steps . A step can be used in conjunction with a range or asterisk and are denoted by a '/' followed by a number. Following a range with a step specifies skips of the step number's value through the range. For example, 0-12/2 used in the hours parameter would, subject to other parameter in the report_timing option, run the report at hours 0, 2, 4, 6, 8, and 12. Steps are also permitted after an asterisk in which case the skips of the step number's value occur through the all possible values of the parameter. For example, */3 can be used in the hours parameter to, subject to other parameter in the report_timing option, run the report at hours 0, 3, 6, 9, 12, 15, 18, and 21.","title":"Lists, ranges and steps"},{"location":"custom/report-scheduling/#nicknames","text":"The report_timing option supports a number of time specification 'nicknames'. These nicknames are prefixed by the '@' character and replace the five parameters in the report_timing option. The nicknames supported are: Nickname Equivalent setting When the report will be run @yearly @annually 0 0 1 1 * Once per year at midnight on 1 January. @monthly 0 0 1 * * Monthly at midnight on the 1st of the month. @weekly 0 0 * * 0 Every week at midnight on Sunday. @daily 0 0 * * * Every day at midnight. @hourly 0 * * * * Every hour on the hour.","title":"Nicknames"},{"location":"custom/report-scheduling/#examples-of-report_timing","text":"Numeric settings for report_timing can be at times difficult to understand due to the complex combinations of parameters. The following table shows a number of example report_timing options and the corresponding times when the report would be run. report_timing When the report will be run * * * * * Every archive period. This setting is effectively the default WeeWX method of operation. 25 * * * * 25 minutes past every hour. 0 * * * * Every hour on the hour. 5 0 * * * 00:05 daily. 25 16 * * * 16:25 daily. 25 16 1 * * 16:25 on the 1st of each month. 25 16 1 2 * 16:25 on the 1st of February. 25 16 * * 0 1:25 each Sunday. */10 * * * * On the hour and 10, 20, 30, 40 and 50 mnutes past the hour. */9 * * * * On the hour and 9, 18, 27, 36, 45 and 54 minutes past the hour. */10 */2 * * * 0, 10, 20, 30, 40 and 50 minutes after the even hour. * 6-17 * * * Every archive period from 06:00 (inclusive) up until, but excluding, 18:00. * 1,4,14 * * * Every archive period in the hour starting 01:00 to 01:59, 04:00 to 04:59 amd 14:00 to 14:59 (Note excludes report times at 02:00, 05:00 and 15:00). 0 * 1 * 0,3 On the hour on the first of the month and on the hour every Sunday and Wednesday. * * 21,1-10/3 6 * Every archive period on the 1st, 4th, 7th, 10th and 21st of June. @monthly Midnight on the 1st of the month.","title":"Examples of report_timing"},{"location":"custom/report-scheduling/#the-wee_reports-utility-and-the-report_timing-option","text":"The report_timing option is ignored when using the wee_reports utility.","title":"The wee_reports utility and the report_timing option"},{"location":"custom/service-engine/","text":"Customizing the service engine \u00b6 This is an advanced topic intended for those who wish to try their hand at extending the internal engine in WeeWX. Before attempting these examples, you should be reasonably proficient with Python. Warning Please note that the API to the service engine may change in future versions! At a high level, WeeWX consists of an engine that is responsible for managing a set of services . A service consists of a Python class which binds its member functions to various events . The engine arranges to have the bound member function called when a specific event happens, such as a new LOOP packet arriving. The services are specified in lists in the [Engine][[Services]] stanza of the configuration file. The [[Services]] section lists all the services to be run, broken up into different service lists . These lists are designed to orchestrate the data as it flows through the WeeWX engine. For example, you want to make sure that data has been processed by the quality control service, StdQC , before putting them in the database. Similarly, the reporting system must come after the data has been put in the database. These groups ensure that things happen in the proper sequence. See the table The standard WeeWX services for a list of the services that are normally run. Modifying an existing service \u00b6 The service weewx.engine.StdPrint prints out new LOOP and archive packets to the console when they arrive. By default, it prints out the entire record, which generally includes a lot of possibly distracting information and can be rather messy. Suppose you do not like this, and want it to print out only the time, barometer reading, and the outside temperature whenever a new LOOP packet arrives. This could be done by subclassing the default print service StdPrint and overriding member function new_loop_packet() . Create the file user/myprint.py : from weewx.engine import StdPrint from weeutil.weeutil import timestamp_to_string class MyPrint ( StdPrint ): # Override the default new_loop_packet member function: def new_loop_packet ( self , event ): packet = event . packet print ( \"LOOP: \" , timestamp_to_string ( packet [ 'dateTime' ]), \"BAR=\" , packet . get ( 'barometer' , 'N/A' ), \"TEMP=\" , packet . get ( 'outTemp' , 'N/A' )) This service substitutes a new implementation for the member function new_loop_packet . This implementation prints out the time, then the barometer reading (or N/A if it is not available) and the outside temperature (or N/A ). You then need to specify that your print service class should be loaded instead of the default StdPrint service. This is done by substituting your service name for StdPrint in service_list , located in [Engine]/[[Services]] : [Engine] [[Services]] ... report_services = user.myprint.MyPrint, weewx.engine.StdReport Note that the report_services must be all on one line. Unfortunately, the parser ConfigObj does not allow options to be continued on to following lines. Creating a new service \u00b6 Suppose there is no service that can be easily customized for your needs. In this case, a new one can easily be created by subclassing off the abstract base class StdService , and then adding the functionality you need. Here is an example that implements an alarm, which sends off an email when an arbitrary expression evaluates True . This example is included in the standard distribution as examples/alarm.py: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 import logging import smtplib import socket import threading import time from email.mime.text import MIMEText import weewx from weeutil.weeutil import timestamp_to_string , option_as_list from weewx.engine import StdService log = logging . getLogger ( __name__ ) # Inherit from the base class StdService: class MyAlarm ( StdService ): \"\"\"Service that sends email if an arbitrary expression evaluates true\"\"\" def __init__ ( self , engine , config_dict ): # Pass the initialization information on to my superclass: super () . __init__ ( engine , config_dict ) # This will hold the time when the last alarm message went out: self . last_msg_ts = 0 try : # Dig the needed options out of the configuration dictionary. # If a critical option is missing, an exception will be raised and # the alarm will not be set. self . expression = config_dict [ 'Alarm' ][ 'expression' ] self . time_wait = int ( config_dict [ 'Alarm' ] . get ( 'time_wait' , 3600 )) self . timeout = int ( config_dict [ 'Alarm' ] . get ( 'timeout' , 10 )) self . smtp_host = config_dict [ 'Alarm' ][ 'smtp_host' ] self . smtp_user = config_dict [ 'Alarm' ] . get ( 'smtp_user' ) self . smtp_password = config_dict [ 'Alarm' ] . get ( 'smtp_password' ) self . SUBJECT = config_dict [ 'Alarm' ] . get ( 'subject' , \"Alarm message from weewx\" ) self . FROM = config_dict [ 'Alarm' ] . get ( 'from' , 'alarm@example.com' ) self . TO = option_as_list ( config_dict [ 'Alarm' ][ 'mailto' ]) except KeyError as e : log . info ( \"No alarm set. Missing parameter: %s \" , e ) else : # If we got this far, it's ok to start intercepting events: self . bind ( weewx . NEW_ARCHIVE_RECORD , self . new_archive_record ) # 1 log . info ( \"Alarm set for expression: ' %s '\" , self . expression ) def new_archive_record ( self , event ): \"\"\"Gets called on a new archive record event.\"\"\" # To avoid a flood of nearly identical emails, this will do # the check only if we have never sent an email, or if we haven't # sent one in the last self.time_wait seconds: if ( not self . last_msg_ts or abs ( time . time () - self . last_msg_ts ) >= self . time_wait ): # Get the new archive record: record = event . record # Be prepared to catch an exception in the case that the expression # contains a variable that is not in the record: try : # 2 # Evaluate the expression in the context of the event archive # record. Sound the alarm if it evaluates true: if eval ( self . expression , None , record ): # 3 # Sound the alarm! Launch in a separate thread, # so it doesn't block the main LOOP thread: t = threading . Thread ( target = MyAlarm . sound_the_alarm , args = ( self , record )) t . start () # Record when the message went out: self . last_msg_ts = time . time () except NameError as e : # The record was missing a named variable. Log it. log . info ( \" %s \" , e ) def sound_the_alarm ( self , record ): \"\"\"Sound the alarm in a 'try' block\"\"\" # Wrap the attempt in a 'try' block so we can log a failure. try : self . do_alarm ( record ) except socket . gaierror : # A gaierror exception is usually caused by an unknown host log . critical ( \"Unknown host %s \" , self . smtp_host ) # Reraise the exception. This will cause the thread to exit. raise except Exception as e : log . critical ( \"Unable to sound alarm. Reason: %s \" , e ) # Reraise the exception. This will cause the thread to exit. raise def do_alarm ( self , record ): \"\"\"Send an email out\"\"\" # Get the time and convert to a string: t_str = timestamp_to_string ( record [ 'dateTime' ]) # Log the alarm log . info ( 'Alarm expression \" %s \" evaluated True at %s ' % ( self . expression , t_str )) # Form the message text: msg_text = 'Alarm expression \" %s \" evaluated True at %s \\n Record: \\n %s ' \\ % ( self . expression , t_str , str ( record )) # Convert to MIME: msg = MIMEText ( msg_text ) # Fill in MIME headers: msg [ 'Subject' ] = self . SUBJECT msg [ 'From' ] = self . FROM msg [ 'To' ] = ',' . join ( self . TO ) try : # First try end-to-end encryption s = smtplib . SMTP_SSL ( self . smtp_host , timeout = self . timeout ) log . debug ( \"Using SMTP_SSL\" ) except ( AttributeError , socket . timeout , socket . error ) as e : log . debug ( \"Unable to use SMTP_SSL connection. Reason: %s \" , e ) # If that doesn't work, try creating an insecure host, # then upgrading s = smtplib . SMTP ( self . smtp_host , timeout = self . timeout ) try : # Be prepared to catch an exception if the server # does not support encrypted transport. s . ehlo () s . starttls () s . ehlo () log . debug ( \"Using SMTP encrypted transport\" ) except smtplib . SMTPException as e : log . debug ( \"Using SMTP unencrypted transport. Reason: %s \" , e ) try : # If a username has been given, assume that login is required # for this host: if self . smtp_user : s . login ( self . smtp_user , self . smtp_password ) log . debug ( \"Logged in with user name %s \" , self . smtp_user ) # Send the email: s . sendmail ( msg [ 'From' ], self . TO , msg . as_string ()) # Log out of the server: s . quit () except Exception as e : log . error ( \"SMTP mailer refused message with error %s \" , e ) raise # Log sending the email: log . info ( \"Email sent to: %s \" , self . TO ) if __name__ == '__main__' : \"\"\"This section is used to test alarm.py. It uses a record and alarm expression that are guaranteed to trigger an alert. You will need a valid weewx.conf configuration file with an [Alarm] section that has been set up as illustrated at the top of this file.\"\"\" from optparse import OptionParser import weecfg import weeutil.logger usage = \"\"\"Usage: python alarm.py --help python alarm.py [CONFIG_FILE|--config=CONFIG_FILE] Arguments: CONFIG_PATH: Path to weewx.conf \"\"\" epilog = \"\"\"You must be sure the WeeWX modules are in your PYTHONPATH. For example: PYTHONPATH=/home/weewx/bin python alarm.py --help\"\"\" # Force debug: weewx . debug = 1 # Create a command line parser: parser = OptionParser ( usage = usage , epilog = epilog ) parser . add_option ( \"--config\" , dest = \"config_path\" , metavar = \"CONFIG_FILE\" , help = \"Use configuration file CONFIG_FILE.\" ) # Parse the arguments and options ( options , args ) = parser . parse_args () try : config_path , config_dict = weecfg . read_config ( options . config_path , args ) except IOError as e : exit ( \"Unable to open configuration file: %s \" % e ) print ( \"Using configuration file %s \" % config_path ) # Set logging configuration: weeutil . logger . setup ( 'alarm' , config_dict ) if 'Alarm' not in config_dict : exit ( \"No [Alarm] section in the configuration file %s \" % config_path ) # This is a fake record that we'll use rec = { 'extraTemp1' : 1.0 , 'outTemp' : 38.2 , 'dateTime' : int ( time . time ())} # Use an expression that will evaluate to True by our fake record. config_dict [ 'Alarm' ][ 'expression' ] = \"outTemp<40.0\" # We need the main WeeWX engine in order to bind to the event, # but we don't need for it to completely start up. So get rid of all # services: config_dict [ 'Engine' ][ 'Services' ] = {} # Now we can instantiate our slim engine, using the DummyEngine class... engine = weewx . engine . DummyEngine ( config_dict ) # ... and set the alarm using it. alarm = MyAlarm ( engine , config_dict ) # Create a NEW_ARCHIVE_RECORD event event = weewx . Event ( weewx . NEW_ARCHIVE_RECORD , record = rec ) # Use it to trigger the alarm: alarm . new_archive_record ( event ) This service expects all the information it needs to be in the configuration file weewx.conf in a new section called [Alarm] . So, add the following lines to your configuration file: [Alarm] expression = \"outTemp < 40.0\" time_wait = 3600 smtp_host = smtp.example.com smtp_user = myusername smtp_password = mypassword mailto = auser@example.com, anotheruser@example.com from = me@example.com subject = \"Alarm message from WeeWX!\" There are three important highlighted points to be noted in this example. (Line 45) Here is where the binding happens between an event, weewx.NEW_ARCHIVE_RECORD , and a member function, self.new_archive_record . When the event NEW_ARCHIVE_RECORD occurs, the function self.new_archive_record will be called. There are many other events that can be intercepted. Look in the file weewx/_init_.py . (Line 61) Some hardware do not emit all possible observation types in every record, so it's possible that a record may be missing some types that are used in the expression. This try block will catch the NameError exception that would be raised should this occur. (Line 64) This is where the test is done for whether to sound the alarm. The [Alarm] configuration options specify that the alarm be sounded when outTemp < 40.0 evaluates True , that is when the outside temperature is below 40.0 degrees. Any valid Python expression can be used, although the only variables available are those in the current archive record. Another example expression could be: expression = \"outTemp < 32.0 and windSpeed > 10.0\" In this case, the alarm is sounded if the outside temperature drops below freezing and the wind speed is greater than 10.0. Note that units must be the same as whatever is being used in your database, that is, the same as what you specified in option target_unit . Option time_wait is used to avoid a flood of nearly identical emails. The new service will wait this long before sending another email out. Email will be sent through the SMTP host specified by option smtp_host . The recipient(s) are specified by the comma separated option mailto . Many SMTP hosts require user login. If this is the case, the user and password are specified with options smtp_user and smtp_password , respectively. The last two options, from and subject are optional. If not supplied, WeeWX will supply something sensible. Note, however, that some mailers require a valid \"from\" email address and the one that WeeWX supplies may not satisfy its requirements. To make this all work, you must first copy the alarm.py file to the user directory. Then tell the engine to load this new service by adding the service name to the list report_services , located in [Engine]/[[Services]] : [Engine] [[Services]] report_services = weewx.engine.StdPrint, weewx.engine.StdReport, user.alarm.MyAlarm Again, note that the option report_services must be all on one line \u2014 the ConfigObj parser does not allow options to be continued on to following lines. In addition to this example, the distribution also includes a low-battery alarm ( lowBattery.py ), which is similar, except that it intercepts LOOP events instead of archiving events. Adding a second data source \u00b6 A very common problem is wanting to augment the data from your weather station with data from some other device. Generally, you have two approaches for how to handle this: Run two instances of WeeWX, each using its own database and weewx.conf configuration file. The results are then combined in a final report, using WeeWX's ability to use more than one database . See the Wiki entry How to run multiple instances of WeeWX for details on how to do this. Run one instance, but use a custom WeeWX service to augment the records coming from your weather station with data from the other device. This section covers the latter approach. Suppose you have installed an electric meter at your house, and you wish to correlate electrical usage with the weather. The meter has some sort of connection to your computer, allowing you to download the total power consumed. At the end of every archive interval you want to calculate the amount of power consumed during the interval, then add the results to the record coming off your weather station. How would you do this? Here is the outline of a service that retrieves the electrical consumption data and adds it to the archive record. It assumes that you already have a function download_total_power() that, somehow, downloads the amount of power consumed since time zero. File user/electricity.py import weewx from weewx.engine import StdService class AddElectricity ( StdService ): def __init__ ( self , engine , config_dict ): # Initialize my superclass first: super ( AddElectricity , self ) . __init__ ( engine , config_dict ) # Bind to any new archive record events: self . bind ( weewx . NEW_ARCHIVE_RECORD , self . new_archive_record ) self . last_total = None def new_archive_record ( self , event ): total_power = download_total_power () if self . last_total : net_consumed = total_power - self . last_total event . record [ 'electricity' ] = net_consumed self . last_total = total_power This adds a new key electricity to the record dictionary and sets it equal to the difference between the amount of power currently consumed and the amount consumed at the last archive record. Hence, it will be the amount of power consumed over the archive interval. The unit should be Watt-hours. As an aside, it is important that the function download_total_power() does not delay very long because it will sit right in the main loop of the WeeWX engine. If it's going to cause a delay of more than a couple seconds you might want to put it in a separate thread and feed the results to AddElectricity through a queue. To make sure your service gets run, you need to add it to one of the service lists in weewx.conf , section [Engine] , subsection [[Services]] . In our case, the obvious place for our new service is in data_services . When you're done, your section [Engine] will look something like this: # This section configures the internal WeeWX engine. [Engine] [[Services]] # This section specifies the services that should be run. They are # grouped by type, and the order of services within each group # determines the order in which the services will be run. xtype_services = weewx.wxxtypes.StdWXXTypes, weewx.wxxtypes.StdPressureCooker, weewx.wxxtypes.StdRainRater, weewx.wxxtypes.StdDelta prep_services = weewx.engine.StdTimeSynch data_services = user.electricity.AddElectricity process_services = weewx.engine.StdConvert, weewx.engine.StdCalibrate, weewx.engine.StdQC, weewx.wxservices.StdWXCalculate archive_services = weewx.engine.StdArchive restful_services = weewx.restx.StdStationRegistry, weewx.restx.StdWunderground, weewx.restx.StdPWSweather, weewx.restx.StdCWOP, weewx.restx.StdWOW, weewx.restx.StdAWEKAS report_services = weewx.engine.StdPrint, weewx.engine.StdReport","title":"Services"},{"location":"custom/service-engine/#customizing-the-service-engine","text":"This is an advanced topic intended for those who wish to try their hand at extending the internal engine in WeeWX. Before attempting these examples, you should be reasonably proficient with Python. Warning Please note that the API to the service engine may change in future versions! At a high level, WeeWX consists of an engine that is responsible for managing a set of services . A service consists of a Python class which binds its member functions to various events . The engine arranges to have the bound member function called when a specific event happens, such as a new LOOP packet arriving. The services are specified in lists in the [Engine][[Services]] stanza of the configuration file. The [[Services]] section lists all the services to be run, broken up into different service lists . These lists are designed to orchestrate the data as it flows through the WeeWX engine. For example, you want to make sure that data has been processed by the quality control service, StdQC , before putting them in the database. Similarly, the reporting system must come after the data has been put in the database. These groups ensure that things happen in the proper sequence. See the table The standard WeeWX services for a list of the services that are normally run.","title":"Customizing the service engine"},{"location":"custom/service-engine/#modify-service","text":"The service weewx.engine.StdPrint prints out new LOOP and archive packets to the console when they arrive. By default, it prints out the entire record, which generally includes a lot of possibly distracting information and can be rather messy. Suppose you do not like this, and want it to print out only the time, barometer reading, and the outside temperature whenever a new LOOP packet arrives. This could be done by subclassing the default print service StdPrint and overriding member function new_loop_packet() . Create the file user/myprint.py : from weewx.engine import StdPrint from weeutil.weeutil import timestamp_to_string class MyPrint ( StdPrint ): # Override the default new_loop_packet member function: def new_loop_packet ( self , event ): packet = event . packet print ( \"LOOP: \" , timestamp_to_string ( packet [ 'dateTime' ]), \"BAR=\" , packet . get ( 'barometer' , 'N/A' ), \"TEMP=\" , packet . get ( 'outTemp' , 'N/A' )) This service substitutes a new implementation for the member function new_loop_packet . This implementation prints out the time, then the barometer reading (or N/A if it is not available) and the outside temperature (or N/A ). You then need to specify that your print service class should be loaded instead of the default StdPrint service. This is done by substituting your service name for StdPrint in service_list , located in [Engine]/[[Services]] : [Engine] [[Services]] ... report_services = user.myprint.MyPrint, weewx.engine.StdReport Note that the report_services must be all on one line. Unfortunately, the parser ConfigObj does not allow options to be continued on to following lines.","title":"Modifying an existing service"},{"location":"custom/service-engine/#create-service","text":"Suppose there is no service that can be easily customized for your needs. In this case, a new one can easily be created by subclassing off the abstract base class StdService , and then adding the functionality you need. Here is an example that implements an alarm, which sends off an email when an arbitrary expression evaluates True . This example is included in the standard distribution as examples/alarm.py: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 import logging import smtplib import socket import threading import time from email.mime.text import MIMEText import weewx from weeutil.weeutil import timestamp_to_string , option_as_list from weewx.engine import StdService log = logging . getLogger ( __name__ ) # Inherit from the base class StdService: class MyAlarm ( StdService ): \"\"\"Service that sends email if an arbitrary expression evaluates true\"\"\" def __init__ ( self , engine , config_dict ): # Pass the initialization information on to my superclass: super () . __init__ ( engine , config_dict ) # This will hold the time when the last alarm message went out: self . last_msg_ts = 0 try : # Dig the needed options out of the configuration dictionary. # If a critical option is missing, an exception will be raised and # the alarm will not be set. self . expression = config_dict [ 'Alarm' ][ 'expression' ] self . time_wait = int ( config_dict [ 'Alarm' ] . get ( 'time_wait' , 3600 )) self . timeout = int ( config_dict [ 'Alarm' ] . get ( 'timeout' , 10 )) self . smtp_host = config_dict [ 'Alarm' ][ 'smtp_host' ] self . smtp_user = config_dict [ 'Alarm' ] . get ( 'smtp_user' ) self . smtp_password = config_dict [ 'Alarm' ] . get ( 'smtp_password' ) self . SUBJECT = config_dict [ 'Alarm' ] . get ( 'subject' , \"Alarm message from weewx\" ) self . FROM = config_dict [ 'Alarm' ] . get ( 'from' , 'alarm@example.com' ) self . TO = option_as_list ( config_dict [ 'Alarm' ][ 'mailto' ]) except KeyError as e : log . info ( \"No alarm set. Missing parameter: %s \" , e ) else : # If we got this far, it's ok to start intercepting events: self . bind ( weewx . NEW_ARCHIVE_RECORD , self . new_archive_record ) # 1 log . info ( \"Alarm set for expression: ' %s '\" , self . expression ) def new_archive_record ( self , event ): \"\"\"Gets called on a new archive record event.\"\"\" # To avoid a flood of nearly identical emails, this will do # the check only if we have never sent an email, or if we haven't # sent one in the last self.time_wait seconds: if ( not self . last_msg_ts or abs ( time . time () - self . last_msg_ts ) >= self . time_wait ): # Get the new archive record: record = event . record # Be prepared to catch an exception in the case that the expression # contains a variable that is not in the record: try : # 2 # Evaluate the expression in the context of the event archive # record. Sound the alarm if it evaluates true: if eval ( self . expression , None , record ): # 3 # Sound the alarm! Launch in a separate thread, # so it doesn't block the main LOOP thread: t = threading . Thread ( target = MyAlarm . sound_the_alarm , args = ( self , record )) t . start () # Record when the message went out: self . last_msg_ts = time . time () except NameError as e : # The record was missing a named variable. Log it. log . info ( \" %s \" , e ) def sound_the_alarm ( self , record ): \"\"\"Sound the alarm in a 'try' block\"\"\" # Wrap the attempt in a 'try' block so we can log a failure. try : self . do_alarm ( record ) except socket . gaierror : # A gaierror exception is usually caused by an unknown host log . critical ( \"Unknown host %s \" , self . smtp_host ) # Reraise the exception. This will cause the thread to exit. raise except Exception as e : log . critical ( \"Unable to sound alarm. Reason: %s \" , e ) # Reraise the exception. This will cause the thread to exit. raise def do_alarm ( self , record ): \"\"\"Send an email out\"\"\" # Get the time and convert to a string: t_str = timestamp_to_string ( record [ 'dateTime' ]) # Log the alarm log . info ( 'Alarm expression \" %s \" evaluated True at %s ' % ( self . expression , t_str )) # Form the message text: msg_text = 'Alarm expression \" %s \" evaluated True at %s \\n Record: \\n %s ' \\ % ( self . expression , t_str , str ( record )) # Convert to MIME: msg = MIMEText ( msg_text ) # Fill in MIME headers: msg [ 'Subject' ] = self . SUBJECT msg [ 'From' ] = self . FROM msg [ 'To' ] = ',' . join ( self . TO ) try : # First try end-to-end encryption s = smtplib . SMTP_SSL ( self . smtp_host , timeout = self . timeout ) log . debug ( \"Using SMTP_SSL\" ) except ( AttributeError , socket . timeout , socket . error ) as e : log . debug ( \"Unable to use SMTP_SSL connection. Reason: %s \" , e ) # If that doesn't work, try creating an insecure host, # then upgrading s = smtplib . SMTP ( self . smtp_host , timeout = self . timeout ) try : # Be prepared to catch an exception if the server # does not support encrypted transport. s . ehlo () s . starttls () s . ehlo () log . debug ( \"Using SMTP encrypted transport\" ) except smtplib . SMTPException as e : log . debug ( \"Using SMTP unencrypted transport. Reason: %s \" , e ) try : # If a username has been given, assume that login is required # for this host: if self . smtp_user : s . login ( self . smtp_user , self . smtp_password ) log . debug ( \"Logged in with user name %s \" , self . smtp_user ) # Send the email: s . sendmail ( msg [ 'From' ], self . TO , msg . as_string ()) # Log out of the server: s . quit () except Exception as e : log . error ( \"SMTP mailer refused message with error %s \" , e ) raise # Log sending the email: log . info ( \"Email sent to: %s \" , self . TO ) if __name__ == '__main__' : \"\"\"This section is used to test alarm.py. It uses a record and alarm expression that are guaranteed to trigger an alert. You will need a valid weewx.conf configuration file with an [Alarm] section that has been set up as illustrated at the top of this file.\"\"\" from optparse import OptionParser import weecfg import weeutil.logger usage = \"\"\"Usage: python alarm.py --help python alarm.py [CONFIG_FILE|--config=CONFIG_FILE] Arguments: CONFIG_PATH: Path to weewx.conf \"\"\" epilog = \"\"\"You must be sure the WeeWX modules are in your PYTHONPATH. For example: PYTHONPATH=/home/weewx/bin python alarm.py --help\"\"\" # Force debug: weewx . debug = 1 # Create a command line parser: parser = OptionParser ( usage = usage , epilog = epilog ) parser . add_option ( \"--config\" , dest = \"config_path\" , metavar = \"CONFIG_FILE\" , help = \"Use configuration file CONFIG_FILE.\" ) # Parse the arguments and options ( options , args ) = parser . parse_args () try : config_path , config_dict = weecfg . read_config ( options . config_path , args ) except IOError as e : exit ( \"Unable to open configuration file: %s \" % e ) print ( \"Using configuration file %s \" % config_path ) # Set logging configuration: weeutil . logger . setup ( 'alarm' , config_dict ) if 'Alarm' not in config_dict : exit ( \"No [Alarm] section in the configuration file %s \" % config_path ) # This is a fake record that we'll use rec = { 'extraTemp1' : 1.0 , 'outTemp' : 38.2 , 'dateTime' : int ( time . time ())} # Use an expression that will evaluate to True by our fake record. config_dict [ 'Alarm' ][ 'expression' ] = \"outTemp<40.0\" # We need the main WeeWX engine in order to bind to the event, # but we don't need for it to completely start up. So get rid of all # services: config_dict [ 'Engine' ][ 'Services' ] = {} # Now we can instantiate our slim engine, using the DummyEngine class... engine = weewx . engine . DummyEngine ( config_dict ) # ... and set the alarm using it. alarm = MyAlarm ( engine , config_dict ) # Create a NEW_ARCHIVE_RECORD event event = weewx . Event ( weewx . NEW_ARCHIVE_RECORD , record = rec ) # Use it to trigger the alarm: alarm . new_archive_record ( event ) This service expects all the information it needs to be in the configuration file weewx.conf in a new section called [Alarm] . So, add the following lines to your configuration file: [Alarm] expression = \"outTemp < 40.0\" time_wait = 3600 smtp_host = smtp.example.com smtp_user = myusername smtp_password = mypassword mailto = auser@example.com, anotheruser@example.com from = me@example.com subject = \"Alarm message from WeeWX!\" There are three important highlighted points to be noted in this example. (Line 45) Here is where the binding happens between an event, weewx.NEW_ARCHIVE_RECORD , and a member function, self.new_archive_record . When the event NEW_ARCHIVE_RECORD occurs, the function self.new_archive_record will be called. There are many other events that can be intercepted. Look in the file weewx/_init_.py . (Line 61) Some hardware do not emit all possible observation types in every record, so it's possible that a record may be missing some types that are used in the expression. This try block will catch the NameError exception that would be raised should this occur. (Line 64) This is where the test is done for whether to sound the alarm. The [Alarm] configuration options specify that the alarm be sounded when outTemp < 40.0 evaluates True , that is when the outside temperature is below 40.0 degrees. Any valid Python expression can be used, although the only variables available are those in the current archive record. Another example expression could be: expression = \"outTemp < 32.0 and windSpeed > 10.0\" In this case, the alarm is sounded if the outside temperature drops below freezing and the wind speed is greater than 10.0. Note that units must be the same as whatever is being used in your database, that is, the same as what you specified in option target_unit . Option time_wait is used to avoid a flood of nearly identical emails. The new service will wait this long before sending another email out. Email will be sent through the SMTP host specified by option smtp_host . The recipient(s) are specified by the comma separated option mailto . Many SMTP hosts require user login. If this is the case, the user and password are specified with options smtp_user and smtp_password , respectively. The last two options, from and subject are optional. If not supplied, WeeWX will supply something sensible. Note, however, that some mailers require a valid \"from\" email address and the one that WeeWX supplies may not satisfy its requirements. To make this all work, you must first copy the alarm.py file to the user directory. Then tell the engine to load this new service by adding the service name to the list report_services , located in [Engine]/[[Services]] : [Engine] [[Services]] report_services = weewx.engine.StdPrint, weewx.engine.StdReport, user.alarm.MyAlarm Again, note that the option report_services must be all on one line \u2014 the ConfigObj parser does not allow options to be continued on to following lines. In addition to this example, the distribution also includes a low-battery alarm ( lowBattery.py ), which is similar, except that it intercepts LOOP events instead of archiving events.","title":"Creating a new service"},{"location":"custom/service-engine/#add-data-source","text":"A very common problem is wanting to augment the data from your weather station with data from some other device. Generally, you have two approaches for how to handle this: Run two instances of WeeWX, each using its own database and weewx.conf configuration file. The results are then combined in a final report, using WeeWX's ability to use more than one database . See the Wiki entry How to run multiple instances of WeeWX for details on how to do this. Run one instance, but use a custom WeeWX service to augment the records coming from your weather station with data from the other device. This section covers the latter approach. Suppose you have installed an electric meter at your house, and you wish to correlate electrical usage with the weather. The meter has some sort of connection to your computer, allowing you to download the total power consumed. At the end of every archive interval you want to calculate the amount of power consumed during the interval, then add the results to the record coming off your weather station. How would you do this? Here is the outline of a service that retrieves the electrical consumption data and adds it to the archive record. It assumes that you already have a function download_total_power() that, somehow, downloads the amount of power consumed since time zero. File user/electricity.py import weewx from weewx.engine import StdService class AddElectricity ( StdService ): def __init__ ( self , engine , config_dict ): # Initialize my superclass first: super ( AddElectricity , self ) . __init__ ( engine , config_dict ) # Bind to any new archive record events: self . bind ( weewx . NEW_ARCHIVE_RECORD , self . new_archive_record ) self . last_total = None def new_archive_record ( self , event ): total_power = download_total_power () if self . last_total : net_consumed = total_power - self . last_total event . record [ 'electricity' ] = net_consumed self . last_total = total_power This adds a new key electricity to the record dictionary and sets it equal to the difference between the amount of power currently consumed and the amount consumed at the last archive record. Hence, it will be the amount of power consumed over the archive interval. The unit should be Watt-hours. As an aside, it is important that the function download_total_power() does not delay very long because it will sit right in the main loop of the WeeWX engine. If it's going to cause a delay of more than a couple seconds you might want to put it in a separate thread and feed the results to AddElectricity through a queue. To make sure your service gets run, you need to add it to one of the service lists in weewx.conf , section [Engine] , subsection [[Services]] . In our case, the obvious place for our new service is in data_services . When you're done, your section [Engine] will look something like this: # This section configures the internal WeeWX engine. [Engine] [[Services]] # This section specifies the services that should be run. They are # grouped by type, and the order of services within each group # determines the order in which the services will be run. xtype_services = weewx.wxxtypes.StdWXXTypes, weewx.wxxtypes.StdPressureCooker, weewx.wxxtypes.StdRainRater, weewx.wxxtypes.StdDelta prep_services = weewx.engine.StdTimeSynch data_services = user.electricity.AddElectricity process_services = weewx.engine.StdConvert, weewx.engine.StdCalibrate, weewx.engine.StdQC, weewx.wxservices.StdWXCalculate archive_services = weewx.engine.StdArchive restful_services = weewx.restx.StdStationRegistry, weewx.restx.StdWunderground, weewx.restx.StdPWSweather, weewx.restx.StdCWOP, weewx.restx.StdWOW, weewx.restx.StdAWEKAS report_services = weewx.engine.StdPrint, weewx.engine.StdReport","title":"Adding a second data source"},{"location":"custom/sle/","text":"Writing search list extensions \u00b6 The intention of this document is to help you write new Search List Extensions (SLE). Here's the plan: We start by explaining how SLEs work. Then we will look at an example that implements an extension $seven_day() . Then we will look at another example, $colorize() , which allows you to pick background colors on the basis of a value (for example, low temperatures could show blue, while high temperatures show red). It will be implemented using 3 different, increasingly sophisticated, ways: A simple, hardwired version that works in only one unit system. A version that can handle any unit system, but with the colors still hardwared. Finally, a version that can handle any unit system, and takes its color bands from the configuration file. How the search list works \u00b6 Let's start by taking a look at how the Cheetah search list works. The Cheetah template engine finds tags by scanning a search list, a Python list of objects. For example, for a tag $foo , the engine will scan down the list, trying each object in the list in turn. For each object, it will first try using foo as an attribute, that is, it will try evaluating obj.foo . If that raises an AttributeError exception, then it will try foo as a key, that is obj[key] . If that raises a KeyError exception, then it moves on to the next item in the list. The first match that does not raise an exception is used. If no match is found, Cheetah raises a NameMapper.NotFound exception. A simple tag \u00b6 Now let's take a look at how the search list interacts with WeeWX tags. Let's start by looking at a simple example: station altitude, available as the tag $station.altitude As we saw in the previous section, Cheetah will run down the search list, looking for an object with a key or attribute station . In the default search list, WeeWX includes one such object, an instance of the class weewx.cheetahgenerator.Station , which has an attribute station , so it gets a hit on this object. Cheetah will then try to evaluate the attribute altitude on this object. Class Station has such an attribute, so Cheetah evaluates it. Return value \u00b6 What this attribute returns is not a raw value, say 700 , nor even a string. Instead, it returns an instance of the class ValueHelper , a special class defined in module weewx.units . Internally, it holds not only the raw value, but also references to the formats, labels, and conversion targets you specified in your configuration file. Its job is to make sure that the final output reflects these preferences. Cheetah doesn't know anything about this class. What it needs, when it has finished evaluating the expression $station.altitude , is a string . In order to convert the ValueHelper it has in hand into a string, it does what every other Python object does when faced with this problem: it calls the special method __str__ . Class ValueHelper has a definition for this method. Evaluating this function triggers the final steps in this process. Any necessary unit conversions are done, then formatting occurs and, finally, a label is attached. The result is a string something like 700 feet which is what Cheetah actually puts in the generated HTML file. This is a good example of lazy evaluation . The tags gather all the information they need, but don't do the final evaluation until the last final moment, when the most context is understood. WeeWX uses this technique extensively. A slightly more complex tag \u00b6 Now let's look at a more complicated example, say the maximum temperature since midnight: $day.outTemp.max When this is evaluated by Cheetah, it actually produces a chain of objects. At the top of this chain is class weewx.tags.TimeBinder , an instance of which is included in the default search list. Internally, this instance stores the time of the desired report (usually the time of the last archive record), a cache to the databases, a default data binding, as well as references to the formatting and labelling options you have chosen. This instance is examined by Cheetah to see if it has an attribute day . It does and, when it is evaluated, it returns the next class in the chain, an instance of weewx.tags.TimespanBinder . In addition to all the other things contained in its parent TimeBinder , class TimespanBinder adds the desired time period, that is, the time span from midnight to the current time. Cheetah then continues on down the chain and tries to find the next attribute, outTemp . There is no such hard coded attribute (hard coding all the conceivable different observation types would be impossible!). Instead, class TimespanBinder defines the Python special method __getattr__ . If Python cannot find a hard coded version of an attribute, and the method __getattr__ exists, it will try it. The definition provided by TimespanBinder returns an instance of the next class in the chain, weewx.tags.ObservationBinder , which not only remembers all the previous stuff, but also adds the observation type, outTemp . Cheetah then tries to evaluate an attribute max of this class, and the pattern repeats. Class weewx.tags.ObservationBinder does not have an attribute max , but it does have a method __getattr__ . This method returns an instance of the next class in the chain, class AggTypeBinder , which not only remembers all the previous information, but adds the aggregation type, max . One final step needs to occur: Cheetah has an instance of AggTypeBinder in hand, but what it really needs is a string to put in the file being created from the template. It creates the string by calling the method __str__() of AggTypeBinder . Now, finally, the chain ends and everything comes together. The method __str__ triggers the actual calculation of the value, using all the known parameters: the database binding to be hit, the time span of interest, the observation type, and the type of aggregation, querying the database as necessary. The database is not actually hit until the last possible moment, after everything needed to do the evalation is known. Like our previous example, the results of the evaluation are then packaged up in an instance of ValueHelper , which does the final conversion to the desired units, formats the string, then adds a label. The results, something like 12\u00b0C are put in the generated HTML file. As you can see, a lot of machinery is hidden behind the deceptively simple expression $day.outTemp.max ! Extending the list \u00b6 As mentioned, WeeWX comes with a number of objects already in the search list, but you can extend it. The general pattern is to create a new class that inherits from weewx.cheetahgenerator.SearchList , which supplies the functionality you need. You may or may not need to override its member function get_extension_list() . If you do not, then a default is supplied. Adding tag $seven_day \u00b6 Let's look at an example. The regular version of WeeWX offers statistical summaries by day, week, month, year, rain year, and all time. While WeeWX offers the tag $week , this is statistics since Sunday at midnight . Suppose we would like to have statistics for a full week, that is since midnight seven days ago. If you wish to use or modify this example, cut and paste the below to user/seven_day.py . import datetime import time from weewx.cheetahgenerator import SearchList from weewx.tags import TimespanBinder from weeutil.weeutil import TimeSpan class SevenDay ( SearchList ): # 1 def __init__ ( self , generator ): # 2 SearchList . __init__ ( self , generator ) def get_extension_list ( self , timespan , db_lookup ): # 3 \"\"\"Returns a search list extension with two additions. Parameters: timespan: An instance of weeutil.weeutil.TimeSpan. This will hold the start and stop times of the domain of valid times. db_lookup: This is a function that, given a data binding as its only parameter, will return a database manager object. \"\"\" # Create a TimespanBinder object for the last seven days. First, # calculate the time at midnight, seven days ago. The variable week_dt # will be an instance of datetime.date. week_dt = datetime . date . fromtimestamp ( timespan . stop ) \\ - datetime . timedelta ( weeks = 1 ) # 4 # Convert it to unix epoch time: week_ts = time . mktime ( week_dt . timetuple ()) # 5 # Form a TimespanBinder object, using the time span we just # calculated: seven_day_stats = TimespanBinder ( TimeSpan ( week_ts , timespan . stop ), db_lookup , context = 'week' , formatter = self . generator . formatter , converter = self . generator . converter , skin_dict = self . generator . skin_dict ) # 6 # Now create a small dictionary with the key 'seven_day': search_list_extension = { 'seven_day' : seven_day_stats } # 7 # Finally, return our extension as a list: return [ search_list_extension ] # 8 Going through the example, line by line: Create a new class called SevenDay , which will inherit from class SearchList . All search list extensions must inherit from this class. Create an initializer for our new class. In this case, the initializer is not really necessary and does nothing except pass its only parameter, generator , a reference to the calling generator, on to its superclass, SearchList , which will then store it in self . Nevertheless, we include the initializer in case you wish to modify it. Override member function get_extension_list() . This function will be called when the generator is ready to accept your new search list extension. The parameters that will be passed in are: self Python's way of indicating the instance we are working with; timespan An instance of the utility class TimeSpan . This will contain the valid start and ending times used by the template. Normally, this is all valid times, but if your template appears under one of the \"Summary By\" sections in the [CheetahGenerator] section of skin.conf , then it will contain the timespan of that time period. db_lookup This is a function supplied by the generator. It takes a single argument, a name of a binding. When called, it will return an instance of the database manager class for that binding. The default for the function is whatever binding you set with the option data_binding for this report, usually wx_binding . The object timespan holds the domain of all valid times for the template, but in order to calculate statistics for the last seven days, we need not the earliest valid time, but the time at midnight seven days ago. So, we do a little Python date arithmetic to calculate this. The object week_dt will be an instance of datetime.date . We convert it to unix epoch time and assign it to variable week_ts . The class TimespanBinder represents a statistical calculation over a time period. We have already met it in the introduction. In our case, we will set it up to represent the statistics over the last seven days. The class takes 6 parameters. The first is the timespan over which the calculation is to be done, which, in our case, is the last seven days. In step 5, we calculated the start of the seven days. The end is \"now\", that is, the end of the reporting period. This is given by the end point of timespan , timespan.stop . The second, db_lookup , is the database lookup function to be used. We simply pass in db_lookup . The third, context , is the time context to be used when formatting times. The set of possible choices is given by sub-section [[TimeFormats]] in the configuration file. Our new tag, $seven_day is pretty similar to $week , so we will just use 'week' , indicating that we want a time format that is suitable for a week-long period. The fourth, formatter , should be an instance of class weewx.units.Formatter , which contains information about how the results should be formatted. We just pass in the formatter set up by the generator, self.generator.formatter . The fifth, converter , should be an instance of weewx.units.Converter , which contains information about the target units ( e.g. , degree_C ) that are to be used. Again, we just pass in the instance set up by the generator, self.generator.converter . The sixth, skin_dict , is an instance of configobj.ConfigObj , and contains the contents of the skin configuration file. We pass it on in order to allow aggregations that need information from the file, such as heating and cooling degree-days. Create a small dictionary with a single key, seven_day , whose value will be the TimespanBinder that we just constructed. Return the dictionary in a list Registering \u00b6 The final step that we need to do is to tell the template engine where to find our extension. You do that by going into the skin configuration file, skin.conf , and adding the option search_list_extensions with our new extension. When you're done, it will look something like this: [CheetahGenerator] # This section is used by the generator CheetahGenerator, and specifies # which files are to be generated from which template. # Possible encodings include 'html_entities', 'strict_ascii', 'normalized_ascii', # as well as those listed in https://docs.python.org/3/library/codecs.html#standard-encodings encoding = html_entities search_list_extensions = user.seven_day.SevenDay [[SummaryByMonth]] ... Our addition has been highlighted . Note that it is in the section [CheetahGenerator] . Now, if the Cheetah engine encounters the tag $seven_day , it will scan the search list, looking for an attribute or key that matches seven_day . When it gets to the little dictionary we provided, it will find a matching key, allowing it to retrieve the appropriate TimespanBinder object. With this approach, you can now include \"seven day\" statistics in your HTML templates: < table > < tr > < td > Maximum temperature over the last seven days: </ td > < td > $seven_day.outTemp.max </ td > </ tr > < tr > < td > Minimum temperature over the last seven days: </ td > < td > $seven_day.outTemp.min </ td > </ tr > < tr > < td > Rain over the last seven days: </ td > < td > $seven_day.rain.sum </ td > </ tr > </ table > We put our addition seven_day.py in the \"user\" directory, which is automatically included by WeeWX in the Python path. However, if you put the file somewhere else, you may have to specify its location with the environment variable PYTHONPATH when you start WeeWX: export PYTHONPATH = /home/me/secret_location Adding tag $colorize \u00b6 Let's look at another example. This one will allow you to supply a background color, depending on the temperature. For example, to colorize an HTML table cell: < table > ... < tr > < td > Outside temperature </ td > < td style = \"background-color:$colorize($current.outTemp.raw)\" > $current.outTemp </ td > </ tr > ... </ table > The highlighted expression will return a color, depending on the value of its argument. For example, if the temperature was 30.9\u00baF, then the output might look like: Outside temperature 30.9\u00b0F A very simple implementation \u00b6 We will start with a very simple version. The code can be found in examples/colorize/colorize_1.py . from weewx.cheetahgenerator import SearchList class Colorize ( SearchList ): # 1 def colorize ( self , t_c ): # 2 \"\"\"Choose a color on the basis of temperature Args: t_c (float): The temperature in degrees Celsius Returns: str: A color string \"\"\" if t_c is None : # 3 return \"#00000000\" elif t_c < - 10 : return \"magenta\" elif t_c < 0 : return \"violet\" elif t_c < 10 : return \"lavender\" elif t_c < 20 : return \"mocassin\" elif t_c < 30 : return \"yellow\" elif t_c < 40 : return \"coral\" else : return \"tomato\" The first thing that's striking about this version is just how simple an SLE can be: just one class with a single function. Let's go through the implementation line-by-line. Just like the first example, all search list extensions inherit from weewx.cheetahgenerator.SearchList The class defines a single function, colorize() , with a single argument that must be of type float . Unlike the first example, notice how we do not define an initializer, __init__() , and, instead, rely on our superclass to do the initialization. The function relies on a big if/else statement to pick a color on the basis of the temperature value. Note how it starts by checking whether the value could be Python None . WeeWX uses None to represent missing or invalid data. One must be always vigilant in guarding against a None value. If None is found, then the color #00000000 is returned, which is transparent and will have no effect. Registering \u00b6 As before, we must register our extension with the Cheetah engine. We do this by copying the extension to the user directory, then adding its location to option search_list_extensions : [CheetahGenerator] ... search_list_extensions = user.colorize_1.Colorize ... Where is get_extension_list() ? \u00b6 You might wonder, \"What happened to the member function get_extension_list() ? We needed it in the first example; why not now?\" The answer is that we are inheriting from, and relying on, the version in the superclass SearchList , which looks like this: def get_extension_list ( self , timespan , db_lookup ): return [ self ] This returns a list, with itself (an instance of class Colorize ) as the only member. How do we know whether to include an instance of get_extension_list() ? Why did we include a version in the first example, but not in the second? The answer is that many extensions, including $seven_day , need information that can only be known when the template is being evaluated. In the case of $seven_day , this was which database binding to use, which will determine the results of the database query done in its implementation. This information is not known until get_extension_list() is called, which is just before template evaluation. By constrast, $colorize() is pure static: it doesn't use the database at all, and everything it needs it can get from its single function argument. So, it has no need for the information in get_extension_list() . Review \u00b6 Let's review the whole process. When the WeeWX Cheetah generator starts up to evaluate a template, it first creates a search list. It does this by calling get_extension_list() for each SLE that has been registered with it. In our case, this will cause the function above to put an instance of Colorize in the search list \u2014 we don't have to do anything to make this happen. When the engine starts to process the template, it will eventually come to < td style = \"background-color:$colorize($current.outTemp.raw)\" > $current.outTemp </ td > It needs to evaluate the expression $colorize($current.outTemp.raw) , so it starts scanning the search list looking for something with an attribute or key colorize . When it comes to our instance of Colorize it gets a hit because, in Python, member functions are implemented as attributes. The Cheetah engine knows to call it as a function because of the parenthesis that follow the name. The engine passes in the value of $current.outTemp.raw as the sole argument, where it appears under the name t_c . As described above, the function colorize() then uses the argument to choose an appropriate color, returning it as a string. Limitation \u00b6 This example has an obvious limitation: the argument to $colorize() must be in degrees Celsius. We can guard against passing in the wrong unit by always converting to Celsius first: < td style = \"background-color:$colorize($current.outTemp.degree_C.raw)\" > $current.outTemp </ td > but the user would have to remember to do this every time colorize() is called. The next version gets around this limitation. A slightly better version \u00b6 Here's an improved version that can handle an argument that uses any unit, not just degrees Celsius. The code can be found in examples/colorize/colorize_2.py . import weewx.units from weewx.cheetahgenerator import SearchList class Colorize ( SearchList ): # 1 def colorize ( self , value_vh ): # 2 \"\"\"Choose a color string on the basis of a temperature value\"\"\" # Extract the ValueTuple part out of the ValueHelper value_vt = value_vh . value_t # 3 # Convert to Celsius: t_celsius = weewx . units . convert ( value_vt , 'degree_C' ) # 4 # The variable \"t_celsius\" is a ValueTuple. Get just the value: t_c = t_celsius . value # 5 # Pick a color based on the temperature if t_c is None : # 6 return \"#00000000\" elif t_c < - 10 : return \"magenta\" elif t_c < 0 : return \"violet\" elif t_c < 10 : return \"lavender\" elif t_c < 20 : return \"mocassin\" elif t_c < 30 : return \"yellow\" elif t_c < 40 : return \"coral\" else : return \"tomato\" Going through the example, line by line: Just like the other examples, we must inherit from weewx.cheetahgenerator.SearchList . However, in this example, notice that the argument to colorize() is an instance of class ValueHelper , instead of a simple float. As before, we do not define an initializer, __init__() , and, instead, rely on our superclass to do the initialization. The argument value_vh will contain many things, including formatting and preferred units, but, for now, we are only interested in the ValueTuple contained within, which can be extracted with the attribute value_t . The variable value_vt could be in any unit that measures temperature. Our code needs Celsius, so we convert to Celsius using the convenience function weewx.units.convert() . The results will be a new ValueTuple , this time in Celsius. We need just the temperature value, and not the other things in a ValueTuple , so extract it using the attribute value . The results will be a simple instance of float or, possibly, Python None . Finally, we need a big if/else statement to choose which color to return, while making sure to test for None . This version uses a ValueHelper as an argument instead of a float. How do we call it? Here's an example: <table> ... <tr> <td>Outside temperature</td> <td style=\"background-color:$colorize($current.outTemp)\">$current.outTemp</td> </tr> ... </table> This time, we call the function with a simple $current.outTemp (without the .raw suffix), which is actually an instance of class ValueHelper . When we met this class earlier, the Cheetah engine needed a string to put in the template, so it called the special member function __str__() . However, in this case, the results are going to be used as an argument to a function, not as a string, so the engine simply passes in the ValueHelper unchanged to colorize() , where it appears as argument value_vh . Our new version is better than the original because it can take a temperature in any unit, not just Celsius. However, it can still only handle temperature values and, even then, the color bands are still hardwired in. Our next version will remove these limitations. A more sophisticated version \u00b6 Rather than hardwire in the values and observation type, in this version we will retrieve them from the skin configuration file, skin.conf . Here's what a typical configuration might look like for this version: [Colorize] # 1 [[group_temperature]] # 2 unit_system = metricwx # 3 default = tomato # 4 None = lightgray # 5 [[[upper_bounds]]] # 6 -10 = magenta # 7 0 = violet # 8 10 = lavender 20 = mocassin 30 = yellow 40 = coral [[group_uv]] # 9 unit_system = metricwx default = darkviolet [[[upper_bounds]]] 2.4 = limegreen 5.4 = yellow 7.4 = orange 10.4 = red Here's what the various lines in the configuration stanza mean: All the configuration information needed by the SLE Colorize can be found in a stanza with the heading [Colorize] . Linking facility with a stanza of the same name is a very common pattern in WeeWX. We need a separate color table for each unit group that we are going to support. This is the start of the table for unit group group_temperature . We need to specify what unit system will be used by the temperature color table. In this example, we are using metricwx . In case we do not find a value in the table, we need a default. We will use the color tomato . In case the value is Python None , return the color given by option None . We will use lightgray . The sub-subsecction [[[upper_bounds]]] lists the upper (max) value of each of the color bands. The first color band (magenta) is used for temperatures less than or equal to -10\u00b0C. The second band (violet) is for temperatures greater than -10\u00b0C and less than or equal to 0\u00b0C. And so on. The next subsection, [[group_uv]] , is very similar to the one for group_temperature , except the values are for bands of the UV index. Although [Colorize] is in skin.conf , there is nothing special about it, and it can be overridden in weewx.conf , just like any other configuration information. Annotated code \u00b6 Here's the alternative version of colorize() , which will use the values in the configuration file. It can also be found in examples/colorize/colorize_3.py . import weewx.units from weewx.cheetahgenerator import SearchList class Colorize ( SearchList ): # 1 def __init__ ( self , generator ): # 2 SearchList . __init__ ( self , generator ) self . color_tables = self . generator . skin_dict . get ( 'Colorize' , {}) def colorize ( self , value_vh ): # Get the ValueTuple and unit group from the incoming ValueHelper value_vt = value_vh . value_t # 3 unit_group = value_vt . group # 4 # Make sure unit_group is in the color table, and that the table # specifies a unit system. if unit_group not in self . color_tables \\ or 'unit_system' not in self . color_tables [ unit_group ]: # 5 return \"#00000000\" # Convert the value to the same unit used by the color table: unit_system = self . color_tables [ unit_group ][ 'unit_system' ] # 6 converted_vt = weewx . units . convertStdName ( value_vt , unit_system ) # 7 # Check for a value of None if converted_vt . value is None : # 8 return self . color_tables [ unit_group ] . get ( 'none' ) \\ or self . color_tables [ unit_group ] . get ( 'None' , \"#00000000\" ) # Search for the value in the color table: for upper_bound in self . color_tables [ unit_group ][ 'upper_bounds' ]: # 9 if converted_vt . value <= float ( upper_bound ): # 10 return self . color_tables [ unit_group ][ 'upper_bounds' ][ upper_bound ] return self . color_tables [ unit_group ] . get ( 'default' , \"#00000000\" ) # 11 As before, our class must inherit from SearchList . In this version, we supply an initializer because we are going to do some work in it: extract our color table out of the skin configuration dictionary. In case the user neglects to include a [Colorize] section, we substitute an empty dictionary. As before, we extract the ValueTuple part out of the incoming ValueHelper using the attribute value_t . Retrieve the unit group used by the incoming argument. This will be something like \"group_temperature\". What if the user is requesting a color for a unit group that we don't know anything about? We must check that the unit group is in our color table. We must also check that a unit system has been supplied for the color table. If either of these checks fail, then return the color #00000000 , which will have no effect in setting a background color. Thanks to the checks we did in step 5, we know that this line will not raise a KeyError exception. Get the unit system used by the color table for this unit group. It will be something like 'US', 'metric', or 'metricwx'. Convert the incoming value, so it uses the same units as the color table. We must always be vigilant for values of Python None! The expression self . color_tables [ unit_group ] . get ( 'none' ) or self . color_tables [ unit_group ] . get ( 'None' , \"#00000000\" ) is just a trick to allow us to accept either \" none \" or \" None \" in the configuration file. If neither is present, then we return the color #00000000 , which will have no effect. Now start searching the color table to find a band that is less than or equal to the value we have in hand. Two details to note. First, the variable converted_vt is a ValueTuple . We need the raw value in order to do the comparison. We get this through attribute .value . Second, WeeWX uses the utility ConfigObj to read configuration files. When ConfigObj returns its results, the values will be strings . We must convert these to floats before doing the comparison. You must be constantly vigilant about this when working with configuration information. If we find a band with an upper bound greater than our value, we have a hit. Return the corresponding color. If we make it all the way through the table without a hit, then we must have a value greater than anything in the table. Return the default, or the color #00000000 if there is no default.","title":"Search lists"},{"location":"custom/sle/#writing-search-list-extensions","text":"The intention of this document is to help you write new Search List Extensions (SLE). Here's the plan: We start by explaining how SLEs work. Then we will look at an example that implements an extension $seven_day() . Then we will look at another example, $colorize() , which allows you to pick background colors on the basis of a value (for example, low temperatures could show blue, while high temperatures show red). It will be implemented using 3 different, increasingly sophisticated, ways: A simple, hardwired version that works in only one unit system. A version that can handle any unit system, but with the colors still hardwared. Finally, a version that can handle any unit system, and takes its color bands from the configuration file.","title":"Writing search list extensions"},{"location":"custom/sle/#how-the-search-list-works","text":"Let's start by taking a look at how the Cheetah search list works. The Cheetah template engine finds tags by scanning a search list, a Python list of objects. For example, for a tag $foo , the engine will scan down the list, trying each object in the list in turn. For each object, it will first try using foo as an attribute, that is, it will try evaluating obj.foo . If that raises an AttributeError exception, then it will try foo as a key, that is obj[key] . If that raises a KeyError exception, then it moves on to the next item in the list. The first match that does not raise an exception is used. If no match is found, Cheetah raises a NameMapper.NotFound exception.","title":"How the search list works"},{"location":"custom/sle/#simple-tag","text":"Now let's take a look at how the search list interacts with WeeWX tags. Let's start by looking at a simple example: station altitude, available as the tag $station.altitude As we saw in the previous section, Cheetah will run down the search list, looking for an object with a key or attribute station . In the default search list, WeeWX includes one such object, an instance of the class weewx.cheetahgenerator.Station , which has an attribute station , so it gets a hit on this object. Cheetah will then try to evaluate the attribute altitude on this object. Class Station has such an attribute, so Cheetah evaluates it.","title":"A simple tag"},{"location":"custom/sle/#return-value","text":"What this attribute returns is not a raw value, say 700 , nor even a string. Instead, it returns an instance of the class ValueHelper , a special class defined in module weewx.units . Internally, it holds not only the raw value, but also references to the formats, labels, and conversion targets you specified in your configuration file. Its job is to make sure that the final output reflects these preferences. Cheetah doesn't know anything about this class. What it needs, when it has finished evaluating the expression $station.altitude , is a string . In order to convert the ValueHelper it has in hand into a string, it does what every other Python object does when faced with this problem: it calls the special method __str__ . Class ValueHelper has a definition for this method. Evaluating this function triggers the final steps in this process. Any necessary unit conversions are done, then formatting occurs and, finally, a label is attached. The result is a string something like 700 feet which is what Cheetah actually puts in the generated HTML file. This is a good example of lazy evaluation . The tags gather all the information they need, but don't do the final evaluation until the last final moment, when the most context is understood. WeeWX uses this technique extensively.","title":"Return value"},{"location":"custom/sle/#complex-tag","text":"Now let's look at a more complicated example, say the maximum temperature since midnight: $day.outTemp.max When this is evaluated by Cheetah, it actually produces a chain of objects. At the top of this chain is class weewx.tags.TimeBinder , an instance of which is included in the default search list. Internally, this instance stores the time of the desired report (usually the time of the last archive record), a cache to the databases, a default data binding, as well as references to the formatting and labelling options you have chosen. This instance is examined by Cheetah to see if it has an attribute day . It does and, when it is evaluated, it returns the next class in the chain, an instance of weewx.tags.TimespanBinder . In addition to all the other things contained in its parent TimeBinder , class TimespanBinder adds the desired time period, that is, the time span from midnight to the current time. Cheetah then continues on down the chain and tries to find the next attribute, outTemp . There is no such hard coded attribute (hard coding all the conceivable different observation types would be impossible!). Instead, class TimespanBinder defines the Python special method __getattr__ . If Python cannot find a hard coded version of an attribute, and the method __getattr__ exists, it will try it. The definition provided by TimespanBinder returns an instance of the next class in the chain, weewx.tags.ObservationBinder , which not only remembers all the previous stuff, but also adds the observation type, outTemp . Cheetah then tries to evaluate an attribute max of this class, and the pattern repeats. Class weewx.tags.ObservationBinder does not have an attribute max , but it does have a method __getattr__ . This method returns an instance of the next class in the chain, class AggTypeBinder , which not only remembers all the previous information, but adds the aggregation type, max . One final step needs to occur: Cheetah has an instance of AggTypeBinder in hand, but what it really needs is a string to put in the file being created from the template. It creates the string by calling the method __str__() of AggTypeBinder . Now, finally, the chain ends and everything comes together. The method __str__ triggers the actual calculation of the value, using all the known parameters: the database binding to be hit, the time span of interest, the observation type, and the type of aggregation, querying the database as necessary. The database is not actually hit until the last possible moment, after everything needed to do the evalation is known. Like our previous example, the results of the evaluation are then packaged up in an instance of ValueHelper , which does the final conversion to the desired units, formats the string, then adds a label. The results, something like 12\u00b0C are put in the generated HTML file. As you can see, a lot of machinery is hidden behind the deceptively simple expression $day.outTemp.max !","title":"A slightly more complex tag"},{"location":"custom/sle/#extending-the-list","text":"As mentioned, WeeWX comes with a number of objects already in the search list, but you can extend it. The general pattern is to create a new class that inherits from weewx.cheetahgenerator.SearchList , which supplies the functionality you need. You may or may not need to override its member function get_extension_list() . If you do not, then a default is supplied.","title":"Extending the list"},{"location":"custom/sle/#adding-tag-seven_day","text":"Let's look at an example. The regular version of WeeWX offers statistical summaries by day, week, month, year, rain year, and all time. While WeeWX offers the tag $week , this is statistics since Sunday at midnight . Suppose we would like to have statistics for a full week, that is since midnight seven days ago. If you wish to use or modify this example, cut and paste the below to user/seven_day.py . import datetime import time from weewx.cheetahgenerator import SearchList from weewx.tags import TimespanBinder from weeutil.weeutil import TimeSpan class SevenDay ( SearchList ): # 1 def __init__ ( self , generator ): # 2 SearchList . __init__ ( self , generator ) def get_extension_list ( self , timespan , db_lookup ): # 3 \"\"\"Returns a search list extension with two additions. Parameters: timespan: An instance of weeutil.weeutil.TimeSpan. This will hold the start and stop times of the domain of valid times. db_lookup: This is a function that, given a data binding as its only parameter, will return a database manager object. \"\"\" # Create a TimespanBinder object for the last seven days. First, # calculate the time at midnight, seven days ago. The variable week_dt # will be an instance of datetime.date. week_dt = datetime . date . fromtimestamp ( timespan . stop ) \\ - datetime . timedelta ( weeks = 1 ) # 4 # Convert it to unix epoch time: week_ts = time . mktime ( week_dt . timetuple ()) # 5 # Form a TimespanBinder object, using the time span we just # calculated: seven_day_stats = TimespanBinder ( TimeSpan ( week_ts , timespan . stop ), db_lookup , context = 'week' , formatter = self . generator . formatter , converter = self . generator . converter , skin_dict = self . generator . skin_dict ) # 6 # Now create a small dictionary with the key 'seven_day': search_list_extension = { 'seven_day' : seven_day_stats } # 7 # Finally, return our extension as a list: return [ search_list_extension ] # 8 Going through the example, line by line: Create a new class called SevenDay , which will inherit from class SearchList . All search list extensions must inherit from this class. Create an initializer for our new class. In this case, the initializer is not really necessary and does nothing except pass its only parameter, generator , a reference to the calling generator, on to its superclass, SearchList , which will then store it in self . Nevertheless, we include the initializer in case you wish to modify it. Override member function get_extension_list() . This function will be called when the generator is ready to accept your new search list extension. The parameters that will be passed in are: self Python's way of indicating the instance we are working with; timespan An instance of the utility class TimeSpan . This will contain the valid start and ending times used by the template. Normally, this is all valid times, but if your template appears under one of the \"Summary By\" sections in the [CheetahGenerator] section of skin.conf , then it will contain the timespan of that time period. db_lookup This is a function supplied by the generator. It takes a single argument, a name of a binding. When called, it will return an instance of the database manager class for that binding. The default for the function is whatever binding you set with the option data_binding for this report, usually wx_binding . The object timespan holds the domain of all valid times for the template, but in order to calculate statistics for the last seven days, we need not the earliest valid time, but the time at midnight seven days ago. So, we do a little Python date arithmetic to calculate this. The object week_dt will be an instance of datetime.date . We convert it to unix epoch time and assign it to variable week_ts . The class TimespanBinder represents a statistical calculation over a time period. We have already met it in the introduction. In our case, we will set it up to represent the statistics over the last seven days. The class takes 6 parameters. The first is the timespan over which the calculation is to be done, which, in our case, is the last seven days. In step 5, we calculated the start of the seven days. The end is \"now\", that is, the end of the reporting period. This is given by the end point of timespan , timespan.stop . The second, db_lookup , is the database lookup function to be used. We simply pass in db_lookup . The third, context , is the time context to be used when formatting times. The set of possible choices is given by sub-section [[TimeFormats]] in the configuration file. Our new tag, $seven_day is pretty similar to $week , so we will just use 'week' , indicating that we want a time format that is suitable for a week-long period. The fourth, formatter , should be an instance of class weewx.units.Formatter , which contains information about how the results should be formatted. We just pass in the formatter set up by the generator, self.generator.formatter . The fifth, converter , should be an instance of weewx.units.Converter , which contains information about the target units ( e.g. , degree_C ) that are to be used. Again, we just pass in the instance set up by the generator, self.generator.converter . The sixth, skin_dict , is an instance of configobj.ConfigObj , and contains the contents of the skin configuration file. We pass it on in order to allow aggregations that need information from the file, such as heating and cooling degree-days. Create a small dictionary with a single key, seven_day , whose value will be the TimespanBinder that we just constructed. Return the dictionary in a list","title":"Adding tag $seven_day"},{"location":"custom/sle/#register-seven-day","text":"The final step that we need to do is to tell the template engine where to find our extension. You do that by going into the skin configuration file, skin.conf , and adding the option search_list_extensions with our new extension. When you're done, it will look something like this: [CheetahGenerator] # This section is used by the generator CheetahGenerator, and specifies # which files are to be generated from which template. # Possible encodings include 'html_entities', 'strict_ascii', 'normalized_ascii', # as well as those listed in https://docs.python.org/3/library/codecs.html#standard-encodings encoding = html_entities search_list_extensions = user.seven_day.SevenDay [[SummaryByMonth]] ... Our addition has been highlighted . Note that it is in the section [CheetahGenerator] . Now, if the Cheetah engine encounters the tag $seven_day , it will scan the search list, looking for an attribute or key that matches seven_day . When it gets to the little dictionary we provided, it will find a matching key, allowing it to retrieve the appropriate TimespanBinder object. With this approach, you can now include \"seven day\" statistics in your HTML templates: < table > < tr > < td > Maximum temperature over the last seven days: </ td > < td > $seven_day.outTemp.max </ td > </ tr > < tr > < td > Minimum temperature over the last seven days: </ td > < td > $seven_day.outTemp.min </ td > </ tr > < tr > < td > Rain over the last seven days: </ td > < td > $seven_day.rain.sum </ td > </ tr > </ table > We put our addition seven_day.py in the \"user\" directory, which is automatically included by WeeWX in the Python path. However, if you put the file somewhere else, you may have to specify its location with the environment variable PYTHONPATH when you start WeeWX: export PYTHONPATH = /home/me/secret_location","title":"Registering"},{"location":"custom/sle/#adding-tag-colorize","text":"Let's look at another example. This one will allow you to supply a background color, depending on the temperature. For example, to colorize an HTML table cell: < table > ... < tr > < td > Outside temperature </ td > < td style = \"background-color:$colorize($current.outTemp.raw)\" > $current.outTemp </ td > </ tr > ... </ table > The highlighted expression will return a color, depending on the value of its argument. For example, if the temperature was 30.9\u00baF, then the output might look like: Outside temperature 30.9\u00b0F","title":"Adding tag $colorize"},{"location":"custom/sle/#a-very-simple-implementation","text":"We will start with a very simple version. The code can be found in examples/colorize/colorize_1.py . from weewx.cheetahgenerator import SearchList class Colorize ( SearchList ): # 1 def colorize ( self , t_c ): # 2 \"\"\"Choose a color on the basis of temperature Args: t_c (float): The temperature in degrees Celsius Returns: str: A color string \"\"\" if t_c is None : # 3 return \"#00000000\" elif t_c < - 10 : return \"magenta\" elif t_c < 0 : return \"violet\" elif t_c < 10 : return \"lavender\" elif t_c < 20 : return \"mocassin\" elif t_c < 30 : return \"yellow\" elif t_c < 40 : return \"coral\" else : return \"tomato\" The first thing that's striking about this version is just how simple an SLE can be: just one class with a single function. Let's go through the implementation line-by-line. Just like the first example, all search list extensions inherit from weewx.cheetahgenerator.SearchList The class defines a single function, colorize() , with a single argument that must be of type float . Unlike the first example, notice how we do not define an initializer, __init__() , and, instead, rely on our superclass to do the initialization. The function relies on a big if/else statement to pick a color on the basis of the temperature value. Note how it starts by checking whether the value could be Python None . WeeWX uses None to represent missing or invalid data. One must be always vigilant in guarding against a None value. If None is found, then the color #00000000 is returned, which is transparent and will have no effect.","title":"A very simple implementation"},{"location":"custom/sle/#register-colorize","text":"As before, we must register our extension with the Cheetah engine. We do this by copying the extension to the user directory, then adding its location to option search_list_extensions : [CheetahGenerator] ... search_list_extensions = user.colorize_1.Colorize ...","title":"Registering"},{"location":"custom/sle/#where-is-get_extension_list","text":"You might wonder, \"What happened to the member function get_extension_list() ? We needed it in the first example; why not now?\" The answer is that we are inheriting from, and relying on, the version in the superclass SearchList , which looks like this: def get_extension_list ( self , timespan , db_lookup ): return [ self ] This returns a list, with itself (an instance of class Colorize ) as the only member. How do we know whether to include an instance of get_extension_list() ? Why did we include a version in the first example, but not in the second? The answer is that many extensions, including $seven_day , need information that can only be known when the template is being evaluated. In the case of $seven_day , this was which database binding to use, which will determine the results of the database query done in its implementation. This information is not known until get_extension_list() is called, which is just before template evaluation. By constrast, $colorize() is pure static: it doesn't use the database at all, and everything it needs it can get from its single function argument. So, it has no need for the information in get_extension_list() .","title":"Where is get_extension_list()?"},{"location":"custom/sle/#review","text":"Let's review the whole process. When the WeeWX Cheetah generator starts up to evaluate a template, it first creates a search list. It does this by calling get_extension_list() for each SLE that has been registered with it. In our case, this will cause the function above to put an instance of Colorize in the search list \u2014 we don't have to do anything to make this happen. When the engine starts to process the template, it will eventually come to < td style = \"background-color:$colorize($current.outTemp.raw)\" > $current.outTemp </ td > It needs to evaluate the expression $colorize($current.outTemp.raw) , so it starts scanning the search list looking for something with an attribute or key colorize . When it comes to our instance of Colorize it gets a hit because, in Python, member functions are implemented as attributes. The Cheetah engine knows to call it as a function because of the parenthesis that follow the name. The engine passes in the value of $current.outTemp.raw as the sole argument, where it appears under the name t_c . As described above, the function colorize() then uses the argument to choose an appropriate color, returning it as a string.","title":"Review"},{"location":"custom/sle/#limitation","text":"This example has an obvious limitation: the argument to $colorize() must be in degrees Celsius. We can guard against passing in the wrong unit by always converting to Celsius first: < td style = \"background-color:$colorize($current.outTemp.degree_C.raw)\" > $current.outTemp </ td > but the user would have to remember to do this every time colorize() is called. The next version gets around this limitation.","title":"Limitation"},{"location":"custom/sle/#a-slightly-better-version","text":"Here's an improved version that can handle an argument that uses any unit, not just degrees Celsius. The code can be found in examples/colorize/colorize_2.py . import weewx.units from weewx.cheetahgenerator import SearchList class Colorize ( SearchList ): # 1 def colorize ( self , value_vh ): # 2 \"\"\"Choose a color string on the basis of a temperature value\"\"\" # Extract the ValueTuple part out of the ValueHelper value_vt = value_vh . value_t # 3 # Convert to Celsius: t_celsius = weewx . units . convert ( value_vt , 'degree_C' ) # 4 # The variable \"t_celsius\" is a ValueTuple. Get just the value: t_c = t_celsius . value # 5 # Pick a color based on the temperature if t_c is None : # 6 return \"#00000000\" elif t_c < - 10 : return \"magenta\" elif t_c < 0 : return \"violet\" elif t_c < 10 : return \"lavender\" elif t_c < 20 : return \"mocassin\" elif t_c < 30 : return \"yellow\" elif t_c < 40 : return \"coral\" else : return \"tomato\" Going through the example, line by line: Just like the other examples, we must inherit from weewx.cheetahgenerator.SearchList . However, in this example, notice that the argument to colorize() is an instance of class ValueHelper , instead of a simple float. As before, we do not define an initializer, __init__() , and, instead, rely on our superclass to do the initialization. The argument value_vh will contain many things, including formatting and preferred units, but, for now, we are only interested in the ValueTuple contained within, which can be extracted with the attribute value_t . The variable value_vt could be in any unit that measures temperature. Our code needs Celsius, so we convert to Celsius using the convenience function weewx.units.convert() . The results will be a new ValueTuple , this time in Celsius. We need just the temperature value, and not the other things in a ValueTuple , so extract it using the attribute value . The results will be a simple instance of float or, possibly, Python None . Finally, we need a big if/else statement to choose which color to return, while making sure to test for None . This version uses a ValueHelper as an argument instead of a float. How do we call it? Here's an example: <table> ... <tr> <td>Outside temperature</td> <td style=\"background-color:$colorize($current.outTemp)\">$current.outTemp</td> </tr> ... </table> This time, we call the function with a simple $current.outTemp (without the .raw suffix), which is actually an instance of class ValueHelper . When we met this class earlier, the Cheetah engine needed a string to put in the template, so it called the special member function __str__() . However, in this case, the results are going to be used as an argument to a function, not as a string, so the engine simply passes in the ValueHelper unchanged to colorize() , where it appears as argument value_vh . Our new version is better than the original because it can take a temperature in any unit, not just Celsius. However, it can still only handle temperature values and, even then, the color bands are still hardwired in. Our next version will remove these limitations.","title":"A slightly better version"},{"location":"custom/sle/#a-more-sophisticated-version","text":"Rather than hardwire in the values and observation type, in this version we will retrieve them from the skin configuration file, skin.conf . Here's what a typical configuration might look like for this version: [Colorize] # 1 [[group_temperature]] # 2 unit_system = metricwx # 3 default = tomato # 4 None = lightgray # 5 [[[upper_bounds]]] # 6 -10 = magenta # 7 0 = violet # 8 10 = lavender 20 = mocassin 30 = yellow 40 = coral [[group_uv]] # 9 unit_system = metricwx default = darkviolet [[[upper_bounds]]] 2.4 = limegreen 5.4 = yellow 7.4 = orange 10.4 = red Here's what the various lines in the configuration stanza mean: All the configuration information needed by the SLE Colorize can be found in a stanza with the heading [Colorize] . Linking facility with a stanza of the same name is a very common pattern in WeeWX. We need a separate color table for each unit group that we are going to support. This is the start of the table for unit group group_temperature . We need to specify what unit system will be used by the temperature color table. In this example, we are using metricwx . In case we do not find a value in the table, we need a default. We will use the color tomato . In case the value is Python None , return the color given by option None . We will use lightgray . The sub-subsecction [[[upper_bounds]]] lists the upper (max) value of each of the color bands. The first color band (magenta) is used for temperatures less than or equal to -10\u00b0C. The second band (violet) is for temperatures greater than -10\u00b0C and less than or equal to 0\u00b0C. And so on. The next subsection, [[group_uv]] , is very similar to the one for group_temperature , except the values are for bands of the UV index. Although [Colorize] is in skin.conf , there is nothing special about it, and it can be overridden in weewx.conf , just like any other configuration information.","title":"A more sophisticated version"},{"location":"custom/sle/#annotated-code","text":"Here's the alternative version of colorize() , which will use the values in the configuration file. It can also be found in examples/colorize/colorize_3.py . import weewx.units from weewx.cheetahgenerator import SearchList class Colorize ( SearchList ): # 1 def __init__ ( self , generator ): # 2 SearchList . __init__ ( self , generator ) self . color_tables = self . generator . skin_dict . get ( 'Colorize' , {}) def colorize ( self , value_vh ): # Get the ValueTuple and unit group from the incoming ValueHelper value_vt = value_vh . value_t # 3 unit_group = value_vt . group # 4 # Make sure unit_group is in the color table, and that the table # specifies a unit system. if unit_group not in self . color_tables \\ or 'unit_system' not in self . color_tables [ unit_group ]: # 5 return \"#00000000\" # Convert the value to the same unit used by the color table: unit_system = self . color_tables [ unit_group ][ 'unit_system' ] # 6 converted_vt = weewx . units . convertStdName ( value_vt , unit_system ) # 7 # Check for a value of None if converted_vt . value is None : # 8 return self . color_tables [ unit_group ] . get ( 'none' ) \\ or self . color_tables [ unit_group ] . get ( 'None' , \"#00000000\" ) # Search for the value in the color table: for upper_bound in self . color_tables [ unit_group ][ 'upper_bounds' ]: # 9 if converted_vt . value <= float ( upper_bound ): # 10 return self . color_tables [ unit_group ][ 'upper_bounds' ][ upper_bound ] return self . color_tables [ unit_group ] . get ( 'default' , \"#00000000\" ) # 11 As before, our class must inherit from SearchList . In this version, we supply an initializer because we are going to do some work in it: extract our color table out of the skin configuration dictionary. In case the user neglects to include a [Colorize] section, we substitute an empty dictionary. As before, we extract the ValueTuple part out of the incoming ValueHelper using the attribute value_t . Retrieve the unit group used by the incoming argument. This will be something like \"group_temperature\". What if the user is requesting a color for a unit group that we don't know anything about? We must check that the unit group is in our color table. We must also check that a unit system has been supplied for the color table. If either of these checks fail, then return the color #00000000 , which will have no effect in setting a background color. Thanks to the checks we did in step 5, we know that this line will not raise a KeyError exception. Get the unit system used by the color table for this unit group. It will be something like 'US', 'metric', or 'metricwx'. Convert the incoming value, so it uses the same units as the color table. We must always be vigilant for values of Python None! The expression self . color_tables [ unit_group ] . get ( 'none' ) or self . color_tables [ unit_group ] . get ( 'None' , \"#00000000\" ) is just a trick to allow us to accept either \" none \" or \" None \" in the configuration file. If neither is present, then we return the color #00000000 , which will have no effect. Now start searching the color table to find a band that is less than or equal to the value we have in hand. Two details to note. First, the variable converted_vt is a ValueTuple . We need the raw value in order to do the comparison. We get this through attribute .value . Second, WeeWX uses the utility ConfigObj to read configuration files. When ConfigObj returns its results, the values will be strings . We must convert these to floats before doing the comparison. You must be constantly vigilant about this when working with configuration information. If we find a band with an upper bound greater than our value, we have a hit. Return the corresponding color. If we make it all the way through the table without a hit, then we must have a value greater than anything in the table. Return the default, or the color #00000000 if there is no default.","title":"Annotated code"},{"location":"custom/units/","text":"Customizing units and unit groups \u00b6 Warning This is an area that is changing rapidly in WeeWX. Presently, new units and unit groups are added by manipulating the internal dictionaries in WeeWX (as described below). In the future, they may be specified in weewx.conf . Assigning a unit group \u00b6 In the examples above, we created a new observation type, electricity , and added it to the database schema. Now we would like to recognize that it is a member of the unit group group_energy (which already exists), so it can enjoy the labels and formats already provided for this group. This is done by extending the dictionary weewx.units.obs_group_dict . Add the following to our new services file user/electricity.py , just after the last import statement: import weewx from weewx.engine import StdService import weewx.units weewx . units . obs_group_dict [ 'electricity' ] = 'group_energy' class AddElectricity ( StdService ): # [...] When our new service gets loaded by the WeeWX engine, these few lines will get run. They tell WeeWX that our new observation type, electricity , is part of the unit group group_energy . Once the observation has been associated with a unit group, the unit labels and other tag syntax will work for that observation. So, now a tag like: $month.electricity.sum will return the total amount of electricity consumed for the month, in Watt-hours. Creating a new unit group \u00b6 That was an easy one, because there was already an existing group, group_energy , that covered our new observation type. But, what if we are measuring something entirely new, like force with time? There is nothing in the existing system of units that covers things like newtons or pounds. We will have to define these new units, as well as the unit group they can belong to. We assume we have a new observation type, rocketForce , which we are measuring over time, for a service named Rocket , located in user/rocket.py . We will create a new unit group, group_force , and new units, newton and pound . Our new observation, rocketForce , will belong to group_force , and will be measured in units of newton or pound . To make this work, we need to add the following to user/rocket.py . As before, we start by specifying what group our new observation type belongs to: import weewx.units weewx . units . obs_group_dict [ 'rocketForce' ] = 'group_force' Next, we specify what unit is used to measure force in the three standard unit systems used by weewx. weewx . units . USUnits [ 'group_force' ] = 'pound' weewx . units . MetricUnits [ 'group_force' ] = 'newton' weewx . units . MetricWXUnits [ 'group_force' ] = 'newton' Then we specify what formats and labels to use for newton and pound : weewx . units . default_unit_format_dict [ 'newton' ] = ' %.1f ' weewx . units . default_unit_format_dict [ 'pound' ] = ' %.1f ' weewx . units . default_unit_label_dict [ 'newton' ] = ' newton' weewx . units . default_unit_label_dict [ 'pound' ] = ' pound' Finally, we specify how to convert between them: weewx . units . conversionDict [ 'newton' ] = { 'pound' : lambda x : x * 0.224809 } weewx . units . conversionDict [ 'pound' ] = { 'newton' : lambda x : x * 4.44822 } Now, when the service Rocket gets loaded, these lines of code will get executed, adding the necessary unit extensions to WeeWX. Using the new units \u00b6 Now you've added a new type of units. How do you use it? Pretty much like any other units. For example, to do a plot of the month's electric consumption, totaled by day, add this section to the [[month_images]] section of skin.conf : [[[monthelectric]]] [[[[electricity]]]] aggregate_type = sum aggregate_interval = 1d label = Electric consumption (daily total) This will cause the generation of an image monthelectric.png , showing a plot of each day's consumption for the past month. If you wish to use the new type in the templates, it will be available using the same syntax as any other type. Here are some other tags that might be useful: Tag Meaning $day.electricity.sum Total consumption since midnight $year.electricity.sum Total consumption since the first of the year $year.electricity.max The most consumed during any archive period $year.electricity.maxsum The most consumed during a day $year.electricity.maxsumtime The day it happened. $year.electricity.sum_ge((5000.0, 'kWh', 'group_energy')) The number of days of the year where more than 5.0 kWh of energy was consumed. The argument is a ValueTuple .","title":"Customizing units"},{"location":"custom/units/#customizing-units-and-unit-groups","text":"Warning This is an area that is changing rapidly in WeeWX. Presently, new units and unit groups are added by manipulating the internal dictionaries in WeeWX (as described below). In the future, they may be specified in weewx.conf .","title":"Customizing units and unit groups"},{"location":"custom/units/#assigning-a-unit-group","text":"In the examples above, we created a new observation type, electricity , and added it to the database schema. Now we would like to recognize that it is a member of the unit group group_energy (which already exists), so it can enjoy the labels and formats already provided for this group. This is done by extending the dictionary weewx.units.obs_group_dict . Add the following to our new services file user/electricity.py , just after the last import statement: import weewx from weewx.engine import StdService import weewx.units weewx . units . obs_group_dict [ 'electricity' ] = 'group_energy' class AddElectricity ( StdService ): # [...] When our new service gets loaded by the WeeWX engine, these few lines will get run. They tell WeeWX that our new observation type, electricity , is part of the unit group group_energy . Once the observation has been associated with a unit group, the unit labels and other tag syntax will work for that observation. So, now a tag like: $month.electricity.sum will return the total amount of electricity consumed for the month, in Watt-hours.","title":"Assigning a unit group"},{"location":"custom/units/#creating-a-new-unit-group","text":"That was an easy one, because there was already an existing group, group_energy , that covered our new observation type. But, what if we are measuring something entirely new, like force with time? There is nothing in the existing system of units that covers things like newtons or pounds. We will have to define these new units, as well as the unit group they can belong to. We assume we have a new observation type, rocketForce , which we are measuring over time, for a service named Rocket , located in user/rocket.py . We will create a new unit group, group_force , and new units, newton and pound . Our new observation, rocketForce , will belong to group_force , and will be measured in units of newton or pound . To make this work, we need to add the following to user/rocket.py . As before, we start by specifying what group our new observation type belongs to: import weewx.units weewx . units . obs_group_dict [ 'rocketForce' ] = 'group_force' Next, we specify what unit is used to measure force in the three standard unit systems used by weewx. weewx . units . USUnits [ 'group_force' ] = 'pound' weewx . units . MetricUnits [ 'group_force' ] = 'newton' weewx . units . MetricWXUnits [ 'group_force' ] = 'newton' Then we specify what formats and labels to use for newton and pound : weewx . units . default_unit_format_dict [ 'newton' ] = ' %.1f ' weewx . units . default_unit_format_dict [ 'pound' ] = ' %.1f ' weewx . units . default_unit_label_dict [ 'newton' ] = ' newton' weewx . units . default_unit_label_dict [ 'pound' ] = ' pound' Finally, we specify how to convert between them: weewx . units . conversionDict [ 'newton' ] = { 'pound' : lambda x : x * 0.224809 } weewx . units . conversionDict [ 'pound' ] = { 'newton' : lambda x : x * 4.44822 } Now, when the service Rocket gets loaded, these lines of code will get executed, adding the necessary unit extensions to WeeWX.","title":"Creating a new unit group"},{"location":"custom/units/#using-the-new-units","text":"Now you've added a new type of units. How do you use it? Pretty much like any other units. For example, to do a plot of the month's electric consumption, totaled by day, add this section to the [[month_images]] section of skin.conf : [[[monthelectric]]] [[[[electricity]]]] aggregate_type = sum aggregate_interval = 1d label = Electric consumption (daily total) This will cause the generation of an image monthelectric.png , showing a plot of each day's consumption for the past month. If you wish to use the new type in the templates, it will be available using the same syntax as any other type. Here are some other tags that might be useful: Tag Meaning $day.electricity.sum Total consumption since midnight $year.electricity.sum Total consumption since the first of the year $year.electricity.max The most consumed during any archive period $year.electricity.maxsum The most consumed during a day $year.electricity.maxsumtime The day it happened. $year.electricity.sum_ge((5000.0, 'kWh', 'group_energy')) The number of days of the year where more than 5.0 kWh of energy was consumed. The argument is a ValueTuple .","title":"Using the new units"},{"location":"hardware/acurite/","text":"AcuRite \u00b6 According to Acurite, the wind speed updates every 18 seconds. The wind direction updates every 30 seconds. Other sensors update every 60 seconds. In fact, because of the message structure and the data logging design, these are the actual update frequencies: AcuRite transmission periods sensor period Wind speed 18 seconds Outdoor temperature, outdoor humidity 36 seconds Wind direction, rain total 36 seconds Indoor temperature, pressure 60 seconds Indoor humidity 12 minutes (only when in USB mode 3) The station emits partial packets, which may confuse some online services. The AcuRite stations do not record wind gusts. Some consoles have a small internal logger. Data in the logger are erased when power is removed from the station. The console has a sensor for inside humidity, but the values from that sensor are available only by reading from the console logger. Due to instability of the console firmware, the WeeWX driver does not read the console logger. USB Mode \u00b6 Some AcuRite consoles have a setting called \"USB Mode\" that controls how data are saved and communicated: AcuRite USB mode Mode Show data in display Store data in logger Send data over USB 1 yes yes 2 yes 3 yes yes yes 4 yes yes If the AcuRite console has multiple USB modes, it must be set to USB mode 3 or 4 in order to work with the WeeWX driver. Communication via USB is disabled in modes 1 and 2. Mode 4 is more reliable than mode 3; mode 3 enables logging of data, mode 4 does not. When the console is logging it frequently causes USB communication problems. The default mode is 2, so after a power failure one must use the console controls to change the mode before WeeWX can resume data collection. The 01025, 01035, 01036, 01525, and 02032 consoles have a USB mode setting. The 02064 and 01536 consoles do not have a mode setting; these consoles are always in USB mode 4. Configuring with weectl device \u00b6 The weectl device utility cannot be used to configure AcuRite stations. Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. AcuRite station data Database Field Observation Loop Archive barometer S pressure pressure H altimeter S inTemp temperature_in H outTemp temperature_out H inHumidity humidity_in outHumidity humidity_out H windSpeed wind_speed H windDir wind_dir H rain rain D rain_total H rainRate S dewpoint S windchill S heatindex S rxCheckPercent rssi H outTempBatteryStatus battery H Each packet contains a subset of all possible readings. For example, one type of packet contains windSpeed , windDir and rain . A different type of packet contains windSpeed , outTemp and outHumidity . H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"AcuRite"},{"location":"hardware/acurite/#acurite_notes","text":"According to Acurite, the wind speed updates every 18 seconds. The wind direction updates every 30 seconds. Other sensors update every 60 seconds. In fact, because of the message structure and the data logging design, these are the actual update frequencies: AcuRite transmission periods sensor period Wind speed 18 seconds Outdoor temperature, outdoor humidity 36 seconds Wind direction, rain total 36 seconds Indoor temperature, pressure 60 seconds Indoor humidity 12 minutes (only when in USB mode 3) The station emits partial packets, which may confuse some online services. The AcuRite stations do not record wind gusts. Some consoles have a small internal logger. Data in the logger are erased when power is removed from the station. The console has a sensor for inside humidity, but the values from that sensor are available only by reading from the console logger. Due to instability of the console firmware, the WeeWX driver does not read the console logger.","title":"AcuRite"},{"location":"hardware/acurite/#acurite_usb_mode","text":"Some AcuRite consoles have a setting called \"USB Mode\" that controls how data are saved and communicated: AcuRite USB mode Mode Show data in display Store data in logger Send data over USB 1 yes yes 2 yes 3 yes yes yes 4 yes yes If the AcuRite console has multiple USB modes, it must be set to USB mode 3 or 4 in order to work with the WeeWX driver. Communication via USB is disabled in modes 1 and 2. Mode 4 is more reliable than mode 3; mode 3 enables logging of data, mode 4 does not. When the console is logging it frequently causes USB communication problems. The default mode is 2, so after a power failure one must use the console controls to change the mode before WeeWX can resume data collection. The 01025, 01035, 01036, 01525, and 02032 consoles have a USB mode setting. The 02064 and 01536 consoles do not have a mode setting; these consoles are always in USB mode 4.","title":"USB Mode"},{"location":"hardware/acurite/#acurite_configuration","text":"The weectl device utility cannot be used to configure AcuRite stations.","title":"Configuring with weectl device"},{"location":"hardware/acurite/#acurite_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. AcuRite station data Database Field Observation Loop Archive barometer S pressure pressure H altimeter S inTemp temperature_in H outTemp temperature_out H inHumidity humidity_in outHumidity humidity_out H windSpeed wind_speed H windDir wind_dir H rain rain D rain_total H rainRate S dewpoint S windchill S heatindex S rxCheckPercent rssi H outTempBatteryStatus battery H Each packet contains a subset of all possible readings. For example, one type of packet contains windSpeed , windDir and rain . A different type of packet contains windSpeed , outTemp and outHumidity . H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"hardware/cc3000/","text":"RainWise CC3000 \u00b6 The CC3000 data logger stores 2MB of records. When the logger fills up, it stops recording. When WeeWX starts up it will attempt to download all records from the logger since the last record in the archive database. The driver does not support hardware record generation. The CC3000 data logger may be configured to return data in METRIC or ENGLISH units. These are then mapped to the WeeWX unit groups METRICWX or US , respectively. Configuring with weectl device \u00b6 The CC3000 can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device . --help \u00b6 Invoking weectl device with the --help option will produce something like this: weectl device --help Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) Usage: weectl device [config_file] [options] [-y] [--debug] [--help] Configuration utility for weewx devices. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --info display weather station configuration --current display current weather readings --history=N display N records (0 for all records) --history-since=N display records since N minutes ago --clear-memory clear station memory --get-header display data header --get-rain get the rain counter --reset-rain reset the rain counter --get-max get the max values observed --reset-max reset the max counters --get-min get the min values observed --reset-min reset the min counters --get-clock display station clock --set-clock set station clock to computer time --get-interval display logger archive interval, in seconds --set-interval=N set logging interval to N seconds --get-units show units of logger --set-units=UNITS set units to METRIC or ENGLISH --get-dst display daylight savings settings --set-dst=mm/dd HH:MM,mm/dd HH:MM,[MM]M set daylight savings start, end, and amount --get-channel display the station channel --set-channel=CHANNEL set the station channel --info \u00b6 Display the station settings with --info weectl device --info This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) Firmware: Rainwise CC-3000 Version: 1.3 Build 022 Dec 02 2016 Time: 2020/01/04 15:38:14 DST: 03/08 02:00,11/01 02:00,060 Units: ENGLISH Memory: 252242 bytes, 4349 records, 12% Interval: 300 Channel: 0 Charger: CHARGER=OFF,BATTERIES=5.26V Baro: 30.37 Rain: 3.31 HEADER: ['HDR', '\"TIMESTAMP\"', '\"TEMP OUT\"', '\"HUMIDITY\"', '\"PRESSURE\"', '\"WIND DIRECTION\"', '\"WIND SPEED\"',~ MAX: ['MAX', '11:59 61.1', '02:47 99', '09:51 30.42', '13:32 337', '13:32 13.3', '00:00 0.00', '09:20 ~ MIN: ['MIN', '02:19 40.6', '14:42 66', '00:34 30.24', '00:00 67', '00:00 0.0', '00:00 0.00', '06:48 ~ --current \u00b6 Returns the current values in a comma-delimited format. The order of the data values corresponds to the output of the --get-header command. NO DATA is returned if the unit has not received a transmission from the weather station. weectl device --current This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) {'dateTime': 1578175453.0, 'outTemp': 58.6, 'outHumidity': 71.0, 'pressure': 30.36, 'windDir': 315.0, ~ --history=N \u00b6 Display the latest N records from the CC3000 logger memory. Use a value of 0 to display all records. Note: because there may be other records mixed in with the archive records, this command will display an extra seven records per day (or partial day). weectl device --history=2 This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) ['REC', '2020/01/04 13:25', ' 58.9', ' 71', '30.36', '344', ' 4.9', ' 10.7', ' 0.00', ' 7.44', ' 5.26', ~ ['REC', '2020/01/04 13:30', ' 59.0', ' 71', '30.36', '327', ' 3.6', ' 10.0', ' 0.00', ' 7.32', ' 5.26', ~ ['REC', '2020/01/04 13:35', ' 59.1', ' 70', '30.36', '305', ' 5.5', ' 13.3', ' 0.00', ' 7.44', ' 5.26', ~ ['REC', '2020/01/04 13:40', ' 59.1', ' 70', '30.36', '330', ' 3.4', ' 8.9', ' 0.00', ' 7.08', ' 5.26', ~ ['REC', '2020/01/04 13:45', ' 58.9', ' 70', '30.36', '318', ' 2.6', ' 7.2', ' 0.00', ' 7.17', ' 5.26', ~ ['REC', '2020/01/04 13:50', ' 58.8', ' 71', '30.36', '312', ' 3.6', ' 7.9', ' 0.00', ' 7.14', ' 5.26', ~ ['REC', '2020/01/04 13:55', ' 58.9', ' 71', '30.36', '330', ' 4.5', ' 10.0', ' 0.00', ' 7.20', ' 5.26', ~ ['REC', '2020/01/04 14:00', ' 58.8', ' 71', '30.36', '331', ' 4.6', ' 9.6', ' 0.00', ' 7.38', ' 5.26', ~ ['REC', '2020/01/04 14:05', ' 58.6', ' 71', '30.36', '331', ' 4.0', ' 9.3', ' 0.00', ' 7.29', ' 5.26', ~ --history-since=N \u00b6 Display all CC3000 logger memory records created in the last N minutes. weectl device --history-since=10 This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) {'dateTime': 1578175800.0, 'outTemp': 58.6, 'outHumidity': 70.0, 'pressure': 30.36, 'windDir': 316.0, ~ {'dateTime': 1578176100.0, 'outTemp': 58.7, 'outHumidity': 70.0, 'pressure': 30.36, 'windDir': 317.0, ~ --clear-memory \u00b6 Use --clear-memory` to erase all records from the logger memory. weectl device --clear-memory --get-header \u00b6 Returns a series of comma delimited text descriptions. These descriptions are used to identify the type and order of the returned data in both --get-current</code>, --download=N and `--download-since=N commands. weectl device --get-header This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) ['HDR', '\"TIMESTAMP\"', '\"TEMP OUT\"', '\"HUMIDITY\"', '\"PRESSURE\"', '\"WIND DIRECTION\"', '\"WIND SPEED\"', ~ --get-rain \u00b6 Display the rain counter. The CC-3000 maintains a rainfall counter that is only reset by a reboot or by issuing the reset command. The counter counts in 0.01 inch increments and rolls over at 65536 counts. Issuing the rainfall reset command will clear all rainfall counters including the current daily rainfall. weectl device --get-rain This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) 3.31 --reset-rain \u00b6 Reset the rain counter to zero. weectl device --reset-rain --get-max \u00b6 Get the maximum values observed since the last time. Output parameter order: Outside temperature, humidity, pressure, wind direction, wind speed, rainfall (daily total), station voltage, inside temperature. If any optional sensors have been enabled they will also be displayed. weectl device --get-max This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) ['MAX', '11:59 61.1', '02:47 99', '09:51 30.42', '13:32 337', '13:32 13.3', '00:00 0.00', '09:20 ~ --reset-max \u00b6 Reset the maximum values. weectl device --reset-max --get-min \u00b6 Get the minimum values observed since the last time. Output parameter order: Outside temperature, humidity, pressure, wind direction, wind speed, rainfall (ignore), station voltage, inside temperature. If any optional sensors have been enabled they will also be displayed. weectl device --get-min This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) ['MIN', '02:19 40.6', '14:42 66', '00:34 30.24', '00:00 67', '00:00 0.0', '00:00 0.00', '06:48 ~ --reset-min \u00b6 Reset the minimum values. weectl device --reset-min --get-clock \u00b6 Get the time. weectl device --get-clock This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) 2020/01/04 15:01:34 --set-clock \u00b6 Set the station clock to match the date/time of the computer. weectl device --set-clock --get-interval \u00b6 Returns the current logging interval (in seconds). weectl device --get-interval This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) 300 --set-interval=N \u00b6 Set the archive interval. CC3000 loggers ship from the factory with an archive interval of 1 minutes (60 seconds). To change the station's interval to 300 seconds (5 minutes), do the following: weectl device --set-interval=5 --get-units \u00b6 Returns the current measurement units. weectl device --get-units This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) ENGLISH --set-units \u00b6 The CC3000 can display data in either ENGLISH or METRIC unit systems. Use --set-units to specify one or the other. The CC3000 driver automatically converts the units to maintain consistency with the units in WeeWX. weectl device --set-units=ENGLISH --get-dst \u00b6 Return the dates and times when the clock will change due to daylight saving and the number of minutes that the clock will change. This will result in something like: Using CC3000 driver version 0.30 (weewx.drivers.cc3000) 03/08 02:00,11/01 02:00,060 --set-dst=N \u00b6 Set the station start, end, and amount of daylight savings. The schedule can be set by adding the three parameters, forward date and time, back date and time and number of minutes to change (120 max). weectl device --set-dst=\"03/08 02:00,11/01 02:00,060\" Daylight saving can be disabled by setting the daylight-saving to zero. weectl device --set-dst=0 --get-channel \u00b6 Displays the station channel (0-3). This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) 0 --set-channel=N \u00b6 Rainwise stations transmit on one of four channels. If you have multiple instrument clusters within a kilometer or so of each other, you should configure each to use a different channel. In the instrument cluster, remove the cover and set the DIP switches 0 and 1. Use --set-channel to a value of 0-3 to match that of the instrument cluster. weectl device --set-channel=0 Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. CC3000 station data Database Field Observation Loop Archive barometer S S pressure PRESSURE H H altimeter S S inTemp TEMP IN H H outTemp TEMP OUT H H outHumidity HUMIDITY H H windSpeed WIND SPEED H H windDir WIND DIRECTION H H windGust WIND GUST H H rain rain_delta D D RAIN H H rainRate S S dewpoint S S windchill S S heatindex S S radiation 1 SOLAR RADIATION H H UV 1 UV INDEX H H supplyVoltage STATION BATTERY H consBatteryVoltage BATTERY BACKUP H extraTemp1 2 TEMP 1 H H extraTemp2 2 TEMP 2 H H 1 The radiation and UV data are available only with the optional solar radiation sensor. 2 The extraTemp1 and extraTemp2 data are available only with the optional additional temperature sensors. H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"CC3000"},{"location":"hardware/cc3000/#cc3000_notes","text":"The CC3000 data logger stores 2MB of records. When the logger fills up, it stops recording. When WeeWX starts up it will attempt to download all records from the logger since the last record in the archive database. The driver does not support hardware record generation. The CC3000 data logger may be configured to return data in METRIC or ENGLISH units. These are then mapped to the WeeWX unit groups METRICWX or US , respectively.","title":"RainWise CC3000"},{"location":"hardware/cc3000/#cc3000_configuration","text":"The CC3000 can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device .","title":"Configuring with weectl device"},{"location":"hardware/cc3000/#cc3000_help","text":"Invoking weectl device with the --help option will produce something like this: weectl device --help Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) Usage: weectl device [config_file] [options] [-y] [--debug] [--help] Configuration utility for weewx devices. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --info display weather station configuration --current display current weather readings --history=N display N records (0 for all records) --history-since=N display records since N minutes ago --clear-memory clear station memory --get-header display data header --get-rain get the rain counter --reset-rain reset the rain counter --get-max get the max values observed --reset-max reset the max counters --get-min get the min values observed --reset-min reset the min counters --get-clock display station clock --set-clock set station clock to computer time --get-interval display logger archive interval, in seconds --set-interval=N set logging interval to N seconds --get-units show units of logger --set-units=UNITS set units to METRIC or ENGLISH --get-dst display daylight savings settings --set-dst=mm/dd HH:MM,mm/dd HH:MM,[MM]M set daylight savings start, end, and amount --get-channel display the station channel --set-channel=CHANNEL set the station channel","title":"--help"},{"location":"hardware/cc3000/#cc3000_info","text":"Display the station settings with --info weectl device --info This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) Firmware: Rainwise CC-3000 Version: 1.3 Build 022 Dec 02 2016 Time: 2020/01/04 15:38:14 DST: 03/08 02:00,11/01 02:00,060 Units: ENGLISH Memory: 252242 bytes, 4349 records, 12% Interval: 300 Channel: 0 Charger: CHARGER=OFF,BATTERIES=5.26V Baro: 30.37 Rain: 3.31 HEADER: ['HDR', '\"TIMESTAMP\"', '\"TEMP OUT\"', '\"HUMIDITY\"', '\"PRESSURE\"', '\"WIND DIRECTION\"', '\"WIND SPEED\"',~ MAX: ['MAX', '11:59 61.1', '02:47 99', '09:51 30.42', '13:32 337', '13:32 13.3', '00:00 0.00', '09:20 ~ MIN: ['MIN', '02:19 40.6', '14:42 66', '00:34 30.24', '00:00 67', '00:00 0.0', '00:00 0.00', '06:48 ~","title":"--info"},{"location":"hardware/cc3000/#cc3000_current","text":"Returns the current values in a comma-delimited format. The order of the data values corresponds to the output of the --get-header command. NO DATA is returned if the unit has not received a transmission from the weather station. weectl device --current This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) {'dateTime': 1578175453.0, 'outTemp': 58.6, 'outHumidity': 71.0, 'pressure': 30.36, 'windDir': 315.0, ~","title":"--current"},{"location":"hardware/cc3000/#cc3000_history","text":"Display the latest N records from the CC3000 logger memory. Use a value of 0 to display all records. Note: because there may be other records mixed in with the archive records, this command will display an extra seven records per day (or partial day). weectl device --history=2 This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) ['REC', '2020/01/04 13:25', ' 58.9', ' 71', '30.36', '344', ' 4.9', ' 10.7', ' 0.00', ' 7.44', ' 5.26', ~ ['REC', '2020/01/04 13:30', ' 59.0', ' 71', '30.36', '327', ' 3.6', ' 10.0', ' 0.00', ' 7.32', ' 5.26', ~ ['REC', '2020/01/04 13:35', ' 59.1', ' 70', '30.36', '305', ' 5.5', ' 13.3', ' 0.00', ' 7.44', ' 5.26', ~ ['REC', '2020/01/04 13:40', ' 59.1', ' 70', '30.36', '330', ' 3.4', ' 8.9', ' 0.00', ' 7.08', ' 5.26', ~ ['REC', '2020/01/04 13:45', ' 58.9', ' 70', '30.36', '318', ' 2.6', ' 7.2', ' 0.00', ' 7.17', ' 5.26', ~ ['REC', '2020/01/04 13:50', ' 58.8', ' 71', '30.36', '312', ' 3.6', ' 7.9', ' 0.00', ' 7.14', ' 5.26', ~ ['REC', '2020/01/04 13:55', ' 58.9', ' 71', '30.36', '330', ' 4.5', ' 10.0', ' 0.00', ' 7.20', ' 5.26', ~ ['REC', '2020/01/04 14:00', ' 58.8', ' 71', '30.36', '331', ' 4.6', ' 9.6', ' 0.00', ' 7.38', ' 5.26', ~ ['REC', '2020/01/04 14:05', ' 58.6', ' 71', '30.36', '331', ' 4.0', ' 9.3', ' 0.00', ' 7.29', ' 5.26', ~","title":"--history=N"},{"location":"hardware/cc3000/#cc3000_history_since","text":"Display all CC3000 logger memory records created in the last N minutes. weectl device --history-since=10 This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) {'dateTime': 1578175800.0, 'outTemp': 58.6, 'outHumidity': 70.0, 'pressure': 30.36, 'windDir': 316.0, ~ {'dateTime': 1578176100.0, 'outTemp': 58.7, 'outHumidity': 70.0, 'pressure': 30.36, 'windDir': 317.0, ~","title":"--history-since=N"},{"location":"hardware/cc3000/#cc3000_clear_memory","text":"Use --clear-memory` to erase all records from the logger memory. weectl device --clear-memory","title":"--clear-memory"},{"location":"hardware/cc3000/#cc3000_get_header","text":"Returns a series of comma delimited text descriptions. These descriptions are used to identify the type and order of the returned data in both --get-current</code>, --download=N and `--download-since=N commands. weectl device --get-header This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) ['HDR', '\"TIMESTAMP\"', '\"TEMP OUT\"', '\"HUMIDITY\"', '\"PRESSURE\"', '\"WIND DIRECTION\"', '\"WIND SPEED\"', ~","title":"--get-header"},{"location":"hardware/cc3000/#cc3000_get_rain","text":"Display the rain counter. The CC-3000 maintains a rainfall counter that is only reset by a reboot or by issuing the reset command. The counter counts in 0.01 inch increments and rolls over at 65536 counts. Issuing the rainfall reset command will clear all rainfall counters including the current daily rainfall. weectl device --get-rain This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) 3.31","title":"--get-rain"},{"location":"hardware/cc3000/#cc3000_reset_rain","text":"Reset the rain counter to zero. weectl device --reset-rain","title":"--reset-rain"},{"location":"hardware/cc3000/#cc3000_get_max","text":"Get the maximum values observed since the last time. Output parameter order: Outside temperature, humidity, pressure, wind direction, wind speed, rainfall (daily total), station voltage, inside temperature. If any optional sensors have been enabled they will also be displayed. weectl device --get-max This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) ['MAX', '11:59 61.1', '02:47 99', '09:51 30.42', '13:32 337', '13:32 13.3', '00:00 0.00', '09:20 ~","title":"--get-max"},{"location":"hardware/cc3000/#cc3000_reset_max","text":"Reset the maximum values. weectl device --reset-max","title":"--reset-max"},{"location":"hardware/cc3000/#cc3000_get_min","text":"Get the minimum values observed since the last time. Output parameter order: Outside temperature, humidity, pressure, wind direction, wind speed, rainfall (ignore), station voltage, inside temperature. If any optional sensors have been enabled they will also be displayed. weectl device --get-min This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) ['MIN', '02:19 40.6', '14:42 66', '00:34 30.24', '00:00 67', '00:00 0.0', '00:00 0.00', '06:48 ~","title":"--get-min"},{"location":"hardware/cc3000/#cc3000_reset_min","text":"Reset the minimum values. weectl device --reset-min","title":"--reset-min"},{"location":"hardware/cc3000/#cc3000_get_clock","text":"Get the time. weectl device --get-clock This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) 2020/01/04 15:01:34","title":"--get-clock"},{"location":"hardware/cc3000/#cc3000_set_clock","text":"Set the station clock to match the date/time of the computer. weectl device --set-clock","title":"--set-clock"},{"location":"hardware/cc3000/#cc3000_get_interval","text":"Returns the current logging interval (in seconds). weectl device --get-interval This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) 300","title":"--get-interval"},{"location":"hardware/cc3000/#cc3000_set_interval","text":"Set the archive interval. CC3000 loggers ship from the factory with an archive interval of 1 minutes (60 seconds). To change the station's interval to 300 seconds (5 minutes), do the following: weectl device --set-interval=5","title":"--set-interval=N"},{"location":"hardware/cc3000/#cc3000_get_units","text":"Returns the current measurement units. weectl device --get-units This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) ENGLISH","title":"--get-units"},{"location":"hardware/cc3000/#cc3000_set_units","text":"The CC3000 can display data in either ENGLISH or METRIC unit systems. Use --set-units to specify one or the other. The CC3000 driver automatically converts the units to maintain consistency with the units in WeeWX. weectl device --set-units=ENGLISH","title":"--set-units"},{"location":"hardware/cc3000/#cc3000_get_dst","text":"Return the dates and times when the clock will change due to daylight saving and the number of minutes that the clock will change. This will result in something like: Using CC3000 driver version 0.30 (weewx.drivers.cc3000) 03/08 02:00,11/01 02:00,060","title":"--get-dst"},{"location":"hardware/cc3000/#cc3000_set_dst","text":"Set the station start, end, and amount of daylight savings. The schedule can be set by adding the three parameters, forward date and time, back date and time and number of minutes to change (120 max). weectl device --set-dst=\"03/08 02:00,11/01 02:00,060\" Daylight saving can be disabled by setting the daylight-saving to zero. weectl device --set-dst=0","title":"--set-dst=N"},{"location":"hardware/cc3000/#cc3000_get_channel","text":"Displays the station channel (0-3). This will result in something like: Using configuration file /home/weewx/weewx.conf Using CC3000 driver version 0.30 (weewx.drivers.cc3000) 0","title":"--get-channel"},{"location":"hardware/cc3000/#cc3000_set_channel","text":"Rainwise stations transmit on one of four channels. If you have multiple instrument clusters within a kilometer or so of each other, you should configure each to use a different channel. In the instrument cluster, remove the cover and set the DIP switches 0 and 1. Use --set-channel to a value of 0-3 to match that of the instrument cluster. weectl device --set-channel=0","title":"--set-channel=N"},{"location":"hardware/cc3000/#cc3000_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. CC3000 station data Database Field Observation Loop Archive barometer S S pressure PRESSURE H H altimeter S S inTemp TEMP IN H H outTemp TEMP OUT H H outHumidity HUMIDITY H H windSpeed WIND SPEED H H windDir WIND DIRECTION H H windGust WIND GUST H H rain rain_delta D D RAIN H H rainRate S S dewpoint S S windchill S S heatindex S S radiation 1 SOLAR RADIATION H H UV 1 UV INDEX H H supplyVoltage STATION BATTERY H consBatteryVoltage BATTERY BACKUP H extraTemp1 2 TEMP 1 H H extraTemp2 2 TEMP 2 H H 1 The radiation and UV data are available only with the optional solar radiation sensor. 2 The extraTemp1 and extraTemp2 data are available only with the optional additional temperature sensors. H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"hardware/drivers/","text":"Hardware guide \u00b6 Core hardware \u00b6 Drivers for these stations are included in the core WeeWX distribution. Each station type provides a different set of observations, at different sampling rates. These are enumerated in a Station data table in the page for each station. AcuRite TE923 WMR100 WS1 CC3000 Ultimeter WMR300 WS23xx FineOffset Vantage WMR9x8 WS28xx Driver status \u00b6 The following table enumerates many of the weather stations that are known to work with WeeWX. If your station is not in the table, check the pictures at the supported hardware page \u2014 it could be a variation of one of the supported models. You can also check the station comparison table \u2014 sometimes new models use the same communication protocols as older hardware. The maturity column indicates the degree of confidence in the driver. For stations marked Tested , the station is routinely tested as part of the release process and should work as documented. For stations not marked at all, they are \"known to work\" using the indicated driver, but are not routinely tested. For stations marked Experimental , we are still working on the driver. There can be problems. Weather hardware supported by WeeWX Vendor Model Hardware Interface Required Package Driver Maturity AcuRite 01025 USB pyusb AcuRite 12 01035 USB pyusb AcuRite 12 Tested 01036 USB pyusb AcuRite 12 01525 USB pyusb AcuRite 12 02032 USB pyusb AcuRite 12 02064 USB pyusb AcuRite 12 06037 USB pyusb AcuRite 12 06039 USB pyusb AcuRite 12 Argent Data Systems WS1 Serial pyusb WS1 9 Aercus WS2083 USB pyusb FineOffsetUSB 5 WS3083 USB pyusb FineOffsetUSB 5 Ambient Weather WS1090 USB pyusb FineOffsetUSB 5 Tested WS2080 USB pyusb FineOffsetUSB 5 Tested WS2080A USB pyusb FineOffsetUSB 5 Tested WS2090 USB pyusb FineOffsetUSB 5 WS2095 USB pyusb FineOffsetUSB 5 Cresta WRX815 USB pyusb TE923 8 PWS720 USB pyusb TE923 8 DAZA DZ-WH1080 USB pyusb FineOffsetUSB 5 DZ-WS3101 USB pyusb FineOffsetUSB 5 DZ-WS3104 USB pyusb FineOffsetUSB 5 Davis VantagePro2 Serial or USB pyserial Vantage 1 Tested VantagePro2 WeatherLink IP Vantage 1 Tested VantageVue Serial or USB pyserial Vantage 1 Tested Elecsa 6975 USB pyusb FineOffsetUSB 5 6976 USB pyusb FineOffsetUSB 5 Excelvan Excelvan USB pyusb FineOffsetUSB 5 Fine Offset WH1080 USB pyusb FineOffsetUSB 5 WH1081 USB pyusb FineOffsetUSB 5 WH1091 USB pyusb FineOffsetUSB 5 WH1090 USB pyusb FineOffsetUSB 5 WS1080 USB pyusb FineOffsetUSB 5 WA2080 USB pyusb FineOffsetUSB 5 WA2081 USB pyusb FineOffsetUSB 5 WH2080 USB pyusb FineOffsetUSB 5 WH2081 USB pyusb FineOffsetUSB 5 WH3080 USB pyusb FineOffsetUSB 5 WH3081 USB pyusb FineOffsetUSB 5 Froggit WS8700 USB pyusb TE923 8 WH1080 USB pyusb FineOffsetUSB 5 WH3080 USB pyusb FineOffsetUSB 5 General Tools WS831DL USB pyusb TE923 8 Hideki DV928 USB pyusb TE923 8 TE821 USB pyusb TE923 8 TE827 USB pyusb TE923 8 TE831 USB pyusb TE923 8 TE838 USB pyusb TE923 8 TE923 USB pyusb TE923 8 Huger WM918 Serial pyserial WMR9x8 4 IROX Pro X USB pyusb TE923 8 La Crosse C86234 USB pyusb WS28xx 7 Tested WS-1640 USB pyusb TE923 8 WS-23XX Serial fcntl/select WS23xx 6 Tested WS-28XX USB pyusb WS28xx 7 Maplin N96GY USB pyusb FineOffsetUSB 5 N96FY USB pyusb FineOffsetUSB 5 Meade TE923W USB pyusb TE923 8 Tested TE923W-M USB pyusb TE923 8 TE924W USB pyusb TE923 8 Mebus TE923 USB pyusb TE923 8 National Geographic 265 USB pyusb FineOffsetUSB 5 Oregon Scientific WMR88 USB pyusb WMR100 2 WMR88A USB pyusb WMR100 2 WMR100 USB pyusb WMR100 2 WMR100N USB pyusb WMR100 2 Tested WMR180 USB pyusb WMR100 2 WMR180A USB pyusb WMR100 2 WMRS200 USB pyusb WMR100 2 WMR300 USB pyusb WMR300 3 Experimental WMR300A USB pyusb WMR300 3 Experimental WMR918 Serial pyserial WMR9x8 4 WMR928N Serial pyserial WMR9x8 4 Tested WMR968 Serial pyserial WMR9x8 4 Tested PeetBros Ultimeter 100 Serial pyserial Ultimeter 10 Ultimeter 800 Serial pyserial Ultimeter 10 Ultimeter 2000 Serial pyserial Ultimeter 10 Ultimeter 2100 Serial pyserial Ultimeter 10 RainWise Mark III Serial pyserial CC3000 11 CC3000 Serial pyserial CC3000 11 Tested Radio Shack 63-256 USB pyusb WMR100 2 63-1016 Serial pyserial WMR9x8 4 Sinometer WS1080 / WS1081 USB pyusb FineOffsetUSB 5 WS3100 / WS3101 USB pyusb FineOffsetUSB 5 TechnoLine WS-2300 Serial fcntl/select WS23xx 6 WS-2350 Serial fcntl/select WS23xx 6 TFA Matrix Serial fcntl/select WS23xx 6 Nexus USB pyusb TE923 8 Opus USB pyusb WS28xx 7 Primus USB pyusb WS28xx 7 Sinus USB pyusb TE923 8 Tycon TP1080WC USB pyusb FineOffsetUSB 5 Watson W-8681 USB pyusb FineOffsetUSB 5 WX-2008 USB pyusb FineOffsetUSB 5 Velleman WS3080 USB pyusb FineOffsetUSB 5 Ventus W831 USB pyusb TE923 8 W928 USB pyusb TE923 8 Davis \"Vantage\" series of weather stations, including the VantagePro2 \u2122 and VantageVue \u2122, using serial, USB, or WeatherLinkIP\u2122 connections. Both the \"Rev A\" (firmware dated before 22 April 2002) and \"Rev B\" versions are supported. Oregon Scientific WMR-100 stations. Tested on the Oregon Scientific WMR100N . Oregon Scientific WMR-300 stations. Tested on the Oregon Scientific WMR300A . Oregon Scientific WMR-9x8 stations. Tested on the Oregon Scientific WMR968 . Fine Offset 10xx, 20xx, and 30xx stations. Tested on the Ambient Weather WS2080. La Crosse WS-23xx stations. Tested on the La Crosse 2317 . La Crosse WS-28xx stations. Tested on the La Crosse C86234 . Hideki Professional Weather Stations. Tested on the Meade TE923. ADS WS1 Stations. Tested on the WS1 . PeetBros Ultimeter Stations. Tested on the Ultimeter 2000 . RainWise Mark III Stations. Tested on the CC3000 (firmware \"Rainwise CC-3000 Version: 1.3 Build 022 Dec 02 2016\"). AcuRite Weather Stations. Tested on the 01036RX.","title":"Drivers"},{"location":"hardware/drivers/#hardware-guide","text":"","title":"Hardware guide"},{"location":"hardware/drivers/#core-hardware","text":"Drivers for these stations are included in the core WeeWX distribution. Each station type provides a different set of observations, at different sampling rates. These are enumerated in a Station data table in the page for each station. AcuRite TE923 WMR100 WS1 CC3000 Ultimeter WMR300 WS23xx FineOffset Vantage WMR9x8 WS28xx","title":"Core hardware"},{"location":"hardware/drivers/#driver-status","text":"The following table enumerates many of the weather stations that are known to work with WeeWX. If your station is not in the table, check the pictures at the supported hardware page \u2014 it could be a variation of one of the supported models. You can also check the station comparison table \u2014 sometimes new models use the same communication protocols as older hardware. The maturity column indicates the degree of confidence in the driver. For stations marked Tested , the station is routinely tested as part of the release process and should work as documented. For stations not marked at all, they are \"known to work\" using the indicated driver, but are not routinely tested. For stations marked Experimental , we are still working on the driver. There can be problems. Weather hardware supported by WeeWX Vendor Model Hardware Interface Required Package Driver Maturity AcuRite 01025 USB pyusb AcuRite 12 01035 USB pyusb AcuRite 12 Tested 01036 USB pyusb AcuRite 12 01525 USB pyusb AcuRite 12 02032 USB pyusb AcuRite 12 02064 USB pyusb AcuRite 12 06037 USB pyusb AcuRite 12 06039 USB pyusb AcuRite 12 Argent Data Systems WS1 Serial pyusb WS1 9 Aercus WS2083 USB pyusb FineOffsetUSB 5 WS3083 USB pyusb FineOffsetUSB 5 Ambient Weather WS1090 USB pyusb FineOffsetUSB 5 Tested WS2080 USB pyusb FineOffsetUSB 5 Tested WS2080A USB pyusb FineOffsetUSB 5 Tested WS2090 USB pyusb FineOffsetUSB 5 WS2095 USB pyusb FineOffsetUSB 5 Cresta WRX815 USB pyusb TE923 8 PWS720 USB pyusb TE923 8 DAZA DZ-WH1080 USB pyusb FineOffsetUSB 5 DZ-WS3101 USB pyusb FineOffsetUSB 5 DZ-WS3104 USB pyusb FineOffsetUSB 5 Davis VantagePro2 Serial or USB pyserial Vantage 1 Tested VantagePro2 WeatherLink IP Vantage 1 Tested VantageVue Serial or USB pyserial Vantage 1 Tested Elecsa 6975 USB pyusb FineOffsetUSB 5 6976 USB pyusb FineOffsetUSB 5 Excelvan Excelvan USB pyusb FineOffsetUSB 5 Fine Offset WH1080 USB pyusb FineOffsetUSB 5 WH1081 USB pyusb FineOffsetUSB 5 WH1091 USB pyusb FineOffsetUSB 5 WH1090 USB pyusb FineOffsetUSB 5 WS1080 USB pyusb FineOffsetUSB 5 WA2080 USB pyusb FineOffsetUSB 5 WA2081 USB pyusb FineOffsetUSB 5 WH2080 USB pyusb FineOffsetUSB 5 WH2081 USB pyusb FineOffsetUSB 5 WH3080 USB pyusb FineOffsetUSB 5 WH3081 USB pyusb FineOffsetUSB 5 Froggit WS8700 USB pyusb TE923 8 WH1080 USB pyusb FineOffsetUSB 5 WH3080 USB pyusb FineOffsetUSB 5 General Tools WS831DL USB pyusb TE923 8 Hideki DV928 USB pyusb TE923 8 TE821 USB pyusb TE923 8 TE827 USB pyusb TE923 8 TE831 USB pyusb TE923 8 TE838 USB pyusb TE923 8 TE923 USB pyusb TE923 8 Huger WM918 Serial pyserial WMR9x8 4 IROX Pro X USB pyusb TE923 8 La Crosse C86234 USB pyusb WS28xx 7 Tested WS-1640 USB pyusb TE923 8 WS-23XX Serial fcntl/select WS23xx 6 Tested WS-28XX USB pyusb WS28xx 7 Maplin N96GY USB pyusb FineOffsetUSB 5 N96FY USB pyusb FineOffsetUSB 5 Meade TE923W USB pyusb TE923 8 Tested TE923W-M USB pyusb TE923 8 TE924W USB pyusb TE923 8 Mebus TE923 USB pyusb TE923 8 National Geographic 265 USB pyusb FineOffsetUSB 5 Oregon Scientific WMR88 USB pyusb WMR100 2 WMR88A USB pyusb WMR100 2 WMR100 USB pyusb WMR100 2 WMR100N USB pyusb WMR100 2 Tested WMR180 USB pyusb WMR100 2 WMR180A USB pyusb WMR100 2 WMRS200 USB pyusb WMR100 2 WMR300 USB pyusb WMR300 3 Experimental WMR300A USB pyusb WMR300 3 Experimental WMR918 Serial pyserial WMR9x8 4 WMR928N Serial pyserial WMR9x8 4 Tested WMR968 Serial pyserial WMR9x8 4 Tested PeetBros Ultimeter 100 Serial pyserial Ultimeter 10 Ultimeter 800 Serial pyserial Ultimeter 10 Ultimeter 2000 Serial pyserial Ultimeter 10 Ultimeter 2100 Serial pyserial Ultimeter 10 RainWise Mark III Serial pyserial CC3000 11 CC3000 Serial pyserial CC3000 11 Tested Radio Shack 63-256 USB pyusb WMR100 2 63-1016 Serial pyserial WMR9x8 4 Sinometer WS1080 / WS1081 USB pyusb FineOffsetUSB 5 WS3100 / WS3101 USB pyusb FineOffsetUSB 5 TechnoLine WS-2300 Serial fcntl/select WS23xx 6 WS-2350 Serial fcntl/select WS23xx 6 TFA Matrix Serial fcntl/select WS23xx 6 Nexus USB pyusb TE923 8 Opus USB pyusb WS28xx 7 Primus USB pyusb WS28xx 7 Sinus USB pyusb TE923 8 Tycon TP1080WC USB pyusb FineOffsetUSB 5 Watson W-8681 USB pyusb FineOffsetUSB 5 WX-2008 USB pyusb FineOffsetUSB 5 Velleman WS3080 USB pyusb FineOffsetUSB 5 Ventus W831 USB pyusb TE923 8 W928 USB pyusb TE923 8 Davis \"Vantage\" series of weather stations, including the VantagePro2 \u2122 and VantageVue \u2122, using serial, USB, or WeatherLinkIP\u2122 connections. Both the \"Rev A\" (firmware dated before 22 April 2002) and \"Rev B\" versions are supported. Oregon Scientific WMR-100 stations. Tested on the Oregon Scientific WMR100N . Oregon Scientific WMR-300 stations. Tested on the Oregon Scientific WMR300A . Oregon Scientific WMR-9x8 stations. Tested on the Oregon Scientific WMR968 . Fine Offset 10xx, 20xx, and 30xx stations. Tested on the Ambient Weather WS2080. La Crosse WS-23xx stations. Tested on the La Crosse 2317 . La Crosse WS-28xx stations. Tested on the La Crosse C86234 . Hideki Professional Weather Stations. Tested on the Meade TE923. ADS WS1 Stations. Tested on the WS1 . PeetBros Ultimeter Stations. Tested on the Ultimeter 2000 . RainWise Mark III Stations. Tested on the CC3000 (firmware \"Rainwise CC-3000 Version: 1.3 Build 022 Dec 02 2016\"). AcuRite Weather Stations. Tested on the 01036RX.","title":"Driver status"},{"location":"hardware/fousb/","text":"FineOffset (USB) \u00b6 The station clock can only be set manually via buttons on the console, or (if the station supports it) by WWVB radio. The FineOffsetUSB driver ignores the station clock since it cannot be trusted. The station reads data from the sensors every 48 seconds. The 30xx stations read UV data every 60 seconds. The 10xx and 20xx stations can save up to 4080 historical readings. That is about 85 days of data with the default recording interval of 30 minutes, or about 14 days with a recording interval of 5 minutes. The 30xx stations can save up to 3264 historical readings. When WeeWX starts up it will attempt to download all records from the console since the last record in the archive database. Polling mode and interval \u00b6 When reading 'live' data, WeeWX can read as fast as possible, or at a user-defined period. This is controlled by the option polling_mode in the WeeWX configuration file. Polling modes for Fine Offset stations Mode Configuration Notes ADAPTIVE [FineOffsetUSB] polling_mode = ADAPTIVE In this mode, WeeWX reads data from the station as often as possible, but at intervals that avoid communication between the console and the sensors. Nominally this results in reading data every 48 seconds. PERIODIC [FineOffsetUSB] polling_mode = PERIODIC polling_interval = 60 In this mode, WeeWX reads data from the station every polling_interval seconds. The console reads the sensors every 48 seconds (60 seconds for UV), so setting the polling_interval to a value less than 48 will result in duplicate readings. Data format \u00b6 The 10xx/20xx consoles have a data format that is different from the 30xx consoles. All the consoles recognize wind, rain, temperature, and humidity from the same instrument clusters. However, some instrument clusters also include a luminosity sensor. Only the 30xx consoles recognize the luminosity and UV output from these sensors. As a consequence, the 30xx consoles also have a different data format. Since WeeWX cannot reliably determine the data format by communicating with the station, the data_format configuration option indicates the station type. Possible values are 1080 and 3080 . Use 1080 for the 10xx and 20xx consoles. The default value is 1080 . For example, this would indicate that the station is a 30xx console: [FineOffsetUSB] data_format = 3080 Configuring with weectl device \u00b6 The Fine Offset stations can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device . --help \u00b6 Invoking weectl device with the --help option weectl device --help will produce something like this: FineOffsetUSB driver version 1.7 Usage: weectl device [config_file] [options] [--debug] [--help] Configuration utility for weewx devices. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --info display weather station configuration --current get the current weather conditions --history=N display N records --history-since=N display records since N minutes ago --clear-memory clear station memory --set-time set station clock to computer time --set-interval=N set logging interval to N minutes --live display live readings from the station --logged display logged readings from the station --fixed-block display the contents of the fixed block --check-usb test the quality of the USB connection --check-fixed-block monitor the contents of the fixed block --format=FORMAT format for output, one of raw, table, or dict Mutating actions will request confirmation before proceeding. --info \u00b6 Display the station settings with the --info option. weectl device --info This will result in something like: Fine Offset station settings: local time: 2013.02.11 18:34:28 CET polling_mode: ADAPTIVE abs_pressure: 933.3 current_pos: 592 data_changed: 0 data_count: 22 date_time: 2007-01-01 22:49 hum_in_offset: 18722 hum_out_offset: 257 id: None lux_wm2_coeff: 0 magic_1: 0x55 magic_2: 0xaa model: None rain_coef: None read_period: 30 rel_pressure: 1014.8 temp_in_offset: 1792 temp_out_offset: 0 timezone: 0 unknown_01: 0 unknown_18: 0 version: 255 wind_coef: None wind_mult: 0 Highlighted values can be modified. --set-interval=N \u00b6 Set the archive interval. Fine Offset stations ship from the factory with an archive interval (read_period) of 30 minutes (1800 seconds). To change the station's interval to 5 minutes, do the following: weectl device --set-interval=5 --history=N \u00b6 Fine Offset stations store records in a circular buffer \u2014 once the buffer fills, the oldest records are replaced by newer records. The 1080 and 2080 consoles store up to 4080 records. The 3080 consoles store up to 3264 records. The data_count indicates how many records are in memory. The read_period indicates the number of minutes between records. weectl device can display these records in space-delimited, raw bytes, or dictionary format. For example, to display the most recent 30 records from the console memory: weectl device --history=30 --clear-memory \u00b6 To clear the console memory: weectl device --clear-memory --check-usb \u00b6 This command can test the quality of the USB connection between the computer and console. Poor quality USB cables, under-powered USB hubs, and other devices on the bus can interfere with communication. To test the quality of the USB connection to the console: weectl device --check-usb Let the utility run for at least a few minutes, or possibly an hour or two. It is not unusual to see a few bad reads in an hour, but if you see many bad reads within a few minutes, consider replacing the USB cable, USB hub, or removing other devices from the bus. Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. Fine Offset station data Database Field Observation Loop Archive barometer S S pressure pressure H H altimeter S S inTemp temperature_in H H outTemp temperature_out H H inHumidity humidity_in H H outHumidity humidity_out H H windSpeed wind_speed H H windDir wind_dir H H windGust wind_gust H H rain rain D D rain_total H H rainRate S S dewpoint dewpoint H S windchill windchill H S heatindex heatindex H S radiation 1 radiation D D luminosity 1 luminosity H H rxCheckPercent signal H outTempBatteryStatus battery H 1 The radiation data are available only from 30xx stations. These stations include a luminosity sensor, from which the radiation is approximated. H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"FineOffset"},{"location":"hardware/fousb/#fousb_notes","text":"The station clock can only be set manually via buttons on the console, or (if the station supports it) by WWVB radio. The FineOffsetUSB driver ignores the station clock since it cannot be trusted. The station reads data from the sensors every 48 seconds. The 30xx stations read UV data every 60 seconds. The 10xx and 20xx stations can save up to 4080 historical readings. That is about 85 days of data with the default recording interval of 30 minutes, or about 14 days with a recording interval of 5 minutes. The 30xx stations can save up to 3264 historical readings. When WeeWX starts up it will attempt to download all records from the console since the last record in the archive database.","title":"FineOffset (USB)"},{"location":"hardware/fousb/#polling-mode-and-interval","text":"When reading 'live' data, WeeWX can read as fast as possible, or at a user-defined period. This is controlled by the option polling_mode in the WeeWX configuration file. Polling modes for Fine Offset stations Mode Configuration Notes ADAPTIVE [FineOffsetUSB] polling_mode = ADAPTIVE In this mode, WeeWX reads data from the station as often as possible, but at intervals that avoid communication between the console and the sensors. Nominally this results in reading data every 48 seconds. PERIODIC [FineOffsetUSB] polling_mode = PERIODIC polling_interval = 60 In this mode, WeeWX reads data from the station every polling_interval seconds. The console reads the sensors every 48 seconds (60 seconds for UV), so setting the polling_interval to a value less than 48 will result in duplicate readings.","title":"Polling mode and interval"},{"location":"hardware/fousb/#fousb_data_format","text":"The 10xx/20xx consoles have a data format that is different from the 30xx consoles. All the consoles recognize wind, rain, temperature, and humidity from the same instrument clusters. However, some instrument clusters also include a luminosity sensor. Only the 30xx consoles recognize the luminosity and UV output from these sensors. As a consequence, the 30xx consoles also have a different data format. Since WeeWX cannot reliably determine the data format by communicating with the station, the data_format configuration option indicates the station type. Possible values are 1080 and 3080 . Use 1080 for the 10xx and 20xx consoles. The default value is 1080 . For example, this would indicate that the station is a 30xx console: [FineOffsetUSB] data_format = 3080","title":"Data format"},{"location":"hardware/fousb/#fousb_configuration","text":"The Fine Offset stations can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device .","title":"Configuring with weectl device"},{"location":"hardware/fousb/#fousb_help","text":"Invoking weectl device with the --help option weectl device --help will produce something like this: FineOffsetUSB driver version 1.7 Usage: weectl device [config_file] [options] [--debug] [--help] Configuration utility for weewx devices. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --info display weather station configuration --current get the current weather conditions --history=N display N records --history-since=N display records since N minutes ago --clear-memory clear station memory --set-time set station clock to computer time --set-interval=N set logging interval to N minutes --live display live readings from the station --logged display logged readings from the station --fixed-block display the contents of the fixed block --check-usb test the quality of the USB connection --check-fixed-block monitor the contents of the fixed block --format=FORMAT format for output, one of raw, table, or dict Mutating actions will request confirmation before proceeding.","title":"--help"},{"location":"hardware/fousb/#fousb_info","text":"Display the station settings with the --info option. weectl device --info This will result in something like: Fine Offset station settings: local time: 2013.02.11 18:34:28 CET polling_mode: ADAPTIVE abs_pressure: 933.3 current_pos: 592 data_changed: 0 data_count: 22 date_time: 2007-01-01 22:49 hum_in_offset: 18722 hum_out_offset: 257 id: None lux_wm2_coeff: 0 magic_1: 0x55 magic_2: 0xaa model: None rain_coef: None read_period: 30 rel_pressure: 1014.8 temp_in_offset: 1792 temp_out_offset: 0 timezone: 0 unknown_01: 0 unknown_18: 0 version: 255 wind_coef: None wind_mult: 0 Highlighted values can be modified.","title":"--info"},{"location":"hardware/fousb/#fousb_set_interval","text":"Set the archive interval. Fine Offset stations ship from the factory with an archive interval (read_period) of 30 minutes (1800 seconds). To change the station's interval to 5 minutes, do the following: weectl device --set-interval=5","title":"--set-interval=N"},{"location":"hardware/fousb/#fousb_history","text":"Fine Offset stations store records in a circular buffer \u2014 once the buffer fills, the oldest records are replaced by newer records. The 1080 and 2080 consoles store up to 4080 records. The 3080 consoles store up to 3264 records. The data_count indicates how many records are in memory. The read_period indicates the number of minutes between records. weectl device can display these records in space-delimited, raw bytes, or dictionary format. For example, to display the most recent 30 records from the console memory: weectl device --history=30","title":"--history=N"},{"location":"hardware/fousb/#fousb_clear_memory","text":"To clear the console memory: weectl device --clear-memory","title":"--clear-memory"},{"location":"hardware/fousb/#fousb_check_usb","text":"This command can test the quality of the USB connection between the computer and console. Poor quality USB cables, under-powered USB hubs, and other devices on the bus can interfere with communication. To test the quality of the USB connection to the console: weectl device --check-usb Let the utility run for at least a few minutes, or possibly an hour or two. It is not unusual to see a few bad reads in an hour, but if you see many bad reads within a few minutes, consider replacing the USB cable, USB hub, or removing other devices from the bus.","title":"--check-usb"},{"location":"hardware/fousb/#fousb_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. Fine Offset station data Database Field Observation Loop Archive barometer S S pressure pressure H H altimeter S S inTemp temperature_in H H outTemp temperature_out H H inHumidity humidity_in H H outHumidity humidity_out H H windSpeed wind_speed H H windDir wind_dir H H windGust wind_gust H H rain rain D D rain_total H H rainRate S S dewpoint dewpoint H S windchill windchill H S heatindex heatindex H S radiation 1 radiation D D luminosity 1 luminosity H H rxCheckPercent signal H outTempBatteryStatus battery H 1 The radiation data are available only from 30xx stations. These stations include a luminosity sensor, from which the radiation is approximated. H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"hardware/te923/","text":"TE923 \u00b6 Some station models will recognize up to 5 remote temperature/humidity sensor units. Use the hardware switch in each sensor unit to identify sensors. Use the sensor_map in weewx.conf to associate each sensor with a database field. The station has either 208 or 3442 history records, depending on the model. With an archive interval set to 5 minutes, that is just over a day (208 records) or about 23 days (3442 records). The TE923 driver will read history records from the station when WeeWX starts up, but it does not support hardware record generation. Configuring with weectl device \u00b6 The TE923 can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device . --help \u00b6 Invoking weectl device with the --help option weectl device /home/weewx/weewx.conf --help will produce something like this: Using configuration file /home/weewx/weewx.conf Using TE923 driver version 0.21 (weewx.drivers.te923) Usage: weectl device [config_file] [options] [--debug] [--help] Configuration utility for weewx devices. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --info display weather station configuration --current get the current weather conditions --history=N display N history records --history-since=N display history records since N minutes ago --minmax display historical min/max data --get-date display station date --set-date=YEAR,MONTH,DAY set station date --sync-date set station date using system clock --get-location-local display local location and timezone --set-location-local=CITY|USR,LONG_DEG,LONG_MIN,E|W,LAT_DEG,LAT_MIN,N|S,TZ,DST set local location and timezone --get-location-alt display alternate location and timezone --set-location-alt=CITY|USR,LONG_DEG,LONG_MIN,E|W,LAT_DEG,LAT_MIN,N|S,TZ,DST set alternate location and timezone --get-altitude display altitude --set-altitude=ALT set altitude (meters) --get-alarms display alarms --set-alarms=WEEKDAY,SINGLE,PRE_ALARM,SNOOZE,MAXTEMP,MINTEMP,RAIN,WIND,GUST set alarm state --get-interval display archive interval --set-interval=INTERVAL set archive interval (minutes) --format=FORMAT formats include: table, dict Be sure to stop weewx first before using. Mutating actions will request confirmation before proceeding. --info \u00b6 Use --info to display the station configuration: weectl device --info This will result in something like: Querying the station for the configuration... altitude: 16 bat_1: True bat_2: True bat_3: True bat_4: True bat_5: True bat_rain: True bat_uv: False bat_wind: True latitude: 43.35 longitude: -72.0 version_bar: 23 version_rcc: 16 version_sys: 41 version_uv: 20 version_wind: 38 --current \u00b6 Use --current to display the current status of each sensor: weectl device --current This will result in something like: Querying the station for current weather data... dateTime: 1454615168 forecast: 5 h_1: 41 h_1_state: ok h_2: 48 h_2_state: ok h_3: None h_3_state: no_link h_4: None h_4_state: no_link h_5: None h_5_state: no_link h_in: 44 h_in_state: ok rain: 2723 rain_state: ok slp: 1012.4375 slp_state: ok storm: 0 t_1: 13.9 t_1_state: ok t_2: 21.5 t_2_state: ok t_3: None t_3_state: no_link t_4: None t_4_state: no_link t_5: None t_5_state: no_link t_in: 22.85 t_in_state: ok uv: None uv_state: no_link windchill: None windchill_state: invalid winddir: 12 winddir_state: invalid windgust: None windgust_state: invalid windspeed: None windspeed_state: invalid --set-interval \u00b6 TE923 stations ship from the factory with an archive interval of 1 hour (3600 seconds). To change the station's interval to 5 minutes (300 seconds), do the following: weectl device --set-interval=300 --history=N \u00b6 Use the --history action to display records from the logger in tabular or dictionary format. For example, to display the most recent 30 records in dictionary format: weectl device --history=30 --format=dict --clear-memory \u00b6 Use --clear-memory to erase all records from the logger memory. Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. TE923 station data Database Field Observation Loop Archive barometer barometer H H pressure S S altimeter S S inTemp t_in H H inHumidity h_in H H outTemp t_1 H H outHumidity h_1 H H outTempBatteryStatus bat_1 H outLinkStatus link_1 H windSpeed windspeed H H windDir winddir H H windGust windgust H H windBatteryStatus bat_wind H windLinkStatus link_wind H rain rain D D rain_total H H rainBatteryStatus bat_rain H rainLinkStatus link_rain H rainRate S S dewpoint S S windchill windchill H H heatindex S S UV 1 uv H H uvBatteryStatus bat_uv H uvLinkStatus link_uv H extraTemp1 t_2 H H extraHumid1 h_2 H H extraBatteryStatus1 bat_2 H extraLinkStatus1 link_2 H extraTemp2 t_3 H H extraHumid2 h_3 H H extraBatteryStatus2 bat_3 H extraLinkStatus2 link_3 H extraTemp3 t_4 H H extraHumid3 h_4 H H extraBatteryStatus3 bat_4 H extraLinkStatus3 link_4 H extraTemp4 t_5 H H extraHumid4 h_5 H H extraBatteryStatus4 bat_5 H extraLinkStatus4 link_5 H Some stations support up to 5 remote temperature/humidity sensors. 1 The UV data are available only with the optional solar radiation sensor. H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"TE923"},{"location":"hardware/te923/#te923_notes","text":"Some station models will recognize up to 5 remote temperature/humidity sensor units. Use the hardware switch in each sensor unit to identify sensors. Use the sensor_map in weewx.conf to associate each sensor with a database field. The station has either 208 or 3442 history records, depending on the model. With an archive interval set to 5 minutes, that is just over a day (208 records) or about 23 days (3442 records). The TE923 driver will read history records from the station when WeeWX starts up, but it does not support hardware record generation.","title":"TE923"},{"location":"hardware/te923/#te923_configuration","text":"The TE923 can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device .","title":"Configuring with weectl device"},{"location":"hardware/te923/#te923_help","text":"Invoking weectl device with the --help option weectl device /home/weewx/weewx.conf --help will produce something like this: Using configuration file /home/weewx/weewx.conf Using TE923 driver version 0.21 (weewx.drivers.te923) Usage: weectl device [config_file] [options] [--debug] [--help] Configuration utility for weewx devices. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --info display weather station configuration --current get the current weather conditions --history=N display N history records --history-since=N display history records since N minutes ago --minmax display historical min/max data --get-date display station date --set-date=YEAR,MONTH,DAY set station date --sync-date set station date using system clock --get-location-local display local location and timezone --set-location-local=CITY|USR,LONG_DEG,LONG_MIN,E|W,LAT_DEG,LAT_MIN,N|S,TZ,DST set local location and timezone --get-location-alt display alternate location and timezone --set-location-alt=CITY|USR,LONG_DEG,LONG_MIN,E|W,LAT_DEG,LAT_MIN,N|S,TZ,DST set alternate location and timezone --get-altitude display altitude --set-altitude=ALT set altitude (meters) --get-alarms display alarms --set-alarms=WEEKDAY,SINGLE,PRE_ALARM,SNOOZE,MAXTEMP,MINTEMP,RAIN,WIND,GUST set alarm state --get-interval display archive interval --set-interval=INTERVAL set archive interval (minutes) --format=FORMAT formats include: table, dict Be sure to stop weewx first before using. Mutating actions will request confirmation before proceeding.","title":"--help"},{"location":"hardware/te923/#te923_info","text":"Use --info to display the station configuration: weectl device --info This will result in something like: Querying the station for the configuration... altitude: 16 bat_1: True bat_2: True bat_3: True bat_4: True bat_5: True bat_rain: True bat_uv: False bat_wind: True latitude: 43.35 longitude: -72.0 version_bar: 23 version_rcc: 16 version_sys: 41 version_uv: 20 version_wind: 38","title":"--info"},{"location":"hardware/te923/#te923_current","text":"Use --current to display the current status of each sensor: weectl device --current This will result in something like: Querying the station for current weather data... dateTime: 1454615168 forecast: 5 h_1: 41 h_1_state: ok h_2: 48 h_2_state: ok h_3: None h_3_state: no_link h_4: None h_4_state: no_link h_5: None h_5_state: no_link h_in: 44 h_in_state: ok rain: 2723 rain_state: ok slp: 1012.4375 slp_state: ok storm: 0 t_1: 13.9 t_1_state: ok t_2: 21.5 t_2_state: ok t_3: None t_3_state: no_link t_4: None t_4_state: no_link t_5: None t_5_state: no_link t_in: 22.85 t_in_state: ok uv: None uv_state: no_link windchill: None windchill_state: invalid winddir: 12 winddir_state: invalid windgust: None windgust_state: invalid windspeed: None windspeed_state: invalid","title":"--current"},{"location":"hardware/te923/#te923_set_interval","text":"TE923 stations ship from the factory with an archive interval of 1 hour (3600 seconds). To change the station's interval to 5 minutes (300 seconds), do the following: weectl device --set-interval=300","title":"--set-interval"},{"location":"hardware/te923/#te923_history","text":"Use the --history action to display records from the logger in tabular or dictionary format. For example, to display the most recent 30 records in dictionary format: weectl device --history=30 --format=dict","title":"--history=N"},{"location":"hardware/te923/#te923_clear_memory","text":"Use --clear-memory to erase all records from the logger memory.","title":"--clear-memory"},{"location":"hardware/te923/#te923_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. TE923 station data Database Field Observation Loop Archive barometer barometer H H pressure S S altimeter S S inTemp t_in H H inHumidity h_in H H outTemp t_1 H H outHumidity h_1 H H outTempBatteryStatus bat_1 H outLinkStatus link_1 H windSpeed windspeed H H windDir winddir H H windGust windgust H H windBatteryStatus bat_wind H windLinkStatus link_wind H rain rain D D rain_total H H rainBatteryStatus bat_rain H rainLinkStatus link_rain H rainRate S S dewpoint S S windchill windchill H H heatindex S S UV 1 uv H H uvBatteryStatus bat_uv H uvLinkStatus link_uv H extraTemp1 t_2 H H extraHumid1 h_2 H H extraBatteryStatus1 bat_2 H extraLinkStatus1 link_2 H extraTemp2 t_3 H H extraHumid2 h_3 H H extraBatteryStatus2 bat_3 H extraLinkStatus2 link_3 H extraTemp3 t_4 H H extraHumid3 h_4 H H extraBatteryStatus3 bat_4 H extraLinkStatus3 link_4 H extraTemp4 t_5 H H extraHumid4 h_5 H H extraBatteryStatus4 bat_5 H extraLinkStatus4 link_5 H Some stations support up to 5 remote temperature/humidity sensors. 1 The UV data are available only with the optional solar radiation sensor. H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"hardware/ultimeter/","text":"Ultimeter \u00b6 The Ultimeter driver operates the Ultimeter in Data Logger Mode, which results in sensor readings every 1/2 second or so. The Ultimeter driver ignores the maximum, minimum, and average values recorded by the station. Configuring with weectl device \u00b6 The Ultimeter stations cannot be configured with the utility weectl device . Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. Ultimeter station data Database Field Observation Loop Archive barometer 2 barometer H pressure 2 S altimeter 2 S inTemp 2 temperature_in H outTemp temperature_out H inHumidity 2 humidity_in H outHumidity humidity_out H windSpeed wind_speed H windDir wind_dir H rain 1 rain D rain_total H rainRate 1 S dewpoint S windchill S heatindex S 1 The rain and rainRate are available only on stations with the optional rain sensor. 2 Pressure, inside temperature, and inside humidity data are not available on all types of Ultimeter stations. H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Ultimeter"},{"location":"hardware/ultimeter/#ultimeter_notes","text":"The Ultimeter driver operates the Ultimeter in Data Logger Mode, which results in sensor readings every 1/2 second or so. The Ultimeter driver ignores the maximum, minimum, and average values recorded by the station.","title":"Ultimeter"},{"location":"hardware/ultimeter/#ultimeter_configuration","text":"The Ultimeter stations cannot be configured with the utility weectl device .","title":"Configuring with weectl device"},{"location":"hardware/ultimeter/#ultimeter_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. Ultimeter station data Database Field Observation Loop Archive barometer 2 barometer H pressure 2 S altimeter 2 S inTemp 2 temperature_in H outTemp temperature_out H inHumidity 2 humidity_in H outHumidity humidity_out H windSpeed wind_speed H windDir wind_dir H rain 1 rain D rain_total H rainRate 1 S dewpoint S windchill S heatindex S 1 The rain and rainRate are available only on stations with the optional rain sensor. 2 Pressure, inside temperature, and inside humidity data are not available on all types of Ultimeter stations. H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"hardware/vantage/","text":"Vantage \u00b6 The Davis Vantage stations include a variety of models and configurations. The WeeWX driver can communicate with a console or envoy using serial, USB, or TCP/IP interface. Configuring with weectl device \u00b6 The Vantage stations can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device . --help \u00b6 Invoking weectl device with the --help option weectl device /home/weewx/weewx.conf --help will produce something like this: Using configuration file /home/weewx-user/weewx-data/weewx.conf Using driver weewx.drivers.vantage. Using Vantage driver version 3.6.2 (weewx.drivers.vantage) Usage: weectl device --help weectl device --info [config_file] weectl device --current [config_file] weectl device --clear-memory [config_file] [-y] weectl device --set-interval=MINUTES [config_file] [-y] weectl device --set-latitude=DEGREE [config_file] [-y] weectl device --set-longitude=DEGREE [config_file] [-y] weectl device --set-altitude=FEET [config_file] [-y] weectl device --set-barometer=inHg [config_file] [-y] weectl device --set-wind-cup=CODE [config_file] [-y] weectl device --set-bucket=CODE [config_file] [-y] weectl device --set-rain-year-start=MM [config_file] [-y] weectl device --set-offset=VARIABLE,OFFSET [config_file] [-y] weectl device --set-transmitter-type=CHANNEL,TYPE,TEMP,HUM,REPEATER_ID [config_file] [-y] weectl device --set-retransmit=[OFF|ON|ON,CHANNEL] [config_file] [-y] weectl device --set-temperature-logging=[LAST|AVERAGE] [config_file] [-y] weectl device --set-time [config_file] [-y] weectl device --set-dst=[AUTO|ON|OFF] [config_file] [-y] weectl device --set-tz-code=TZCODE [config_file] [-y] weectl device --set-tz-offset=HHMM [config_file] [-y] weectl device --set-lamp=[ON|OFF] [config_file] weectl device --dump [--batch-size=BATCH_SIZE] [config_file] [-y] weectl device --logger-summary=FILE [config_file] [-y] weectl device [--start | --stop] [config_file] Configures the Davis Vantage weather station. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --info To print configuration, reception, and barometer calibration information about your weather station. --current To print current LOOP information. --clear-memory To clear the memory of your weather station. --set-interval=MINUTES Sets the archive interval to the specified number of minutes. Valid values are 1, 5, 10, 15, 30, 60, or 120. --set-latitude=DEGREE Sets the latitude of the station to the specified number of tenth degree. --set-longitude=DEGREE Sets the longitude of the station to the specified number of tenth degree. --set-altitude=FEET Sets the altitude of the station to the specified number of feet. --set-barometer=inHg Sets the barometer reading of the station to a known correct value in inches of mercury. Specify 0 (zero) to have the console pick a sensible value. --set-wind-cup=CODE Set the type of wind cup. Specify '0' for small size; '1' for large size --set-bucket=CODE Set the type of rain bucket. Specify '0' for 0.01 inches; '1' for 0.2 mm; '2' for 0.1 mm --set-rain-year-start=MM Set the rain year start (1=Jan, 2=Feb, etc.). --set-offset=VARIABLE,OFFSET Set the onboard offset for VARIABLE inTemp, outTemp, extraTemp[1-7], inHumid, outHumid, extraHumid[1-7], soilTemp[1-4], leafTemp[1-4], windDir) to OFFSET (Fahrenheit, %, degrees) --set-transmitter-type=CHANNEL,TYPE,TEMP,HUM,REPEATER_ID Set the transmitter type for CHANNEL (1-8), TYPE (0=iss, 1=temp, 2=hum, 3=temp_hum, 4=wind, 5=rain, 6=leaf, 7=soil, 8=leaf_soil, 9=sensorlink, 10=none), as extra TEMP station and extra HUM station (both 1-7, if applicable), REPEATER_ID (A-H, or 0=OFF) --set-retransmit=OFF|ON|ON,CHANNEL Turn ISS retransmit 'ON' or 'OFF', using optional CHANNEL. --set-temperature-logging=LAST|AVERAGE Set console temperature logging to either 'LAST' or 'AVERAGE'. --set-time Set the onboard clock to the current time. --set-dst=AUTO|ON|OFF Set DST to 'ON', 'OFF', or 'AUTO' --set-tz-code=TZCODE Set timezone code to TZCODE. See your Vantage manual for valid codes. --set-tz-offset=HHMM Set timezone offset to HHMM. E.g. '-0800' for U.S. Pacific Time. --set-lamp=ON|OFF Turn the console lamp 'ON' or 'OFF'. --dump Dump all data to the archive. NB: This may result in many duplicate primary key errors. --batch-size=BATCH_SIZE Use with option --dump. Pages are read off the console in batches of BATCH_SIZE. A BATCH_SIZE of zero means dump all data first, then put it in the database. This can improve performance in high-latency environments, but requires sufficient memory to hold all station data. Default is 1 (one). --logger-summary=FILE Save diagnostic summary to FILE (for debugging the logger). --start Start the logger. --stop Stop the logger. Be sure to stop weewxd first before using. Mutating actions will request confirmation before proceeding. --info \u00b6 Use the --info option to display the current EEPROM settings: weectl device --info This will result in something like: Using configuration file /home/weewx/weewx.conf Using driver weewx.drivers.vantage. Using Vantage driver version 3.6.2 (weewx.drivers.vantage) Querying... Davis Vantage EEPROM settings: CONSOLE TYPE: Vantage Pro2 CONSOLE FIRMWARE: Date: Dec 11 2012 Version: 3.12 CONSOLE SETTINGS: Archive interval: 300 (seconds) Altitude: 700 (foot) Wind cup type: large Rain bucket type: 0.01 inches Rain year start: 10 Onboard time: 2023-05-01 07:35:25 CONSOLE DISPLAY UNITS: Barometer: mbar Temperature: degree_F Rain: inch Wind: mile_per_hour CONSOLE STATION INFO: Latitude (onboard): +46.0 Longitude (onboard): -121.6 Use manual or auto DST? AUTO DST setting: N/A Use GMT offset or zone code? ZONE_CODE Time zone code: 4 GMT offset: N/A Temperature logging: AVERAGE TRANSMITTERS: Channel Receive Retransmit Repeater Type 1 inactive N NONE iss 2 inactive N NONE (N/A) 3 active N NONE temp (as extra temperature 1) 4 active N 8 temp_hum (as extra temperature 4 and extra humidity 1) 5 inactive N NONE (N/A) 6 inactive Y NONE (N/A) 7 inactive N NONE (N/A) 8 inactive N NONE (N/A) RECEPTION STATS: Total packets received: 2895 Total packets missed: 82 Number of resynchronizations: 0 Longest good stretch: 330 Number of CRC errors: 134 BAROMETER CALIBRATION DATA: Current barometer reading: 29.821 inHg Altitude: 700 feet Dew point: 43 F Virtual temperature: 56 F Humidity correction factor: 1.7 Correction ratio: 1.026 Correction constant: +0.036 inHg Gain: 0.000 Offset: -47.000 OFFSETS: Wind direction: +0 deg Inside Temperature: +0.0 F Inside Humidity: +0 % Outside Temperature: +0.0 F Outside Humidity: +0 % Extra Temperature 1: +0.0 F Extra Temperature 4: +0.0 F Extra Humidity 1: +0.0 F The console version number is available only on consoles with firmware dates after about 2006. Highlighted values can be modified using the commands below. --current \u00b6 This command will print a single LOOP packet. --clear-memory \u00b6 This command will clear the logger memory after asking for confirmation. --set-interval=N \u00b6 Use this command to change the archive interval of the internal logger. Valid intervals are 1, 5, 10, 15, 30, 60, or 120 minutes. However, if you are ftp'ing lots of files to a server, setting it to one minute may not give enough time to have them all uploaded before the next archive record is due. If this is the case, you should pick a longer archive interval, or trim the number of files you are using. An archive interval of five minutes works well for the Vantage stations. Because of the large amount of onboard memory they carry, going to a larger interval does not have any real advantages. Example: change the archive interval to 10 minutes: weectl device --set-interval=10 --set-altitude=N \u00b6 Use this command to set the console's stored altitude. The altitude must be in feet . Example: change the altitude to 700 feet: weectl device --set-altitude=700 --set-barometer=N \u00b6 Use this command to calibrate the barometer in your Vantage weather station. To use it, you must have a known correct barometer reading for your altitude . In practice, you will either have to move your console to a known-correct station (perhaps a nearby airport) and perform the calibration there, or reduce the barometer reading to your altitude. Otherwise, specify the value zero and the station will pick a sensible value. The barometer value must be in inches of Mercury . --set-bucket \u00b6 Normally, this is set by Davis, but if you have replaced your bucket with a different kind, you might want to reconfigure. For example, to change to a 0.1 mm bucket (bucket code 2 ), use the following: weectl device --set-bucket=2 --set-rain-year-start \u00b6 The Davis Vantage series allows the start of the rain year to be something other than 1 January. For example, to set it to 1 October: weectl device --set-rain-year-start=10 --set-offset \u00b6 The Davis instruments can correct sensor errors by adding an offset to their emitted values. This is particularly useful for Southern Hemisphere users. Davis fits the wind vane to the Integrated Sensor Suite (ISS) in a position optimized for Northern Hemisphere users, who face the solar panel to the south. Users south of the equator must orient the ISS's solar panel to the north to get maximal insolation, resulting in a 180\u00b0 error in the wind direction. The solution is to add a 180\u00b0 offset correction. You can do this with the following command: weectl device --set-offset=windDir,180 --set-transmitter-type \u00b6 If you have additional sensors and/or repeaters for your Vantage station, you can configure them using your console. However, if you have a Davis Weather Envoy , it will not have a console! As an alternative, weectl device can do this using the command --set-transmitter-type . For example, to add an extra temperature sensor to channel 3 and no repeater is used, do the following: weectl device --set-transmitter-type=3,1,2 This says to turn on channel 3, set its type to 1 (\"Temperature only\"), and it will show up in the database as extraTemp2 . No repeater id was specified, so it defaults to \"no repeater.\" Here's another example, this time for a combined temperature / humidity sensor retransmitted via repeater A: weectl device --set-transmitter-type=5,3,2,4,a This will add the combined sensor to channel 5, set its type to 3 (\"Temperature and humidity\"), via Repeater A, and it will show up in the database as extraTemp2 and extraHumid4 . The --help option will give you the code for each sensor type and repeater id. If you have to use repeaters with your Vantage Pro2 station, please take a look at Installing Repeater Networks for Vantage Pro2 for how to set them up. --set-retransmit \u00b6 Use this command to tell your console whether to act as a retransmitter of ISS data. Example: Tell your console to retransmit ISS data using the first available channel: weectl device --set-retransmit=on Example: Tell your console to retransmit ISS data on channel 4: weectl device --set-retransmit=on,4 Warning You can use only channels not actively used for reception. The command checks for this and will not accept channel numbers actively used for reception of sensor stations. Example: Tell your console to turn retransmission 'OFF': weectl device --set-retransmit=off --set-dst \u00b6 Use the command to tell your console whether daylight savings time is in effect, or to have it set automatically based on the time zone. --set-tz-code \u00b6 This command can be used to change the time zone. Consult the Vantage manual for the code that corresponds to your time zone. For example, to set the time zone code to Central European Time (code 20): weectl device --set-tz-code=20 Warning You can set either the time zone code or the time zone offset, but not both. --set-tz-offset \u00b6 If you live in an odd time zone that is perhaps not covered by the \"canned\" Davis time zones, you can set the offset from UTC using this command. For example, to set the time zone offset for Newfoundland Standard Time (UTC-03:30), use the following: weectl device --set-tz-offset=-0330 Warning You can set either the time zone code or the time zone offset, but not both. --set-lamp \u00b6 Use this command to turn the console lamp on or off. --dump \u00b6 Generally, WeeWX downloads only new archive records from the on-board logger in the Vantage. However, occasionally the memory in the Vantage will get corrupted, making this impossible. See the section WeeWX generates HTML pages, but it does not update them in the Wiki. The fix involves clearing the memory but, unfortunately, this means you may lose any data which might have accumulated in the logger memory, but not yet downloaded. By using the --dump command before clearing the memory, you might be able to save these data. Stop WeeWX first, then weectl device --dump This will dump all data archived in the Vantage memory directly to the database, without regard to whether or not they have been seen before. Because the command dumps all data, it may result in many duplicate primary key errors. These can be ignored. --logger-summary \u00b6 This command is useful for debugging the console logger. It will scan the logger memory, recording the timestamp in each page and index slot to the file FILE . Example: weectl device --logger-summary=/var/tmp/summary.txt --start \u00b6 Use this command to start the logger. There are occasions when an out-of-the-box logger needs this command. --stop \u00b6 Use this command to stop the logger. This can be useful when servicing your weather station, and you don't want any bad data to be stored in the logger. Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. Vantage station data Database Field Observation Loop Archive barometer barometer H H pressure S S altimeter S S inTemp inTemp H H outTemp outTemp H H inHumidity inHumidity H H outHumidity outHumidity H H windSpeed windSpeed H H windDir windDir H H windGust windGust H H windGustDir windGustDir H H rain rain D H monthRain H H rainRate rainRate H H dewpoint S S windchill S S heatindex S S radiation radiation H H UV UV H H extraTemp1 extraTemp1 H H extraTemp2 extraTemp2 H H extraTemp3 extraTemp3 H H extraTemp4 extraTemp4 H extraTemp5 extraTemp5 H extraTemp6 extraTemp6 H extraTemp7 extraTemp7 H soilTemp1 soilTemp1 H H soilTemp2 soilTemp2 H H soilTemp3 soilTemp3 H H soilTemp4 soilTemp4 H H leafTemp1 leafTemp1 H H leafTemp2 leafTemp2 H H leafTemp3 leafTemp3 H H leafTemp4 leafTemp4 H H extraHumid1 extraHumid1 H H extraHumid2 extraHumid2 H H extraHumid3 extraHumid3 H extraHumid4 extraHumid4 H extraHumid5 extraHumid5 H extraHumid6 extraHumid6 H extraHumid7 extraHumid7 H soilMoist1 soilMoist1 H H soilMoist2 soilMoist2 H H soilMoist3 soilMoist3 H H soilMoist4 soilMoist4 H H leafWet1 leafWet1 H H leafWet2 leafWet2 H H leafWet3 leafWet3 H H leafWet4 leafWet4 H H txBatteryStatus txBatteryStatus H H consBatteryVoltage consBatteryVoltage H H wind_samples H H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Vantage"},{"location":"hardware/vantage/#vantage_notes","text":"The Davis Vantage stations include a variety of models and configurations. The WeeWX driver can communicate with a console or envoy using serial, USB, or TCP/IP interface.","title":"Vantage"},{"location":"hardware/vantage/#vantage_configuration","text":"The Vantage stations can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device .","title":"Configuring with weectl device"},{"location":"hardware/vantage/#vantage_help","text":"Invoking weectl device with the --help option weectl device /home/weewx/weewx.conf --help will produce something like this: Using configuration file /home/weewx-user/weewx-data/weewx.conf Using driver weewx.drivers.vantage. Using Vantage driver version 3.6.2 (weewx.drivers.vantage) Usage: weectl device --help weectl device --info [config_file] weectl device --current [config_file] weectl device --clear-memory [config_file] [-y] weectl device --set-interval=MINUTES [config_file] [-y] weectl device --set-latitude=DEGREE [config_file] [-y] weectl device --set-longitude=DEGREE [config_file] [-y] weectl device --set-altitude=FEET [config_file] [-y] weectl device --set-barometer=inHg [config_file] [-y] weectl device --set-wind-cup=CODE [config_file] [-y] weectl device --set-bucket=CODE [config_file] [-y] weectl device --set-rain-year-start=MM [config_file] [-y] weectl device --set-offset=VARIABLE,OFFSET [config_file] [-y] weectl device --set-transmitter-type=CHANNEL,TYPE,TEMP,HUM,REPEATER_ID [config_file] [-y] weectl device --set-retransmit=[OFF|ON|ON,CHANNEL] [config_file] [-y] weectl device --set-temperature-logging=[LAST|AVERAGE] [config_file] [-y] weectl device --set-time [config_file] [-y] weectl device --set-dst=[AUTO|ON|OFF] [config_file] [-y] weectl device --set-tz-code=TZCODE [config_file] [-y] weectl device --set-tz-offset=HHMM [config_file] [-y] weectl device --set-lamp=[ON|OFF] [config_file] weectl device --dump [--batch-size=BATCH_SIZE] [config_file] [-y] weectl device --logger-summary=FILE [config_file] [-y] weectl device [--start | --stop] [config_file] Configures the Davis Vantage weather station. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --info To print configuration, reception, and barometer calibration information about your weather station. --current To print current LOOP information. --clear-memory To clear the memory of your weather station. --set-interval=MINUTES Sets the archive interval to the specified number of minutes. Valid values are 1, 5, 10, 15, 30, 60, or 120. --set-latitude=DEGREE Sets the latitude of the station to the specified number of tenth degree. --set-longitude=DEGREE Sets the longitude of the station to the specified number of tenth degree. --set-altitude=FEET Sets the altitude of the station to the specified number of feet. --set-barometer=inHg Sets the barometer reading of the station to a known correct value in inches of mercury. Specify 0 (zero) to have the console pick a sensible value. --set-wind-cup=CODE Set the type of wind cup. Specify '0' for small size; '1' for large size --set-bucket=CODE Set the type of rain bucket. Specify '0' for 0.01 inches; '1' for 0.2 mm; '2' for 0.1 mm --set-rain-year-start=MM Set the rain year start (1=Jan, 2=Feb, etc.). --set-offset=VARIABLE,OFFSET Set the onboard offset for VARIABLE inTemp, outTemp, extraTemp[1-7], inHumid, outHumid, extraHumid[1-7], soilTemp[1-4], leafTemp[1-4], windDir) to OFFSET (Fahrenheit, %, degrees) --set-transmitter-type=CHANNEL,TYPE,TEMP,HUM,REPEATER_ID Set the transmitter type for CHANNEL (1-8), TYPE (0=iss, 1=temp, 2=hum, 3=temp_hum, 4=wind, 5=rain, 6=leaf, 7=soil, 8=leaf_soil, 9=sensorlink, 10=none), as extra TEMP station and extra HUM station (both 1-7, if applicable), REPEATER_ID (A-H, or 0=OFF) --set-retransmit=OFF|ON|ON,CHANNEL Turn ISS retransmit 'ON' or 'OFF', using optional CHANNEL. --set-temperature-logging=LAST|AVERAGE Set console temperature logging to either 'LAST' or 'AVERAGE'. --set-time Set the onboard clock to the current time. --set-dst=AUTO|ON|OFF Set DST to 'ON', 'OFF', or 'AUTO' --set-tz-code=TZCODE Set timezone code to TZCODE. See your Vantage manual for valid codes. --set-tz-offset=HHMM Set timezone offset to HHMM. E.g. '-0800' for U.S. Pacific Time. --set-lamp=ON|OFF Turn the console lamp 'ON' or 'OFF'. --dump Dump all data to the archive. NB: This may result in many duplicate primary key errors. --batch-size=BATCH_SIZE Use with option --dump. Pages are read off the console in batches of BATCH_SIZE. A BATCH_SIZE of zero means dump all data first, then put it in the database. This can improve performance in high-latency environments, but requires sufficient memory to hold all station data. Default is 1 (one). --logger-summary=FILE Save diagnostic summary to FILE (for debugging the logger). --start Start the logger. --stop Stop the logger. Be sure to stop weewxd first before using. Mutating actions will request confirmation before proceeding.","title":"--help"},{"location":"hardware/vantage/#vantage_info","text":"Use the --info option to display the current EEPROM settings: weectl device --info This will result in something like: Using configuration file /home/weewx/weewx.conf Using driver weewx.drivers.vantage. Using Vantage driver version 3.6.2 (weewx.drivers.vantage) Querying... Davis Vantage EEPROM settings: CONSOLE TYPE: Vantage Pro2 CONSOLE FIRMWARE: Date: Dec 11 2012 Version: 3.12 CONSOLE SETTINGS: Archive interval: 300 (seconds) Altitude: 700 (foot) Wind cup type: large Rain bucket type: 0.01 inches Rain year start: 10 Onboard time: 2023-05-01 07:35:25 CONSOLE DISPLAY UNITS: Barometer: mbar Temperature: degree_F Rain: inch Wind: mile_per_hour CONSOLE STATION INFO: Latitude (onboard): +46.0 Longitude (onboard): -121.6 Use manual or auto DST? AUTO DST setting: N/A Use GMT offset or zone code? ZONE_CODE Time zone code: 4 GMT offset: N/A Temperature logging: AVERAGE TRANSMITTERS: Channel Receive Retransmit Repeater Type 1 inactive N NONE iss 2 inactive N NONE (N/A) 3 active N NONE temp (as extra temperature 1) 4 active N 8 temp_hum (as extra temperature 4 and extra humidity 1) 5 inactive N NONE (N/A) 6 inactive Y NONE (N/A) 7 inactive N NONE (N/A) 8 inactive N NONE (N/A) RECEPTION STATS: Total packets received: 2895 Total packets missed: 82 Number of resynchronizations: 0 Longest good stretch: 330 Number of CRC errors: 134 BAROMETER CALIBRATION DATA: Current barometer reading: 29.821 inHg Altitude: 700 feet Dew point: 43 F Virtual temperature: 56 F Humidity correction factor: 1.7 Correction ratio: 1.026 Correction constant: +0.036 inHg Gain: 0.000 Offset: -47.000 OFFSETS: Wind direction: +0 deg Inside Temperature: +0.0 F Inside Humidity: +0 % Outside Temperature: +0.0 F Outside Humidity: +0 % Extra Temperature 1: +0.0 F Extra Temperature 4: +0.0 F Extra Humidity 1: +0.0 F The console version number is available only on consoles with firmware dates after about 2006. Highlighted values can be modified using the commands below.","title":"--info"},{"location":"hardware/vantage/#vantage_current","text":"This command will print a single LOOP packet.","title":"--current"},{"location":"hardware/vantage/#vantage_clear_console_memory","text":"This command will clear the logger memory after asking for confirmation.","title":"--clear-memory"},{"location":"hardware/vantage/#vantage_archive_interval","text":"Use this command to change the archive interval of the internal logger. Valid intervals are 1, 5, 10, 15, 30, 60, or 120 minutes. However, if you are ftp'ing lots of files to a server, setting it to one minute may not give enough time to have them all uploaded before the next archive record is due. If this is the case, you should pick a longer archive interval, or trim the number of files you are using. An archive interval of five minutes works well for the Vantage stations. Because of the large amount of onboard memory they carry, going to a larger interval does not have any real advantages. Example: change the archive interval to 10 minutes: weectl device --set-interval=10","title":"--set-interval=N"},{"location":"hardware/vantage/#-set-altituden","text":"Use this command to set the console's stored altitude. The altitude must be in feet . Example: change the altitude to 700 feet: weectl device --set-altitude=700","title":"--set-altitude=N"},{"location":"hardware/vantage/#-set-barometern","text":"Use this command to calibrate the barometer in your Vantage weather station. To use it, you must have a known correct barometer reading for your altitude . In practice, you will either have to move your console to a known-correct station (perhaps a nearby airport) and perform the calibration there, or reduce the barometer reading to your altitude. Otherwise, specify the value zero and the station will pick a sensible value. The barometer value must be in inches of Mercury .","title":"--set-barometer=N"},{"location":"hardware/vantage/#vantage_rain_bucket_type","text":"Normally, this is set by Davis, but if you have replaced your bucket with a different kind, you might want to reconfigure. For example, to change to a 0.1 mm bucket (bucket code 2 ), use the following: weectl device --set-bucket=2","title":"--set-bucket"},{"location":"hardware/vantage/#-set-rain-year-start","text":"The Davis Vantage series allows the start of the rain year to be something other than 1 January. For example, to set it to 1 October: weectl device --set-rain-year-start=10","title":"--set-rain-year-start"},{"location":"hardware/vantage/#vantage_setting_offsets","text":"The Davis instruments can correct sensor errors by adding an offset to their emitted values. This is particularly useful for Southern Hemisphere users. Davis fits the wind vane to the Integrated Sensor Suite (ISS) in a position optimized for Northern Hemisphere users, who face the solar panel to the south. Users south of the equator must orient the ISS's solar panel to the north to get maximal insolation, resulting in a 180\u00b0 error in the wind direction. The solution is to add a 180\u00b0 offset correction. You can do this with the following command: weectl device --set-offset=windDir,180","title":"--set-offset"},{"location":"hardware/vantage/#vantage_configuring_additional_sensors","text":"If you have additional sensors and/or repeaters for your Vantage station, you can configure them using your console. However, if you have a Davis Weather Envoy , it will not have a console! As an alternative, weectl device can do this using the command --set-transmitter-type . For example, to add an extra temperature sensor to channel 3 and no repeater is used, do the following: weectl device --set-transmitter-type=3,1,2 This says to turn on channel 3, set its type to 1 (\"Temperature only\"), and it will show up in the database as extraTemp2 . No repeater id was specified, so it defaults to \"no repeater.\" Here's another example, this time for a combined temperature / humidity sensor retransmitted via repeater A: weectl device --set-transmitter-type=5,3,2,4,a This will add the combined sensor to channel 5, set its type to 3 (\"Temperature and humidity\"), via Repeater A, and it will show up in the database as extraTemp2 and extraHumid4 . The --help option will give you the code for each sensor type and repeater id. If you have to use repeaters with your Vantage Pro2 station, please take a look at Installing Repeater Networks for Vantage Pro2 for how to set them up.","title":"--set-transmitter-type"},{"location":"hardware/vantage/#vantage_retransmit","text":"Use this command to tell your console whether to act as a retransmitter of ISS data. Example: Tell your console to retransmit ISS data using the first available channel: weectl device --set-retransmit=on Example: Tell your console to retransmit ISS data on channel 4: weectl device --set-retransmit=on,4 Warning You can use only channels not actively used for reception. The command checks for this and will not accept channel numbers actively used for reception of sensor stations. Example: Tell your console to turn retransmission 'OFF': weectl device --set-retransmit=off","title":"--set-retransmit"},{"location":"hardware/vantage/#-set-dst","text":"Use the command to tell your console whether daylight savings time is in effect, or to have it set automatically based on the time zone.","title":"--set-dst"},{"location":"hardware/vantage/#vantage_time_zone","text":"This command can be used to change the time zone. Consult the Vantage manual for the code that corresponds to your time zone. For example, to set the time zone code to Central European Time (code 20): weectl device --set-tz-code=20 Warning You can set either the time zone code or the time zone offset, but not both.","title":"--set-tz-code"},{"location":"hardware/vantage/#-set-tz-offset","text":"If you live in an odd time zone that is perhaps not covered by the \"canned\" Davis time zones, you can set the offset from UTC using this command. For example, to set the time zone offset for Newfoundland Standard Time (UTC-03:30), use the following: weectl device --set-tz-offset=-0330 Warning You can set either the time zone code or the time zone offset, but not both.","title":"--set-tz-offset"},{"location":"hardware/vantage/#-set-lamp","text":"Use this command to turn the console lamp on or off.","title":"--set-lamp"},{"location":"hardware/vantage/#vantage_dumping_the_logger_memory","text":"Generally, WeeWX downloads only new archive records from the on-board logger in the Vantage. However, occasionally the memory in the Vantage will get corrupted, making this impossible. See the section WeeWX generates HTML pages, but it does not update them in the Wiki. The fix involves clearing the memory but, unfortunately, this means you may lose any data which might have accumulated in the logger memory, but not yet downloaded. By using the --dump command before clearing the memory, you might be able to save these data. Stop WeeWX first, then weectl device --dump This will dump all data archived in the Vantage memory directly to the database, without regard to whether or not they have been seen before. Because the command dumps all data, it may result in many duplicate primary key errors. These can be ignored.","title":"--dump"},{"location":"hardware/vantage/#-logger-summary","text":"This command is useful for debugging the console logger. It will scan the logger memory, recording the timestamp in each page and index slot to the file FILE . Example: weectl device --logger-summary=/var/tmp/summary.txt","title":"--logger-summary"},{"location":"hardware/vantage/#-start","text":"Use this command to start the logger. There are occasions when an out-of-the-box logger needs this command.","title":"--start"},{"location":"hardware/vantage/#-stop","text":"Use this command to stop the logger. This can be useful when servicing your weather station, and you don't want any bad data to be stored in the logger.","title":"--stop"},{"location":"hardware/vantage/#vantage_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. Vantage station data Database Field Observation Loop Archive barometer barometer H H pressure S S altimeter S S inTemp inTemp H H outTemp outTemp H H inHumidity inHumidity H H outHumidity outHumidity H H windSpeed windSpeed H H windDir windDir H H windGust windGust H H windGustDir windGustDir H H rain rain D H monthRain H H rainRate rainRate H H dewpoint S S windchill S S heatindex S S radiation radiation H H UV UV H H extraTemp1 extraTemp1 H H extraTemp2 extraTemp2 H H extraTemp3 extraTemp3 H H extraTemp4 extraTemp4 H extraTemp5 extraTemp5 H extraTemp6 extraTemp6 H extraTemp7 extraTemp7 H soilTemp1 soilTemp1 H H soilTemp2 soilTemp2 H H soilTemp3 soilTemp3 H H soilTemp4 soilTemp4 H H leafTemp1 leafTemp1 H H leafTemp2 leafTemp2 H H leafTemp3 leafTemp3 H H leafTemp4 leafTemp4 H H extraHumid1 extraHumid1 H H extraHumid2 extraHumid2 H H extraHumid3 extraHumid3 H extraHumid4 extraHumid4 H extraHumid5 extraHumid5 H extraHumid6 extraHumid6 H extraHumid7 extraHumid7 H soilMoist1 soilMoist1 H H soilMoist2 soilMoist2 H H soilMoist3 soilMoist3 H H soilMoist4 soilMoist4 H H leafWet1 leafWet1 H H leafWet2 leafWet2 H H leafWet3 leafWet3 H H leafWet4 leafWet4 H H txBatteryStatus txBatteryStatus H H consBatteryVoltage consBatteryVoltage H H wind_samples H H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"hardware/wmr100/","text":"WMR100 \u00b6 The station emits partial packets, which may confuse some online services. Configuring with weectl device \u00b6 The WMR100 stations cannot be configured with the utility weectl device . Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WMR100 station data Database Field Observation Loop Archive barometer S pressure pressure H altimeter S inTemp temperature_0 H outTemp temperature_1 H inHumidity humidity_0 H outHumidity humidity_1 H windSpeed wind_speed H windDir wind_dir H windGust wind_gust H rain rain D rain_total H rainRate rain_rate H dewpoint S windchill S heatindex S extraTemp1 temperature_2 H extraTemp2 temperature_3 H extraTemp3 temperature_4 H extraTemp4 temperature_5 H extraTemp5 temperature_6 H extraTemp6 temperature_7 H extraTemp7 temperature_8 H extraHumid1 humidity_2 H extraHumid2 humidity_3 H extraHumid3 humidity_4 H extraHumid4 humidity_5 H extraHumid5 humidity_6 H extraHumid6 humidity_7 H extraHumid7 humidity_8 H UV uv H inTempBatteryStatus battery_status_0 H outTempBatteryStatus battery_status_1 H rainBatteryStatus rain_battery_status H windBatteryStatus wind_battery_status H uvBatteryStatus uv_battery_status H extraBatteryStatus1 battery_status_2 H extraBatteryStatus2 battery_status_3 H extraBatteryStatus3 battery_status_4 H extraBatteryStatus4 battery_status_5 H extraBatteryStatus5 battery_status_6 H extraBatteryStatus6 battery_status_7 H extraBatteryStatus7 battery_status_8 H Each packet contains a subset of all possible readings. For example, a temperature packet contains temperature_N and battery_status_N , a rain packet contains rain_total and rain_rate . H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"WMR100"},{"location":"hardware/wmr100/#wmr100_notes","text":"The station emits partial packets, which may confuse some online services.","title":"WMR100"},{"location":"hardware/wmr100/#wmr100_configuration","text":"The WMR100 stations cannot be configured with the utility weectl device .","title":"Configuring with weectl device"},{"location":"hardware/wmr100/#wmr100_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WMR100 station data Database Field Observation Loop Archive barometer S pressure pressure H altimeter S inTemp temperature_0 H outTemp temperature_1 H inHumidity humidity_0 H outHumidity humidity_1 H windSpeed wind_speed H windDir wind_dir H windGust wind_gust H rain rain D rain_total H rainRate rain_rate H dewpoint S windchill S heatindex S extraTemp1 temperature_2 H extraTemp2 temperature_3 H extraTemp3 temperature_4 H extraTemp4 temperature_5 H extraTemp5 temperature_6 H extraTemp6 temperature_7 H extraTemp7 temperature_8 H extraHumid1 humidity_2 H extraHumid2 humidity_3 H extraHumid3 humidity_4 H extraHumid4 humidity_5 H extraHumid5 humidity_6 H extraHumid6 humidity_7 H extraHumid7 humidity_8 H UV uv H inTempBatteryStatus battery_status_0 H outTempBatteryStatus battery_status_1 H rainBatteryStatus rain_battery_status H windBatteryStatus wind_battery_status H uvBatteryStatus uv_battery_status H extraBatteryStatus1 battery_status_2 H extraBatteryStatus2 battery_status_3 H extraBatteryStatus3 battery_status_4 H extraBatteryStatus4 battery_status_5 H extraBatteryStatus5 battery_status_6 H extraBatteryStatus6 battery_status_7 H extraBatteryStatus7 battery_status_8 H Each packet contains a subset of all possible readings. For example, a temperature packet contains temperature_N and battery_status_N , a rain packet contains rain_total and rain_rate . H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"hardware/wmr300/","text":"WMR300 \u00b6 A single WMR300 console supports 1 wind, 1 rain, 1 UV, and up to 8 temperature/humidity sensors. The WMR300 sensors send at different rates: WMR300 transmission periods sensor period Wind 2.5 to 3 seconds T/H 10 to 12 seconds Rain 20 to 24 seconds The console contains the pressure sensor. The console reports pressure every 15 minutes. The station emits partial packets, which may confuse some online services. The rain counter has a limit of 400 inches (10160 mm). The counter does not wrap around; it must be reset when it hits the limit, otherwise additional rain data will not be recorded. The logger stores about 50,000 records. When the logger fills up, it stops recording data. When WeeWX starts up it will attempt to download all records from the console since the last record in the archive database. This can take as much as couple of hours, depending on the number of records in the logger and the speed of the computer and disk. Configuring with weectl device \u00b6 The WMR300 stations cannot be configured with the utility weectl device . Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WMR300 station data Database Field Observation Loop Archive barometer barometer H H pressure pressure H S altimeter S S inTemp temperature_0 H H inHumidity humidity_0 H H windSpeed wind_avg H H windDir wind_dir H H windGust wind_gust H H windGustDir wind_gust_dir H H rain rain D D rain_total H H rainRate rain_rate H H outTemp temperature_1 H H outHumidity humidity_1 H H dewpoint dewpoint_1 H H heatindex heatindex_1 H H windchill windchill H H extraTemp1 temperature_2 H H extraHumid1 humidity_2 H H extraDewpoint1 dewpoint_2 H H extraHeatindex1 heatindex_2 H H extraTemp2 temperature_3 H H extraHumid2 humidity_3 H H extraDewpoint2 dewpoint_3 H H extraHeatindex2 heatindex_3 H H extraTemp3 temperature_4 H H extraHumid3 humidity_4 H H extraDewpoint3 dewpoint_4 H H extraHeatindex3 heatindex_4 H H extraTemp4 temperature_5 H H extraHumid4 humidity_5 H H extraDewpoint4 dewpoint_5 H H extraHeatindex4 heatindex_5 H H extraTemp5 temperature_6 H H extraHumid5 humidity_6 H H extraDewpoint5 dewpoint_6 H H extraHeatindex5 heatindex_6 H H extraTemp6 temperature_7 H H extraHumid6 humidity_7 H H extraDewpoint6 dewpoint_7 H H extraHeatindex6 heatindex_7 H H extraTemp7 temperature_8 H H extraHumid7 humidity_8 H H extraDewpoint7 dewpoint_8 H H extraHeatindex7 heatindex_8 H H Each packet contains a subset of all possible readings. H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"WMR300"},{"location":"hardware/wmr300/#wmr300_notes","text":"A single WMR300 console supports 1 wind, 1 rain, 1 UV, and up to 8 temperature/humidity sensors. The WMR300 sensors send at different rates: WMR300 transmission periods sensor period Wind 2.5 to 3 seconds T/H 10 to 12 seconds Rain 20 to 24 seconds The console contains the pressure sensor. The console reports pressure every 15 minutes. The station emits partial packets, which may confuse some online services. The rain counter has a limit of 400 inches (10160 mm). The counter does not wrap around; it must be reset when it hits the limit, otherwise additional rain data will not be recorded. The logger stores about 50,000 records. When the logger fills up, it stops recording data. When WeeWX starts up it will attempt to download all records from the console since the last record in the archive database. This can take as much as couple of hours, depending on the number of records in the logger and the speed of the computer and disk.","title":"WMR300"},{"location":"hardware/wmr300/#wrm300_configuration","text":"The WMR300 stations cannot be configured with the utility weectl device .","title":"Configuring with weectl device"},{"location":"hardware/wmr300/#wmr300_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WMR300 station data Database Field Observation Loop Archive barometer barometer H H pressure pressure H S altimeter S S inTemp temperature_0 H H inHumidity humidity_0 H H windSpeed wind_avg H H windDir wind_dir H H windGust wind_gust H H windGustDir wind_gust_dir H H rain rain D D rain_total H H rainRate rain_rate H H outTemp temperature_1 H H outHumidity humidity_1 H H dewpoint dewpoint_1 H H heatindex heatindex_1 H H windchill windchill H H extraTemp1 temperature_2 H H extraHumid1 humidity_2 H H extraDewpoint1 dewpoint_2 H H extraHeatindex1 heatindex_2 H H extraTemp2 temperature_3 H H extraHumid2 humidity_3 H H extraDewpoint2 dewpoint_3 H H extraHeatindex2 heatindex_3 H H extraTemp3 temperature_4 H H extraHumid3 humidity_4 H H extraDewpoint3 dewpoint_4 H H extraHeatindex3 heatindex_4 H H extraTemp4 temperature_5 H H extraHumid4 humidity_5 H H extraDewpoint4 dewpoint_5 H H extraHeatindex4 heatindex_5 H H extraTemp5 temperature_6 H H extraHumid5 humidity_6 H H extraDewpoint5 dewpoint_6 H H extraHeatindex5 heatindex_6 H H extraTemp6 temperature_7 H H extraHumid6 humidity_7 H H extraDewpoint6 dewpoint_7 H H extraHeatindex6 heatindex_7 H H extraTemp7 temperature_8 H H extraHumid7 humidity_8 H H extraDewpoint7 dewpoint_8 H H extraHeatindex7 heatindex_8 H H Each packet contains a subset of all possible readings. H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"hardware/wmr9x8/","text":"WMR9x8 \u00b6 The station includes a data logger, but the driver does not read records from the station. The station emits partial packets, which may confuse some online services. Configuring with weectl device \u00b6 The WMR9x8 stations cannot be configured with the utility weectl device . Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WMR9x8 station data Database Field Observation Loop Archive barometer barometer H pressure pressure H altimeter S inTemp temperature_in H outTemp temperature_out H inHumidity humidity_in H outHumidity humidity_out H windSpeed wind_speed H windDir wind_dir H windGust wind_gust H windGustDir wind_gust_dir H rain rain D rain_total H rainRate rain_rate H inDewpoint dewpoint_in H dewpoint dewpoint_out H windchill windchill H heatindex S UV uv H extraTemp1 temperature_1 H extraTemp2 temperature_2 H extraTemp3 temperature_3 H extraTemp4 temperature_4 H extraTemp5 temperature_5 H extraTemp6 temperature_6 H extraTemp7 temperature_7 H extraTemp8 temperature_8 H extraHumid1 humidity_1 H extraHumid2 humidity_3 H extraHumid3 humidity_3 H extraHumid4 humidity_4 H extraHumid5 humidity_5 H extraHumid6 humidity_6 H extraHumid7 humidity_7 H extraHumid8 humidity_8 H inTempBatteryStatus battery_status_in H outTempBatteryStatus battery_status_out H rainBatteryStatus rain_battery_status H windBatteryStatus wind_battery_status H extraBatteryStatus1 battery_status_1 H extraBatteryStatus2 battery_status_2 H extraBatteryStatus3 battery_status_3 H extraBatteryStatus4 battery_status_4 H extraBatteryStatus5 battery_status_5 H extraBatteryStatus6 battery_status_6 H extraBatteryStatus7 battery_status_7 H extraBatteryStatus8 battery_status_8 H Each packet contains a subset of all possible readings. For example, a temperature packet contains temperature_N and battery_status_N , a rain packet contains rain_total and rain_rate . H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"WMR9x8"},{"location":"hardware/wmr9x8/#wmr9x8_notes","text":"The station includes a data logger, but the driver does not read records from the station. The station emits partial packets, which may confuse some online services.","title":"WMR9x8"},{"location":"hardware/wmr9x8/#wmr9x8_configuration","text":"The WMR9x8 stations cannot be configured with the utility weectl device .","title":"Configuring with weectl device"},{"location":"hardware/wmr9x8/#wmr9x8_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WMR9x8 station data Database Field Observation Loop Archive barometer barometer H pressure pressure H altimeter S inTemp temperature_in H outTemp temperature_out H inHumidity humidity_in H outHumidity humidity_out H windSpeed wind_speed H windDir wind_dir H windGust wind_gust H windGustDir wind_gust_dir H rain rain D rain_total H rainRate rain_rate H inDewpoint dewpoint_in H dewpoint dewpoint_out H windchill windchill H heatindex S UV uv H extraTemp1 temperature_1 H extraTemp2 temperature_2 H extraTemp3 temperature_3 H extraTemp4 temperature_4 H extraTemp5 temperature_5 H extraTemp6 temperature_6 H extraTemp7 temperature_7 H extraTemp8 temperature_8 H extraHumid1 humidity_1 H extraHumid2 humidity_3 H extraHumid3 humidity_3 H extraHumid4 humidity_4 H extraHumid5 humidity_5 H extraHumid6 humidity_6 H extraHumid7 humidity_7 H extraHumid8 humidity_8 H inTempBatteryStatus battery_status_in H outTempBatteryStatus battery_status_out H rainBatteryStatus rain_battery_status H windBatteryStatus wind_battery_status H extraBatteryStatus1 battery_status_1 H extraBatteryStatus2 battery_status_2 H extraBatteryStatus3 battery_status_3 H extraBatteryStatus4 battery_status_4 H extraBatteryStatus5 battery_status_5 H extraBatteryStatus6 battery_status_6 H extraBatteryStatus7 battery_status_7 H extraBatteryStatus8 battery_status_8 H Each packet contains a subset of all possible readings. For example, a temperature packet contains temperature_N and battery_status_N , a rain packet contains rain_total and rain_rate . H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"hardware/ws1/","text":"WS1 \u00b6 The WS1 stations produce data every 1/2 second or so. Configuring with weectl device \u00b6 The WS1 stations cannot be configured with the utility weectl device . Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WS1 station data Database Field Observation Loop Archive barometer S pressure pressure H altimeter S inTemp temperature_in H outTemp temperature_out H inHumidity humidity_in H outHumidity humidity_out H windSpeed wind_speed H windDir wind_dir H rain rain D rain_total H rainRate S dewpoint S windchill S heatindex S H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"WS1"},{"location":"hardware/ws1/#ws1_notes","text":"The WS1 stations produce data every 1/2 second or so.","title":"WS1"},{"location":"hardware/ws1/#ws1_configuration","text":"The WS1 stations cannot be configured with the utility weectl device .","title":"Configuring with weectl device"},{"location":"hardware/ws1/#ws1_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WS1 station data Database Field Observation Loop Archive barometer S pressure pressure H altimeter S inTemp temperature_in H outTemp temperature_out H inHumidity humidity_in H outHumidity humidity_out H windSpeed wind_speed H windDir wind_dir H rain rain D rain_total H rainRate S dewpoint S windchill S heatindex S H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"hardware/ws23xx/","text":"WS23xx \u00b6 The hardware interface is a serial port, but USB-serial converters can be used with computers that have no serial port. Beware that not every type of USB-serial converter will work. Converters based on ATEN UC-232A chipset are known to work. The station does not record wind gust or wind gust direction. The hardware calculates windchill and dewpoint. Sensors can be connected to the console with a wire. If not wired, the sensors will communicate via a wireless interface. When connected by wire, some sensor data are transmitted every 8 seconds. With wireless, data are transmitted every 16 to 128 seconds, depending on wind speed and rain activity. WS23xx transmission periods sensor period Wind 32 seconds when wind > 22.36 mph (wireless) 128 seconds when wind > 22.36 mph (wireless) 10 minutes (wireless after 5 failed attempts) 8 seconds (wired) Temperature 15 seconds Humidity 20 seconds Pressure 15 seconds The station has 175 history records. That is just over 7 days of data with the factory default history recording interval of 60 minutes, or about 14 hours with a recording interval of 5 minutes. When WeeWX starts up it will attempt to download all records from the console since the last record in the archive database. Configuring with weectl device \u00b6 The WS23xx stations can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device . --help \u00b6 Invoking weectl device with the --help option weectl device --help will produce something like this: WS23xx driver version 0.21 Usage: weectl device [config_file] [options] [--debug] [--help] Configuration utility for weewx devices. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --info display weather station configuration --current get the current weather conditions --history=N display N history records --history-since=N display history records since N minutes ago --clear-memory clear station memory --set-time set the station clock to the current time --set-interval=N set the station archive interval to N minutes Mutating actions will request confirmation before proceeding. --info \u00b6 Display the station settings with the --info option. weectl device --info This will result in something like: buzzer: 0 connection time till connect: 1.5 connection type: 15 dew point: 8.88 dew point max: 18.26 dew point max alarm: 20.0 dew point max alarm active: 0 dew point max alarm set: 0 dew point max when: 978565200.0 dew point min: -2.88 dew point min alarm: 0.0 dew point min alarm active: 0 dew point min alarm set: 0 dew point min when: 978757260.0 forecast: 0 history interval: 5.0 history last record pointer: 8.0 history last sample when: 1385564760.0 history number of records: 175.0 history time till sample: 5.0 icon alarm active: 0 in humidity: 48.0 The line history number of records indicates how many records are in memory. The line history interval indicates the number of minutes between records. --set-interval \u00b6 WS23xx stations ship from the factory with an archive interval of 60 minutes (3600 seconds). To change the interval to 5 minutes, do the following: weectl device --set-interval=5 Warning Changing the interval will clear the station memory. --history \u00b6 WS23xx stations store records in a circular buffer \u2014 once the buffer fills, the oldest records are replaced by newer records. The console stores up to 175 records. For example, to display the latest 30 records from the console memory: weectl device --history=30 --clear-memory \u00b6 To clear the console memory: weectl device --clear-memory Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WS23xx station data Database Field Observation Loop Archive barometer S S pressure pressure H H altimeter S S inTemp temperature_in H H outTemp temperature_out H H inHumidity humidity_in H H outHumidity humidity_out H H windSpeed wind_speed H H windDir wind_dir H H rain rain D D rain_total H H rainRate rain_rate H H dewpoint dewpoint H H windchill windchill H H heatindex S S H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"WS23xx"},{"location":"hardware/ws23xx/#ws23xx_notes","text":"The hardware interface is a serial port, but USB-serial converters can be used with computers that have no serial port. Beware that not every type of USB-serial converter will work. Converters based on ATEN UC-232A chipset are known to work. The station does not record wind gust or wind gust direction. The hardware calculates windchill and dewpoint. Sensors can be connected to the console with a wire. If not wired, the sensors will communicate via a wireless interface. When connected by wire, some sensor data are transmitted every 8 seconds. With wireless, data are transmitted every 16 to 128 seconds, depending on wind speed and rain activity. WS23xx transmission periods sensor period Wind 32 seconds when wind > 22.36 mph (wireless) 128 seconds when wind > 22.36 mph (wireless) 10 minutes (wireless after 5 failed attempts) 8 seconds (wired) Temperature 15 seconds Humidity 20 seconds Pressure 15 seconds The station has 175 history records. That is just over 7 days of data with the factory default history recording interval of 60 minutes, or about 14 hours with a recording interval of 5 minutes. When WeeWX starts up it will attempt to download all records from the console since the last record in the archive database.","title":"WS23xx"},{"location":"hardware/ws23xx/#ws23xx_configuration","text":"The WS23xx stations can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device .","title":"Configuring with weectl device"},{"location":"hardware/ws23xx/#ws23xx_help","text":"Invoking weectl device with the --help option weectl device --help will produce something like this: WS23xx driver version 0.21 Usage: weectl device [config_file] [options] [--debug] [--help] Configuration utility for weewx devices. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --info display weather station configuration --current get the current weather conditions --history=N display N history records --history-since=N display history records since N minutes ago --clear-memory clear station memory --set-time set the station clock to the current time --set-interval=N set the station archive interval to N minutes Mutating actions will request confirmation before proceeding.","title":"--help"},{"location":"hardware/ws23xx/#ws23xx_info","text":"Display the station settings with the --info option. weectl device --info This will result in something like: buzzer: 0 connection time till connect: 1.5 connection type: 15 dew point: 8.88 dew point max: 18.26 dew point max alarm: 20.0 dew point max alarm active: 0 dew point max alarm set: 0 dew point max when: 978565200.0 dew point min: -2.88 dew point min alarm: 0.0 dew point min alarm active: 0 dew point min alarm set: 0 dew point min when: 978757260.0 forecast: 0 history interval: 5.0 history last record pointer: 8.0 history last sample when: 1385564760.0 history number of records: 175.0 history time till sample: 5.0 icon alarm active: 0 in humidity: 48.0 The line history number of records indicates how many records are in memory. The line history interval indicates the number of minutes between records.","title":"--info"},{"location":"hardware/ws23xx/#ws23xx_set_interval","text":"WS23xx stations ship from the factory with an archive interval of 60 minutes (3600 seconds). To change the interval to 5 minutes, do the following: weectl device --set-interval=5 Warning Changing the interval will clear the station memory.","title":"--set-interval"},{"location":"hardware/ws23xx/#ws23xx_history","text":"WS23xx stations store records in a circular buffer \u2014 once the buffer fills, the oldest records are replaced by newer records. The console stores up to 175 records. For example, to display the latest 30 records from the console memory: weectl device --history=30","title":"--history"},{"location":"hardware/ws23xx/#ws23xx_clear_memory","text":"To clear the console memory: weectl device --clear-memory","title":"--clear-memory"},{"location":"hardware/ws23xx/#ws23xx_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WS23xx station data Database Field Observation Loop Archive barometer S S pressure pressure H H altimeter S S inTemp temperature_in H H outTemp temperature_out H H inHumidity humidity_in H H outHumidity humidity_out H H windSpeed wind_speed H H windDir wind_dir H H rain rain D D rain_total H H rainRate rain_rate H H dewpoint dewpoint H H windchill windchill H H heatindex S S H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"hardware/ws28xx/","text":"WS28xx \u00b6 WeeWX communicates with a USB transceiver, which communicates with the station console, which in turn communicates with the sensors. The transceiver and console must be paired and synchronized. The sensors send data at different rates: WS28xx transmission periods sensor period Wind 17 seconds T/H 13 seconds Rain 19 seconds Pressure 15 seconds The wind and rain sensors transmit to the temperature/humidity device, then the temperature/humidity device retransmits to the weather station console. Pressure is measured by a sensor in the console. The station has 1797 history records. That is just over 6 days of data with an archive interval of 5 minutes. When WeeWX starts up it will attempt to download all records from the console since the last record in the archive database. The WS28xx driver sets the station archive interval to 5 minutes. The WS28xx driver does not support hardware archive record generation. Pairing \u00b6 The console and transceiver must be paired. Pairing ensures that your transceiver is talking to your console, not your neighbor's console. Pairing should only have to be done once, although you might have to pair again after power cycling the console, for example after you replace the batteries. There are two ways to pair the console and the transceiver: The WeeWX way. Be sure that WeeWX is not running. Run the configuration utility, press and hold the [v] button on the console until you see 'PC' in the display, then release the button. If the console pairs with the transceiver, 'PC' will go away within a second or two. weectl device --pair Pairing transceiver with console... Press and hold the [v] key until \"PC\" appears (attempt 1 of 3) Transceiver is paired to console The HeavyWeather way. Follow the pairing instructions that came with the station. You will have to run HeavyWeather on a Windows computer with the USB transceiver. After HeavyWeather indicates the devices are paired, put the USB transceiver in your WeeWX computer and start WeeWX. Do not power cycle the station console, or you will have to start over. If the console does not pair, you will see messages in the log such as this: ws28xx: RFComm: message from console contains unknown device ID (id=165a resp=80 req=6) Either approach to pairing may require multiple attempts. Synchronizing \u00b6 After pairing, the transceiver and console must be synchronized in order to communicate. Synchronization will happen automatically at the top of each hour, or you can force synchronization by pressing the [SET] button momentarily. Do not press and hold the [SET] button \u2014 that modifies the console alarms. When the transceiver and console are synchronized, you will see lots of ws28xx: RFComm messages in the log when debug=1 . When the devices are not synchronized, you will see messages like this about every 10 minutes: Nov 7 19:12:17 raspi weewx[2335]: ws28xx: MainThread: no contact with console If you see this, or if you see an extended gap in the weather data in the WeeWX plots, press momentarily the [SET] button, or wait until the top of the hour. When the transceiver has not received new data for awhile, you will see messages like this in the log: Nov 7 19:12:17 raspi weewx[2335]: ws28xx: MainThread: no new weather data If you see 'no new weather data' messages with the 'no contact with console' messages, it simply means that the transceiver has not been able to synchronize with the console. If you see only the 'no new weather data' messages, then the sensors are not communicating with the console, or the console may be defective. Alarms \u00b6 When an alarm goes off, communication with the transceiver stops. The WS28xx driver clears all alarms in the station. It is better to create alarms in WeeWX, and the WeeWX alarms can do much more than the console alarms anyway. Configuring with weectl device \u00b6 The WS28xx stations can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device . --help \u00b6 Invoking weectl device with the --help option weectl device --help will produce something like this: WS28xx driver version 0.33 Usage: weectl device [config_file] [options] [--debug] [--help] Configuration utility for weewx devices. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --check-transceiver check USB transceiver --pair pair the USB transceiver with station console --info display weather station configuration --set-interval=N set logging interval to N minutes --current get the current weather conditions --history=N display N history records --history-since=N display history records since N minutes ago --maxtries=MAXTRIES maximum number of retries, 0 indicates no max Mutating actions will request confirmation before proceeding. --pair \u00b6 The console and transceiver must be paired. This can be done either by using this command, or by running the program HeavyWeather on a Windows PC. Be sure that WeeWX is not running. Run the command: weectl device --pair Pairing transceiver with console... Press and hold the [v] key until \"PC\" appears (attempt 1 of 3) Transceiver is paired to console Press and hold the [v] button on the console until you see 'PC' in the display, then release the button. If the console pairs with the transceiver, 'PC' will go away within a second or two. If the console does not pair, you will see messages in the log such as this: ws28xx: RFComm: message from console contains unknown device ID (id=165a resp=80 req=6) Pairing may require multiple attempts. After pairing, the transceiver and console must be synchronized in order to communicate. This should happen automatically. --info \u00b6 Display the station settings with the --info option. weectl device --info This will result in something like: alarm_flags_other: 0 alarm_flags_wind_dir: 0 checksum_in: 1327 checksum_out: 1327 format_clock: 1 format_pressure: 0 format_rain: 1 format_temperature: 0 format_windspeed: 4 history_interval: 1 indoor_humidity_max: 70 indoor_humidity_max_time: None indoor_humidity_min: 45 indoor_humidity_min_time: None indoor_temp_max: 40.0 indoor_temp_max_time: None indoor_temp_min: 0.0 indoor_temp_min_time: None lcd_contrast: 4 low_battery_flags: 0 outdoor_humidity_max: 70 outdoor_humidity_max_time: None outdoor_humidity_min: 45 outdoor_humidity_min_time: None outdoor_temp_max: 40.0 outdoor_temp_max_time: None outdoor_temp_min: 0.0 outdoor_temp_min_time: None pressure_max: 1040.0 pressure_max_time: None pressure_min: 960.0 pressure_min_time: None rain_24h_max: 50.0 rain_24h_max_time: None threshold_storm: 5 threshold_weather: 3 wind_gust_max: 12.874765625 wind_gust_max_time: None Station data \u00b6 The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WS28xx station data Database Field Observation Loop Archive barometer S S pressure pressure H H altimeter S S inTemp temperature_in H H outTemp temperature_out H H inHumidity humidity_in H H outHumidity humidity_out H H windSpeed wind_speed H H windDir wind_dir H H windGust wind_gust H H windGustDir wind_gust_dir H H rain rain D D rain_total H H rainRate rain_rate H dewpoint S S windchill windchill H H heatindex heatindex H H rxCheckPercent rssi H windBatteryStatus wind_battery_status H rainBatteryStatus rain_battery_status H outTempBatteryStatus battery_status_out H inTempBatteryStatus battery_status_in H H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"WS28xx"},{"location":"hardware/ws28xx/#ws28xx_notes","text":"WeeWX communicates with a USB transceiver, which communicates with the station console, which in turn communicates with the sensors. The transceiver and console must be paired and synchronized. The sensors send data at different rates: WS28xx transmission periods sensor period Wind 17 seconds T/H 13 seconds Rain 19 seconds Pressure 15 seconds The wind and rain sensors transmit to the temperature/humidity device, then the temperature/humidity device retransmits to the weather station console. Pressure is measured by a sensor in the console. The station has 1797 history records. That is just over 6 days of data with an archive interval of 5 minutes. When WeeWX starts up it will attempt to download all records from the console since the last record in the archive database. The WS28xx driver sets the station archive interval to 5 minutes. The WS28xx driver does not support hardware archive record generation.","title":"WS28xx"},{"location":"hardware/ws28xx/#ws28xx_pairing","text":"The console and transceiver must be paired. Pairing ensures that your transceiver is talking to your console, not your neighbor's console. Pairing should only have to be done once, although you might have to pair again after power cycling the console, for example after you replace the batteries. There are two ways to pair the console and the transceiver: The WeeWX way. Be sure that WeeWX is not running. Run the configuration utility, press and hold the [v] button on the console until you see 'PC' in the display, then release the button. If the console pairs with the transceiver, 'PC' will go away within a second or two. weectl device --pair Pairing transceiver with console... Press and hold the [v] key until \"PC\" appears (attempt 1 of 3) Transceiver is paired to console The HeavyWeather way. Follow the pairing instructions that came with the station. You will have to run HeavyWeather on a Windows computer with the USB transceiver. After HeavyWeather indicates the devices are paired, put the USB transceiver in your WeeWX computer and start WeeWX. Do not power cycle the station console, or you will have to start over. If the console does not pair, you will see messages in the log such as this: ws28xx: RFComm: message from console contains unknown device ID (id=165a resp=80 req=6) Either approach to pairing may require multiple attempts.","title":"Pairing"},{"location":"hardware/ws28xx/#ws28xx_synchronizing","text":"After pairing, the transceiver and console must be synchronized in order to communicate. Synchronization will happen automatically at the top of each hour, or you can force synchronization by pressing the [SET] button momentarily. Do not press and hold the [SET] button \u2014 that modifies the console alarms. When the transceiver and console are synchronized, you will see lots of ws28xx: RFComm messages in the log when debug=1 . When the devices are not synchronized, you will see messages like this about every 10 minutes: Nov 7 19:12:17 raspi weewx[2335]: ws28xx: MainThread: no contact with console If you see this, or if you see an extended gap in the weather data in the WeeWX plots, press momentarily the [SET] button, or wait until the top of the hour. When the transceiver has not received new data for awhile, you will see messages like this in the log: Nov 7 19:12:17 raspi weewx[2335]: ws28xx: MainThread: no new weather data If you see 'no new weather data' messages with the 'no contact with console' messages, it simply means that the transceiver has not been able to synchronize with the console. If you see only the 'no new weather data' messages, then the sensors are not communicating with the console, or the console may be defective.","title":"Synchronizing"},{"location":"hardware/ws28xx/#ws28xx_alarms","text":"When an alarm goes off, communication with the transceiver stops. The WS28xx driver clears all alarms in the station. It is better to create alarms in WeeWX, and the WeeWX alarms can do much more than the console alarms anyway.","title":"Alarms"},{"location":"hardware/ws28xx/#ws28xx_configuration","text":"The WS28xx stations can be configured with the utility weectl device . Note Make sure you stop weewxd before running weectl device .","title":"Configuring with weectl device"},{"location":"hardware/ws28xx/#ws28xx_help","text":"Invoking weectl device with the --help option weectl device --help will produce something like this: WS28xx driver version 0.33 Usage: weectl device [config_file] [options] [--debug] [--help] Configuration utility for weewx devices. Options: -h, --help show this help message and exit --debug display diagnostic information while running -y answer yes to every prompt --check-transceiver check USB transceiver --pair pair the USB transceiver with station console --info display weather station configuration --set-interval=N set logging interval to N minutes --current get the current weather conditions --history=N display N history records --history-since=N display history records since N minutes ago --maxtries=MAXTRIES maximum number of retries, 0 indicates no max Mutating actions will request confirmation before proceeding.","title":"--help"},{"location":"hardware/ws28xx/#-pair","text":"The console and transceiver must be paired. This can be done either by using this command, or by running the program HeavyWeather on a Windows PC. Be sure that WeeWX is not running. Run the command: weectl device --pair Pairing transceiver with console... Press and hold the [v] key until \"PC\" appears (attempt 1 of 3) Transceiver is paired to console Press and hold the [v] button on the console until you see 'PC' in the display, then release the button. If the console pairs with the transceiver, 'PC' will go away within a second or two. If the console does not pair, you will see messages in the log such as this: ws28xx: RFComm: message from console contains unknown device ID (id=165a resp=80 req=6) Pairing may require multiple attempts. After pairing, the transceiver and console must be synchronized in order to communicate. This should happen automatically.","title":"--pair"},{"location":"hardware/ws28xx/#-info","text":"Display the station settings with the --info option. weectl device --info This will result in something like: alarm_flags_other: 0 alarm_flags_wind_dir: 0 checksum_in: 1327 checksum_out: 1327 format_clock: 1 format_pressure: 0 format_rain: 1 format_temperature: 0 format_windspeed: 4 history_interval: 1 indoor_humidity_max: 70 indoor_humidity_max_time: None indoor_humidity_min: 45 indoor_humidity_min_time: None indoor_temp_max: 40.0 indoor_temp_max_time: None indoor_temp_min: 0.0 indoor_temp_min_time: None lcd_contrast: 4 low_battery_flags: 0 outdoor_humidity_max: 70 outdoor_humidity_max_time: None outdoor_humidity_min: 45 outdoor_humidity_min_time: None outdoor_temp_max: 40.0 outdoor_temp_max_time: None outdoor_temp_min: 0.0 outdoor_temp_min_time: None pressure_max: 1040.0 pressure_max_time: None pressure_min: 960.0 pressure_min_time: None rain_24h_max: 50.0 rain_24h_max_time: None threshold_storm: 5 threshold_weather: 3 wind_gust_max: 12.874765625 wind_gust_max_time: None","title":"--info"},{"location":"hardware/ws28xx/#ws28xx_data","text":"The following table shows which data are provided by the station hardware and which are calculated by WeeWX. WS28xx station data Database Field Observation Loop Archive barometer S S pressure pressure H H altimeter S S inTemp temperature_in H H outTemp temperature_out H H inHumidity humidity_in H H outHumidity humidity_out H H windSpeed wind_speed H H windDir wind_dir H H windGust wind_gust H H windGustDir wind_gust_dir H H rain rain D D rain_total H H rainRate rain_rate H dewpoint S S windchill windchill H H heatindex heatindex H H rxCheckPercent rssi H windBatteryStatus wind_battery_status H rainBatteryStatus rain_battery_status H outTempBatteryStatus battery_status_out H inTempBatteryStatus battery_status_in H H indicates data provided by H ardware D indicates data calculated by the D river S indicates data calculated by the StdWXCalculate S ervice","title":"Station data"},{"location":"quickstarts/","text":"Quickstarts \u00b6 If you're an old hand at installing software on Unix systems, you may be able to use one of our Quickstart guides : Debian - including Ubuntu, Mint, Raspberry Pi OS, Devuan. Uses apt . Redhat - including Fedora, CentOS, Rocky. Uses yum . SUSE - including openSUSE. Uses zypper . pip - any operating system. Uses pip git - any operating system. Run directly from repository.","title":"Quickstarts"},{"location":"quickstarts/#quickstarts","text":"If you're an old hand at installing software on Unix systems, you may be able to use one of our Quickstart guides : Debian - including Ubuntu, Mint, Raspberry Pi OS, Devuan. Uses apt . Redhat - including Fedora, CentOS, Rocky. Uses yum . SUSE - including openSUSE. Uses zypper . pip - any operating system. Uses pip git - any operating system. Run directly from repository.","title":"Quickstarts"},{"location":"quickstarts/debian/","text":"Installation on Debian systems \u00b6 This is a guide to installing WeeWX from a DEB package on systems based on Debian, including Ubuntu, Mint, and Raspberry Pi OS. WeeWX V5 requires Python 3.7 or greater, which is only available on Debian 10 or later. For older systems, either use WeeWX V4, or install Python 3.7 then install WeeWX V5 using pip . Configure apt \u00b6 The first time you install WeeWX, you must configure apt so that it will trust weewx.com, and know where to find the WeeWX releases. Tell your system to trust weewx.com. wget -qO - https://weewx.com/keys.html | \\ sudo gpg --dearmor --output /etc/apt/trusted.gpg.d/weewx.gpg Tell apt where to find the WeeWX repository. echo \"deb [arch=all] https://weewx.com/apt/python3 buster main\" | \\ sudo tee /etc/apt/sources.list.d/weewx.list If you encounter errors, please consult the FAQ . Install \u00b6 Use apt to install WeeWX. The installer will prompt for a location, latitude/longitude, altitude, station type, and parameters specific to your station hardware. When you are done, WeeWX will be running in the background as a daemon. sudo apt update sudo apt install weewx Verify \u00b6 After about 5 minutes (the exact length of time depends on your archive interval), copy the following and paste into a web browser: /var/www/html/weewx/index.html You should see your station information and data. Check the system log /var/log/syslog for problems. Configure \u00b6 If you chose the simulator as your station type, then at some point you will probably want to switch to using real hardware. This is how to reconfigure. # Stop the daemon sudo systemctl stop weewx # Reconfigure to use your hardware sudo weectl station reconfigure # Delete the old database sudo rm /var/lib/weewx/weewx.sdb # Start the daemon sudo systemctl start weewx Customize \u00b6 To enable uploads or to customize reports, modify the configuration file. See the Customization Guide for instructions, and the application and skin references for all the options. Use any text editor, such as nano : sudo nano /etc/weewx/weewx.conf WeeWX must be restarted for the changes to take effect. sudo systemctl restart weewx Upgrade \u00b6 Upgrade to the latest version like this: sudo apt update sudo apt install weewx The upgrade process will not modify the WeeWX databases. Unmodified files will be upgraded. If modifications have been made to the WeeWX configuration, you will be prompted whether you want to keep the existing configuration or accept the new configuration. Either way, a copy of the option you did not choose will be saved. For example, if /etc/weewx/weewx.conf was modified, you will see a message something like this: Configuration file `/etc/weewx/weewx.conf' ==> Modified (by you or by a script) since installation. ==> Package distributor has shipped an updated version. What would you like to do about it ? Your options are: Y or I : install the package maintainer's version N or O : keep your currently-installed version D : show the differences between the versions Z : start a shell to examine the situation The default action is to keep your current version. *** weewx.conf (Y/I/N/O/D/Z) [default=N] ? Choosing Y or I (install the new version) will place your old configuration in /etc/weewx/weewx.conf.dpkg-old , where it can be compared with the new version in /etc/weewx/weewx.conf . Choosing N or O (keep the current version) will place the new configuration in /etc/weewx/weewx.conf.X.Y.Z , where X.Y.Z is the new version number. It can then be compared with your old version which will be in /etc/weewx/weewx.conf . Note In most cases you should choose N (the default). Uninstall \u00b6 To uninstall WeeWX, but retain configuration files and data: sudo apt remove weewx To uninstall WeeWX, deleting configuration files but retaining data: sudo apt purge weewx To delete data: sudo rm -r /var/lib/weewx sudo rm -r /var/www/html/weewx","title":"Debian"},{"location":"quickstarts/debian/#installation-on-debian-systems","text":"This is a guide to installing WeeWX from a DEB package on systems based on Debian, including Ubuntu, Mint, and Raspberry Pi OS. WeeWX V5 requires Python 3.7 or greater, which is only available on Debian 10 or later. For older systems, either use WeeWX V4, or install Python 3.7 then install WeeWX V5 using pip .","title":"Installation on Debian systems"},{"location":"quickstarts/debian/#configure-apt","text":"The first time you install WeeWX, you must configure apt so that it will trust weewx.com, and know where to find the WeeWX releases. Tell your system to trust weewx.com. wget -qO - https://weewx.com/keys.html | \\ sudo gpg --dearmor --output /etc/apt/trusted.gpg.d/weewx.gpg Tell apt where to find the WeeWX repository. echo \"deb [arch=all] https://weewx.com/apt/python3 buster main\" | \\ sudo tee /etc/apt/sources.list.d/weewx.list If you encounter errors, please consult the FAQ .","title":"Configure apt"},{"location":"quickstarts/debian/#install","text":"Use apt to install WeeWX. The installer will prompt for a location, latitude/longitude, altitude, station type, and parameters specific to your station hardware. When you are done, WeeWX will be running in the background as a daemon. sudo apt update sudo apt install weewx","title":"Install"},{"location":"quickstarts/debian/#verify","text":"After about 5 minutes (the exact length of time depends on your archive interval), copy the following and paste into a web browser: /var/www/html/weewx/index.html You should see your station information and data. Check the system log /var/log/syslog for problems.","title":"Verify"},{"location":"quickstarts/debian/#configure","text":"If you chose the simulator as your station type, then at some point you will probably want to switch to using real hardware. This is how to reconfigure. # Stop the daemon sudo systemctl stop weewx # Reconfigure to use your hardware sudo weectl station reconfigure # Delete the old database sudo rm /var/lib/weewx/weewx.sdb # Start the daemon sudo systemctl start weewx","title":"Configure"},{"location":"quickstarts/debian/#customize","text":"To enable uploads or to customize reports, modify the configuration file. See the Customization Guide for instructions, and the application and skin references for all the options. Use any text editor, such as nano : sudo nano /etc/weewx/weewx.conf WeeWX must be restarted for the changes to take effect. sudo systemctl restart weewx","title":"Customize"},{"location":"quickstarts/debian/#upgrade","text":"Upgrade to the latest version like this: sudo apt update sudo apt install weewx The upgrade process will not modify the WeeWX databases. Unmodified files will be upgraded. If modifications have been made to the WeeWX configuration, you will be prompted whether you want to keep the existing configuration or accept the new configuration. Either way, a copy of the option you did not choose will be saved. For example, if /etc/weewx/weewx.conf was modified, you will see a message something like this: Configuration file `/etc/weewx/weewx.conf' ==> Modified (by you or by a script) since installation. ==> Package distributor has shipped an updated version. What would you like to do about it ? Your options are: Y or I : install the package maintainer's version N or O : keep your currently-installed version D : show the differences between the versions Z : start a shell to examine the situation The default action is to keep your current version. *** weewx.conf (Y/I/N/O/D/Z) [default=N] ? Choosing Y or I (install the new version) will place your old configuration in /etc/weewx/weewx.conf.dpkg-old , where it can be compared with the new version in /etc/weewx/weewx.conf . Choosing N or O (keep the current version) will place the new configuration in /etc/weewx/weewx.conf.X.Y.Z , where X.Y.Z is the new version number. It can then be compared with your old version which will be in /etc/weewx/weewx.conf . Note In most cases you should choose N (the default).","title":"Upgrade"},{"location":"quickstarts/debian/#uninstall","text":"To uninstall WeeWX, but retain configuration files and data: sudo apt remove weewx To uninstall WeeWX, deleting configuration files but retaining data: sudo apt purge weewx To delete data: sudo rm -r /var/lib/weewx sudo rm -r /var/www/html/weewx","title":"Uninstall"},{"location":"quickstarts/git/","text":"Running WeeWX from a git repository \u00b6 Because WeeWX is pure-Python and does not need to be compiled, it can be run directly from a git repository without \"installing\" it first. This approach is perhaps most appropriate for developers, but it is also useful on older operating systems or on platforms with tight memory and/or storage constraints. This technique can also be used to run from a source directory expanded from a zip/tar file. Although you do not need root privileges to run WeeWX this way, you will need them to set up a daemon and, perhaps, to change device permissions. Install pre-requisites \u00b6 Before starting, you must install the pre-requisite Python and Python modules. Ensure that Python 3.7 or later is installed. Ensure that pip and venv are installed. Create and activate a virtual environment in your home directory: python3 -m venv ~/weewx-venv source ~/weewx-venv/bin/activate Install the minimum WeeWX dependencies: python3 -m pip install CT3 python3 -m pip install configobj python3 -m pip install Pillow Depending on your situation, you may want to install these additional dependencies: # If your hardware uses a serial port python3 -m pip install pyserial # If your hardware uses a USB port python3 -m pip install pyusb # If you want extended celestial information: python3 -m pip install ephem # If you use MySQL or Maria python3 -m pip install PyMySQL [ rsa ] Get the code \u00b6 Use git to clone the WeeWX repository into a directory called weewx in your home directory 1 : git clone https://github.com/weewx/weewx ~/weewx Note For systems with very little space, you may want to create a shallow clone: git clone --depth 1 https://github.com/weewx/weewx ~/weewx Provision a new station \u00b6 Now that you have the prerequisites and the WeeWX code, you can provision a new station: # If necessary, activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Provision a new station python3 ~/weewx/src/weectl.py station create The tool weectl will ask you a series of questions, then create a directory weewx-data in your home directory with a new configuration file. It will also install skins, documentation, utilitiy files, and examples in the same directory. The database and reports will also go into that directory, but only after you run weewxd , as shown in the following step. Run weewxd \u00b6 The program weewxd does the data collection, archiving, uploading, and report generation. You can run it directly, or as a daemon. When you run weewxd directly, it will print data to the screen. It will stop when you log out, or when you terminate it with control-c . # If necessary, activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Run weewxd python3 ~/weewx/src/weewxd.py To run weewxd as a daemon, install a systemd or init file that is appropriate for your operating system. Be sure to use the full path in the virtual environment to the Python interpreter and weewxd.py . Examples are included in the directory ~/weewx-data/util . Verify \u00b6 After about 5 minutes (the exact length of time depends on your archive interval), copy the following and paste into a web browser. You should see your station information and data. ~/weewx-data/public_html/index.html Note Not all browsers understand the tilde (\" ~ \") mark. You may have to substitute an explicit path to your home directory, for example, file:///home/jackhandy instead of ~ . If you have problems, check the system log for entries from weewxd . Customize \u00b6 To enable uploads or to customize reports, modify the configuration file. See the Customization Guide for instructions, and the application and skin references for all the options. nano ~/weewx-data/weewx.conf The executable weewxd must be restarted for the changes to take effect. Upgrade \u00b6 Update the code by pulling the latest: cd ~/weewx && git pull Then restart weewxd Uninstall \u00b6 Before you uninstall, be sure that weewxd is not running. Then simply delete the git clone: rm -rf ~/weewx If desired, delete the data directory: rm -r ~/weewx-data Of course, the directory you clone into does not have to be ~/weewx . It can be any directory. Just be sure to replace ~/weewx with your directory's path in the rest of the instructions. \u21a9","title":"git"},{"location":"quickstarts/git/#running-weewx-from-a-git-repository","text":"Because WeeWX is pure-Python and does not need to be compiled, it can be run directly from a git repository without \"installing\" it first. This approach is perhaps most appropriate for developers, but it is also useful on older operating systems or on platforms with tight memory and/or storage constraints. This technique can also be used to run from a source directory expanded from a zip/tar file. Although you do not need root privileges to run WeeWX this way, you will need them to set up a daemon and, perhaps, to change device permissions.","title":"Running WeeWX from a git repository"},{"location":"quickstarts/git/#install-pre-requisites","text":"Before starting, you must install the pre-requisite Python and Python modules. Ensure that Python 3.7 or later is installed. Ensure that pip and venv are installed. Create and activate a virtual environment in your home directory: python3 -m venv ~/weewx-venv source ~/weewx-venv/bin/activate Install the minimum WeeWX dependencies: python3 -m pip install CT3 python3 -m pip install configobj python3 -m pip install Pillow Depending on your situation, you may want to install these additional dependencies: # If your hardware uses a serial port python3 -m pip install pyserial # If your hardware uses a USB port python3 -m pip install pyusb # If you want extended celestial information: python3 -m pip install ephem # If you use MySQL or Maria python3 -m pip install PyMySQL [ rsa ]","title":"Install pre-requisites"},{"location":"quickstarts/git/#get-the-code","text":"Use git to clone the WeeWX repository into a directory called weewx in your home directory 1 : git clone https://github.com/weewx/weewx ~/weewx Note For systems with very little space, you may want to create a shallow clone: git clone --depth 1 https://github.com/weewx/weewx ~/weewx","title":"Get the code"},{"location":"quickstarts/git/#provision-a-new-station","text":"Now that you have the prerequisites and the WeeWX code, you can provision a new station: # If necessary, activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Provision a new station python3 ~/weewx/src/weectl.py station create The tool weectl will ask you a series of questions, then create a directory weewx-data in your home directory with a new configuration file. It will also install skins, documentation, utilitiy files, and examples in the same directory. The database and reports will also go into that directory, but only after you run weewxd , as shown in the following step.","title":"Provision a new station"},{"location":"quickstarts/git/#run-weewxd","text":"The program weewxd does the data collection, archiving, uploading, and report generation. You can run it directly, or as a daemon. When you run weewxd directly, it will print data to the screen. It will stop when you log out, or when you terminate it with control-c . # If necessary, activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Run weewxd python3 ~/weewx/src/weewxd.py To run weewxd as a daemon, install a systemd or init file that is appropriate for your operating system. Be sure to use the full path in the virtual environment to the Python interpreter and weewxd.py . Examples are included in the directory ~/weewx-data/util .","title":"Run weewxd"},{"location":"quickstarts/git/#verify","text":"After about 5 minutes (the exact length of time depends on your archive interval), copy the following and paste into a web browser. You should see your station information and data. ~/weewx-data/public_html/index.html Note Not all browsers understand the tilde (\" ~ \") mark. You may have to substitute an explicit path to your home directory, for example, file:///home/jackhandy instead of ~ . If you have problems, check the system log for entries from weewxd .","title":"Verify"},{"location":"quickstarts/git/#customize","text":"To enable uploads or to customize reports, modify the configuration file. See the Customization Guide for instructions, and the application and skin references for all the options. nano ~/weewx-data/weewx.conf The executable weewxd must be restarted for the changes to take effect.","title":"Customize"},{"location":"quickstarts/git/#upgrade","text":"Update the code by pulling the latest: cd ~/weewx && git pull Then restart weewxd","title":"Upgrade"},{"location":"quickstarts/git/#uninstall","text":"Before you uninstall, be sure that weewxd is not running. Then simply delete the git clone: rm -rf ~/weewx If desired, delete the data directory: rm -r ~/weewx-data Of course, the directory you clone into does not have to be ~/weewx . It can be any directory. Just be sure to replace ~/weewx with your directory's path in the rest of the instructions. \u21a9","title":"Uninstall"},{"location":"quickstarts/pip/","text":"Installation using pip \u00b6 This is a guide to installing WeeWX using pip . It can be used on almost any operating system (including macOS) that offers Python v3.7 or greater. Python 2, or earlier versions of Python 3, will not work. Although you do not need root privileges to install and configure WeeWX using pip , you will need them to set up a daemon, and you may need them to change device permissions. While there are many ways to install WeeWX using pip (see the wiki document pip install strategies for a partial list), we recommend creating a Python virtual environment , because it is the least likely to disturb the rest of your system. It is worth reading about venv , the module used to create a virtual environment, in the Python3 documentation. Note You may need to install pip and venv first. This usually involves a command such as sudo apt install python3-pip python3-venv See Installing pip with Linux Package Managers . Install in a virtual environment \u00b6 To install WeeWX in a virtual environment, follow the directions below for your system. If you plan to use MySQL or MariaDB, be sure to see the MySQL/MariaDB tab as well. When you are finished, the WeeWX executables and dependencies will have been installed inside the virtual environment. Debian Redhat 8 Redhat 9 openSUSE macOS Other MySQL/MariaDB sudo apt update # If necessary, install pip and venv sudo apt install python3-pip -y sudo apt install python3-venv -y # Create the virtual environment python3 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3 -m pip install weewx Tested with Debian 10, 12, RPi OS 32-bit, Ubuntu 20.04, and 22.04. sudo yum update # Check your version of Python. You must have 3.7 or later python3 -V # If it is less than Python 3.7, install a later version of Python. # For example, this would install Python 3.11. Afterwards, you must # remember to invoke Python using \"python3.11\", NOT \"python3\" sudo yum install python3.11 -y sudo yum install python3.11-pip -y # Create the virtual environment python3.11 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3.11 -m pip install weewx Tested with Rocky 8.7. sudo yum update sudo yum install python3-pip -y # Create the virtual environment python3 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3 -m pip install weewx Tested with Rocky 9.1 and 9.2. sudo zypper refresh # Check your version of Python. You must have 3.7 or later python3 -V # If it is less than Python 3.7, install a later version of Python. # For example, this would install Python 3.11. Afterwards, you must # remember to invoke Python using \"python3.11\", NOT \"python3\" sudo zypper install -y python311 # Create the virtual environment python3.11 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3.11 -m pip install weewx Tested with openSUSE Leap 15.5. # Create the virtual environment python3 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3 -m pip install weewx Tested on macOS 13.4 (Ventura) # Create the virtual environment python3 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3 -m pip install weewx If you plan on using MySQL or MariaDB with sha256_password or caching_sha2_password authentication, you will also need to install the module cryptography . On some operating systems this can be a bit of a struggle, but the following usually works. The key step is to update pip before trying the install. # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Make sure pip is up-to-date python3 -m pip install pip --upgrade # Install cryptography python3 -m pip install cryptography Provision a new station \u00b6 While the instructions above install WeeWX, they do not set up the configuration specific to your station, nor do they set up the reporting skins. That is the job of the tool weectl . # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Create the station data weectl station create The tool weectl will ask you a series of questions, then create a directory weewx-data in your home directory with a new configuration file. It will also install skins, documentation, utilitiy files, and examples in the same directory. The database and reports will also go into that directory, but only after you run weewxd , as shown in the following step. Run weewxd \u00b6 The program weewxd does the data collection, archiving, uploading, and report generation. You can run it directly, or as a daemon. Run directly \u00b6 When you run WeeWX directly, it will print data to the screen. WeeWX will stop when you log out, or when you terminate it with control-c . # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Run weewxd weewxd Run as a daemon \u00b6 To make WeeWX start when the system is booted, run weewxd as a daemon. The steps to configure weewxd to run as a daemon depend on your operating system, and require root privileges. systemd sysV macOS # Systems that use systemd, e.g., Debian, Redhat, SUSE sudo cp ~/weewx-data/util/systemd/weewx.service /etc/systemd/system sudo systemctl daemon-reload sudo systemctl enable weewx sudo systemctl start weewx Note The resulting daemon will be run using your username. If you prefer to use run as root , you will have to modify the file /etc/systemd/system/weewx.service . # Systems that use SysV init, e.g., Slackware, Devuan, Puppy, DD-WRT sudo cp ~/weewx-data/util/init.d/weewx.debian /etc/init.d/weewx sudo chmod +x /etc/init.d/weewx sudo update-rc.d weewx defaults 98 sudo /etc/init.d/weewx start Note The resulting daemon will be run using your username. If you prefer to use run as root , you will have to modify the file /etc/init.d/weewx . sudo cp ~/weewx-data/util/launchd/com.weewx.weewxd.plist /Library/LaunchDaemons sudo launchctl load /Library/LaunchDaemons/com.weewx.weewxd.plist Verify \u00b6 After about 5 minutes (the exact length of time depends on your archive interval), copy the following and paste into a web browser. You should see your station information and data. ~/weewx-data/public_html/index.html Note Not all browsers understand the tilde (\" ~ \") mark. You may have to substitute an explicit path to your home directory, for example, file:///home/jackhandy instead of ~ . If you have problems, check the system log for entries from weewxd . Configure \u00b6 If you chose the simulator as your station type, then at some point you will probably want to switch to using real hardware. This is how to reconfigure. systemd sysV macOS # Stop the weewx daemon: sudo systemctl stop weewx # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Reconfigure to use your hardware weectl station reconfigure # Remove the old database rm ~/weewx-data/archive/weewx.sdb # Start the weewx daemon sudo systemctl start weewx # Stop the weewx daemon: sudo /etc/init.d/weewx stop # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Reconfigure to use your hardware weectl station reconfigure # Remove the old database rm ~/weewx-data/archive/weewx.sdb # Start the weewx daemon sudo /etc/init.d/weewx start # Stop the weewx daemon: sudo launchctl unload /Library/LaunchDaemons/com.weewx.weewxd.plist # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Reconfigure to use your hardware weectl station reconfigure # Remove the old database rm ~/weewx-data/archive/weewx.sdb # Start the weewx daemon sudo launchctl load /Library/LaunchDaemons/com.weewx.weewxd.plist Customize \u00b6 To enable uploads or to customize reports, modify the configuration file. See the Customization Guide for instructions, and the application and skin references for all the options. Use any text editor, such as nano : nano ~/weewx-data/weewx.conf WeeWX must be restarted for the changes to take effect. systemd sysV macOS sudo systemctl restart weewx sudo /etc/init.d/weewx stop sudo /etc/init.d/weewx start sudo launchctl unload /Library/LaunchDaemons/com.weewx.weewxd.plist sudo launchctl load /Library/LaunchDaemons/com.weewx.weewxd.plist Upgrade \u00b6 Get the latest release using pip : # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Upgrade the WeeWX code python3 -m pip install weewx --upgrade Optional: You may want to upgrade your documentation and examples. weectl station upgrade --what docs examples util Optional: You may want to upgrade your skins, although this may break or remove modifications you have made to them. Your old skins will be saved in a timestamped directory. weectl station upgrade --what skins Optional: You may want to upgrade your configuration file. This is only necessary in the rare case that a new WeeWX release is not backward compatible with older configuration files. weectl station upgrade --what config Uninstall \u00b6 Before you uninstall, be sure that weewxd is not running. If you installed a daemon configuration, remove it. systemd sysV macOS sudo systemctl stop weewx sudo systemctl disable weewx sudo rm /etc/systemd/system/weewx.service sudo /etc/rc.d/init.d/weewx stop sudo update-rc.d weewx remove sudo rm /etc/init.d/weewx sudo launchctl unload /Library/LaunchDaemons/com.weewx.weewxd.plist sudo rm /Library/LaunchDaemons/com.weewx.weewxd.plist To delete the applications and code, remove the WeeWX virtual environment: rm -r ~/weewx-venv Finally, if desired, to delete the database, skins, and other utilities, remove the data directory: rm -r ~/weewx-data","title":"pip"},{"location":"quickstarts/pip/#installation-using-pip","text":"This is a guide to installing WeeWX using pip . It can be used on almost any operating system (including macOS) that offers Python v3.7 or greater. Python 2, or earlier versions of Python 3, will not work. Although you do not need root privileges to install and configure WeeWX using pip , you will need them to set up a daemon, and you may need them to change device permissions. While there are many ways to install WeeWX using pip (see the wiki document pip install strategies for a partial list), we recommend creating a Python virtual environment , because it is the least likely to disturb the rest of your system. It is worth reading about venv , the module used to create a virtual environment, in the Python3 documentation. Note You may need to install pip and venv first. This usually involves a command such as sudo apt install python3-pip python3-venv See Installing pip with Linux Package Managers .","title":"Installation using pip"},{"location":"quickstarts/pip/#install-in-a-virtual-environment","text":"To install WeeWX in a virtual environment, follow the directions below for your system. If you plan to use MySQL or MariaDB, be sure to see the MySQL/MariaDB tab as well. When you are finished, the WeeWX executables and dependencies will have been installed inside the virtual environment. Debian Redhat 8 Redhat 9 openSUSE macOS Other MySQL/MariaDB sudo apt update # If necessary, install pip and venv sudo apt install python3-pip -y sudo apt install python3-venv -y # Create the virtual environment python3 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3 -m pip install weewx Tested with Debian 10, 12, RPi OS 32-bit, Ubuntu 20.04, and 22.04. sudo yum update # Check your version of Python. You must have 3.7 or later python3 -V # If it is less than Python 3.7, install a later version of Python. # For example, this would install Python 3.11. Afterwards, you must # remember to invoke Python using \"python3.11\", NOT \"python3\" sudo yum install python3.11 -y sudo yum install python3.11-pip -y # Create the virtual environment python3.11 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3.11 -m pip install weewx Tested with Rocky 8.7. sudo yum update sudo yum install python3-pip -y # Create the virtual environment python3 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3 -m pip install weewx Tested with Rocky 9.1 and 9.2. sudo zypper refresh # Check your version of Python. You must have 3.7 or later python3 -V # If it is less than Python 3.7, install a later version of Python. # For example, this would install Python 3.11. Afterwards, you must # remember to invoke Python using \"python3.11\", NOT \"python3\" sudo zypper install -y python311 # Create the virtual environment python3.11 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3.11 -m pip install weewx Tested with openSUSE Leap 15.5. # Create the virtual environment python3 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3 -m pip install weewx Tested on macOS 13.4 (Ventura) # Create the virtual environment python3 -m venv ~/weewx-venv # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Install WeeWX into the virtual environment python3 -m pip install weewx If you plan on using MySQL or MariaDB with sha256_password or caching_sha2_password authentication, you will also need to install the module cryptography . On some operating systems this can be a bit of a struggle, but the following usually works. The key step is to update pip before trying the install. # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Make sure pip is up-to-date python3 -m pip install pip --upgrade # Install cryptography python3 -m pip install cryptography","title":"Install in a virtual environment"},{"location":"quickstarts/pip/#provision-a-new-station","text":"While the instructions above install WeeWX, they do not set up the configuration specific to your station, nor do they set up the reporting skins. That is the job of the tool weectl . # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Create the station data weectl station create The tool weectl will ask you a series of questions, then create a directory weewx-data in your home directory with a new configuration file. It will also install skins, documentation, utilitiy files, and examples in the same directory. The database and reports will also go into that directory, but only after you run weewxd , as shown in the following step.","title":"Provision a new station"},{"location":"quickstarts/pip/#run-weewxd","text":"The program weewxd does the data collection, archiving, uploading, and report generation. You can run it directly, or as a daemon.","title":"Run weewxd"},{"location":"quickstarts/pip/#run-directly","text":"When you run WeeWX directly, it will print data to the screen. WeeWX will stop when you log out, or when you terminate it with control-c . # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Run weewxd weewxd","title":"Run directly"},{"location":"quickstarts/pip/#run-as-a-daemon","text":"To make WeeWX start when the system is booted, run weewxd as a daemon. The steps to configure weewxd to run as a daemon depend on your operating system, and require root privileges. systemd sysV macOS # Systems that use systemd, e.g., Debian, Redhat, SUSE sudo cp ~/weewx-data/util/systemd/weewx.service /etc/systemd/system sudo systemctl daemon-reload sudo systemctl enable weewx sudo systemctl start weewx Note The resulting daemon will be run using your username. If you prefer to use run as root , you will have to modify the file /etc/systemd/system/weewx.service . # Systems that use SysV init, e.g., Slackware, Devuan, Puppy, DD-WRT sudo cp ~/weewx-data/util/init.d/weewx.debian /etc/init.d/weewx sudo chmod +x /etc/init.d/weewx sudo update-rc.d weewx defaults 98 sudo /etc/init.d/weewx start Note The resulting daemon will be run using your username. If you prefer to use run as root , you will have to modify the file /etc/init.d/weewx . sudo cp ~/weewx-data/util/launchd/com.weewx.weewxd.plist /Library/LaunchDaemons sudo launchctl load /Library/LaunchDaemons/com.weewx.weewxd.plist","title":"Run as a daemon"},{"location":"quickstarts/pip/#verify","text":"After about 5 minutes (the exact length of time depends on your archive interval), copy the following and paste into a web browser. You should see your station information and data. ~/weewx-data/public_html/index.html Note Not all browsers understand the tilde (\" ~ \") mark. You may have to substitute an explicit path to your home directory, for example, file:///home/jackhandy instead of ~ . If you have problems, check the system log for entries from weewxd .","title":"Verify"},{"location":"quickstarts/pip/#configure","text":"If you chose the simulator as your station type, then at some point you will probably want to switch to using real hardware. This is how to reconfigure. systemd sysV macOS # Stop the weewx daemon: sudo systemctl stop weewx # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Reconfigure to use your hardware weectl station reconfigure # Remove the old database rm ~/weewx-data/archive/weewx.sdb # Start the weewx daemon sudo systemctl start weewx # Stop the weewx daemon: sudo /etc/init.d/weewx stop # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Reconfigure to use your hardware weectl station reconfigure # Remove the old database rm ~/weewx-data/archive/weewx.sdb # Start the weewx daemon sudo /etc/init.d/weewx start # Stop the weewx daemon: sudo launchctl unload /Library/LaunchDaemons/com.weewx.weewxd.plist # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Reconfigure to use your hardware weectl station reconfigure # Remove the old database rm ~/weewx-data/archive/weewx.sdb # Start the weewx daemon sudo launchctl load /Library/LaunchDaemons/com.weewx.weewxd.plist","title":"Configure"},{"location":"quickstarts/pip/#customize","text":"To enable uploads or to customize reports, modify the configuration file. See the Customization Guide for instructions, and the application and skin references for all the options. Use any text editor, such as nano : nano ~/weewx-data/weewx.conf WeeWX must be restarted for the changes to take effect. systemd sysV macOS sudo systemctl restart weewx sudo /etc/init.d/weewx stop sudo /etc/init.d/weewx start sudo launchctl unload /Library/LaunchDaemons/com.weewx.weewxd.plist sudo launchctl load /Library/LaunchDaemons/com.weewx.weewxd.plist","title":"Customize"},{"location":"quickstarts/pip/#upgrade","text":"Get the latest release using pip : # Activate the WeeWX virtual environment source ~/weewx-venv/bin/activate # Upgrade the WeeWX code python3 -m pip install weewx --upgrade Optional: You may want to upgrade your documentation and examples. weectl station upgrade --what docs examples util Optional: You may want to upgrade your skins, although this may break or remove modifications you have made to them. Your old skins will be saved in a timestamped directory. weectl station upgrade --what skins Optional: You may want to upgrade your configuration file. This is only necessary in the rare case that a new WeeWX release is not backward compatible with older configuration files. weectl station upgrade --what config","title":"Upgrade"},{"location":"quickstarts/pip/#uninstall","text":"Before you uninstall, be sure that weewxd is not running. If you installed a daemon configuration, remove it. systemd sysV macOS sudo systemctl stop weewx sudo systemctl disable weewx sudo rm /etc/systemd/system/weewx.service sudo /etc/rc.d/init.d/weewx stop sudo update-rc.d weewx remove sudo rm /etc/init.d/weewx sudo launchctl unload /Library/LaunchDaemons/com.weewx.weewxd.plist sudo rm /Library/LaunchDaemons/com.weewx.weewxd.plist To delete the applications and code, remove the WeeWX virtual environment: rm -r ~/weewx-venv Finally, if desired, to delete the database, skins, and other utilities, remove the data directory: rm -r ~/weewx-data","title":"Uninstall"},{"location":"quickstarts/redhat/","text":"Installation on Redhat systems \u00b6 This is a guide to installing WeeWX from an RPM package on systems based on Redhat, including Fedora, CentOS, or Rocky. WeeWX V5 requires Python 3.7 or greater, which is only available on Redhat 8 or later. For older systems, either use WeeWX V4, or install Python 3.7 then install WeeWX V5 using pip . Install pre-requisites \u00b6 Not everything that WeeWX uses is included in the standard Redhat repositories, so you must first enable the EPEL repositories (\"Extra Packages for Enterprise Linux\") then install the WeeWX prerequisites. sudo yum install epel-release sudo yum install python3-cheetah Configure yum \u00b6 The first time you install WeeWX, you must configure yum so that it will trust weewx.com, and know where to find the WeeWX releases. Tell your system to trust weewx.com: sudo rpm --import https://weewx.com/keys.html Tell yum where to find the WeeWX repository. curl -s https://weewx.com/yum/weewx-el8.repo | \\ sudo tee /etc/yum.repos.d/weewx.repo Install \u00b6 Install WeeWX using yum or dnf . When you are done, WeeWX will be running the Simulator in the background as a daemon. sudo yum install weewx Verify \u00b6 After 5 minutes, copy the following and paste into a web browser: /var/www/html/weewx/index.html You should see simulated data. Check the system log /var/log/messages for problems. Configure \u00b6 To switch from the Simulator to real hardware, reconfigure the driver. # Stop the daemon sudo systemctl stop weewx # Reconfigure to use your hardware sudo weectl station reconfigure # Delete the old database sudo rm /var/lib/weewx/weewx.sdb # Start the daemon: sudo systemctl start weewx Customize \u00b6 To enable uploads or to customize reports, modify the configuration file. See the Customization Guide for instructions, and the application and skin references for all the options. Use any text editor, such as nano : sudo nano /etc/weewx/weewx.conf WeeWX must be restarted for the changes to take effect. sudo systemctl restart weewx Upgrade \u00b6 Upgrade to the latest version like this: sudo yum update weewx The upgrade process will not modify the WeeWX databases. Unmodified files will be upgraded. If modifications have been made to the configuration, rpm will display a message about any differences between the changes and the new configuration. Any new changes from the upgrade will be noted as files with a .rpmnew extension and the modified files will be left untouched. For example, if /etc/weewx/weewx.conf was modified, rpm will present a message something like this: warning: /etc/weewx/weewx.conf created as /etc/weewx/weewx.conf.rpmnew Uninstall \u00b6 To uninstall WeeWX, deleting configuration files but retaining data: sudo yum remove weewx To delete data: sudo rm -r /var/lib/weewx sudo rm -r /var/www/html/weewx","title":"RedHat"},{"location":"quickstarts/redhat/#installation-on-redhat-systems","text":"This is a guide to installing WeeWX from an RPM package on systems based on Redhat, including Fedora, CentOS, or Rocky. WeeWX V5 requires Python 3.7 or greater, which is only available on Redhat 8 or later. For older systems, either use WeeWX V4, or install Python 3.7 then install WeeWX V5 using pip .","title":"Installation on Redhat systems"},{"location":"quickstarts/redhat/#install-pre-requisites","text":"Not everything that WeeWX uses is included in the standard Redhat repositories, so you must first enable the EPEL repositories (\"Extra Packages for Enterprise Linux\") then install the WeeWX prerequisites. sudo yum install epel-release sudo yum install python3-cheetah","title":"Install pre-requisites"},{"location":"quickstarts/redhat/#configure-yum","text":"The first time you install WeeWX, you must configure yum so that it will trust weewx.com, and know where to find the WeeWX releases. Tell your system to trust weewx.com: sudo rpm --import https://weewx.com/keys.html Tell yum where to find the WeeWX repository. curl -s https://weewx.com/yum/weewx-el8.repo | \\ sudo tee /etc/yum.repos.d/weewx.repo","title":"Configure yum"},{"location":"quickstarts/redhat/#install","text":"Install WeeWX using yum or dnf . When you are done, WeeWX will be running the Simulator in the background as a daemon. sudo yum install weewx","title":"Install"},{"location":"quickstarts/redhat/#verify","text":"After 5 minutes, copy the following and paste into a web browser: /var/www/html/weewx/index.html You should see simulated data. Check the system log /var/log/messages for problems.","title":"Verify"},{"location":"quickstarts/redhat/#configure","text":"To switch from the Simulator to real hardware, reconfigure the driver. # Stop the daemon sudo systemctl stop weewx # Reconfigure to use your hardware sudo weectl station reconfigure # Delete the old database sudo rm /var/lib/weewx/weewx.sdb # Start the daemon: sudo systemctl start weewx","title":"Configure"},{"location":"quickstarts/redhat/#customize","text":"To enable uploads or to customize reports, modify the configuration file. See the Customization Guide for instructions, and the application and skin references for all the options. Use any text editor, such as nano : sudo nano /etc/weewx/weewx.conf WeeWX must be restarted for the changes to take effect. sudo systemctl restart weewx","title":"Customize"},{"location":"quickstarts/redhat/#upgrade","text":"Upgrade to the latest version like this: sudo yum update weewx The upgrade process will not modify the WeeWX databases. Unmodified files will be upgraded. If modifications have been made to the configuration, rpm will display a message about any differences between the changes and the new configuration. Any new changes from the upgrade will be noted as files with a .rpmnew extension and the modified files will be left untouched. For example, if /etc/weewx/weewx.conf was modified, rpm will present a message something like this: warning: /etc/weewx/weewx.conf created as /etc/weewx/weewx.conf.rpmnew","title":"Upgrade"},{"location":"quickstarts/redhat/#uninstall","text":"To uninstall WeeWX, deleting configuration files but retaining data: sudo yum remove weewx To delete data: sudo rm -r /var/lib/weewx sudo rm -r /var/www/html/weewx","title":"Uninstall"},{"location":"quickstarts/suse/","text":"Installation on SUSE systems \u00b6 This is a guide to installing WeeWX from an RPM package systems based on SUSE, such as openSUSE Leap. WeeWX V5 requires Python 3.7 or greater, which is only available on SUSE-15 or later. For older systems, either use WeeWX V4, or install Python 3.7 then install WeeWX V5 using pip . Configure zypper \u00b6 The first time you install WeeWX, you must configure zypper so that it will trust weewx.com, and know where to find the WeeWX releases. Tell your system to trust weewx.com: sudo rpm --import https://weewx.com/keys.html Tell zypper where to find the WeeWX repository. curl -s https://weewx.com/suse/weewx-suse15.repo | \\ sudo tee /etc/zypp/repos.d/weewx.repo Install \u00b6 Install WeeWX using zypper . When you are done, WeeWX will be running the Simulator in the background as a daemon. sudo zypper install weewx Verify \u00b6 After 5 minutes, copy the following and paste into a web browser: /var/www/html/weewx/index.html You should see simulated data. Check the system log /var/log/messages for problems. Configure \u00b6 To switch from the Simulator to real hardware, reconfigure the driver. # Stop the daemon sudo systemctl stop weewx # Reconfigure to use your hardware sudo weectl station reconfigure # Delete the old database sudo rm /var/lib/weewx/weewx.sdb # Start the daemon sudo systemctl start weewx Customize \u00b6 To enable uploads or to customize reports, modify the configuration file. See the Customization Guide for instructions, and the application and skin references for all the options. Use any text editor, such as nano : sudo nano /etc/weewx/weewx.conf WeeWX must be restarted for the changes to take effect. sudo systemctl restart weewx Upgrade \u00b6 Upgrade to the latest version like this: sudo zypper update weewx The upgrade process will not modify the WeeWX databases. Unmodified files will be upgraded. If modifications have been made to the configuration, rpm will display a message about any differences between the changes and the new configuration. Any new changes from the upgrade will be noted as files with a .rpmnew extension and the modified files will be left untouched. For example, if /etc/weewx/weewx.conf was modified, rpm will present a message something like this: warning: /etc/weewx/weewx.conf created as /etc/weewx/weewx.conf.rpmnew Uninstall \u00b6 To uninstall WeeWX, deleting configuration files but retaining data: sudo zypper remove weewx To delete data: sudo rm -r /var/lib/weewx sudo rm -r /var/www/html/weewx","title":"SuSE"},{"location":"quickstarts/suse/#installation-on-suse-systems","text":"This is a guide to installing WeeWX from an RPM package systems based on SUSE, such as openSUSE Leap. WeeWX V5 requires Python 3.7 or greater, which is only available on SUSE-15 or later. For older systems, either use WeeWX V4, or install Python 3.7 then install WeeWX V5 using pip .","title":"Installation on SUSE systems"},{"location":"quickstarts/suse/#configure-zypper","text":"The first time you install WeeWX, you must configure zypper so that it will trust weewx.com, and know where to find the WeeWX releases. Tell your system to trust weewx.com: sudo rpm --import https://weewx.com/keys.html Tell zypper where to find the WeeWX repository. curl -s https://weewx.com/suse/weewx-suse15.repo | \\ sudo tee /etc/zypp/repos.d/weewx.repo","title":"Configure zypper"},{"location":"quickstarts/suse/#install","text":"Install WeeWX using zypper . When you are done, WeeWX will be running the Simulator in the background as a daemon. sudo zypper install weewx","title":"Install"},{"location":"quickstarts/suse/#verify","text":"After 5 minutes, copy the following and paste into a web browser: /var/www/html/weewx/index.html You should see simulated data. Check the system log /var/log/messages for problems.","title":"Verify"},{"location":"quickstarts/suse/#configure","text":"To switch from the Simulator to real hardware, reconfigure the driver. # Stop the daemon sudo systemctl stop weewx # Reconfigure to use your hardware sudo weectl station reconfigure # Delete the old database sudo rm /var/lib/weewx/weewx.sdb # Start the daemon sudo systemctl start weewx","title":"Configure"},{"location":"quickstarts/suse/#customize","text":"To enable uploads or to customize reports, modify the configuration file. See the Customization Guide for instructions, and the application and skin references for all the options. Use any text editor, such as nano : sudo nano /etc/weewx/weewx.conf WeeWX must be restarted for the changes to take effect. sudo systemctl restart weewx","title":"Customize"},{"location":"quickstarts/suse/#upgrade","text":"Upgrade to the latest version like this: sudo zypper update weewx The upgrade process will not modify the WeeWX databases. Unmodified files will be upgraded. If modifications have been made to the configuration, rpm will display a message about any differences between the changes and the new configuration. Any new changes from the upgrade will be noted as files with a .rpmnew extension and the modified files will be left untouched. For example, if /etc/weewx/weewx.conf was modified, rpm will present a message something like this: warning: /etc/weewx/weewx.conf created as /etc/weewx/weewx.conf.rpmnew","title":"Upgrade"},{"location":"quickstarts/suse/#uninstall","text":"To uninstall WeeWX, deleting configuration files but retaining data: sudo zypper remove weewx To delete data: sudo rm -r /var/lib/weewx sudo rm -r /var/www/html/weewx","title":"Uninstall"},{"location":"reference/aggtypes/","text":"Aggregation types \u00b6 Aggregation types Aggregation type Meaning avg The average value in the aggregation period. avg_ge(val) The number of days when the average value is greater than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . avg_le(val) The number of days when the average value is less than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . count The number of non-null values in the aggregation period. diff The difference between the last and first value in the aggregation period. exists Returns True if the observation type exists in the database. first The first non-null value in the aggregation period. firsttime The time of the first non-null value in the aggregation period. gustdir The direction of the max gust in the aggregation period. has_data Returns True if the observation type exists either in the database or as an xtype and is non-null. last The last non-null value in the aggregation period. lasttime The time of the last non-null value in the aggregation period. max The maximum value in the aggregation period. maxmin The maximum daily minimum in the aggregation period. Aggregation period must be one day or longer. maxmintime The time of the maximum daily minimum. maxsum The maximum daily sum in the aggregation period. Aggregation period must be one day or longer. maxsumtime The time of the maximum daily sum. maxtime The time of the maximum value. max_ge(val) The number of days when the maximum value is greater than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . max_le(val) The number of days when the maximum value is less than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . meanmax The average daily maximum in the aggregation period. Aggregation period must be one day or longer. meanmin The average daily minimum in the aggregation period. Aggregation period must be one day or longer. min The minimum value in the aggregation period. minmax The minimum daily maximum in the aggregation period. Aggregation period must be one day or longer. minmaxtime The time of the minimum daily maximum. minsum The minimum daily sum in the aggregation period. Aggregation period must be one day or longer. minsumtime The time of the minimum daily sum. mintime The time of the minimum value. min_ge(val) The number of days when the minimum value is greater than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . min_le(val) The number of days when the minimum value is less than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . not_null Returns truthy if any value over the aggregation period is non-null. rms The root mean square value in the aggregation period. sum The sum of values in the aggregation period. sum_ge(val) The number of days when the sum of value is greater than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . sum_le(val) The number of days when the sum of value is less than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . tderiv The time derivative between the last and first value in the aggregation period. This is the difference in value divided by the difference in time. vecavg The vector average speed in the aggregation period. vecdir The vector averaged direction during the aggregation period.","title":"Aggregation types"},{"location":"reference/aggtypes/#aggregation-types","text":"Aggregation types Aggregation type Meaning avg The average value in the aggregation period. avg_ge(val) The number of days when the average value is greater than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . avg_le(val) The number of days when the average value is less than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . count The number of non-null values in the aggregation period. diff The difference between the last and first value in the aggregation period. exists Returns True if the observation type exists in the database. first The first non-null value in the aggregation period. firsttime The time of the first non-null value in the aggregation period. gustdir The direction of the max gust in the aggregation period. has_data Returns True if the observation type exists either in the database or as an xtype and is non-null. last The last non-null value in the aggregation period. lasttime The time of the last non-null value in the aggregation period. max The maximum value in the aggregation period. maxmin The maximum daily minimum in the aggregation period. Aggregation period must be one day or longer. maxmintime The time of the maximum daily minimum. maxsum The maximum daily sum in the aggregation period. Aggregation period must be one day or longer. maxsumtime The time of the maximum daily sum. maxtime The time of the maximum value. max_ge(val) The number of days when the maximum value is greater than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . max_le(val) The number of days when the maximum value is less than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . meanmax The average daily maximum in the aggregation period. Aggregation period must be one day or longer. meanmin The average daily minimum in the aggregation period. Aggregation period must be one day or longer. min The minimum value in the aggregation period. minmax The minimum daily maximum in the aggregation period. Aggregation period must be one day or longer. minmaxtime The time of the minimum daily maximum. minsum The minimum daily sum in the aggregation period. Aggregation period must be one day or longer. minsumtime The time of the minimum daily sum. mintime The time of the minimum value. min_ge(val) The number of days when the minimum value is greater than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . min_le(val) The number of days when the minimum value is less than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . not_null Returns truthy if any value over the aggregation period is non-null. rms The root mean square value in the aggregation period. sum The sum of values in the aggregation period. sum_ge(val) The number of days when the sum of value is greater than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . sum_le(val) The number of days when the sum of value is less than or equal to val . Aggregation period must be one day or longer. The argument val is a ValueTuple . tderiv The time derivative between the last and first value in the aggregation period. This is the difference in value divided by the difference in time. vecavg The vector average speed in the aggregation period. vecdir The vector averaged direction during the aggregation period.","title":"Aggregation types"},{"location":"reference/durations/","text":"Durations \u00b6 Rather than give a value in seconds, many durations can be expressed using a shorthand notation. For example, in a skin configuration file skin.conf , a value for aggregate_interval can be given as either aggregate_interval = 3600 or aggregate_interval = 1h The same notation can be used in trends. For example: <p>Barometer trend over the last 2 hours: $trend(time_delta='2h').barometer</p> Here is a summary of the notation: Example Meaning 10800 3 hours 3h 3 hours 1d 1 day 2w 2 weeks 1m 1 month 1y 1 year hour Synonym for 1h day Synonym for 1d week Synonym for 1w month Synonym for 1m year Synonym for 1y","title":"Durations"},{"location":"reference/durations/#durations","text":"Rather than give a value in seconds, many durations can be expressed using a shorthand notation. For example, in a skin configuration file skin.conf , a value for aggregate_interval can be given as either aggregate_interval = 3600 or aggregate_interval = 1h The same notation can be used in trends. For example: <p>Barometer trend over the last 2 hours: $trend(time_delta='2h').barometer</p> Here is a summary of the notation: Example Meaning 10800 3 hours 3h 3 hours 1d 1 day 2w 2 weeks 1m 1 month 1y 1 year hour Synonym for 1h day Synonym for 1d week Synonym for 1w month Synonym for 1m year Synonym for 1y","title":"Durations"},{"location":"reference/units/","text":"Units \u00b6 WeeWX offers three different unit systems : The standard unit systems used within WeeWX Name Encoded value Note US 0x01 U.S. Customary METRICWX 0x11 Metric, with rain related measurements in mm and speeds in m/s METRIC 0x10 Metric, with rain related measurements in cm and speeds in km/hr The table below lists all the unit groups, their members, which units are options for the group, and what the defaults are for each standard unit system. Unit groups, members and options Group Members Unit options US METRICWX METRIC group_altitude altitude cloudbase foot meter foot meter meter group_amp amp amp amp amp group_angle degree_angle radian degree_angle degree_angle degree_angle group_boolean boolean boolean boolean boolean group_concentration no2 pm1_0 pm2_5 pm10_0 microgram_per_meter_cubed microgram_per_meter_cubed microgram_per_meter_cubed microgram_per_meter_cubed group_count leafWet1 leafWet2 lightning_disturber_count lightning_noise_count lightning_strike_count count count count count group_data byte bit byte byte byte group_db noise dB dB dB dB group_deltatime daySunshineDur rainDur sunshineDurDoc second minute hour day second second second group_degree_day cooldeg heatdeg growdeg degree_F_day degree_C_day degree_F_day degree_C_day degree_C_day group_direction gustdir vecdir windDir windGustDir degree_compass degree_compass degree_compass degree_compass group_distance windrun lightning_distance mile km mile km km group_energy kilowatt_hour mega_joule watt_hour watt_second watt_hour watt_hour watt_hour group_energy2 kilowatt_hour watt_hour watt_second watt_second watt_second watt_second group_fraction co co2 nh3 o3 pb so2 ppm ppm ppm ppm group_frequency hertz hertz hertz hertz group_illuminance illuminance lux lux lux lux group_interval interval minute minute minute minute group_length inch cm inch cm cm group_moisture soilMoist1 soilMoist2 soilMoist3 soilMoist4 centibar centibar centibar centibar group_percent cloudcover extraHumid1 extraHumid2 inHumidity outHumidity pop rxCheckPercent snowMoisture percent percent percent percent group_power kilowatt watt watt watt watt group_pressure barometer altimeter pressure inHg mbar hPa kPa inHg mbar mbar group_pressurerate barometerRate altimeterRate pressureRate inHg_per_hour mbar_per_hour hPa_per_hour kPa_per_hour inHg_per_hour mbar_per_hour mbar_per_hour group_radiation maxSolarRad radiation watt_per_meter_squared watt_per_meter_squared watt_per_meter_squared watt_per_meter_squared group_rain rain ET hail snowDepth snowRate inch cm mm inch mm cm group_rainrate rainRate hailRate inch_per_hour cm_per_hour mm_per_hour inch_per_hour mm_per_hour cm_per_hour group_speed wind windGust windSpeed windgustvec windvec mile_per_hour km_per_hour knot meter_per_second beaufort mile_per_hour meter_per_second km_per_hour group_speed2 rms vecavg mile_per_hour2 km_per_hour2 knot2 meter_per_second2 mile_per_hour2 meter_per_second2 km_per_hour2 group_temperature appTemp dewpoint extraTemp1 extraTemp2 extraTemp3 heatindex heatingTemp humidex inTemp leafTemp1 leafTemp2 outTemp soilTemp1 soilTemp2 soilTemp3 soilTemp4 windchill THSW degree_C degree_F degree_E degree_K degree_F degree_C degree_C group_time dateTime unix_epoch dublin_jd unix_epoch unix_epoch unix_epoch group_uv UV uv_index uv_index uv_index uv_index group_volt consBatteryVoltage heatingVoltage referenceVoltage supplyVoltage volt volt volt volt group_volume cubic_foot gallon liter gallon liter liter group_NONE NONE NONE NONE NONE NONE","title":"Units"},{"location":"reference/units/#units","text":"WeeWX offers three different unit systems : The standard unit systems used within WeeWX Name Encoded value Note US 0x01 U.S. Customary METRICWX 0x11 Metric, with rain related measurements in mm and speeds in m/s METRIC 0x10 Metric, with rain related measurements in cm and speeds in km/hr The table below lists all the unit groups, their members, which units are options for the group, and what the defaults are for each standard unit system. Unit groups, members and options Group Members Unit options US METRICWX METRIC group_altitude altitude cloudbase foot meter foot meter meter group_amp amp amp amp amp group_angle degree_angle radian degree_angle degree_angle degree_angle group_boolean boolean boolean boolean boolean group_concentration no2 pm1_0 pm2_5 pm10_0 microgram_per_meter_cubed microgram_per_meter_cubed microgram_per_meter_cubed microgram_per_meter_cubed group_count leafWet1 leafWet2 lightning_disturber_count lightning_noise_count lightning_strike_count count count count count group_data byte bit byte byte byte group_db noise dB dB dB dB group_deltatime daySunshineDur rainDur sunshineDurDoc second minute hour day second second second group_degree_day cooldeg heatdeg growdeg degree_F_day degree_C_day degree_F_day degree_C_day degree_C_day group_direction gustdir vecdir windDir windGustDir degree_compass degree_compass degree_compass degree_compass group_distance windrun lightning_distance mile km mile km km group_energy kilowatt_hour mega_joule watt_hour watt_second watt_hour watt_hour watt_hour group_energy2 kilowatt_hour watt_hour watt_second watt_second watt_second watt_second group_fraction co co2 nh3 o3 pb so2 ppm ppm ppm ppm group_frequency hertz hertz hertz hertz group_illuminance illuminance lux lux lux lux group_interval interval minute minute minute minute group_length inch cm inch cm cm group_moisture soilMoist1 soilMoist2 soilMoist3 soilMoist4 centibar centibar centibar centibar group_percent cloudcover extraHumid1 extraHumid2 inHumidity outHumidity pop rxCheckPercent snowMoisture percent percent percent percent group_power kilowatt watt watt watt watt group_pressure barometer altimeter pressure inHg mbar hPa kPa inHg mbar mbar group_pressurerate barometerRate altimeterRate pressureRate inHg_per_hour mbar_per_hour hPa_per_hour kPa_per_hour inHg_per_hour mbar_per_hour mbar_per_hour group_radiation maxSolarRad radiation watt_per_meter_squared watt_per_meter_squared watt_per_meter_squared watt_per_meter_squared group_rain rain ET hail snowDepth snowRate inch cm mm inch mm cm group_rainrate rainRate hailRate inch_per_hour cm_per_hour mm_per_hour inch_per_hour mm_per_hour cm_per_hour group_speed wind windGust windSpeed windgustvec windvec mile_per_hour km_per_hour knot meter_per_second beaufort mile_per_hour meter_per_second km_per_hour group_speed2 rms vecavg mile_per_hour2 km_per_hour2 knot2 meter_per_second2 mile_per_hour2 meter_per_second2 km_per_hour2 group_temperature appTemp dewpoint extraTemp1 extraTemp2 extraTemp3 heatindex heatingTemp humidex inTemp leafTemp1 leafTemp2 outTemp soilTemp1 soilTemp2 soilTemp3 soilTemp4 windchill THSW degree_C degree_F degree_E degree_K degree_F degree_C degree_C group_time dateTime unix_epoch dublin_jd unix_epoch unix_epoch unix_epoch group_uv UV uv_index uv_index uv_index uv_index group_volt consBatteryVoltage heatingVoltage referenceVoltage supplyVoltage volt volt volt volt group_volume cubic_foot gallon liter gallon liter liter group_NONE NONE NONE NONE NONE NONE","title":"Units"},{"location":"reference/valuehelper/","text":"Class ValueHelper \u00b6 Class ValueHelper contains all the information necessary to do the proper formatting of a value, including a unit label. Instance attribute \u00b6 ValueHelper.value_t \u00b6 Returns the ValueTuple instance held internally. Instance methods \u00b6 ValueHelper. str () \u00b6 Formats the value as a string, including a unit label, and returns it. ValueHelper.format(format_string=None, None_string=None, add_label=True, localize=True) \u00b6 Format the value as a string, using various specified options, and return it. Unless otherwise specified, a label is included. Its parameters: format_string A string to be used for formatting. It must include one, and only one, format specifier . None_string In the event of a value of Python None , this string will be substituted. If None , then a default string from skin.conf will be used. add_label If truthy, then an appropriate unit label will be attached. Otherwise, no label is attached. localize If truthy, then the results will be localized. For example, in some locales, a comma will be used as the decimal specifier.","title":"ValueHelper"},{"location":"reference/valuehelper/#class-valuehelper","text":"Class ValueHelper contains all the information necessary to do the proper formatting of a value, including a unit label.","title":"Class ValueHelper"},{"location":"reference/valuehelper/#instance-attribute","text":"","title":"Instance attribute"},{"location":"reference/valuehelper/#valuehelpervalue_t","text":"Returns the ValueTuple instance held internally.","title":"ValueHelper.value_t"},{"location":"reference/valuehelper/#instance-methods","text":"","title":"Instance methods"},{"location":"reference/valuehelper/#valuehelperstr","text":"Formats the value as a string, including a unit label, and returns it.","title":"ValueHelper.str()"},{"location":"reference/valuehelper/#valuehelperformatformat_stringnone-none_stringnone-add_labeltrue-localizetrue","text":"Format the value as a string, using various specified options, and return it. Unless otherwise specified, a label is included. Its parameters: format_string A string to be used for formatting. It must include one, and only one, format specifier . None_string In the event of a value of Python None , this string will be substituted. If None , then a default string from skin.conf will be used. add_label If truthy, then an appropriate unit label will be attached. Otherwise, no label is attached. localize If truthy, then the results will be localized. For example, in some locales, a comma will be used as the decimal specifier.","title":"ValueHelper.format(format_string=None, None_string=None, add_label=True, localize=True)"},{"location":"reference/valuetuple/","text":"Class ValueTuple \u00b6 A value, along with the unit it is in, can be represented by a 3-way tuple called a \"value tuple\". They are used throughout WeeWX. All WeeWX routines can accept a simple unadorned 3-way tuple as a value tuple, but they return the type ValueTuple . It is useful because its contents can be accessed using named attributes. You can think of it as a unit-aware value, useful for converting to and from other units. The following attributes, and their index, are present: Index Attribute Meaning 0 value The data value(s). Can be a series (e.g., [20.2, 23.2, ...] ) or a scalar (e.g., 20.2 ) 1 unit The unit it is in ( \"degree_C\" ) 2 group The unit group ( \"group_temperature\" ) It is valid to have a datum value of None . It is also valid to have a unit type of None (meaning there is no information about the unit the value is in). In this case, you won't be able to convert it to another unit. Here are some examples: from weewx.units import ValueTuple freezing_vt = ValueTuple ( 0.0 , \"degree_C\" , \"group_temperature\" ) body_temperature_vt = ValueTuple ( 98.6 , \"degree_F\" , group_temperature \") station_altitude_vt = ValueTuple ( 120.0 , \"meter\" , \"group_altitude\" )","title":"ValueTuple"},{"location":"reference/valuetuple/#class-valuetuple","text":"A value, along with the unit it is in, can be represented by a 3-way tuple called a \"value tuple\". They are used throughout WeeWX. All WeeWX routines can accept a simple unadorned 3-way tuple as a value tuple, but they return the type ValueTuple . It is useful because its contents can be accessed using named attributes. You can think of it as a unit-aware value, useful for converting to and from other units. The following attributes, and their index, are present: Index Attribute Meaning 0 value The data value(s). Can be a series (e.g., [20.2, 23.2, ...] ) or a scalar (e.g., 20.2 ) 1 unit The unit it is in ( \"degree_C\" ) 2 group The unit group ( \"group_temperature\" ) It is valid to have a datum value of None . It is also valid to have a unit type of None (meaning there is no information about the unit the value is in). In this case, you won't be able to convert it to another unit. Here are some examples: from weewx.units import ValueTuple freezing_vt = ValueTuple ( 0.0 , \"degree_C\" , \"group_temperature\" ) body_temperature_vt = ValueTuple ( 98.6 , \"degree_F\" , group_temperature \") station_altitude_vt = ValueTuple ( 120.0 , \"meter\" , \"group_altitude\" )","title":"Class ValueTuple"},{"location":"reference/skin-options/almanac/","text":"[Almanac] \u00b6 This section controls what text to use for the almanac. moon_phases \u00b6 This option is a comma separated list of labels to be used for the eight phases of the moon. Default is New, Waxing crescent, First quarter, Waxing gibbous, Full, Waning gibbous, Last quarter, Waning crescent .","title":"[Almanac]"},{"location":"reference/skin-options/almanac/#almanac","text":"This section controls what text to use for the almanac.","title":"[Almanac]"},{"location":"reference/skin-options/almanac/#moon_phases","text":"This option is a comma separated list of labels to be used for the eight phases of the moon. Default is New, Waxing crescent, First quarter, Waxing gibbous, Full, Waning gibbous, Last quarter, Waning crescent .","title":"moon_phases"},{"location":"reference/skin-options/cheetahgenerator/","text":"[CheetahGenerator] \u00b6 This section contains the options for the Cheetah generator. It applies to skin.conf only. search_list \u00b6 This is the list of search list objects that will be scanned by the template engine, looking for tags. See the section Defining new tags and the Cheetah documentation for details on search lists. If no search_list is specified, a default list will be used. search_list_extensions \u00b6 This defines one or more search list objects that will be appended to the search_list . For example, if you are using the \"seven day\" and \"forecast\" search list extensions, the option would look like search_list_extensions = user.seven_day.SevenDay, user.forecast.ForecastVariables encoding \u00b6 As Cheetah goes through the template, it substitutes strings for all tag values. This option controls which encoding to use for the new strings. The encoding can be chosen on a per-file basis. All the encodings listed in the Python documentation Standard Encodings are available, as well as these WeeWX-specific encodings: Encoding Comments html_entities Non 7-bit characters will be represented as HTML entities ( e.g. , the degree sign will be represented as \" &#176; \") strict_ascii Non 7-bit characters will be ignored. normalized_ascii Replace accented characters with non-accented analogs ( e.g. , '\u00f6' will be replaced with 'o'). The encoding html_entities is the default. Other common choices are utf8 , cp1252 ( a.k.a. Windows-1252), and latin1 . template \u00b6 The name of a template file. A template filename must end with .tmpl . Filenames are case-sensitive. If the template filename has the letters YYYY , MM , WW or DD in its name, these will be substituted for the year, month, week and day of month, respectively. So, a template with the name summary-YYYY-MM.html.tmpl would have name summary-2010-03.html for the month of March 2010. generate_once \u00b6 When set to True , the template is processed only on the first invocation of the report engine service. This feature is useful for files that do not change when data values change, such as HTML files that define a layout. The default is False . stale_age \u00b6 File staleness age, in seconds. If the file is older than this age it will be generated from the template. If no stale_age is specified, then the file will be generated every time the generator runs. Note Precise control over when a run is available through use of the report_timing option. The report_timing option uses a CRON-like syntax to specify precisely when a report should be run. See the guide Scheduling report generation for details. [[SummaryByDay]] \u00b6 The SummaryByDay section defines some special behavior. Each template in this section will be used multiple times, each time with a different per-day timespan. Be sure to include YYYY , MM , and DD in the filename of any template in this section. [[SummaryByMonth]] \u00b6 The SummaryByMonth section defines some special behavior. Each template in this section will be used multiple times, each time with a different per-month timespan. Be sure to include YYYY and MM in the filename of any template in this section. [[SummaryByYear]] \u00b6 The SummaryByYear section defines some special behavior. Each template in this section will be used multiple times, each time with a different per-year timespan. Be sure to include YYYY in the filename of any template in this section.","title":"[CheetahGenerator]"},{"location":"reference/skin-options/cheetahgenerator/#cheetahgenerator","text":"This section contains the options for the Cheetah generator. It applies to skin.conf only.","title":"[CheetahGenerator]"},{"location":"reference/skin-options/cheetahgenerator/#search_list","text":"This is the list of search list objects that will be scanned by the template engine, looking for tags. See the section Defining new tags and the Cheetah documentation for details on search lists. If no search_list is specified, a default list will be used.","title":"search_list"},{"location":"reference/skin-options/cheetahgenerator/#search_list_extensions","text":"This defines one or more search list objects that will be appended to the search_list . For example, if you are using the \"seven day\" and \"forecast\" search list extensions, the option would look like search_list_extensions = user.seven_day.SevenDay, user.forecast.ForecastVariables","title":"search_list_extensions"},{"location":"reference/skin-options/cheetahgenerator/#encoding","text":"As Cheetah goes through the template, it substitutes strings for all tag values. This option controls which encoding to use for the new strings. The encoding can be chosen on a per-file basis. All the encodings listed in the Python documentation Standard Encodings are available, as well as these WeeWX-specific encodings: Encoding Comments html_entities Non 7-bit characters will be represented as HTML entities ( e.g. , the degree sign will be represented as \" &#176; \") strict_ascii Non 7-bit characters will be ignored. normalized_ascii Replace accented characters with non-accented analogs ( e.g. , '\u00f6' will be replaced with 'o'). The encoding html_entities is the default. Other common choices are utf8 , cp1252 ( a.k.a. Windows-1252), and latin1 .","title":"encoding"},{"location":"reference/skin-options/cheetahgenerator/#template","text":"The name of a template file. A template filename must end with .tmpl . Filenames are case-sensitive. If the template filename has the letters YYYY , MM , WW or DD in its name, these will be substituted for the year, month, week and day of month, respectively. So, a template with the name summary-YYYY-MM.html.tmpl would have name summary-2010-03.html for the month of March 2010.","title":"template"},{"location":"reference/skin-options/cheetahgenerator/#generate_once","text":"When set to True , the template is processed only on the first invocation of the report engine service. This feature is useful for files that do not change when data values change, such as HTML files that define a layout. The default is False .","title":"generate_once"},{"location":"reference/skin-options/cheetahgenerator/#stale_age","text":"File staleness age, in seconds. If the file is older than this age it will be generated from the template. If no stale_age is specified, then the file will be generated every time the generator runs. Note Precise control over when a run is available through use of the report_timing option. The report_timing option uses a CRON-like syntax to specify precisely when a report should be run. See the guide Scheduling report generation for details.","title":"stale_age"},{"location":"reference/skin-options/cheetahgenerator/#summarybyday","text":"The SummaryByDay section defines some special behavior. Each template in this section will be used multiple times, each time with a different per-day timespan. Be sure to include YYYY , MM , and DD in the filename of any template in this section.","title":"[[SummaryByDay]]"},{"location":"reference/skin-options/cheetahgenerator/#summarybymonth","text":"The SummaryByMonth section defines some special behavior. Each template in this section will be used multiple times, each time with a different per-month timespan. Be sure to include YYYY and MM in the filename of any template in this section.","title":"[[SummaryByMonth]]"},{"location":"reference/skin-options/cheetahgenerator/#summarybyyear","text":"The SummaryByYear section defines some special behavior. Each template in this section will be used multiple times, each time with a different per-year timespan. Be sure to include YYYY in the filename of any template in this section.","title":"[[SummaryByYear]]"},{"location":"reference/skin-options/copygenerator/","text":"[CopyGenerator] \u00b6 This section is used by generator weewx.reportengine.CopyGenerator and controls which files are to be copied over from the skin directory to the destination directory. Think of it as \"file generation,\" except that rather than going through the template engine, the files are simply copied over. It is useful for making sure CSS and Javascript files are in place. copy_once \u00b6 This option controls which files get copied over on the first invocation of the report engine service. Typically, this is things such as style sheets or background GIFs. Wildcards can be used. copy_always \u00b6 This is a list of files that should be copied on every invocation. Wildcards can be used. Here is the [CopyGenerator] section from the Standard skin.conf [CopyGenerator] # This section is used by the generator CopyGenerator # List of files to be copied only the first time the generator runs copy_once = backgrounds/*, weewx.css, mobile.css, favicon.ico # List of files to be copied each time the generator runs # copy_always = The Standard skin includes some background images, CSS files, and icons that need to be copied once. There are no files that need to be copied every time the generator runs.","title":"[CopyGenerator]"},{"location":"reference/skin-options/copygenerator/#copygenerator","text":"This section is used by generator weewx.reportengine.CopyGenerator and controls which files are to be copied over from the skin directory to the destination directory. Think of it as \"file generation,\" except that rather than going through the template engine, the files are simply copied over. It is useful for making sure CSS and Javascript files are in place.","title":"[CopyGenerator]"},{"location":"reference/skin-options/copygenerator/#copy_once","text":"This option controls which files get copied over on the first invocation of the report engine service. Typically, this is things such as style sheets or background GIFs. Wildcards can be used.","title":"copy_once"},{"location":"reference/skin-options/copygenerator/#copy_always","text":"This is a list of files that should be copied on every invocation. Wildcards can be used. Here is the [CopyGenerator] section from the Standard skin.conf [CopyGenerator] # This section is used by the generator CopyGenerator # List of files to be copied only the first time the generator runs copy_once = backgrounds/*, weewx.css, mobile.css, favicon.ico # List of files to be copied each time the generator runs # copy_always = The Standard skin includes some background images, CSS files, and icons that need to be copied once. There are no files that need to be copied every time the generator runs.","title":"copy_always"},{"location":"reference/skin-options/extras/","text":"[Extras] \u00b6 This section is available to add any static tags you might want to use in your templates. As an example, the skin.conf file for the Seasons skin includes three options: Skin option Template tag radar_img $Extras.radar_img radar_url $Extras.radar_url googleAnalyticsId $Extras.googleAnalyticsId If you take a look at the template radar.inc you will see examples of testing for these tags. radar_img \u00b6 Set to an URL to show a local radar image for your region. radar_url \u00b6 If the radar image is clicked, the browser will go to this URL. This is usually used to show a more detailed, close-up, radar picture. For me in Oregon, setting the two options to: [Extras] radar_img = http://radar.weather.gov/ridge/lite/N0R/RTX_loop.gif radar_url = http://radar.weather.gov/ridge/radar.php?product=NCR&rid=RTX&loop=yes results in a nice image of a radar centered on Portland, Oregon. When you click on it, it gives you a detailed, animated view. If you live in the USA, take a look at the NOAA radar website to find a nice one that will work for you. In other countries, you will have to consult your local weather service. googleAnalyticsId \u00b6 If you have a Google Analytics ID , you can set it here. The Google Analytics Javascript code will then be included, enabling analytics of your website usage. If commented out, the code will not be included. Extending [Extras] \u00b6 Other tags can be added in a similar manner, including subsections. For example, say you have added a video camera, and you would like to add a still image with a hyperlink to a page with the video. You want all of these options to be neatly contained in a subsection. [Extras] [[video]] still = video_capture.jpg hyperlink = http://www.eatatjoes.com/video.html Then in your template you could refer to these as: < a href = \"$Extras.video.hyperlink\" > < img src = \"$Extras.video.still\" alt = \"Video capture\" /> </ a >","title":"[Extras]"},{"location":"reference/skin-options/extras/#extras","text":"This section is available to add any static tags you might want to use in your templates. As an example, the skin.conf file for the Seasons skin includes three options: Skin option Template tag radar_img $Extras.radar_img radar_url $Extras.radar_url googleAnalyticsId $Extras.googleAnalyticsId If you take a look at the template radar.inc you will see examples of testing for these tags.","title":"[Extras]"},{"location":"reference/skin-options/extras/#radar_img","text":"Set to an URL to show a local radar image for your region.","title":"radar_img"},{"location":"reference/skin-options/extras/#radar_url","text":"If the radar image is clicked, the browser will go to this URL. This is usually used to show a more detailed, close-up, radar picture. For me in Oregon, setting the two options to: [Extras] radar_img = http://radar.weather.gov/ridge/lite/N0R/RTX_loop.gif radar_url = http://radar.weather.gov/ridge/radar.php?product=NCR&rid=RTX&loop=yes results in a nice image of a radar centered on Portland, Oregon. When you click on it, it gives you a detailed, animated view. If you live in the USA, take a look at the NOAA radar website to find a nice one that will work for you. In other countries, you will have to consult your local weather service.","title":"radar_url"},{"location":"reference/skin-options/extras/#googleanalyticsid","text":"If you have a Google Analytics ID , you can set it here. The Google Analytics Javascript code will then be included, enabling analytics of your website usage. If commented out, the code will not be included.","title":"googleAnalyticsId"},{"location":"reference/skin-options/extras/#extending-extras","text":"Other tags can be added in a similar manner, including subsections. For example, say you have added a video camera, and you would like to add a still image with a hyperlink to a page with the video. You want all of these options to be neatly contained in a subsection. [Extras] [[video]] still = video_capture.jpg hyperlink = http://www.eatatjoes.com/video.html Then in your template you could refer to these as: < a href = \"$Extras.video.hyperlink\" > < img src = \"$Extras.video.still\" alt = \"Video capture\" /> </ a >","title":"Extending [Extras]"},{"location":"reference/skin-options/generators/","text":"[Generators] \u00b6 This section defines the list of generators that should be run. generator_list \u00b6 This option controls which generators get run for this skin. It is a comma separated list. The generators will be run in this order. For example, the Standard skin uses three generators: CheetahGenerator , ImageGenerator , and CopyGenerator . Here is the [Generators] section from the Standard skin.conf [Generators] generator_list = weewx.cheetahgenerator.CheetahGenerator, weewx.imagegenerator.ImageGenerator, weewx.reportengine.CopyGenerator","title":"[Generators]"},{"location":"reference/skin-options/generators/#generators","text":"This section defines the list of generators that should be run.","title":"[Generators]"},{"location":"reference/skin-options/generators/#generator_list","text":"This option controls which generators get run for this skin. It is a comma separated list. The generators will be run in this order. For example, the Standard skin uses three generators: CheetahGenerator , ImageGenerator , and CopyGenerator . Here is the [Generators] section from the Standard skin.conf [Generators] generator_list = weewx.cheetahgenerator.CheetahGenerator, weewx.imagegenerator.ImageGenerator, weewx.reportengine.CopyGenerator","title":"generator_list"},{"location":"reference/skin-options/imagegenerator/","text":"[ImageGenerator] \u00b6 This section describes the various options available to the image generator. Part names in a WeeWX image General options \u00b6 These are options that affect the overall image. anti_alias \u00b6 Setting to 2 or more might give a sharper image, with fewer jagged edges. Experimentation is in order. Default is 1 . A GIF showing the same image with anti_alias=1 , 2 , and 4 . chart_background_color \u00b6 The background color of the chart itself. Optional. Default is #d8d8d8 . chart_gridline_color \u00b6 The color of the chart grid lines. Optional. Default is #a0a0a0 Example of day/night bands in a one week image daynight_day_color \u00b6 The color to be used for the daylight band. Optional. Default is #ffffff . daynight_edge_color \u00b6 The color to be used in the transition zone between night and day. Optional. Default is #efefef , a mid-gray. daynight_night_color \u00b6 The color to be used for the nighttime band. Optional. Default is #f0f0f0 , a dark gray. image_background_color \u00b6 The background color of the whole image. Optional. Default is #f5f5f5 (\"SmokeGray\") image_width \u00b6 image_height \u00b6 The width and height of the image in pixels. Optional. Default is 300 x 180 pixels. show_daynight \u00b6 Set to true to show day/night bands in an image. Otherwise, set to false. This only looks good with day or week plots. Optional. Default is false . skip_if_empty \u00b6 If set to true , then skip the generation of the image if all data in it are null. If set to a time period, such as month or year , then skip the generation of the image if all data in that period are null. Default is false . stale_age \u00b6 Image file staleness age, in seconds. If the image file is older than this age it will be generated. If no stale_age is specified, then the image file will be generated every time the generator runs. unit \u00b6 Normally, the unit used in a plot is set by whatever unit group the types are in . However, this option allows overriding the unit used in a specific plot. Label options \u00b6 These are options for the various labels used in the image. axis_label_font_color \u00b6 The color of the x- and y-axis label font. Optional. Default is black . axis_label_font_path \u00b6 The path to the font to be used for the x- and y-axis labels. Optional. If not given, or if WeeWX cannot find the font, then the default PIL font will be used. axis_label_font_size \u00b6 The size of the x- and y-axis labels in pixels. Optional. The default is 10 . bottom_label_font_color \u00b6 The color of the bottom label font. Optional. Default is black . bottom_label_font_path \u00b6 The path to the font to be used for the bottom label. Optional. If not given, or if WeeWX cannot find the font, then the default PIL font will be used. bottom_label_font_size \u00b6 The size of the bottom label in pixels. Optional. The default is 10 . bottom_label_format \u00b6 The format to be used for the bottom label. It should be a strftime format . Optional. Default is '%m/%d/%y %H:%M' . bottom_label_offset \u00b6 The margin of the bottom label from the bottom of the plot. Default is 3. top_label_font_path \u00b6 The path to the font to be used for the top label. Optional. If not given, or if WeeWX cannot find the font, then the default PIL font will be used. top_label_font_size \u00b6 The size of the top label in pixels. Optional. The default is 10 . unit_label_font_color \u00b6 The color of the unit label font. Optional. Default is black . unit_label_font_path \u00b6 The path to the font to be used for the unit label. Optional. If not given, or if WeeWX cannot find the font, then the default PIL font will be used. unit_label_font_size \u00b6 The size of the unit label in pixels. Optional. The default is 10 . x_interval \u00b6 The time interval in seconds between x-axis tick marks. Optional. If not given, a suitable default will be chosen. x_label_format \u00b6 The format to be used for the time labels on the x-axis. It should be a strftime format . Optional. If not given, a sensible format will be chosen automatically. x_label_spacing \u00b6 Specifies the ordinal increment between labels on the x-axis: For example, 3 means a label every 3rd tick mark. Optional. The default is 2 . y_label_side \u00b6 Specifies if the y-axis labels should be on the left, right, or both sides of the graph. Valid values are left , right or both . Optional. Default is left . y_label_spacing \u00b6 Specifies the ordinal increment between labels on the y-axis: For example, 3 means a label every 3rd tick mark. Optional. The default is 2 . y_nticks \u00b6 The nominal number of ticks along the y-axis. The default is 10 . Plot scaling options \u00b6 time_length \u00b6 The nominal length of the time period to be covered in seconds. Alternatively, a duration notation can be used. The exact length of the x-axis is chosen by the plotting engine to cover this period. Optional. Default is 86400 (one day). yscale \u00b6 A 3-way tuple ( ylow , yhigh , min_interval ), where ylow and yhigh are the minimum and maximum y-axis values, respectively, and min_interval is the minimum tick interval. If set to None , the corresponding value will be automatically chosen. Optional. Default is None, None, None . (Choose the y-axis minimum, maximum, and minimum increment automatically.) Compass rose options \u00b6 Example of a vector plot with a compass rose in the lower-left rose_label \u00b6 The label to be used in the compass rose to indicate due North. Optional. Default is N . rose_label_font_path \u00b6 The path to the font to be used for the rose label (the letter \"N,\" indicating North). Optional. If not given, or if WeeWX cannot find the font, then the default PIL font will be used. rose_label_font_size \u00b6 The size of the compass rose label in pixels. Optional. The default is 10 . rose_label_font_color \u00b6 The color of the compass rose label. Optional. Default is the same color as the rose itself. vector_rotate \u00b6 Causes the vectors to be rotated by this many degrees. Positive is clockwise. If westerly winds dominate at your location (as they do at mine), then you may want to specify +90 for this option. This will cause the average vector to point straight up, rather than lie flat against the x-axis. Optional. The default is 0 . Plot line options \u00b6 These are options shared by all the plot lines. chart_line_colors \u00b6 Each chart line is drawn in a different color. This option is a list of those colors. If the number of lines exceeds the length of the list, then the colors wrap around to the beginning of the list. Optional. In the case of bar charts, this is the color of the outline of the bar. Default is #0000ff, #00ff00, #ff0000 . Individual line color can be overridden by using option color . chart_fill_colors \u00b6 A list of the color to be used as the fill of the bar charts. Optional. The default is to use the same color as the outline color (option chart_line_colors ). chart_line_width \u00b6 Each chart line can be drawn using a different line width. This option is a list of these widths. If the number of lines exceeds the length of the list, then the widths wrap around to the beginning of the list. Optional. Default is 1, 1, 1 . Individual line widths can be overridden by using option width . Individual line options \u00b6 These are options that are set for individual lines. aggregate_interval \u00b6 The time period over which the data should be aggregated, in seconds. Alternatively, a duration notation can be used. Required if aggregate_type has been set. aggregate_type \u00b6 The default is to plot every data point, but this is probably not a good idea for any plot longer than a day. By setting this option, you can aggregate data by a set time interval. Available aggregation types include avg , count , cumulative , diff , last , max , min , sum , and tderiv . color \u00b6 This option is to override the color for an individual line. Optional. Default is to use the color in chart_line_colors . data_type \u00b6 The SQL data type to be used for this plot line. For more information, see the section Including a type more than once in a plot . Optional. The default is to use the section name. fill_color \u00b6 This option is to override the fill color for a bar chart. Optional. Default is to use the color in chart_fill_colors . label \u00b6 The label to be used for this plot line in the top label. Optional. The default is to use the SQL variable name. line_gap_fraction \u00b6 If there is a gap between data points bigger than this fractional amount of the x-axis, then a gap will be drawn, rather than a connecting line. See Section Line gaps . Optional. The default is to always draw the line. line_type \u00b6 The type of line to be used. Choices are solid or none . Optional. Default is solid . marker_size \u00b6 The size of the marker. Optional. Default is 8 . marker_type \u00b6 The type of marker to be used to mark each data point. Choices are cross , x , circle , box , or none . Optional. Default is none . plot_type \u00b6 The type of plot for this line. Choices are line , bar , or vector . Optional. Default is line . width \u00b6 This option is to override the line width for an individual line. Optional. Default is to use the width in chart_line_width .","title":"[ImageGenerator]"},{"location":"reference/skin-options/imagegenerator/#imagegenerator","text":"This section describes the various options available to the image generator. Part names in a WeeWX image","title":"[ImageGenerator]"},{"location":"reference/skin-options/imagegenerator/#general-options","text":"These are options that affect the overall image.","title":"General options"},{"location":"reference/skin-options/imagegenerator/#anti_alias","text":"Setting to 2 or more might give a sharper image, with fewer jagged edges. Experimentation is in order. Default is 1 . A GIF showing the same image with anti_alias=1 , 2 , and 4 .","title":"anti_alias"},{"location":"reference/skin-options/imagegenerator/#chart_background_color","text":"The background color of the chart itself. Optional. Default is #d8d8d8 .","title":"chart_background_color"},{"location":"reference/skin-options/imagegenerator/#chart_gridline_color","text":"The color of the chart grid lines. Optional. Default is #a0a0a0 Example of day/night bands in a one week image","title":"chart_gridline_color"},{"location":"reference/skin-options/imagegenerator/#daynight_day_color","text":"The color to be used for the daylight band. Optional. Default is #ffffff .","title":"daynight_day_color"},{"location":"reference/skin-options/imagegenerator/#daynight_edge_color","text":"The color to be used in the transition zone between night and day. Optional. Default is #efefef , a mid-gray.","title":"daynight_edge_color"},{"location":"reference/skin-options/imagegenerator/#daynight_night_color","text":"The color to be used for the nighttime band. Optional. Default is #f0f0f0 , a dark gray.","title":"daynight_night_color"},{"location":"reference/skin-options/imagegenerator/#image_background_color","text":"The background color of the whole image. Optional. Default is #f5f5f5 (\"SmokeGray\")","title":"image_background_color"},{"location":"reference/skin-options/imagegenerator/#image_width","text":"","title":"image_width"},{"location":"reference/skin-options/imagegenerator/#image_height","text":"The width and height of the image in pixels. Optional. Default is 300 x 180 pixels.","title":"image_height"},{"location":"reference/skin-options/imagegenerator/#show_daynight","text":"Set to true to show day/night bands in an image. Otherwise, set to false. This only looks good with day or week plots. Optional. Default is false .","title":"show_daynight"},{"location":"reference/skin-options/imagegenerator/#skip_if_empty","text":"If set to true , then skip the generation of the image if all data in it are null. If set to a time period, such as month or year , then skip the generation of the image if all data in that period are null. Default is false .","title":"skip_if_empty"},{"location":"reference/skin-options/imagegenerator/#stale_age","text":"Image file staleness age, in seconds. If the image file is older than this age it will be generated. If no stale_age is specified, then the image file will be generated every time the generator runs.","title":"stale_age"},{"location":"reference/skin-options/imagegenerator/#unit","text":"Normally, the unit used in a plot is set by whatever unit group the types are in . However, this option allows overriding the unit used in a specific plot.","title":"unit"},{"location":"reference/skin-options/imagegenerator/#label-options","text":"These are options for the various labels used in the image.","title":"Label options"},{"location":"reference/skin-options/imagegenerator/#axis_label_font_color","text":"The color of the x- and y-axis label font. Optional. Default is black .","title":"axis_label_font_color"},{"location":"reference/skin-options/imagegenerator/#axis_label_font_path","text":"The path to the font to be used for the x- and y-axis labels. Optional. If not given, or if WeeWX cannot find the font, then the default PIL font will be used.","title":"axis_label_font_path"},{"location":"reference/skin-options/imagegenerator/#axis_label_font_size","text":"The size of the x- and y-axis labels in pixels. Optional. The default is 10 .","title":"axis_label_font_size"},{"location":"reference/skin-options/imagegenerator/#bottom_label_font_color","text":"The color of the bottom label font. Optional. Default is black .","title":"bottom_label_font_color"},{"location":"reference/skin-options/imagegenerator/#bottom_label_font_path","text":"The path to the font to be used for the bottom label. Optional. If not given, or if WeeWX cannot find the font, then the default PIL font will be used.","title":"bottom_label_font_path"},{"location":"reference/skin-options/imagegenerator/#bottom_label_font_size","text":"The size of the bottom label in pixels. Optional. The default is 10 .","title":"bottom_label_font_size"},{"location":"reference/skin-options/imagegenerator/#bottom_label_format","text":"The format to be used for the bottom label. It should be a strftime format . Optional. Default is '%m/%d/%y %H:%M' .","title":"bottom_label_format"},{"location":"reference/skin-options/imagegenerator/#bottom_label_offset","text":"The margin of the bottom label from the bottom of the plot. Default is 3.","title":"bottom_label_offset"},{"location":"reference/skin-options/imagegenerator/#top_label_font_path","text":"The path to the font to be used for the top label. Optional. If not given, or if WeeWX cannot find the font, then the default PIL font will be used.","title":"top_label_font_path"},{"location":"reference/skin-options/imagegenerator/#top_label_font_size","text":"The size of the top label in pixels. Optional. The default is 10 .","title":"top_label_font_size"},{"location":"reference/skin-options/imagegenerator/#unit_label_font_color","text":"The color of the unit label font. Optional. Default is black .","title":"unit_label_font_color"},{"location":"reference/skin-options/imagegenerator/#unit_label_font_path","text":"The path to the font to be used for the unit label. Optional. If not given, or if WeeWX cannot find the font, then the default PIL font will be used.","title":"unit_label_font_path"},{"location":"reference/skin-options/imagegenerator/#unit_label_font_size","text":"The size of the unit label in pixels. Optional. The default is 10 .","title":"unit_label_font_size"},{"location":"reference/skin-options/imagegenerator/#x_interval","text":"The time interval in seconds between x-axis tick marks. Optional. If not given, a suitable default will be chosen.","title":"x_interval"},{"location":"reference/skin-options/imagegenerator/#x_label_format","text":"The format to be used for the time labels on the x-axis. It should be a strftime format . Optional. If not given, a sensible format will be chosen automatically.","title":"x_label_format"},{"location":"reference/skin-options/imagegenerator/#x_label_spacing","text":"Specifies the ordinal increment between labels on the x-axis: For example, 3 means a label every 3rd tick mark. Optional. The default is 2 .","title":"x_label_spacing"},{"location":"reference/skin-options/imagegenerator/#y_label_side","text":"Specifies if the y-axis labels should be on the left, right, or both sides of the graph. Valid values are left , right or both . Optional. Default is left .","title":"y_label_side"},{"location":"reference/skin-options/imagegenerator/#y_label_spacing","text":"Specifies the ordinal increment between labels on the y-axis: For example, 3 means a label every 3rd tick mark. Optional. The default is 2 .","title":"y_label_spacing"},{"location":"reference/skin-options/imagegenerator/#y_nticks","text":"The nominal number of ticks along the y-axis. The default is 10 .","title":"y_nticks"},{"location":"reference/skin-options/imagegenerator/#plot-scaling-options","text":"","title":"Plot scaling options"},{"location":"reference/skin-options/imagegenerator/#time_length","text":"The nominal length of the time period to be covered in seconds. Alternatively, a duration notation can be used. The exact length of the x-axis is chosen by the plotting engine to cover this period. Optional. Default is 86400 (one day).","title":"time_length"},{"location":"reference/skin-options/imagegenerator/#yscale","text":"A 3-way tuple ( ylow , yhigh , min_interval ), where ylow and yhigh are the minimum and maximum y-axis values, respectively, and min_interval is the minimum tick interval. If set to None , the corresponding value will be automatically chosen. Optional. Default is None, None, None . (Choose the y-axis minimum, maximum, and minimum increment automatically.)","title":"yscale"},{"location":"reference/skin-options/imagegenerator/#compass-rose-options","text":"Example of a vector plot with a compass rose in the lower-left","title":"Compass rose options"},{"location":"reference/skin-options/imagegenerator/#rose_label","text":"The label to be used in the compass rose to indicate due North. Optional. Default is N .","title":"rose_label"},{"location":"reference/skin-options/imagegenerator/#rose_label_font_path","text":"The path to the font to be used for the rose label (the letter \"N,\" indicating North). Optional. If not given, or if WeeWX cannot find the font, then the default PIL font will be used.","title":"rose_label_font_path"},{"location":"reference/skin-options/imagegenerator/#rose_label_font_size","text":"The size of the compass rose label in pixels. Optional. The default is 10 .","title":"rose_label_font_size"},{"location":"reference/skin-options/imagegenerator/#rose_label_font_color","text":"The color of the compass rose label. Optional. Default is the same color as the rose itself.","title":"rose_label_font_color"},{"location":"reference/skin-options/imagegenerator/#vector_rotate","text":"Causes the vectors to be rotated by this many degrees. Positive is clockwise. If westerly winds dominate at your location (as they do at mine), then you may want to specify +90 for this option. This will cause the average vector to point straight up, rather than lie flat against the x-axis. Optional. The default is 0 .","title":"vector_rotate"},{"location":"reference/skin-options/imagegenerator/#plot-line-options","text":"These are options shared by all the plot lines.","title":"Plot line options"},{"location":"reference/skin-options/imagegenerator/#chart_line_colors","text":"Each chart line is drawn in a different color. This option is a list of those colors. If the number of lines exceeds the length of the list, then the colors wrap around to the beginning of the list. Optional. In the case of bar charts, this is the color of the outline of the bar. Default is #0000ff, #00ff00, #ff0000 . Individual line color can be overridden by using option color .","title":"chart_line_colors"},{"location":"reference/skin-options/imagegenerator/#chart_fill_colors","text":"A list of the color to be used as the fill of the bar charts. Optional. The default is to use the same color as the outline color (option chart_line_colors ).","title":"chart_fill_colors"},{"location":"reference/skin-options/imagegenerator/#chart_line_width","text":"Each chart line can be drawn using a different line width. This option is a list of these widths. If the number of lines exceeds the length of the list, then the widths wrap around to the beginning of the list. Optional. Default is 1, 1, 1 . Individual line widths can be overridden by using option width .","title":"chart_line_width"},{"location":"reference/skin-options/imagegenerator/#individual-line-options","text":"These are options that are set for individual lines.","title":"Individual line options"},{"location":"reference/skin-options/imagegenerator/#aggregate_interval","text":"The time period over which the data should be aggregated, in seconds. Alternatively, a duration notation can be used. Required if aggregate_type has been set.","title":"aggregate_interval"},{"location":"reference/skin-options/imagegenerator/#aggregate_type","text":"The default is to plot every data point, but this is probably not a good idea for any plot longer than a day. By setting this option, you can aggregate data by a set time interval. Available aggregation types include avg , count , cumulative , diff , last , max , min , sum , and tderiv .","title":"aggregate_type"},{"location":"reference/skin-options/imagegenerator/#color","text":"This option is to override the color for an individual line. Optional. Default is to use the color in chart_line_colors .","title":"color"},{"location":"reference/skin-options/imagegenerator/#data_type","text":"The SQL data type to be used for this plot line. For more information, see the section Including a type more than once in a plot . Optional. The default is to use the section name.","title":"data_type"},{"location":"reference/skin-options/imagegenerator/#fill_color","text":"This option is to override the fill color for a bar chart. Optional. Default is to use the color in chart_fill_colors .","title":"fill_color"},{"location":"reference/skin-options/imagegenerator/#label","text":"The label to be used for this plot line in the top label. Optional. The default is to use the SQL variable name.","title":"label"},{"location":"reference/skin-options/imagegenerator/#line_gap_fraction","text":"If there is a gap between data points bigger than this fractional amount of the x-axis, then a gap will be drawn, rather than a connecting line. See Section Line gaps . Optional. The default is to always draw the line.","title":"line_gap_fraction"},{"location":"reference/skin-options/imagegenerator/#line_type","text":"The type of line to be used. Choices are solid or none . Optional. Default is solid .","title":"line_type"},{"location":"reference/skin-options/imagegenerator/#marker_size","text":"The size of the marker. Optional. Default is 8 .","title":"marker_size"},{"location":"reference/skin-options/imagegenerator/#marker_type","text":"The type of marker to be used to mark each data point. Choices are cross , x , circle , box , or none . Optional. Default is none .","title":"marker_type"},{"location":"reference/skin-options/imagegenerator/#plot_type","text":"The type of plot for this line. Choices are line , bar , or vector . Optional. Default is line .","title":"plot_type"},{"location":"reference/skin-options/imagegenerator/#width","text":"This option is to override the line width for an individual line. Optional. Default is to use the width in chart_line_width .","title":"width"},{"location":"reference/skin-options/introduction/","text":"Skin options \u00b6 The skin configuration options control report behavior, including: how files and plots are generated how files and plots look how data are displayed how units are displayed which language is used Options that control the behavior of a skin are specified in the skin configuration file skin.conf . Language-dependent labels and texts are specified in the language files, located in the skin's lang directory. UTF-8 is used throughout the skin configuration file, just as it is throughout the WeeWX configuration file.","title":"Introduction"},{"location":"reference/skin-options/introduction/#skin-options","text":"The skin configuration options control report behavior, including: how files and plots are generated how files and plots look how data are displayed how units are displayed which language is used Options that control the behavior of a skin are specified in the skin configuration file skin.conf . Language-dependent labels and texts are specified in the language files, located in the skin's lang directory. UTF-8 is used throughout the skin configuration file, just as it is throughout the WeeWX configuration file.","title":"Skin options"},{"location":"reference/skin-options/labels/","text":"[Labels] \u00b6 This section defines various labels. hemispheres \u00b6 Comma separated list for the labels to be used for the four hemispheres. The default is N, S, E, W . latlon_formats \u00b6 Comma separated list for the formatting to be used when converting latitude and longitude to strings. There should be three elements: The format to be used for whole degrees of latitude The format to be used for whole degrees of longitude The format to be used for minutes. This allows you to decide whether you want leading zeroes. The default includes leading zeroes and is \"%02d\", \"%03d\", \"%05.2f\" . [[Generic]] \u00b6 This section specifies default labels to be used for each observation type. For example, options inTemp = Temperature inside the house outTemp = Outside Temperature UV = UV Index would cause the given labels to be used for plots of inTemp and outTemp . If no option is given, then the observation type itself will be used ( e.g. , outTemp ).","title":"[Labels]"},{"location":"reference/skin-options/labels/#labels","text":"This section defines various labels.","title":"[Labels]"},{"location":"reference/skin-options/labels/#hemispheres","text":"Comma separated list for the labels to be used for the four hemispheres. The default is N, S, E, W .","title":"hemispheres"},{"location":"reference/skin-options/labels/#latlon_formats","text":"Comma separated list for the formatting to be used when converting latitude and longitude to strings. There should be three elements: The format to be used for whole degrees of latitude The format to be used for whole degrees of longitude The format to be used for minutes. This allows you to decide whether you want leading zeroes. The default includes leading zeroes and is \"%02d\", \"%03d\", \"%05.2f\" .","title":"latlon_formats"},{"location":"reference/skin-options/labels/#generic","text":"This section specifies default labels to be used for each observation type. For example, options inTemp = Temperature inside the house outTemp = Outside Temperature UV = UV Index would cause the given labels to be used for plots of inTemp and outTemp . If no option is given, then the observation type itself will be used ( e.g. , outTemp ).","title":"[[Generic]]"},{"location":"reference/skin-options/texts/","text":"[Texts] \u00b6 The section [Texts] holds static texts that are used in the templates. Generally there are multiple language files, one for each supported language, named by the language codes defined in ISO 639-1 . The entries give the translation of the texts to the target language. For example, [Texts] \"Current Conditions\" = \"Aktuelle Werte\" would cause \"Aktuelle Werte\" to be used whereever $gettext(\"Current Conditions\" appeared. See the section on $gettext . Note Strings that include commas must be included in single or double quotes. Otherwise, they will be misinterpreted as a list.","title":"[Texts]"},{"location":"reference/skin-options/texts/#texts","text":"The section [Texts] holds static texts that are used in the templates. Generally there are multiple language files, one for each supported language, named by the language codes defined in ISO 639-1 . The entries give the translation of the texts to the target language. For example, [Texts] \"Current Conditions\" = \"Aktuelle Werte\" would cause \"Aktuelle Werte\" to be used whereever $gettext(\"Current Conditions\" appeared. See the section on $gettext . Note Strings that include commas must be included in single or double quotes. Otherwise, they will be misinterpreted as a list.","title":"[Texts]"},{"location":"reference/skin-options/units/","text":"[Units] \u00b6 This section controls how units are managed and displayed. [[Groups]] \u00b6 This section lists all the Unit Groups and specifies which measurement unit is to be used for each one of them. As there are many different observational measurement types (such as outTemp , barometer , etc.) used in WeeWX (more than 50 at last count), it would be tedious, not to say possibly inconsistent, to specify a different measurement system for each one of them. At the other extreme, requiring all of them to be \"U.S. Customary\" or \"Metric\" seems overly restrictive. WeeWX has taken a middle route and divided all the different observation types into 12 different unit groups . A unit group is something like group_temperature . It represents the measurement system to be used by all observation types that are measured in temperature, such as inside temperature (type inTemp ), outside temperature ( outTemp ), dewpoint ( dewpoint ), wind chill ( windchill ), and so on. If you decide that you want unit group group_temperature to be measured in degree_C then you are saying all members of its group will be reported in degrees Celsius. Note that the measurement unit is always specified in the singular. That is, specify degree_C or foot , not degrees_C or feet . See the reference section Units for more information, including a concise summary of the groups, their members, and which options can be used for each group. group_altitude \u00b6 Which measurement unit to be used for altitude. Possible options are foot or meter . group_direction \u00b6 Which measurement unit to be used for direction. The only option is degree_compass . group_distance \u00b6 Which measurement unit to be used for distance (such as for wind run). Possible options are mile or km . group_moisture \u00b6 The measurement unit to be used for soil moisture. The only option is centibar . group_percent \u00b6 The measurement unit to be used for percentages. The only option is percent . group_pressure \u00b6 The measurement unit to be used for pressure. Possible options are one of inHg (inches of mercury), mbar , hPa , or kPa . group_pressurerate \u00b6 The measurement unit to be used for rate of change in pressure. Possible options are one of inHg_per_hour (inches of mercury per hour), mbar_per_hour , hPa_per_hour , or kPa_per_hour . group_radiation \u00b6 The measurement unit to be used for radiation. The only option is watt_per_meter_squared . group_rain \u00b6 The measurement unit to be used for precipitation. Options are inch , cm , or mm . group_rainrate \u00b6 The measurement unit to be used for rate of precipitation. Possible options are one of inch_per_hour , cm_per_hour , or mm_per_hour . group_speed \u00b6 The measurement unit to be used for wind speeds. Possible options are one of mile_per_hour , km_per_hour , knot , meter_per_second , or beaufort . group_speed2 \u00b6 This group is similar to group_speed , but is used for calculated wind speeds which typically have a slightly higher resolution. Possible options are one mile_per_hour2 , km_per_hour2 , knot2 , or meter_per_second2 . group_temperature \u00b6 The measurement unit to be used for temperatures. Options are degree_C , degree_E , degree_F , or degree_K . group_volt \u00b6 The measurement unit to be used for voltages. The only option is volt . [[StringFormats]] \u00b6 This section is used to specify what string format is to be used for each unit when a quantity needs to be converted to a string. Typically, this happens with y-axis labeling on plots and for statistics in HTML file generation. For example, the options degree_C = %.1f inch = %.2f would specify that the given string formats are to be used when formatting any temperature measured in degrees Celsius or any precipitation amount measured in inches, respectively. The formatting codes are those used by Python , and are very similar to C's sprintf() codes. You can also specify what string to use for an invalid or unavailable measurement (value None ). For example, NONE = \" N/A \" [[Labels]] \u00b6 This section specifies what label is to be used for each measurement unit type. For example, the options degree_F = \u00b0F inch = ' in' would cause all temperatures to have unit labels \u00b0F and all precipitation to have labels in . If any special symbols are to be used (such as the degree sign) they should be encoded in UTF-8. This is generally what most text editors use if you cut-and-paste from a character map. If the label includes two values, then the first is assumed to be the singular form, the second the plural form. For example, foot = \" foot\", \" feet\" ... day = \" day\", \" days\" hour = \" hour\", \" hours\" minute = \" minute\", \" minutes\" second = \" second\", \" seconds\" [[TimeFormats]] \u00b6 This section specifies what time format to use for different time contexts . For example, you might want to use a different format when displaying the time in a day, versus the time in a month. It uses strftime() formats. The default looks like this: [[TimeFormats]] hour = %H:%M day = %X week = %X (%A) month = %x %X year = %x %X rainyear = %x %X current = %x %X ephem_day = %X ephem_year = %x %X The specifiers %x , %X , and %A code locale dependent date, time, and weekday names, respectively. Hence, if you set an appropriate environment variable LANG , then the date and times should follow local conventions (see section Environment variable LANG for details on how to do this). However, the results may not look particularly nice, and you may want to change them. For example, I use this in the U.S.: [[TimeFormats]] # # More attractive formats that work in most Western countries. # day = %H:%M week = %H:%M on %A month = %d-%b-%Y %H:%M year = %d-%b-%Y %H:%M rainyear = %d-%b-%Y %H:%M current = %d-%b-%Y %H:%M ephem_day = %H:%M ephem_year = %d-%b-%Y %H:%M The last two formats, ephem_day and ephem_year allow the formatting to be set for almanac times The first, ephem_day , is used for almanac times within the day, such as sunrise or sunset. The second, ephem_year , is used for almanac times within the year, such as the next equinox or full moon. [[Ordinates]] \u00b6 directions \u00b6 Set to the abbreviations to be used for ordinal directions. By default, this is N, NNE, NE, ENE, E, ESE, SE, SSE, S, SSW, SW, WSW, W, WNW, NW, NNW, N . [[DegreeDays]] \u00b6 heating_base \u00b6 cooling_base \u00b6 growing_base \u00b6 Set to the base temperature for calculating heating, cooling, and growing degree-days, along with the unit to be used. Examples: heating_base = 65.0, degree_F cooling_base = 20.0, degree_C growing_base = 50.0, degree_F [[Trend]] \u00b6 time_delta \u00b6 Set to the time difference over which you want trends to be calculated. Alternatively, a duration notation can be used. The default is 3 hours. time_grace \u00b6 When searching for a previous record to be used in calculating a trend, a record within this amount of time_delta will be accepted. Default is 300 seconds.","title":"[Units]"},{"location":"reference/skin-options/units/#units","text":"This section controls how units are managed and displayed.","title":"[Units]"},{"location":"reference/skin-options/units/#groups","text":"This section lists all the Unit Groups and specifies which measurement unit is to be used for each one of them. As there are many different observational measurement types (such as outTemp , barometer , etc.) used in WeeWX (more than 50 at last count), it would be tedious, not to say possibly inconsistent, to specify a different measurement system for each one of them. At the other extreme, requiring all of them to be \"U.S. Customary\" or \"Metric\" seems overly restrictive. WeeWX has taken a middle route and divided all the different observation types into 12 different unit groups . A unit group is something like group_temperature . It represents the measurement system to be used by all observation types that are measured in temperature, such as inside temperature (type inTemp ), outside temperature ( outTemp ), dewpoint ( dewpoint ), wind chill ( windchill ), and so on. If you decide that you want unit group group_temperature to be measured in degree_C then you are saying all members of its group will be reported in degrees Celsius. Note that the measurement unit is always specified in the singular. That is, specify degree_C or foot , not degrees_C or feet . See the reference section Units for more information, including a concise summary of the groups, their members, and which options can be used for each group.","title":"[[Groups]]"},{"location":"reference/skin-options/units/#group_altitude","text":"Which measurement unit to be used for altitude. Possible options are foot or meter .","title":"group_altitude"},{"location":"reference/skin-options/units/#group_direction","text":"Which measurement unit to be used for direction. The only option is degree_compass .","title":"group_direction"},{"location":"reference/skin-options/units/#group_distance","text":"Which measurement unit to be used for distance (such as for wind run). Possible options are mile or km .","title":"group_distance"},{"location":"reference/skin-options/units/#group_moisture","text":"The measurement unit to be used for soil moisture. The only option is centibar .","title":"group_moisture"},{"location":"reference/skin-options/units/#group_percent","text":"The measurement unit to be used for percentages. The only option is percent .","title":"group_percent"},{"location":"reference/skin-options/units/#group_pressure","text":"The measurement unit to be used for pressure. Possible options are one of inHg (inches of mercury), mbar , hPa , or kPa .","title":"group_pressure"},{"location":"reference/skin-options/units/#group_pressurerate","text":"The measurement unit to be used for rate of change in pressure. Possible options are one of inHg_per_hour (inches of mercury per hour), mbar_per_hour , hPa_per_hour , or kPa_per_hour .","title":"group_pressurerate"},{"location":"reference/skin-options/units/#group_radiation","text":"The measurement unit to be used for radiation. The only option is watt_per_meter_squared .","title":"group_radiation"},{"location":"reference/skin-options/units/#group_rain","text":"The measurement unit to be used for precipitation. Options are inch , cm , or mm .","title":"group_rain"},{"location":"reference/skin-options/units/#group_rainrate","text":"The measurement unit to be used for rate of precipitation. Possible options are one of inch_per_hour , cm_per_hour , or mm_per_hour .","title":"group_rainrate"},{"location":"reference/skin-options/units/#group_speed","text":"The measurement unit to be used for wind speeds. Possible options are one of mile_per_hour , km_per_hour , knot , meter_per_second , or beaufort .","title":"group_speed"},{"location":"reference/skin-options/units/#group_speed2","text":"This group is similar to group_speed , but is used for calculated wind speeds which typically have a slightly higher resolution. Possible options are one mile_per_hour2 , km_per_hour2 , knot2 , or meter_per_second2 .","title":"group_speed2"},{"location":"reference/skin-options/units/#group_temperature","text":"The measurement unit to be used for temperatures. Options are degree_C , degree_E , degree_F , or degree_K .","title":"group_temperature"},{"location":"reference/skin-options/units/#group_volt","text":"The measurement unit to be used for voltages. The only option is volt .","title":"group_volt"},{"location":"reference/skin-options/units/#stringformats","text":"This section is used to specify what string format is to be used for each unit when a quantity needs to be converted to a string. Typically, this happens with y-axis labeling on plots and for statistics in HTML file generation. For example, the options degree_C = %.1f inch = %.2f would specify that the given string formats are to be used when formatting any temperature measured in degrees Celsius or any precipitation amount measured in inches, respectively. The formatting codes are those used by Python , and are very similar to C's sprintf() codes. You can also specify what string to use for an invalid or unavailable measurement (value None ). For example, NONE = \" N/A \"","title":"[[StringFormats]]"},{"location":"reference/skin-options/units/#labels","text":"This section specifies what label is to be used for each measurement unit type. For example, the options degree_F = \u00b0F inch = ' in' would cause all temperatures to have unit labels \u00b0F and all precipitation to have labels in . If any special symbols are to be used (such as the degree sign) they should be encoded in UTF-8. This is generally what most text editors use if you cut-and-paste from a character map. If the label includes two values, then the first is assumed to be the singular form, the second the plural form. For example, foot = \" foot\", \" feet\" ... day = \" day\", \" days\" hour = \" hour\", \" hours\" minute = \" minute\", \" minutes\" second = \" second\", \" seconds\"","title":"[[Labels]]"},{"location":"reference/skin-options/units/#timeformats","text":"This section specifies what time format to use for different time contexts . For example, you might want to use a different format when displaying the time in a day, versus the time in a month. It uses strftime() formats. The default looks like this: [[TimeFormats]] hour = %H:%M day = %X week = %X (%A) month = %x %X year = %x %X rainyear = %x %X current = %x %X ephem_day = %X ephem_year = %x %X The specifiers %x , %X , and %A code locale dependent date, time, and weekday names, respectively. Hence, if you set an appropriate environment variable LANG , then the date and times should follow local conventions (see section Environment variable LANG for details on how to do this). However, the results may not look particularly nice, and you may want to change them. For example, I use this in the U.S.: [[TimeFormats]] # # More attractive formats that work in most Western countries. # day = %H:%M week = %H:%M on %A month = %d-%b-%Y %H:%M year = %d-%b-%Y %H:%M rainyear = %d-%b-%Y %H:%M current = %d-%b-%Y %H:%M ephem_day = %H:%M ephem_year = %d-%b-%Y %H:%M The last two formats, ephem_day and ephem_year allow the formatting to be set for almanac times The first, ephem_day , is used for almanac times within the day, such as sunrise or sunset. The second, ephem_year , is used for almanac times within the year, such as the next equinox or full moon.","title":"[[TimeFormats]]"},{"location":"reference/skin-options/units/#ordinates","text":"","title":"[[Ordinates]]"},{"location":"reference/skin-options/units/#directions","text":"Set to the abbreviations to be used for ordinal directions. By default, this is N, NNE, NE, ENE, E, ESE, SE, SSE, S, SSW, SW, WSW, W, WNW, NW, NNW, N .","title":"directions"},{"location":"reference/skin-options/units/#degreedays","text":"","title":"[[DegreeDays]]"},{"location":"reference/skin-options/units/#heating_base","text":"","title":"heating_base"},{"location":"reference/skin-options/units/#cooling_base","text":"","title":"cooling_base"},{"location":"reference/skin-options/units/#growing_base","text":"Set to the base temperature for calculating heating, cooling, and growing degree-days, along with the unit to be used. Examples: heating_base = 65.0, degree_F cooling_base = 20.0, degree_C growing_base = 50.0, degree_F","title":"growing_base"},{"location":"reference/skin-options/units/#trend","text":"","title":"[[Trend]]"},{"location":"reference/skin-options/units/#time_delta","text":"Set to the time difference over which you want trends to be calculated. Alternatively, a duration notation can be used. The default is 3 hours.","title":"time_delta"},{"location":"reference/skin-options/units/#time_grace","text":"When searching for a previous record to be used in calculating a trend, a record within this amount of time_delta will be accepted. Default is 300 seconds.","title":"time_grace"},{"location":"reference/weewx-options/data-bindings/","text":"[DataBindings] \u00b6 A \"data binding\" associates storage characteristics with a specific database. Each binding contains a database from the [Databases] section plus parameters such as schema, table name, and mechanism for aggregating data. [[wx_binding]] \u00b6 This is the binding normally used for weather data. A typical [[wx_binding]] section looks something like this: [[wx_binding]] database = archive_sqlite table_name = archive manager = weewx.manager.DaySummaryManager schema = schemas.wview_extended.schema What follows is more detailed information about each of the binding options. database \u00b6 The actual database to be used \u2014 it should match one of the sections in [Databases] . Should you decide to use a MySQL database, instead of the default SQLite database, this is the place to change it. See the section Configuring MySQL/MariaDB for details. Required. table_name \u00b6 Internally, the archive data is stored in one, long, flat table. This is the name of that table. Normally this does not need to be changed. Optional. Default is archive . manager \u00b6 The name of the class to be used to manage the table. Optional. Default is class weewx.manager.DaySummaryManager . This class stores daily summaries in the database. Normally, this does not need to be changed. schema \u00b6 A Python structure holding the schema to be used to initialize the database. After initialization, it is not used. Optional. Default is schemas.wview_extended.schema , which is a superset of the schema used by the wview weather system.","title":"[DataBindings]"},{"location":"reference/weewx-options/data-bindings/#databindings","text":"A \"data binding\" associates storage characteristics with a specific database. Each binding contains a database from the [Databases] section plus parameters such as schema, table name, and mechanism for aggregating data.","title":"[DataBindings]"},{"location":"reference/weewx-options/data-bindings/#wx_binding","text":"This is the binding normally used for weather data. A typical [[wx_binding]] section looks something like this: [[wx_binding]] database = archive_sqlite table_name = archive manager = weewx.manager.DaySummaryManager schema = schemas.wview_extended.schema What follows is more detailed information about each of the binding options.","title":"[[wx_binding]]"},{"location":"reference/weewx-options/data-bindings/#database","text":"The actual database to be used \u2014 it should match one of the sections in [Databases] . Should you decide to use a MySQL database, instead of the default SQLite database, this is the place to change it. See the section Configuring MySQL/MariaDB for details. Required.","title":"database"},{"location":"reference/weewx-options/data-bindings/#table_name","text":"Internally, the archive data is stored in one, long, flat table. This is the name of that table. Normally this does not need to be changed. Optional. Default is archive .","title":"table_name"},{"location":"reference/weewx-options/data-bindings/#manager","text":"The name of the class to be used to manage the table. Optional. Default is class weewx.manager.DaySummaryManager . This class stores daily summaries in the database. Normally, this does not need to be changed.","title":"manager"},{"location":"reference/weewx-options/data-bindings/#schema","text":"A Python structure holding the schema to be used to initialize the database. After initialization, it is not used. Optional. Default is schemas.wview_extended.schema , which is a superset of the schema used by the wview weather system.","title":"schema"},{"location":"reference/weewx-options/database-types/","text":"[DatabaseTypes] \u00b6 This section defines default parameters for various databases. [[SQLite]] \u00b6 This section defines default values for SQLite databases. They can be overridden by individual databases. driver \u00b6 The sqlite driver name. Required. SQLITE_ROOT \u00b6 The location of the directory that contains the SQLite database files. If this is a relative path, it is relative to WEEWX_ROOT . timeout \u00b6 When the database is accessed by multiple threads and one of these threads modifies the database, the SQLite database is locked until the transaction is completed. The timeout option specifies how long other threads should wait in seconds for the lock to go away before raising an exception. The default is 5 . isolation_level \u00b6 Set the current isolation level. See the pysqlite documentation on isolation levels for more information. There is no reason to change this, but it is here for completeness. Default is None (autocommit). [[MySQL]] \u00b6 This section defines default values for MySQL databases. They can be overridden by individual databases. Note If you choose the MySQL database, it is assumed that you know how to administer it. In particular, you will have to set up a user with appropriate create and modify privileges. Tip In what follows, if you wish to connect to a MySQL server using a Unix socket instead of a TCP/IP connection, set host to an empty string ( '' ), then add an option unix_socket with the socket address. [[MySQL]] ... host = '' unix_socket = /var/run/mysqld/mysqld.sock ... driver \u00b6 The MySQL driver name. Required. host \u00b6 The name of the server on which the database is located. Default is localhost . user \u00b6 The username to be used to log into the server. Required. password \u00b6 The password. Required. port \u00b6 The port number to be used. Optional. Default is 3306 . engine \u00b6 The type of MySQL database storage engine to be used. This should not be changed without a good reason. Default is INNODB .","title":"[DatabaseTypes]"},{"location":"reference/weewx-options/database-types/#databasetypes","text":"This section defines default parameters for various databases.","title":"[DatabaseTypes]"},{"location":"reference/weewx-options/database-types/#sqlite","text":"This section defines default values for SQLite databases. They can be overridden by individual databases.","title":"[[SQLite]]"},{"location":"reference/weewx-options/database-types/#driver","text":"The sqlite driver name. Required.","title":"driver"},{"location":"reference/weewx-options/database-types/#sqlite_root","text":"The location of the directory that contains the SQLite database files. If this is a relative path, it is relative to WEEWX_ROOT .","title":"SQLITE_ROOT"},{"location":"reference/weewx-options/database-types/#timeout","text":"When the database is accessed by multiple threads and one of these threads modifies the database, the SQLite database is locked until the transaction is completed. The timeout option specifies how long other threads should wait in seconds for the lock to go away before raising an exception. The default is 5 .","title":"timeout"},{"location":"reference/weewx-options/database-types/#isolation_level","text":"Set the current isolation level. See the pysqlite documentation on isolation levels for more information. There is no reason to change this, but it is here for completeness. Default is None (autocommit).","title":"isolation_level"},{"location":"reference/weewx-options/database-types/#mysql","text":"This section defines default values for MySQL databases. They can be overridden by individual databases. Note If you choose the MySQL database, it is assumed that you know how to administer it. In particular, you will have to set up a user with appropriate create and modify privileges. Tip In what follows, if you wish to connect to a MySQL server using a Unix socket instead of a TCP/IP connection, set host to an empty string ( '' ), then add an option unix_socket with the socket address. [[MySQL]] ... host = '' unix_socket = /var/run/mysqld/mysqld.sock ...","title":"[[MySQL]]"},{"location":"reference/weewx-options/database-types/#driver_1","text":"The MySQL driver name. Required.","title":"driver"},{"location":"reference/weewx-options/database-types/#host","text":"The name of the server on which the database is located. Default is localhost .","title":"host"},{"location":"reference/weewx-options/database-types/#user","text":"The username to be used to log into the server. Required.","title":"user"},{"location":"reference/weewx-options/database-types/#password","text":"The password. Required.","title":"password"},{"location":"reference/weewx-options/database-types/#port","text":"The port number to be used. Optional. Default is 3306 .","title":"port"},{"location":"reference/weewx-options/database-types/#engine","text":"The type of MySQL database storage engine to be used. This should not be changed without a good reason. Default is INNODB .","title":"engine"},{"location":"reference/weewx-options/databases/","text":"[Databases] \u00b6 This section lists actual databases. The name of each database is given in double brackets, for example, [[archive_sqlite]] . Each database section contains the parameters necessary to create and manage the database. The number of parameters varies depending on the type of database. [[archive_sqlite]] \u00b6 This definition uses the SQLite database engine to store data. SQLite is open-source, simple, lightweight, highly portable, and memory efficient. For most purposes it serves nicely. database_type \u00b6 Set to SQLite to signal that this is a SQLite database. The definitions that go with type SQLite are defined in section [DatabaseTypes] / [[SQLite]] . database_name \u00b6 The path to the SQLite file. If the path is relative, it is relative to SQLITE_ROOT . Default is weewx.sdb . timeout \u00b6 How many seconds to wait before raising an error when a table is locked. Default is 5 . [[archive_mysql]] \u00b6 This definition uses the MySQL database engine to store data. It is free, highly-scalable, but more complicated to administer. database_type \u00b6 Set to MySQL to signal that this is a MySQL database. The definitions that go with type MySQL are defined in section [DatabaseTypes] / [[MySQL]] . database_name \u00b6 The name of the database. Default is weewx .","title":"[Databases]"},{"location":"reference/weewx-options/databases/#databases","text":"This section lists actual databases. The name of each database is given in double brackets, for example, [[archive_sqlite]] . Each database section contains the parameters necessary to create and manage the database. The number of parameters varies depending on the type of database.","title":"[Databases]"},{"location":"reference/weewx-options/databases/#archive_sqlite","text":"This definition uses the SQLite database engine to store data. SQLite is open-source, simple, lightweight, highly portable, and memory efficient. For most purposes it serves nicely.","title":"[[archive_sqlite]]"},{"location":"reference/weewx-options/databases/#database_type","text":"Set to SQLite to signal that this is a SQLite database. The definitions that go with type SQLite are defined in section [DatabaseTypes] / [[SQLite]] .","title":"database_type"},{"location":"reference/weewx-options/databases/#database_name","text":"The path to the SQLite file. If the path is relative, it is relative to SQLITE_ROOT . Default is weewx.sdb .","title":"database_name"},{"location":"reference/weewx-options/databases/#timeout","text":"How many seconds to wait before raising an error when a table is locked. Default is 5 .","title":"timeout"},{"location":"reference/weewx-options/databases/#archive_mysql","text":"This definition uses the MySQL database engine to store data. It is free, highly-scalable, but more complicated to administer.","title":"[[archive_mysql]]"},{"location":"reference/weewx-options/databases/#database_type_1","text":"Set to MySQL to signal that this is a MySQL database. The definitions that go with type MySQL are defined in section [DatabaseTypes] / [[MySQL]] .","title":"database_type"},{"location":"reference/weewx-options/databases/#database_name_1","text":"The name of the database. Default is weewx .","title":"database_name"},{"location":"reference/weewx-options/engine/","text":"[Engine] \u00b6 This section is used to configure the internal service engine in WeeWX. It is for advanced customization. Details on how to do this can be found in the Services section of the Customization Guide . [[Services]] \u00b6 Internally, WeeWX consists of many services, each responsible for some aspect of the program's functionality. After an event happens, such as the arrival of a new LOOP packet, any interested service gets a chance to do some useful work on the event. For example, a service might manipulate the packet, print it out, store it in a database, etc . This section controls which services are loaded and in what order they get their opportunity to do that work. Before WeeWX v2.6, this section held one, long, option called service_list , which held the names of all the services that should be run. Since then, this list has been broken down into smaller lists. Service lists are run in the order given below. Service list Function prep_services Perform any actions before the main loop is run. data_services Augment data, before it is processed. process_services Process, filter, and massage the data. xtype_services Add derived types to the data stream. archive_services Record the data in a database. restful_services Upload processed data to an external RESTful service. report_services Run any reports. For reference, here is the standard set of services that are run with the default distribution. Service list Function prep_services weewx.engine.StdTimeSynch data_services process_services weewx.engine.StdConvert weewx.engine.StdCalibrate weewx.engine.StdQC weewx.wxservices.StdWXCalculate xtype_services weewx.wxxtypes.StdWXXTypes weewx.wxxtypes.StdPressureCooker weewx.wxxtypes.StdRainRater weewx.wxxtypes.StdDelta archive_services weewx.engine.StdArchive restful_services weewx.restx.StdStationRegistry weewx.restx.StdWunderground weewx.restx.StdPWSweather weewx.restx.StdCWOP weewx.restx.StdWOW weewx.restx.StdAWEKAS report_services weewx.engine.StdPrint weewx.engine.StdReport If you're the type who likes to clean out your car trunk after every use, then you may also be the type who wants to pare this down to the bare minimum. However, this will only make a slight difference in execution speed and memory use. prep_services \u00b6 These services get called before any others. They are typically used to prepare the console. For example, the service weewx.wxengine.StdTimeSynch , which is responsible for making sure the console's clock is up-to-date, is a member of this group. data_services \u00b6 Augment data before processing. Typically, this means adding fields to a LOOP packet or archive record. process_services \u00b6 Services in this group tend to process any incoming data. They typically do things like quality control, or unit conversion, or sensor calibration. xtype_services \u00b6 These are services that use the WeeWX XTypes system to augment the data. Typically, they calculate derived variables such as dewpoint , ET , rainRate , etc . archive_services \u00b6 Once data have been processed, services in this group archive them. restful_services \u00b6 RESTful services, such as the Weather Underground, or CWOP, are in this group. They need processed data that have been archived, hence they are run after the preceeding groups. report_services \u00b6 The various reporting services run in this group, including the standard reporting engine.","title":"[Engine]"},{"location":"reference/weewx-options/engine/#engine","text":"This section is used to configure the internal service engine in WeeWX. It is for advanced customization. Details on how to do this can be found in the Services section of the Customization Guide .","title":"[Engine]"},{"location":"reference/weewx-options/engine/#services","text":"Internally, WeeWX consists of many services, each responsible for some aspect of the program's functionality. After an event happens, such as the arrival of a new LOOP packet, any interested service gets a chance to do some useful work on the event. For example, a service might manipulate the packet, print it out, store it in a database, etc . This section controls which services are loaded and in what order they get their opportunity to do that work. Before WeeWX v2.6, this section held one, long, option called service_list , which held the names of all the services that should be run. Since then, this list has been broken down into smaller lists. Service lists are run in the order given below. Service list Function prep_services Perform any actions before the main loop is run. data_services Augment data, before it is processed. process_services Process, filter, and massage the data. xtype_services Add derived types to the data stream. archive_services Record the data in a database. restful_services Upload processed data to an external RESTful service. report_services Run any reports. For reference, here is the standard set of services that are run with the default distribution. Service list Function prep_services weewx.engine.StdTimeSynch data_services process_services weewx.engine.StdConvert weewx.engine.StdCalibrate weewx.engine.StdQC weewx.wxservices.StdWXCalculate xtype_services weewx.wxxtypes.StdWXXTypes weewx.wxxtypes.StdPressureCooker weewx.wxxtypes.StdRainRater weewx.wxxtypes.StdDelta archive_services weewx.engine.StdArchive restful_services weewx.restx.StdStationRegistry weewx.restx.StdWunderground weewx.restx.StdPWSweather weewx.restx.StdCWOP weewx.restx.StdWOW weewx.restx.StdAWEKAS report_services weewx.engine.StdPrint weewx.engine.StdReport If you're the type who likes to clean out your car trunk after every use, then you may also be the type who wants to pare this down to the bare minimum. However, this will only make a slight difference in execution speed and memory use.","title":"[[Services]]"},{"location":"reference/weewx-options/engine/#prep_services","text":"These services get called before any others. They are typically used to prepare the console. For example, the service weewx.wxengine.StdTimeSynch , which is responsible for making sure the console's clock is up-to-date, is a member of this group.","title":"prep_services"},{"location":"reference/weewx-options/engine/#data_services","text":"Augment data before processing. Typically, this means adding fields to a LOOP packet or archive record.","title":"data_services"},{"location":"reference/weewx-options/engine/#process_services","text":"Services in this group tend to process any incoming data. They typically do things like quality control, or unit conversion, or sensor calibration.","title":"process_services"},{"location":"reference/weewx-options/engine/#xtype_services","text":"These are services that use the WeeWX XTypes system to augment the data. Typically, they calculate derived variables such as dewpoint , ET , rainRate , etc .","title":"xtype_services"},{"location":"reference/weewx-options/engine/#archive_services","text":"Once data have been processed, services in this group archive them.","title":"archive_services"},{"location":"reference/weewx-options/engine/#restful_services","text":"RESTful services, such as the Weather Underground, or CWOP, are in this group. They need processed data that have been archived, hence they are run after the preceeding groups.","title":"restful_services"},{"location":"reference/weewx-options/engine/#report_services","text":"The various reporting services run in this group, including the standard reporting engine.","title":"report_services"},{"location":"reference/weewx-options/general/","text":"General options \u00b6 The options declared at the top are not part of any section. debug \u00b6 Set to 1 to have the program perform extra debug checks, as well as emit extra information in the log file. This is strongly recommended if you are having trouble. Set to 2 for even more information. Otherwise, set to 0 . Default is 0 (no debug). WEEWX_ROOT \u00b6 Set to the root directory of the WeeWX file hierarchy for this station. Normally, this is set automatically by the installation process. Required. No default. USER_ROOT \u00b6 The location of the user package, relative to WEEWX_ROOT . WeeWX will look for any user-installed extensions in this directory. Default is bin/user . log_success \u00b6 If set to true , the default will be to log a successful operation (for example, the completion of a report, or uploading to the Weather Underground, etc.) to the system log. Default is true . log_failure \u00b6 If set to true , the default will be to log an unsuccessful operation (for example, failure to generate a report, or failure to upload to the Weather Underground, etc.) to the system log. Default is true . socket_timeout \u00b6 Set to how long to wait in seconds before declaring a socket time out. This is used by many services such as FTP, or the uploaders. Twenty (20) seconds is reasonable. Default is 20 . gc_interval \u00b6 Set to how often garbage collection should be performed in seconds by the Python runtime engine. Default is every 10800 (3 hours). loop_on_init \u00b6 Normally, if a hardware driver fails to load, WeeWX will exit, on the assumption that there is likely a configuration problem and so retries are useless. However, in some cases, drivers can fail to load for intermittent reasons, such as a network failure. In these cases, it may be useful to have WeeWX do a retry. Setting this option to true will cause WeeWX to keep retrying indefinitely. Default is false .` retry_wait \u00b6 If a retry is called for, how long to wait in seconds. Default is 60 .","title":"General options"},{"location":"reference/weewx-options/general/#general-options","text":"The options declared at the top are not part of any section.","title":"General options"},{"location":"reference/weewx-options/general/#debug","text":"Set to 1 to have the program perform extra debug checks, as well as emit extra information in the log file. This is strongly recommended if you are having trouble. Set to 2 for even more information. Otherwise, set to 0 . Default is 0 (no debug).","title":"debug"},{"location":"reference/weewx-options/general/#weewx_root","text":"Set to the root directory of the WeeWX file hierarchy for this station. Normally, this is set automatically by the installation process. Required. No default.","title":"WEEWX_ROOT"},{"location":"reference/weewx-options/general/#user_root","text":"The location of the user package, relative to WEEWX_ROOT . WeeWX will look for any user-installed extensions in this directory. Default is bin/user .","title":"USER_ROOT"},{"location":"reference/weewx-options/general/#log_success","text":"If set to true , the default will be to log a successful operation (for example, the completion of a report, or uploading to the Weather Underground, etc.) to the system log. Default is true .","title":"log_success"},{"location":"reference/weewx-options/general/#log_failure","text":"If set to true , the default will be to log an unsuccessful operation (for example, failure to generate a report, or failure to upload to the Weather Underground, etc.) to the system log. Default is true .","title":"log_failure"},{"location":"reference/weewx-options/general/#socket_timeout","text":"Set to how long to wait in seconds before declaring a socket time out. This is used by many services such as FTP, or the uploaders. Twenty (20) seconds is reasonable. Default is 20 .","title":"socket_timeout"},{"location":"reference/weewx-options/general/#gc_interval","text":"Set to how often garbage collection should be performed in seconds by the Python runtime engine. Default is every 10800 (3 hours).","title":"gc_interval"},{"location":"reference/weewx-options/general/#loop_on_init","text":"Normally, if a hardware driver fails to load, WeeWX will exit, on the assumption that there is likely a configuration problem and so retries are useless. However, in some cases, drivers can fail to load for intermittent reasons, such as a network failure. In these cases, it may be useful to have WeeWX do a retry. Setting this option to true will cause WeeWX to keep retrying indefinitely. Default is false .`","title":"loop_on_init"},{"location":"reference/weewx-options/general/#retry_wait","text":"If a retry is called for, how long to wait in seconds. Default is 60 .","title":"retry_wait"},{"location":"reference/weewx-options/introduction/","text":"Application options \u00b6 Application options are specified in a configuration file, nominally called weewx.conf . This is a big text file, which holds the configuration information about your installation of WeeWX. This includes things such as: The type of hardware you have. The name of your station. What kind of database to use and where is it located. How to recognize out-of-range observations, etc. Note The location of the configuration file will depend on your installation method. For example, if you installed using pip, then the nominal location is ~/weewx-data/weewx.conf . For other installation methods, the location depends on your operating system. See the section Where to find things . Note There is another configuration file for presentation-specific options. This file is called skin.conf , and there is one for each skin. It is described in the reference guide Skin options . The following sections are the definitive guide to the many configuration options available. There are many more options than you are likely to need \u2014 you can safely ignore most of them. The truly important ones, the ones you are likely to have to customize for your station, are highlighted . Default values are provided for many options, meaning that if they are not listed in the configuration file at all, WeeWX will pick sensible values. When the documentation gives a \"default value\" this is what it means. Option hierarchy \u00b6 In general, options closer to the \"root\" of weewx.conf are overridden by options closer to the leaves. Here's an example: log_success = false ... [StdRESTful] log_success = true ... [[Wunderground]] log_success = false # Wunderground will not be logged ... [[WOW]] log_success = true # WOW will be logged ... [[CWOP]] # CWOP will be logged (inherits from [StdRESTful]) ... In this example, at the top level, log_success is set to false. So, unless set otherwise, successful operations will not be logged. However, for StdRESTful operations, it is set to true, so for these services, successful operations will be logged, unless set otherwise by an individual service. Looking at the individual services, successful operations for Wunderground will not be logged (set explicitly) WOW will be logged (set explicitly) CWOP will be logged (inherits from StdRESTful ) Boolean values \u00b6 The following will evaluate True : true , True , yes , Yes , 1 . The following will evaluate False : false , False , no , No , 0 .","title":"Introduction"},{"location":"reference/weewx-options/introduction/#application-options","text":"Application options are specified in a configuration file, nominally called weewx.conf . This is a big text file, which holds the configuration information about your installation of WeeWX. This includes things such as: The type of hardware you have. The name of your station. What kind of database to use and where is it located. How to recognize out-of-range observations, etc. Note The location of the configuration file will depend on your installation method. For example, if you installed using pip, then the nominal location is ~/weewx-data/weewx.conf . For other installation methods, the location depends on your operating system. See the section Where to find things . Note There is another configuration file for presentation-specific options. This file is called skin.conf , and there is one for each skin. It is described in the reference guide Skin options . The following sections are the definitive guide to the many configuration options available. There are many more options than you are likely to need \u2014 you can safely ignore most of them. The truly important ones, the ones you are likely to have to customize for your station, are highlighted . Default values are provided for many options, meaning that if they are not listed in the configuration file at all, WeeWX will pick sensible values. When the documentation gives a \"default value\" this is what it means.","title":"Application options"},{"location":"reference/weewx-options/introduction/#option-hierarchy","text":"In general, options closer to the \"root\" of weewx.conf are overridden by options closer to the leaves. Here's an example: log_success = false ... [StdRESTful] log_success = true ... [[Wunderground]] log_success = false # Wunderground will not be logged ... [[WOW]] log_success = true # WOW will be logged ... [[CWOP]] # CWOP will be logged (inherits from [StdRESTful]) ... In this example, at the top level, log_success is set to false. So, unless set otherwise, successful operations will not be logged. However, for StdRESTful operations, it is set to true, so for these services, successful operations will be logged, unless set otherwise by an individual service. Looking at the individual services, successful operations for Wunderground will not be logged (set explicitly) WOW will be logged (set explicitly) CWOP will be logged (inherits from StdRESTful )","title":"Option hierarchy"},{"location":"reference/weewx-options/introduction/#boolean-values","text":"The following will evaluate True : true , True , yes , Yes , 1 . The following will evaluate False : false , False , no , No , 0 .","title":"Boolean values"},{"location":"reference/weewx-options/stations/","text":"[Station] \u00b6 This section covers options relating to your weather station setup. General Settings \u00b6 This applies to all station types location \u00b6 The station location should be a UTF-8 string that describes the geography of where your weather station is located. Required. No default. location = \"A small ranch in Kentucky\" latitude \u00b6 longitude \u00b6 The lat/lon should be set in decimal degrees, negative for southern and western hemispheres, respectively. Required. No default. latitude = 38.8977 longitude = -77.0366 altitude \u00b6 Normally the altitude is downloaded from your hardware, but not all stations support this. Set to the altitude of your console and the unit used to measure that altitude. Note If you live in a high-rise building, the altitude of the console (which is where the pressure gauge is located), can be considerably different from the ground altitude. You want the altitude of the console. Example: altitude = 700, foot An example in meters: altitude = 220, meter station_type \u00b6 Set to the type of hardware you are using. station_type = Simulator Note Whatever option you choose, you must have a matching section in your configuration file. For example, if you choose station_type = Simulator , then you will need a [Simulator] section. While you can do this by hand, it is tedious and error-prone. The better way to add the needed section is by using the utility weectl station reconfigure . If the needed section is missing, this utility will automatically inject it into the configuration file. Valid station types include: Option Description Simulator A software weather station simulator. Useful for testing and debugging. AcuRite AcuRite 5-in-1 stations with USB interface. CC3000 RainWise CC3000 data logger. FineOffsetUSB Fine Offset 10xx, 20xx, and 30xx stations. TE923 Hideki TE923 stations. Ultimeter PeetBros Ultimeter stations Vantage Davis Vantage weather stations. WMR100 Oregon Scientific WMR100 series stations. WMR300 Oregon Scientific WMR300 series stations. WMR9x8 Oregon Scientific WMR-918/968 series stations WS1 Argent Data Systems WS1 stations. WS23xx La Crosse 23xx stations. WS28xx La Crosse 28xx stations. station_url \u00b6 If you have a website, you may optionally specify an URL for its HTML server. It will be included in the RSS file generated by WeeWX and, if you choose to opt into the station registry , it will also be included in the map of WeeWX stations . It must be a valid URL. In particular, it must start with either http:// or https:// . Example: station_url = https://www.mywebsite.com rain_year_start \u00b6 Normally the start of the rain year is downloaded from your hardware, but not all stations support this. Set to the start of your rain year, for example, if your rain year starts in October, set it to 10 . Default is 1 . rain_year_start = 1 week_start \u00b6 Start of the week. 0 =Monday, 1 = Tuesday, ... , 6 = Sunday. Default is 6 (Sunday). week_start = 6 [Simulator] \u00b6 This section is for options relating to the software weather station simulator that comes with WeeWX. loop_interval \u00b6 The time (in seconds) between emitting loop packets. Default is 2.5 . mode \u00b6 One of either simulator or generator . Default is simulator . mode Description simulator Real-time simulator. It will sleep between emitting packets. generator Emit packets as fast as it can. Useful for testing. start \u00b6 The local start time for the generator in the format YYYY-mm-ddTHH:MM . An example would be 2012-03-30T18:30 . This would code 30-March-2012, at 6:30pm, local time. Optional. Default is the present time. [AcuRite] \u00b6 This section is for options relating to the AcuRite 5-in-1 series of weather stations with USB connectors. model \u00b6 Set to the station model. For example, \"AcuRite 01035\", \"AcuRite 01036\", or \"02032C\" use_constants \u00b6 Some stations (01035, 01036) use the HP038 sensor, which contains constants that define how the pressure and temperature should be interpreted. Other stations (02032, 02064) use the MS5607 sensor, which requires a different calculation to determine the pressure and temperature from the sensor. When use_constants=True , the driver will use the constants to determine which type of sensor is in the station and will adjust the calculation accordingly. A value of False causes the driver to use a linear approximation, regardless of the type of sensors. The default is True . [CC3000] \u00b6 This section is for options relating to the RainWise Mark III weather stations and CC3000 data logger. port \u00b6 The serial port, e.g., /dev/ttyS0 . When using a USB-Serial converter, the port will be something like /dev/ttyUSB0 . Default is /dev/ttyUSB0 debug_serial \u00b6 debug_openclose \u00b6 debug_checksum \u00b6 The debug_serial , debug_openclose , and debug_checksum can be set to one to produce debugging information in the WeeWX log. The defaults for these options are zero. logger_threshold \u00b6 The logger_threshold specifies the number of records in the CC3000 station's memory at which the station memory's should be cleared. If logger_threshold is not specified, or if zero is specified, the station's memory will never be cleared. In this case, when the memory fills up, new archive records will no longer be saved in memory. Note: the CC3000's memory will hold about 35,000 records. The default is 0 (i.e., never clear memory). max_tries \u00b6 The max_tries option specifies how many times WeeWX should retry communicating with the CC3000 station when a serial communications error occurs. The default is 5 . model \u00b6 The option model specifies the name of the hardware reported to WeeWX. The default is CC3000 . polling_interval \u00b6 The polling_interval determines how often WeeWX will query the station for data in seconds. The default is 2 . Note: 2 seconds is a good choice as this is the rate at which the CC3000 receives updates from the Rainwise Mark III Weather Station. sensor_map \u00b6 This option defines the mapping between temperature values in the database and the remote sensors. Two additional temperature sensors are supported. For example, this would associate extraTemp1 with the second optional temperature sensor: [[sensor_map]] extraTemp1 = TEMP 2 See the CC3000 Station data table in the Hardware guide for a complete listing of sensor names and the default database fields for each sensor. use_station_time \u00b6 The use_station_time specifies whether the loop packets read by weewx should use the time specified in the CC3000 station packet or the computer time. The default is True ( i.e. , to use CC3000 station time). [FineOffsetUSB] \u00b6 This section is for options relating to the Fine Offset series of weather stations with USB connectors. Warning The following settings are highly recommended for Fine Offset stations. Using hardware record generation or adaptive polling is more likely to cause USB communication failure. Using hardware record generation will cause delays in report generation. [FineOffsetUSB] polling_mode = PERIODIC polling_interval = 60 [StdArchive] record_generation = software model \u00b6 Set to the station model. For example, WH1080 , WS2080 , WH3081 , etc. polling_mode \u00b6 One of PERIODIC or ADAPTIVE . In PERIODIC mode, WeeWX queries the console at regular intervals determined by the polling_interval. In ADAPTIVE mode, WeeWX attempts to query the console at times when it is not reading data from the sensors or writing data to memory. See the section Polling mode and interval in the Hardware Guide for more details. The default is PERIODIC . polling_interval \u00b6 The frequency, in seconds, at which WeeWX will poll the console for data. This setting applies only when the polling_mode is PERIODIC . Default is 60 . data_format \u00b6 There are two classes of hardware, the 10xx/20xx consoles and the 30xx consoles. Unlike the 10xx/20xx consoles, the 30xx consoles record luminosity and UV, so they have a different data format. Use the data_format to indicate which type of hardware you have. Possible values are 1080 (for the 10xx and 20xx consoles) and 3080 (for the 30xx consoles). Default is 1080 . [TE923] \u00b6 This section is for options relating to the Hideki TE923 series of weather stations. model \u00b6 Set to the station model. For example, Meade TE923W or TFA Nexus. Default is TE923 . sensor_map \u00b6 This option defines the mapping between temperature / humidity values in the database and the remote sensors. Up to 5 remote sensors are supported. A switch on each sensor determines which of 5 channels that sensor will use. For example, if the switch on the sensor is set to 3, the temperature from that sensor will be t_3 and the humidity from that sensor will be h_3 . For example, this would associate outTemp and outHumidity with sensor 4: [[sensor_map]] outTemp = t_4 outHumidity = h_4 See the TE923 section of the Hardware Guide for a complete listing of sensor names and their corresponding default database field. [Ultimeter] \u00b6 This section is for options relating to the PeetBros Ultimeter weather stations. port \u00b6 The serial port, e.g., /dev/ttyS0 . When using a USB-Serial converter, the port will be something like /dev/ttyUSB0 . Default is /dev/ttyUSB0 model \u00b6 Set to the station model. For example, Ultimeter 2000 or Ultimeter 800 . Default is Ultimeter . [Vantage] \u00b6 This section is for options relating to the Davis Vantage series of hardware (VantagePro, VantagePro2 or VantageVue). type \u00b6 Set to either serial , for a serial or USB connection to the VantagePro (by far the most common), or to ethernet for the WeatherLinkIP. No default. port \u00b6 If you chose serial , for type , then set to the serial port name used by the station. For example, /dev/ttyUSB0 is a common location for USB ports, /dev/ttyS0 for serial ports. Otherwise, not required. No default. host \u00b6 If you chose ethernet , then specify either the IP address ( e.g. , 192.168.0.1 ) or hostname ( e.g. , console.mydomain.com ) to the console. Otherwise, not required. No default. baudrate \u00b6 Set to the baudrate of the station. The default is 19200 . tcp_port \u00b6 The port where WeatherLinkIP will be listening. Default is 22222 . tcp_send_delay \u00b6 How long to wait in seconds after sending a socket packet to the WeatherLinkIP before looking for input. Default is 0.5 . loop_request \u00b6 The type of LOOP packet to use for LOOP data. Options are 1 (type LOOP1 ); 2 (type LOOP2 ); or 3 (alternate between). Type LOOP2 packets have the advantage of including gauge pressure, altimeter, heat index, THSW, and a few other types, so they do not have to be calculated in software. On the other hand, they do not include any of the extra Davis sensors, such as soil moisture, leaf temperature, etc . If you decide to alternate between packet types (option 3 ), then the console will send a type LOOP1 packet, followed by a type LOOP2 packet. This means that for certain types, and depending on the options specified in [StdWXCalculate] , the value that is used by WeeWX can flip between hardware and software values with every packet. In this case, you should be sure to specify option hardware for types pressure , altimeter , dewpoint , windchill , and heatindex . This way, only hardware values will be used. Info Not all stations support LOOP2 data. You need firmware version 1.90 or later. Default is 1 (use LOOP1 type packets). iss_id \u00b6 Set to the ID number of the Integrated Sensor Suite (ISS). This is used in the formula to calculate reception quality for wireless stations. Default is 1 . timeout \u00b6 How many seconds to wait for a response from the station before giving up. Default is 5 . wait_before_retry \u00b6 How many seconds to wait before retrying. Unless you have a good reason to change it, this value should be left at the default, as it is long enough for the station to offer new data, but not so long as to go into a new loop packet (which arrive every 2 seconds). Default is 1.2 . max_tries \u00b6 How many times to try again before giving up. Default is 4 . [WMR100] \u00b6 This section is for options relating to the Oregon Scientific WMR100 series of weather stations with USB connectors. model \u00b6 Set to the station model. For example, WMR100 or WMRS200 . sensor_map \u00b6 This option defines the mapping between observations from remote sensors and the fields in the database. For example, this would associate extraTemp1 with the remote T/H sensor on channel 5: [[sensor_map]] extraTemp1 = temperature_5 See the WMR100 section of the Hardware guide for a complete listing of sensor names and the default database fields for each sensor. [WMR300] \u00b6 This section is for options relating to the Oregon Scientific WMR300 series of weather stations with USB connectors. model \u00b6 Set to the station model. For example, WMR300 or WMR300A . sensor_map \u00b6 This option defines the mapping between temperature / humidity values in the database and the remote sensors. Up to 8 remote sensors are supported. For example, this would associate outTemp and outHumidity with sensor 4: [[sensor_map]] outTemp = temperature_4 outHumidity = humidity_4 See the WMR300 section of the Hardware guide for a complete listing of sensor names and the default database fields for each sensor. [WMR9x8] \u00b6 This section is for options relating to the Oregon Scientific WMR-918/968 series of weather stations with serial connectors. type \u00b6 For the moment, only serial is supported. port \u00b6 Along with the serial option above, you must set the serial port name used by the station. For example, /dev/ttyUSB0 is a common location for USB ports, /dev/ttyS0 for serial ports. No default. model \u00b6 Set to the station model. For example, WMR968 or WMR918 . sensor_map \u00b6 This option defines the mapping between observations from remote sensors and the fields in the database. For example, this would associate extraTemp1 with the remote T/H sensor on channel 5: [[sensor_map]] extraTemp1 = temperature_5 extraHumid1 = humidity_5 See the WMR9x8 sectioin of the Hardware guide for a complete listing of sensor names and the default database fields for each sensor. [WS1] \u00b6 This section is for options relating to the Argent Data Systems WS1 weather stations. mode \u00b6 Select whether to connect via a serial line (option serial ), or via an IP connection using TCP (option tcp ), or UDP (option udp ). Default is serial . port \u00b6 The port to be used. For a serial connection, this will be something like /dev/ttyUSB0 . For a TCP or UDP connection, it will be an IP address and port, such as 192.168.1.12:3000 Default is /dev/ttyUSB0 . polling_interval \u00b6 The polling_interval determines how often in seconds that WeeWX will query the station for data. The default is 1 . [WS23xx] \u00b6 This section is for options relating to the La Crosse WS-23xx series of weather stations. port \u00b6 The serial port, e.g. , /dev/ttyS0 . When using a USB-Serial converter, the port will be something like /dev/ttyUSB0 . Default is /dev/ttyUSB0 model \u00b6 Set to the station model. For example, WS-2315 , LaCrosse WS2317 , etc . Default is LaCrosse WS23xx . polling_interval \u00b6 The polling_interval determines how often WeeWX will query the station for data. If polling_interval is not specified (the default), WeeWX will automatically use a polling interval based on the type of connection between the station and the sensors (wired or wireless). When connected with a wire, the console updates sensor data every 8 seconds. When connected wirelessly, the console updates from 16 to 128 seconds, depending on sensor activity. [WS28xx] \u00b6 This section is for options relating to the La Crosse WS-28xx series of weather stations. transceiver_frequency \u00b6 Radio frequency to use between USB transceiver and console. Specify either US or EU . US uses 915 MHz, EU uses 868.3 MHz. Default is US . model \u00b6 Set to the station model. For example, LaCrosse WS2810 , TFA Primus , etc . Default is LaCrosse WS28xx .","title":"[Station]"},{"location":"reference/weewx-options/stations/#station","text":"This section covers options relating to your weather station setup.","title":"[Station]"},{"location":"reference/weewx-options/stations/#general-settings","text":"This applies to all station types","title":"General Settings"},{"location":"reference/weewx-options/stations/#location","text":"The station location should be a UTF-8 string that describes the geography of where your weather station is located. Required. No default. location = \"A small ranch in Kentucky\"","title":"location"},{"location":"reference/weewx-options/stations/#latitude","text":"","title":"latitude"},{"location":"reference/weewx-options/stations/#longitude","text":"The lat/lon should be set in decimal degrees, negative for southern and western hemispheres, respectively. Required. No default. latitude = 38.8977 longitude = -77.0366","title":"longitude"},{"location":"reference/weewx-options/stations/#altitude","text":"Normally the altitude is downloaded from your hardware, but not all stations support this. Set to the altitude of your console and the unit used to measure that altitude. Note If you live in a high-rise building, the altitude of the console (which is where the pressure gauge is located), can be considerably different from the ground altitude. You want the altitude of the console. Example: altitude = 700, foot An example in meters: altitude = 220, meter","title":"altitude"},{"location":"reference/weewx-options/stations/#station_type","text":"Set to the type of hardware you are using. station_type = Simulator Note Whatever option you choose, you must have a matching section in your configuration file. For example, if you choose station_type = Simulator , then you will need a [Simulator] section. While you can do this by hand, it is tedious and error-prone. The better way to add the needed section is by using the utility weectl station reconfigure . If the needed section is missing, this utility will automatically inject it into the configuration file. Valid station types include: Option Description Simulator A software weather station simulator. Useful for testing and debugging. AcuRite AcuRite 5-in-1 stations with USB interface. CC3000 RainWise CC3000 data logger. FineOffsetUSB Fine Offset 10xx, 20xx, and 30xx stations. TE923 Hideki TE923 stations. Ultimeter PeetBros Ultimeter stations Vantage Davis Vantage weather stations. WMR100 Oregon Scientific WMR100 series stations. WMR300 Oregon Scientific WMR300 series stations. WMR9x8 Oregon Scientific WMR-918/968 series stations WS1 Argent Data Systems WS1 stations. WS23xx La Crosse 23xx stations. WS28xx La Crosse 28xx stations.","title":"station_type"},{"location":"reference/weewx-options/stations/#station_url","text":"If you have a website, you may optionally specify an URL for its HTML server. It will be included in the RSS file generated by WeeWX and, if you choose to opt into the station registry , it will also be included in the map of WeeWX stations . It must be a valid URL. In particular, it must start with either http:// or https:// . Example: station_url = https://www.mywebsite.com","title":"station_url"},{"location":"reference/weewx-options/stations/#rain_year_start","text":"Normally the start of the rain year is downloaded from your hardware, but not all stations support this. Set to the start of your rain year, for example, if your rain year starts in October, set it to 10 . Default is 1 . rain_year_start = 1","title":"rain_year_start"},{"location":"reference/weewx-options/stations/#week_start","text":"Start of the week. 0 =Monday, 1 = Tuesday, ... , 6 = Sunday. Default is 6 (Sunday). week_start = 6","title":"week_start"},{"location":"reference/weewx-options/stations/#simulator","text":"This section is for options relating to the software weather station simulator that comes with WeeWX.","title":"[Simulator]"},{"location":"reference/weewx-options/stations/#loop_interval","text":"The time (in seconds) between emitting loop packets. Default is 2.5 .","title":"loop_interval"},{"location":"reference/weewx-options/stations/#mode","text":"One of either simulator or generator . Default is simulator . mode Description simulator Real-time simulator. It will sleep between emitting packets. generator Emit packets as fast as it can. Useful for testing.","title":"mode"},{"location":"reference/weewx-options/stations/#start","text":"The local start time for the generator in the format YYYY-mm-ddTHH:MM . An example would be 2012-03-30T18:30 . This would code 30-March-2012, at 6:30pm, local time. Optional. Default is the present time.","title":"start"},{"location":"reference/weewx-options/stations/#acurite","text":"This section is for options relating to the AcuRite 5-in-1 series of weather stations with USB connectors.","title":"[AcuRite]"},{"location":"reference/weewx-options/stations/#model","text":"Set to the station model. For example, \"AcuRite 01035\", \"AcuRite 01036\", or \"02032C\"","title":"model"},{"location":"reference/weewx-options/stations/#use_constants","text":"Some stations (01035, 01036) use the HP038 sensor, which contains constants that define how the pressure and temperature should be interpreted. Other stations (02032, 02064) use the MS5607 sensor, which requires a different calculation to determine the pressure and temperature from the sensor. When use_constants=True , the driver will use the constants to determine which type of sensor is in the station and will adjust the calculation accordingly. A value of False causes the driver to use a linear approximation, regardless of the type of sensors. The default is True .","title":"use_constants"},{"location":"reference/weewx-options/stations/#cc3000","text":"This section is for options relating to the RainWise Mark III weather stations and CC3000 data logger.","title":"[CC3000]"},{"location":"reference/weewx-options/stations/#port","text":"The serial port, e.g., /dev/ttyS0 . When using a USB-Serial converter, the port will be something like /dev/ttyUSB0 . Default is /dev/ttyUSB0","title":"port"},{"location":"reference/weewx-options/stations/#debug_serial","text":"","title":"debug_serial"},{"location":"reference/weewx-options/stations/#debug_openclose","text":"","title":"debug_openclose"},{"location":"reference/weewx-options/stations/#debug_checksum","text":"The debug_serial , debug_openclose , and debug_checksum can be set to one to produce debugging information in the WeeWX log. The defaults for these options are zero.","title":"debug_checksum"},{"location":"reference/weewx-options/stations/#logger_threshold","text":"The logger_threshold specifies the number of records in the CC3000 station's memory at which the station memory's should be cleared. If logger_threshold is not specified, or if zero is specified, the station's memory will never be cleared. In this case, when the memory fills up, new archive records will no longer be saved in memory. Note: the CC3000's memory will hold about 35,000 records. The default is 0 (i.e., never clear memory).","title":"logger_threshold"},{"location":"reference/weewx-options/stations/#max_tries","text":"The max_tries option specifies how many times WeeWX should retry communicating with the CC3000 station when a serial communications error occurs. The default is 5 .","title":"max_tries"},{"location":"reference/weewx-options/stations/#model_1","text":"The option model specifies the name of the hardware reported to WeeWX. The default is CC3000 .","title":"model"},{"location":"reference/weewx-options/stations/#polling_interval","text":"The polling_interval determines how often WeeWX will query the station for data in seconds. The default is 2 . Note: 2 seconds is a good choice as this is the rate at which the CC3000 receives updates from the Rainwise Mark III Weather Station.","title":"polling_interval"},{"location":"reference/weewx-options/stations/#sensor_map","text":"This option defines the mapping between temperature values in the database and the remote sensors. Two additional temperature sensors are supported. For example, this would associate extraTemp1 with the second optional temperature sensor: [[sensor_map]] extraTemp1 = TEMP 2 See the CC3000 Station data table in the Hardware guide for a complete listing of sensor names and the default database fields for each sensor.","title":"sensor_map"},{"location":"reference/weewx-options/stations/#use_station_time","text":"The use_station_time specifies whether the loop packets read by weewx should use the time specified in the CC3000 station packet or the computer time. The default is True ( i.e. , to use CC3000 station time).","title":"use_station_time"},{"location":"reference/weewx-options/stations/#fineoffsetusb","text":"This section is for options relating to the Fine Offset series of weather stations with USB connectors. Warning The following settings are highly recommended for Fine Offset stations. Using hardware record generation or adaptive polling is more likely to cause USB communication failure. Using hardware record generation will cause delays in report generation. [FineOffsetUSB] polling_mode = PERIODIC polling_interval = 60 [StdArchive] record_generation = software","title":"[FineOffsetUSB]"},{"location":"reference/weewx-options/stations/#model_2","text":"Set to the station model. For example, WH1080 , WS2080 , WH3081 , etc.","title":"model"},{"location":"reference/weewx-options/stations/#polling_mode","text":"One of PERIODIC or ADAPTIVE . In PERIODIC mode, WeeWX queries the console at regular intervals determined by the polling_interval. In ADAPTIVE mode, WeeWX attempts to query the console at times when it is not reading data from the sensors or writing data to memory. See the section Polling mode and interval in the Hardware Guide for more details. The default is PERIODIC .","title":"polling_mode"},{"location":"reference/weewx-options/stations/#polling_interval_1","text":"The frequency, in seconds, at which WeeWX will poll the console for data. This setting applies only when the polling_mode is PERIODIC . Default is 60 .","title":"polling_interval"},{"location":"reference/weewx-options/stations/#data_format","text":"There are two classes of hardware, the 10xx/20xx consoles and the 30xx consoles. Unlike the 10xx/20xx consoles, the 30xx consoles record luminosity and UV, so they have a different data format. Use the data_format to indicate which type of hardware you have. Possible values are 1080 (for the 10xx and 20xx consoles) and 3080 (for the 30xx consoles). Default is 1080 .","title":"data_format"},{"location":"reference/weewx-options/stations/#te923","text":"This section is for options relating to the Hideki TE923 series of weather stations.","title":"[TE923]"},{"location":"reference/weewx-options/stations/#model_3","text":"Set to the station model. For example, Meade TE923W or TFA Nexus. Default is TE923 .","title":"model"},{"location":"reference/weewx-options/stations/#sensor_map_1","text":"This option defines the mapping between temperature / humidity values in the database and the remote sensors. Up to 5 remote sensors are supported. A switch on each sensor determines which of 5 channels that sensor will use. For example, if the switch on the sensor is set to 3, the temperature from that sensor will be t_3 and the humidity from that sensor will be h_3 . For example, this would associate outTemp and outHumidity with sensor 4: [[sensor_map]] outTemp = t_4 outHumidity = h_4 See the TE923 section of the Hardware Guide for a complete listing of sensor names and their corresponding default database field.","title":"sensor_map"},{"location":"reference/weewx-options/stations/#ultimeter","text":"This section is for options relating to the PeetBros Ultimeter weather stations.","title":"[Ultimeter]"},{"location":"reference/weewx-options/stations/#port_1","text":"The serial port, e.g., /dev/ttyS0 . When using a USB-Serial converter, the port will be something like /dev/ttyUSB0 . Default is /dev/ttyUSB0","title":"port"},{"location":"reference/weewx-options/stations/#model_4","text":"Set to the station model. For example, Ultimeter 2000 or Ultimeter 800 . Default is Ultimeter .","title":"model"},{"location":"reference/weewx-options/stations/#vantage","text":"This section is for options relating to the Davis Vantage series of hardware (VantagePro, VantagePro2 or VantageVue).","title":"[Vantage]"},{"location":"reference/weewx-options/stations/#type","text":"Set to either serial , for a serial or USB connection to the VantagePro (by far the most common), or to ethernet for the WeatherLinkIP. No default.","title":"type"},{"location":"reference/weewx-options/stations/#port_2","text":"If you chose serial , for type , then set to the serial port name used by the station. For example, /dev/ttyUSB0 is a common location for USB ports, /dev/ttyS0 for serial ports. Otherwise, not required. No default.","title":"port"},{"location":"reference/weewx-options/stations/#host","text":"If you chose ethernet , then specify either the IP address ( e.g. , 192.168.0.1 ) or hostname ( e.g. , console.mydomain.com ) to the console. Otherwise, not required. No default.","title":"host"},{"location":"reference/weewx-options/stations/#baudrate","text":"Set to the baudrate of the station. The default is 19200 .","title":"baudrate"},{"location":"reference/weewx-options/stations/#tcp_port","text":"The port where WeatherLinkIP will be listening. Default is 22222 .","title":"tcp_port"},{"location":"reference/weewx-options/stations/#tcp_send_delay","text":"How long to wait in seconds after sending a socket packet to the WeatherLinkIP before looking for input. Default is 0.5 .","title":"tcp_send_delay"},{"location":"reference/weewx-options/stations/#loop_request","text":"The type of LOOP packet to use for LOOP data. Options are 1 (type LOOP1 ); 2 (type LOOP2 ); or 3 (alternate between). Type LOOP2 packets have the advantage of including gauge pressure, altimeter, heat index, THSW, and a few other types, so they do not have to be calculated in software. On the other hand, they do not include any of the extra Davis sensors, such as soil moisture, leaf temperature, etc . If you decide to alternate between packet types (option 3 ), then the console will send a type LOOP1 packet, followed by a type LOOP2 packet. This means that for certain types, and depending on the options specified in [StdWXCalculate] , the value that is used by WeeWX can flip between hardware and software values with every packet. In this case, you should be sure to specify option hardware for types pressure , altimeter , dewpoint , windchill , and heatindex . This way, only hardware values will be used. Info Not all stations support LOOP2 data. You need firmware version 1.90 or later. Default is 1 (use LOOP1 type packets).","title":"loop_request"},{"location":"reference/weewx-options/stations/#iss_id","text":"Set to the ID number of the Integrated Sensor Suite (ISS). This is used in the formula to calculate reception quality for wireless stations. Default is 1 .","title":"iss_id"},{"location":"reference/weewx-options/stations/#timeout","text":"How many seconds to wait for a response from the station before giving up. Default is 5 .","title":"timeout"},{"location":"reference/weewx-options/stations/#wait_before_retry","text":"How many seconds to wait before retrying. Unless you have a good reason to change it, this value should be left at the default, as it is long enough for the station to offer new data, but not so long as to go into a new loop packet (which arrive every 2 seconds). Default is 1.2 .","title":"wait_before_retry"},{"location":"reference/weewx-options/stations/#max_tries_1","text":"How many times to try again before giving up. Default is 4 .","title":"max_tries"},{"location":"reference/weewx-options/stations/#wmr100","text":"This section is for options relating to the Oregon Scientific WMR100 series of weather stations with USB connectors.","title":"[WMR100]"},{"location":"reference/weewx-options/stations/#model_5","text":"Set to the station model. For example, WMR100 or WMRS200 .","title":"model"},{"location":"reference/weewx-options/stations/#sensor_map_2","text":"This option defines the mapping between observations from remote sensors and the fields in the database. For example, this would associate extraTemp1 with the remote T/H sensor on channel 5: [[sensor_map]] extraTemp1 = temperature_5 See the WMR100 section of the Hardware guide for a complete listing of sensor names and the default database fields for each sensor.","title":"sensor_map"},{"location":"reference/weewx-options/stations/#wmr300","text":"This section is for options relating to the Oregon Scientific WMR300 series of weather stations with USB connectors.","title":"[WMR300]"},{"location":"reference/weewx-options/stations/#model_6","text":"Set to the station model. For example, WMR300 or WMR300A .","title":"model"},{"location":"reference/weewx-options/stations/#sensor_map_3","text":"This option defines the mapping between temperature / humidity values in the database and the remote sensors. Up to 8 remote sensors are supported. For example, this would associate outTemp and outHumidity with sensor 4: [[sensor_map]] outTemp = temperature_4 outHumidity = humidity_4 See the WMR300 section of the Hardware guide for a complete listing of sensor names and the default database fields for each sensor.","title":"sensor_map"},{"location":"reference/weewx-options/stations/#wmr9x8","text":"This section is for options relating to the Oregon Scientific WMR-918/968 series of weather stations with serial connectors.","title":"[WMR9x8]"},{"location":"reference/weewx-options/stations/#type_1","text":"For the moment, only serial is supported.","title":"type"},{"location":"reference/weewx-options/stations/#port_3","text":"Along with the serial option above, you must set the serial port name used by the station. For example, /dev/ttyUSB0 is a common location for USB ports, /dev/ttyS0 for serial ports. No default.","title":"port"},{"location":"reference/weewx-options/stations/#model_7","text":"Set to the station model. For example, WMR968 or WMR918 .","title":"model"},{"location":"reference/weewx-options/stations/#sensor_map_4","text":"This option defines the mapping between observations from remote sensors and the fields in the database. For example, this would associate extraTemp1 with the remote T/H sensor on channel 5: [[sensor_map]] extraTemp1 = temperature_5 extraHumid1 = humidity_5 See the WMR9x8 sectioin of the Hardware guide for a complete listing of sensor names and the default database fields for each sensor.","title":"sensor_map"},{"location":"reference/weewx-options/stations/#ws1","text":"This section is for options relating to the Argent Data Systems WS1 weather stations.","title":"[WS1]"},{"location":"reference/weewx-options/stations/#mode_1","text":"Select whether to connect via a serial line (option serial ), or via an IP connection using TCP (option tcp ), or UDP (option udp ). Default is serial .","title":"mode"},{"location":"reference/weewx-options/stations/#port_4","text":"The port to be used. For a serial connection, this will be something like /dev/ttyUSB0 . For a TCP or UDP connection, it will be an IP address and port, such as 192.168.1.12:3000 Default is /dev/ttyUSB0 .","title":"port"},{"location":"reference/weewx-options/stations/#polling_interval_2","text":"The polling_interval determines how often in seconds that WeeWX will query the station for data. The default is 1 .","title":"polling_interval"},{"location":"reference/weewx-options/stations/#ws23xx","text":"This section is for options relating to the La Crosse WS-23xx series of weather stations.","title":"[WS23xx]"},{"location":"reference/weewx-options/stations/#port_5","text":"The serial port, e.g. , /dev/ttyS0 . When using a USB-Serial converter, the port will be something like /dev/ttyUSB0 . Default is /dev/ttyUSB0","title":"port"},{"location":"reference/weewx-options/stations/#model_8","text":"Set to the station model. For example, WS-2315 , LaCrosse WS2317 , etc . Default is LaCrosse WS23xx .","title":"model"},{"location":"reference/weewx-options/stations/#polling_interval_3","text":"The polling_interval determines how often WeeWX will query the station for data. If polling_interval is not specified (the default), WeeWX will automatically use a polling interval based on the type of connection between the station and the sensors (wired or wireless). When connected with a wire, the console updates sensor data every 8 seconds. When connected wirelessly, the console updates from 16 to 128 seconds, depending on sensor activity.","title":"polling_interval"},{"location":"reference/weewx-options/stations/#ws28xx","text":"This section is for options relating to the La Crosse WS-28xx series of weather stations.","title":"[WS28xx]"},{"location":"reference/weewx-options/stations/#transceiver_frequency","text":"Radio frequency to use between USB transceiver and console. Specify either US or EU . US uses 915 MHz, EU uses 868.3 MHz. Default is US .","title":"transceiver_frequency"},{"location":"reference/weewx-options/stations/#model_9","text":"Set to the station model. For example, LaCrosse WS2810 , TFA Primus , etc . Default is LaCrosse WS28xx .","title":"model"},{"location":"reference/weewx-options/stdarchive/","text":"[StdArchive] \u00b6 The StdArchive service stores data into a database. archive_interval \u00b6 If your station hardware supports data logging then the archive interval will be downloaded from the station. Otherwise, you must specify it here in seconds, and it must be evenly divisible by 60. Optional. Default is 300 . archive_delay \u00b6 How long to wait in seconds after the top of an archiving interval before fetching new data off the station. For example, if your archive interval is 5 minutes and archive_delay is set to 15, then the data will be fetched at 00:00:15, 00:05:15, 00:10:15, etc. This delay is to give the station a few seconds to archive the data internally, and in case your server has any other tasks to do at the top of the minute. Default is 15 . record_generation \u00b6 Set to whether records should be downloaded off the hardware (recommended), or generated in software. If set to hardware , then WeeWX tries to download archive records from your station. However, not all types of stations support this, in which case WeeWX falls back to software generation. A setting of hardware will work for most users. A notable exception is users who have cobbled together homebrew serial interfaces for the Vantage stations that do not include memory for a logger. These users should set this option to software , forcing software record generation. Default is hardware . record_augmentation \u00b6 When performing hardware record generation, this option will attempt to augment the record with any additional observation types that it can extract out of the LOOP packets. Default is true . loop_hilo \u00b6 Set to true to have LOOP data and archive data to be used for high / low statistics. Set to false to have only archive data used. If your sensor emits lots of spiky data, setting to false may help. Default is true . log_success \u00b6 If you set a value for log_success here, it will override the value set at the top-level and will apply only to archiving operations. log_failure \u00b6 If you set a value for log_failure here, it will override the value set at the top-level and will apply only to archiving operations. data_binding \u00b6 The data binding to be used to store the data. This should match one of the bindings in the [DataBindings] section. Optional. Default is wx_binding .","title":"[StdArchive]"},{"location":"reference/weewx-options/stdarchive/#stdarchive","text":"The StdArchive service stores data into a database.","title":"[StdArchive]"},{"location":"reference/weewx-options/stdarchive/#archive_interval","text":"If your station hardware supports data logging then the archive interval will be downloaded from the station. Otherwise, you must specify it here in seconds, and it must be evenly divisible by 60. Optional. Default is 300 .","title":"archive_interval"},{"location":"reference/weewx-options/stdarchive/#archive_delay","text":"How long to wait in seconds after the top of an archiving interval before fetching new data off the station. For example, if your archive interval is 5 minutes and archive_delay is set to 15, then the data will be fetched at 00:00:15, 00:05:15, 00:10:15, etc. This delay is to give the station a few seconds to archive the data internally, and in case your server has any other tasks to do at the top of the minute. Default is 15 .","title":"archive_delay"},{"location":"reference/weewx-options/stdarchive/#record_generation","text":"Set to whether records should be downloaded off the hardware (recommended), or generated in software. If set to hardware , then WeeWX tries to download archive records from your station. However, not all types of stations support this, in which case WeeWX falls back to software generation. A setting of hardware will work for most users. A notable exception is users who have cobbled together homebrew serial interfaces for the Vantage stations that do not include memory for a logger. These users should set this option to software , forcing software record generation. Default is hardware .","title":"record_generation"},{"location":"reference/weewx-options/stdarchive/#record_augmentation","text":"When performing hardware record generation, this option will attempt to augment the record with any additional observation types that it can extract out of the LOOP packets. Default is true .","title":"record_augmentation"},{"location":"reference/weewx-options/stdarchive/#loop_hilo","text":"Set to true to have LOOP data and archive data to be used for high / low statistics. Set to false to have only archive data used. If your sensor emits lots of spiky data, setting to false may help. Default is true .","title":"loop_hilo"},{"location":"reference/weewx-options/stdarchive/#log_success","text":"If you set a value for log_success here, it will override the value set at the top-level and will apply only to archiving operations.","title":"log_success"},{"location":"reference/weewx-options/stdarchive/#log_failure","text":"If you set a value for log_failure here, it will override the value set at the top-level and will apply only to archiving operations.","title":"log_failure"},{"location":"reference/weewx-options/stdarchive/#data_binding","text":"The data binding to be used to store the data. This should match one of the bindings in the [DataBindings] section. Optional. Default is wx_binding .","title":"data_binding"},{"location":"reference/weewx-options/stdcalibrate/","text":"[StdCalibrate] \u00b6 The StdCalibrate service offers an opportunity to correct for any calibration errors in your instruments. It is very general and flexible. Because this service is normally run after StdConvert , the units to be used should be the same as the target unit system chosen in StdConvert . It is also important that this service be run before the archiving service StdArchive , so that it is the corrected data that are stored. In a default configuration, calibrations are applied to observations from the hardware. They are not applied to derived calculations since the StdWXCalculate service runs after StdCalibrate . [[Corrections]] \u00b6 In this section you list all correction expressions. For example, say that you know your outside thermometer reads high by 0.2\u00b0F. You could add the expression: outTemp = outTemp - 0.2 Perhaps you need a linear correction around a reference temperature of 68\u00b0F: outTemp = outTemp + (outTemp-68) * 0.02 It is even possible to do corrections involving more than one variable. Suppose you have a temperature sensitive barometer: barometer = barometer + (outTemp-32) * 0.0091 All correction expressions are run in the order given. Both LOOP data and archive data will be corrected. If you are using a Davis Vantage instrument and all you require is a simple correction offset, this can also be done in the hardware. See your manual for instructions.","title":"[StdCalibrate]"},{"location":"reference/weewx-options/stdcalibrate/#stdcalibrate","text":"The StdCalibrate service offers an opportunity to correct for any calibration errors in your instruments. It is very general and flexible. Because this service is normally run after StdConvert , the units to be used should be the same as the target unit system chosen in StdConvert . It is also important that this service be run before the archiving service StdArchive , so that it is the corrected data that are stored. In a default configuration, calibrations are applied to observations from the hardware. They are not applied to derived calculations since the StdWXCalculate service runs after StdCalibrate .","title":"[StdCalibrate]"},{"location":"reference/weewx-options/stdcalibrate/#corrections","text":"In this section you list all correction expressions. For example, say that you know your outside thermometer reads high by 0.2\u00b0F. You could add the expression: outTemp = outTemp - 0.2 Perhaps you need a linear correction around a reference temperature of 68\u00b0F: outTemp = outTemp + (outTemp-68) * 0.02 It is even possible to do corrections involving more than one variable. Suppose you have a temperature sensitive barometer: barometer = barometer + (outTemp-32) * 0.0091 All correction expressions are run in the order given. Both LOOP data and archive data will be corrected. If you are using a Davis Vantage instrument and all you require is a simple correction offset, this can also be done in the hardware. See your manual for instructions.","title":"[[Corrections]]"},{"location":"reference/weewx-options/stdconvert/","text":"[StdConvert] \u00b6 The StdConvert service acts as a filter for units, converting the unit system coming off your hardware to a target output unit system. All downstream services, including the archiving service, will then see this unit system. Hence, your data will be stored in the database using whatever unit system you specify here. Once chosen, the unit system in the database cannot be changed! WeeWX does not allow you to mix unit systems within the databases. You must choose a unit system and then stick with it. This means that users coming from wview (which uses US Customary) should not change the default setting. Having said this, there is a way of reconfiguring the database to use another unit system. See the section Changing the unit system in an existing database in the Customization Guide . Note This service only affects the units used in the databases. In particular, it has nothing to do with what units are displayed in plots or files. Those units are specified in the skin configuration file, as described in the Customization Guide , under section Changing unit systems . Because of this, unless you have a special purpose application, there is really no good reason to change from the default, which is US . Warning If, despite these precautions, you do decide to change the units of data stored in the database, be sure to read the sections [StdCalibrate] and [StdQC] , and change the units there as well! target_unit \u00b6 Set to either US , METRICWX , or METRIC . The difference between METRICWX and METRIC is that the former uses mm instead of cm for rain, and m/s instead of km/hr for wind speed. See the reference section Units for the exact differences beween each of these options. Default is US .","title":"[StdConvert]"},{"location":"reference/weewx-options/stdconvert/#stdconvert","text":"The StdConvert service acts as a filter for units, converting the unit system coming off your hardware to a target output unit system. All downstream services, including the archiving service, will then see this unit system. Hence, your data will be stored in the database using whatever unit system you specify here. Once chosen, the unit system in the database cannot be changed! WeeWX does not allow you to mix unit systems within the databases. You must choose a unit system and then stick with it. This means that users coming from wview (which uses US Customary) should not change the default setting. Having said this, there is a way of reconfiguring the database to use another unit system. See the section Changing the unit system in an existing database in the Customization Guide . Note This service only affects the units used in the databases. In particular, it has nothing to do with what units are displayed in plots or files. Those units are specified in the skin configuration file, as described in the Customization Guide , under section Changing unit systems . Because of this, unless you have a special purpose application, there is really no good reason to change from the default, which is US . Warning If, despite these precautions, you do decide to change the units of data stored in the database, be sure to read the sections [StdCalibrate] and [StdQC] , and change the units there as well!","title":"[StdConvert]"},{"location":"reference/weewx-options/stdconvert/#target_unit","text":"Set to either US , METRICWX , or METRIC . The difference between METRICWX and METRIC is that the former uses mm instead of cm for rain, and m/s instead of km/hr for wind speed. See the reference section Units for the exact differences beween each of these options. Default is US .","title":"target_unit"},{"location":"reference/weewx-options/stdqc/","text":"[StdQC] \u00b6 The StdQC service offers a very simple Quality Control that only checks that values are within a minimum and maximum range. Because this service is normally run after StdConvert , the units to be used should be the same as the target unit system chosen in StdConvert . It is also important that it be run after the calibration service, StdCalibrate and before the archiving service StdArchive , so that it is the calibrated and corrected data that are stored. In a default configuration, quality control checks are applied to observations from the hardware. They are not applied to derived calculations since the StdWXCalculate service runs after the quality control. [[MinMax]] \u00b6 In this section you list the observation types you wish to have checked, along with their minimum and maximum values. If not specified, the units should are in the same unit system as specified in [StdConvert] . For example, [[MinMax]] outTemp = -40, 120 barometer = 28, 32.5 outHumidity = 0, 100 With target_unit=US (the default), if a temperature should fall outside the inclusive range -40 \u00b0F through 120 \u00b0F, then it will be set to the null value, None , and ignored. In a similar manner, the acceptable values for barometric pressure would be 28 through 32.5 inHg, for humidity 0 through 100%. You can also specify units. For example, [[MinMax]] outTemp = -40, 60, degree_C barometer = 28, 32.5, inHg In this example, if a temperature should fall outside the inclusive range -40 \u00b0C through 60 \u00b0C, then it will be set to the null value, None , and ignored. In a similar manner, the acceptable values for barometric pressure would be 28 through 32.5 inHg. Since the units have been specified, these values apply no matter what the target_unit . Both LOOP and archive data will be checked. Knowing the details of how your hardware encodes data helps to minimize the number of observations that need to be checked. For example, the VP2 devotes only one unsigned byte to storing wind speed, and even then 0xff is devoted to a bad value, so the only possible values that could appear are 0 through 126 mph, a reasonable range. So, for the VP2, there is no real point in checking wind speed.","title":"[StdQC]"},{"location":"reference/weewx-options/stdqc/#stdqc","text":"The StdQC service offers a very simple Quality Control that only checks that values are within a minimum and maximum range. Because this service is normally run after StdConvert , the units to be used should be the same as the target unit system chosen in StdConvert . It is also important that it be run after the calibration service, StdCalibrate and before the archiving service StdArchive , so that it is the calibrated and corrected data that are stored. In a default configuration, quality control checks are applied to observations from the hardware. They are not applied to derived calculations since the StdWXCalculate service runs after the quality control.","title":"[StdQC]"},{"location":"reference/weewx-options/stdqc/#minmax","text":"In this section you list the observation types you wish to have checked, along with their minimum and maximum values. If not specified, the units should are in the same unit system as specified in [StdConvert] . For example, [[MinMax]] outTemp = -40, 120 barometer = 28, 32.5 outHumidity = 0, 100 With target_unit=US (the default), if a temperature should fall outside the inclusive range -40 \u00b0F through 120 \u00b0F, then it will be set to the null value, None , and ignored. In a similar manner, the acceptable values for barometric pressure would be 28 through 32.5 inHg, for humidity 0 through 100%. You can also specify units. For example, [[MinMax]] outTemp = -40, 60, degree_C barometer = 28, 32.5, inHg In this example, if a temperature should fall outside the inclusive range -40 \u00b0C through 60 \u00b0C, then it will be set to the null value, None , and ignored. In a similar manner, the acceptable values for barometric pressure would be 28 through 32.5 inHg. Since the units have been specified, these values apply no matter what the target_unit . Both LOOP and archive data will be checked. Knowing the details of how your hardware encodes data helps to minimize the number of observations that need to be checked. For example, the VP2 devotes only one unsigned byte to storing wind speed, and even then 0xff is devoted to a bad value, so the only possible values that could appear are 0 through 126 mph, a reasonable range. So, for the VP2, there is no real point in checking wind speed.","title":"[[MinMax]]"},{"location":"reference/weewx-options/stdreport/","text":"[StdReport] \u00b6 This section is for configuring the StdReport service, which controls what reports are to be generated. While it can be highly customized for your individual situation, this documentation describes the section as shipped in the standard distribution. Each report is represented by a subsection, marked with double brackets (e.g., [[MyReport]] ). Any options for the report should be placed under it. The standard report service will go through the subsections, running each report in order. WeeWX ships with the following subsections: subsection Description [[SeasonsReport]] A full-featured single-page skin. Statistics and plots are revealed by touch or button press. [[SmartphoneReport]] A skin formatted for smaller screens, with a look-and-feel reminiscent of first-generation Apple iPhone. [[MobileReport]] A static skin formatted for very small screens, with a look-and-feel reminiscent of WindowsCE or PalmOS. [[StandardReport]] The original skin that shipped for many years as the default report. It uses static HTML and images, and requires few resources to generate and display. [[FTP]] No presentation elements. Uses the reporting machinery to transfer files to a remote server using FTP. [[RSYNC]] No presentation elements. Uses the reporting machinery to transfer files to a remote server using rsync. Order matters. The reports that generate HTML and images, that is, SeasonsReport , SmartphoneReport , MobileReport , and StandardReport , are run first , then the reports that move them to a webserver, FTP and RSYNC , are run. This insures that report generation is done before the results are sent off. Details for how to customize reports are in the section Customizing reports , in the Customization Guide . SKIN_ROOT \u00b6 The directory where the skins live. If a relative path is specified, it is relative to WEEWX_ROOT . HTML_ROOT \u00b6 The target directory for the generated files. Generated files and images wil l be put here. If a relative path is specified, it is relative to WEEWX_ROOT . log_success \u00b6 If you set a value for log_success here, it will override the value set at the top-level and will apply only to reporting. In addition, log_success can be set for individual reports by putting them under the appropriate subsection ( e.g. , under [[Seasons]] ). log_failure \u00b6 If you set a value for log_failure here, it will override the value set at the top-level and will apply only to reporting. In addition, log_failure can be set for individual reports by putting them under the appropriate subsection ( e.g. , under [[Seasons]] ). data_binding \u00b6 The data source to be used for the reports. It should match a binding given in section [DataBindings] . The binding can be overridden in individual reports. Optional. Default is wx_binding . report_timing \u00b6 This parameter uses a cron-like syntax that determines when a report will be run. The setting can be overridden in individual reports, so it is possible to run each report with a different schedule. Refer to the separate document Scheduling report generation for how to control when reports are run. Optional. By default, a value is missing, which causes each report to run on each archive interval. Standard WeeWX reports \u00b6 These are the four reports that are included in the standard distribution of WeeWX, and which actually generate HTML files and plots. They all use US Customary units by default (but this can be changed by setting the option unit_system ). [[SeasonsReport]] \u00b6 [[SmartphoneReport]] \u00b6 [[MobileReport]] \u00b6 [[StandardReport]] \u00b6 They all have the following options in common: lang \u00b6 Which language the skin should be localized in. The value is a two-character language code as defined in ISO 639-1 . This option only works with skins that have been internationalized. All skins that ship with WeeWX have been internationalized, but only a handful of languages are included. To see which language a skin supports, look in the subdirectory lang in the skin's directory. For example, if you see a file fr.conf , then the skin can be localized in French. unit_system \u00b6 Which unit system to use with the skin. Choices are US , METRIC , or METRICWX . See the reference section Units for definitions of these unit systems. Individual units can be overridden. See the section Changing unit systems in the Customization Guide for more details. enable \u00b6 Set to true to enable the processing of this skin. Set to false to disable. If this option is missing, true is assumed. skin \u00b6 Where to find the skin. This should be a directory under SKIN_ROOT . Inside the directory should be any templates used by the skin and a skin configuration file, skin.conf . HTML_ROOT \u00b6 If you put a value for HTML_ROOT here, it will override the value directly under [StdReport] . [[FTP]] \u00b6 While this \"report\" does not actually generate anything, it uses the report machinery to upload files from directory HTML_ROOT to a remote webserver. It does an incremental update, that is, it only FTPs any files that have changed, saving the outgoing bandwidth of your Internet connection. enable \u00b6 Set to true (the default) to enable FTP. Set to false to disable. user \u00b6 Set to the username you use for your FTP connection to your web server. Required. No default. password \u00b6 Set to the password you use for your FTP connection to your web server. Required. No default. server \u00b6 Set to the name of your web server ( e.g. , www.acme.com ). Required. No default path \u00b6 Set to the path where the weather data will be stored on your webserver ( e.g. , /weather ). Required. No default. Note Some FTP servers require a leading slash (' / '), some do not. secure_ftp \u00b6 Set to true to use FTP (FTPS) over TLS. This is an extension to the FTP protocol that uses a Secure Socket Layer (SSL) protocol, not to be confused with SFTP, which uses a Secure Socket Shell protocol. Not all FTP servers support this. In particular, the Microsoft FTP server seems to do a poor job of it. Optional. Default is false secure_data \u00b6 If a secure session is requested (option secure_ftp=true ), should we attempt a secure data connection as well? This option is useful due to a bug in the Python FTP client library. See WeeWx GitHub Issue #284 . Optional. Default is true . reuse_ssl \u00b6 Some FTP servers (notably PureFTP) reuse ssl connections with FTPS. Unfortunately, the Python library has a bug that prematurely closes such connections. See https://bit.ly/2Lrywla . Symptom is an exception OSError: [Errno 0] , or a 425 error (\" 425 Unable to build data connection: Operation not permitted \"). This option activates a workaround for Python versions greater than 3.6. It won't work for earlier versions. Optional. Default is false . port \u00b6 Set to the port ID of your FTP server. Default is 21 . passive \u00b6 Set to 1 if you wish to use the more modern, FTP passive mode, 0 if you wish to use active mode. Passive mode generally works better through firewalls, but not all FTP servers do a good job of supporting it. See Active FTP vs. Passive FTP, a Definitive Explanation for a good explanation of the difference. Default is 1 (passive mode). max_tries \u00b6 WeeWX will try up to this many times to FTP a file up to your server before giving up. Default is 3 . ftp_encoding \u00b6 The vast majority of FTP servers send their responses back using UTF-8 encoding. However, there are a few oddballs that respond using Latin-1. This option allows you to specify an alternative encoding. ciphers \u00b6 Some clients require a higher cipher level than the FTP server is capable of delivering. The symptom is an error something like: ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:997)` This option allows you to specify a custom level. For example, in this case, you might want to specify: ciphers = 'DEFAULT@SECLEVEL=1' However, if possible, you are always better off upgrading the FTP server. [[RSYNC]] \u00b6 While this \"report\" does not actually generate anything, it uses the report machinery to upload files from directory HTML_ROOT to a remote webserver using rsync . Fast, efficient, and secure, it does an incremental update, that is, it only synchronizes those parts of a file that have changed, saving the outgoing bandwidth of your Internet connection. If you wish to use rsync, you must configure passwordless ssh using public/private key authentication from the user account that WeeWX runs, to the user account on the remote machine where the files will be copied. enable \u00b6 Set to true (the default) to enable rsync. Set to false to disable. server \u00b6 Set to the name of your server. This name should appear in your .ssh/config file. Required. No default user \u00b6 Set to the ssh username you use for your rsync connection to your web server. The local user that WeeWX runs as must have passwordless ssh configured for user@server . Required. No default. path \u00b6 Set to the path where the weather data will be stored on your webserver ( e.g. , /var/www/html/weather ). Make sure user has write privileges in this directory. Required. No default. port \u00b6 The port to use for the ssh connection. Default is to use the default port for the ssh command (generally 22). delete \u00b6 Files that don't exist in the local report are removed from the remote location. Warning USE WITH CAUTION! If you make a mistake in setting the path, this can cause unexpected files to be deleted on the remote server. Valid values are 1 to enable and 0 to disable. Required. Default is 0 . [[Defaults]] \u00b6 This section defines default values for all reports. You can set: The unit system to be used Overrides for individual units Which language to be used Number and time formats Labels to be used Calculation options for some derived values. See the section Processing order in the Customization Guide for more details.","title":"[StdReport]"},{"location":"reference/weewx-options/stdreport/#stdreport","text":"This section is for configuring the StdReport service, which controls what reports are to be generated. While it can be highly customized for your individual situation, this documentation describes the section as shipped in the standard distribution. Each report is represented by a subsection, marked with double brackets (e.g., [[MyReport]] ). Any options for the report should be placed under it. The standard report service will go through the subsections, running each report in order. WeeWX ships with the following subsections: subsection Description [[SeasonsReport]] A full-featured single-page skin. Statistics and plots are revealed by touch or button press. [[SmartphoneReport]] A skin formatted for smaller screens, with a look-and-feel reminiscent of first-generation Apple iPhone. [[MobileReport]] A static skin formatted for very small screens, with a look-and-feel reminiscent of WindowsCE or PalmOS. [[StandardReport]] The original skin that shipped for many years as the default report. It uses static HTML and images, and requires few resources to generate and display. [[FTP]] No presentation elements. Uses the reporting machinery to transfer files to a remote server using FTP. [[RSYNC]] No presentation elements. Uses the reporting machinery to transfer files to a remote server using rsync. Order matters. The reports that generate HTML and images, that is, SeasonsReport , SmartphoneReport , MobileReport , and StandardReport , are run first , then the reports that move them to a webserver, FTP and RSYNC , are run. This insures that report generation is done before the results are sent off. Details for how to customize reports are in the section Customizing reports , in the Customization Guide .","title":"[StdReport]"},{"location":"reference/weewx-options/stdreport/#skin_root","text":"The directory where the skins live. If a relative path is specified, it is relative to WEEWX_ROOT .","title":"SKIN_ROOT"},{"location":"reference/weewx-options/stdreport/#html_root","text":"The target directory for the generated files. Generated files and images wil l be put here. If a relative path is specified, it is relative to WEEWX_ROOT .","title":"HTML_ROOT"},{"location":"reference/weewx-options/stdreport/#log_success","text":"If you set a value for log_success here, it will override the value set at the top-level and will apply only to reporting. In addition, log_success can be set for individual reports by putting them under the appropriate subsection ( e.g. , under [[Seasons]] ).","title":"log_success"},{"location":"reference/weewx-options/stdreport/#log_failure","text":"If you set a value for log_failure here, it will override the value set at the top-level and will apply only to reporting. In addition, log_failure can be set for individual reports by putting them under the appropriate subsection ( e.g. , under [[Seasons]] ).","title":"log_failure"},{"location":"reference/weewx-options/stdreport/#data_binding","text":"The data source to be used for the reports. It should match a binding given in section [DataBindings] . The binding can be overridden in individual reports. Optional. Default is wx_binding .","title":"data_binding"},{"location":"reference/weewx-options/stdreport/#report_timing","text":"This parameter uses a cron-like syntax that determines when a report will be run. The setting can be overridden in individual reports, so it is possible to run each report with a different schedule. Refer to the separate document Scheduling report generation for how to control when reports are run. Optional. By default, a value is missing, which causes each report to run on each archive interval.","title":"report_timing"},{"location":"reference/weewx-options/stdreport/#standard-weewx-reports","text":"These are the four reports that are included in the standard distribution of WeeWX, and which actually generate HTML files and plots. They all use US Customary units by default (but this can be changed by setting the option unit_system ).","title":"Standard WeeWX reports"},{"location":"reference/weewx-options/stdreport/#seasonsreport","text":"","title":"[[SeasonsReport]]"},{"location":"reference/weewx-options/stdreport/#smartphonereport","text":"","title":"[[SmartphoneReport]]"},{"location":"reference/weewx-options/stdreport/#mobilereport","text":"","title":"[[MobileReport]]"},{"location":"reference/weewx-options/stdreport/#standardreport","text":"They all have the following options in common:","title":"[[StandardReport]]"},{"location":"reference/weewx-options/stdreport/#lang","text":"Which language the skin should be localized in. The value is a two-character language code as defined in ISO 639-1 . This option only works with skins that have been internationalized. All skins that ship with WeeWX have been internationalized, but only a handful of languages are included. To see which language a skin supports, look in the subdirectory lang in the skin's directory. For example, if you see a file fr.conf , then the skin can be localized in French.","title":"lang"},{"location":"reference/weewx-options/stdreport/#unit_system","text":"Which unit system to use with the skin. Choices are US , METRIC , or METRICWX . See the reference section Units for definitions of these unit systems. Individual units can be overridden. See the section Changing unit systems in the Customization Guide for more details.","title":"unit_system"},{"location":"reference/weewx-options/stdreport/#enable","text":"Set to true to enable the processing of this skin. Set to false to disable. If this option is missing, true is assumed.","title":"enable"},{"location":"reference/weewx-options/stdreport/#skin","text":"Where to find the skin. This should be a directory under SKIN_ROOT . Inside the directory should be any templates used by the skin and a skin configuration file, skin.conf .","title":"skin"},{"location":"reference/weewx-options/stdreport/#html_root_1","text":"If you put a value for HTML_ROOT here, it will override the value directly under [StdReport] .","title":"HTML_ROOT"},{"location":"reference/weewx-options/stdreport/#ftp","text":"While this \"report\" does not actually generate anything, it uses the report machinery to upload files from directory HTML_ROOT to a remote webserver. It does an incremental update, that is, it only FTPs any files that have changed, saving the outgoing bandwidth of your Internet connection.","title":"[[FTP]]"},{"location":"reference/weewx-options/stdreport/#enable_1","text":"Set to true (the default) to enable FTP. Set to false to disable.","title":"enable"},{"location":"reference/weewx-options/stdreport/#user","text":"Set to the username you use for your FTP connection to your web server. Required. No default.","title":"user"},{"location":"reference/weewx-options/stdreport/#password","text":"Set to the password you use for your FTP connection to your web server. Required. No default.","title":"password"},{"location":"reference/weewx-options/stdreport/#server","text":"Set to the name of your web server ( e.g. , www.acme.com ). Required. No default","title":"server"},{"location":"reference/weewx-options/stdreport/#path","text":"Set to the path where the weather data will be stored on your webserver ( e.g. , /weather ). Required. No default. Note Some FTP servers require a leading slash (' / '), some do not.","title":"path"},{"location":"reference/weewx-options/stdreport/#secure_ftp","text":"Set to true to use FTP (FTPS) over TLS. This is an extension to the FTP protocol that uses a Secure Socket Layer (SSL) protocol, not to be confused with SFTP, which uses a Secure Socket Shell protocol. Not all FTP servers support this. In particular, the Microsoft FTP server seems to do a poor job of it. Optional. Default is false","title":"secure_ftp"},{"location":"reference/weewx-options/stdreport/#secure_data","text":"If a secure session is requested (option secure_ftp=true ), should we attempt a secure data connection as well? This option is useful due to a bug in the Python FTP client library. See WeeWx GitHub Issue #284 . Optional. Default is true .","title":"secure_data"},{"location":"reference/weewx-options/stdreport/#reuse_ssl","text":"Some FTP servers (notably PureFTP) reuse ssl connections with FTPS. Unfortunately, the Python library has a bug that prematurely closes such connections. See https://bit.ly/2Lrywla . Symptom is an exception OSError: [Errno 0] , or a 425 error (\" 425 Unable to build data connection: Operation not permitted \"). This option activates a workaround for Python versions greater than 3.6. It won't work for earlier versions. Optional. Default is false .","title":"reuse_ssl"},{"location":"reference/weewx-options/stdreport/#port","text":"Set to the port ID of your FTP server. Default is 21 .","title":"port"},{"location":"reference/weewx-options/stdreport/#passive","text":"Set to 1 if you wish to use the more modern, FTP passive mode, 0 if you wish to use active mode. Passive mode generally works better through firewalls, but not all FTP servers do a good job of supporting it. See Active FTP vs. Passive FTP, a Definitive Explanation for a good explanation of the difference. Default is 1 (passive mode).","title":"passive"},{"location":"reference/weewx-options/stdreport/#max_tries","text":"WeeWX will try up to this many times to FTP a file up to your server before giving up. Default is 3 .","title":"max_tries"},{"location":"reference/weewx-options/stdreport/#ftp_encoding","text":"The vast majority of FTP servers send their responses back using UTF-8 encoding. However, there are a few oddballs that respond using Latin-1. This option allows you to specify an alternative encoding.","title":"ftp_encoding"},{"location":"reference/weewx-options/stdreport/#ciphers","text":"Some clients require a higher cipher level than the FTP server is capable of delivering. The symptom is an error something like: ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:997)` This option allows you to specify a custom level. For example, in this case, you might want to specify: ciphers = 'DEFAULT@SECLEVEL=1' However, if possible, you are always better off upgrading the FTP server.","title":"ciphers"},{"location":"reference/weewx-options/stdreport/#rsync","text":"While this \"report\" does not actually generate anything, it uses the report machinery to upload files from directory HTML_ROOT to a remote webserver using rsync . Fast, efficient, and secure, it does an incremental update, that is, it only synchronizes those parts of a file that have changed, saving the outgoing bandwidth of your Internet connection. If you wish to use rsync, you must configure passwordless ssh using public/private key authentication from the user account that WeeWX runs, to the user account on the remote machine where the files will be copied.","title":"[[RSYNC]]"},{"location":"reference/weewx-options/stdreport/#enable_2","text":"Set to true (the default) to enable rsync. Set to false to disable.","title":"enable"},{"location":"reference/weewx-options/stdreport/#server_1","text":"Set to the name of your server. This name should appear in your .ssh/config file. Required. No default","title":"server"},{"location":"reference/weewx-options/stdreport/#user_1","text":"Set to the ssh username you use for your rsync connection to your web server. The local user that WeeWX runs as must have passwordless ssh configured for user@server . Required. No default.","title":"user"},{"location":"reference/weewx-options/stdreport/#path_1","text":"Set to the path where the weather data will be stored on your webserver ( e.g. , /var/www/html/weather ). Make sure user has write privileges in this directory. Required. No default.","title":"path"},{"location":"reference/weewx-options/stdreport/#port_1","text":"The port to use for the ssh connection. Default is to use the default port for the ssh command (generally 22).","title":"port"},{"location":"reference/weewx-options/stdreport/#delete","text":"Files that don't exist in the local report are removed from the remote location. Warning USE WITH CAUTION! If you make a mistake in setting the path, this can cause unexpected files to be deleted on the remote server. Valid values are 1 to enable and 0 to disable. Required. Default is 0 .","title":"delete"},{"location":"reference/weewx-options/stdreport/#defaults","text":"This section defines default values for all reports. You can set: The unit system to be used Overrides for individual units Which language to be used Number and time formats Labels to be used Calculation options for some derived values. See the section Processing order in the Customization Guide for more details.","title":"[[Defaults]]"},{"location":"reference/weewx-options/stdrestful/","text":"[StdRESTful] \u00b6 This section is for configuring the StdRESTful services, which upload to simple RESTful services such as: Weather Underground PWSweather.com CWOP British Weather Observations Website (WOW) Automatisches Wetterkarten System (AWEKAS) General options for each RESTful Service \u00b6 log_success \u00b6 If you set a value for log_success here, it will override the value set at the top-level and will apply only to RESTful services. In addition, log_success can be set for individual services by putting them under the appropriate subsection ( e.g. , under [[CWOP]] ). log_failure \u00b6 If you set a value for log_failure here, it will override the value set at the top-level and will apply only to RESTful services. In addition, log_failure can be set for individual services by putting them under the appropriate subsection ( e.g. , under [[CWOP]] ). [[StationRegistry]] \u00b6 A registry of WeeWX weather stations is maintained at weewx.com . Stations are displayed on a map and a list at https://weewx.com/stations.html . How does the registry work? Individual weather stations periodically contact the registry. Each station provides a unique URL to identify itself, plus other information such as the station type, Python version, WeeWX version and installation method. No personal information, nor any meteorological data, is sent. To add your station to this list, you must do two things: Enable the station registry by setting option register_this_station to true . Your station will contact the registry once per day. If your station does not contact the registry for about a month, it will be removed from the list. Provide a value for option station_url . This value must be unique, so choose it carefully. [StdRestful] [[StationRegistry]] register_this_station = True description = \"Beach side weather\" station_url = https://acme.com register_this_station \u00b6 Set this to true to register the weather station. description \u00b6 A description of the station. If no description is specified, the location from section [Station] will be used. station_url \u00b6 The URL to the weather station. If no URL is specified, the station_url from section [Station] will be used. It must be a valid URL. In particular, it must start with either http:// or https:// . log_success \u00b6 If you set a value here, it will apply only to the station registry. log_failure \u00b6 If you set a value here, it will apply only to the station registry. [[AWEKAS]] \u00b6 WeeWX can send your current data to the Automatisches Wetterkarten System (AWEKAS) . If you wish to do this, set the option enable to true , then set options username and password appropriately. When you are done, it will look something like this: [StdRestful] [[AWEKAS]] enable = true username = joeuser password = XXX enable \u00b6 Set to true to enable posting to AWEKAS. Optional. Default is false . username \u00b6 Set to your AWEKAS username (e.g., joeuser ). Required. password \u00b6 Set to your AWEKAS password. Required. language \u00b6 Set to your preferred language. Default is en . log_success \u00b6 If you set a value here, it will apply only to logging for AWEKAS. log_failure \u00b6 If you set a value here, it will apply only to logging for AWEKAS. retry_login \u00b6 How long to wait in seconds before retrying a bad login. If set to zero, no retry will be attempted. Default is 3600 . post_interval \u00b6 The interval in seconds between posts. Setting this value to zero will cause every archive record to be posted. Optional. Default is zero. [[CWOP]] \u00b6 WeeWX can send your current data to the Citizen Weather Observer Program . If you wish to do this, set the option enable to true , then set the option station to your CWOP station code. If your station is an amateur radio APRS station, you will have to set passcode as well. When you are done, it will look something like [StdRestful] [[CWOP]] enable = true station = CW1234 passcode = XXX # Replace with your passcode (APRS stations only) post_interval = 600 enable \u00b6 Set to true to enable posting to the CWOP. Optional. Default is false . station \u00b6 Set to your CWOP station ID (e.g., CW1234) or amateur radio callsign (APRS). Required. passcode \u00b6 This is used for APRS (amateur radio) stations only. Set to the passcode given to you by the CWOP operators. Required for APRS stations, ignored for others. post_interval \u00b6 The interval in seconds between posts. Because CWOP is heavily used, the operators discourage very frequent posts. Every 5 minutes (300 seconds) is fine, but they prefer every 10 minutes (600 s) or even longer. Setting this value to zero will cause every archive record to be posted. Optional. Default is 600 . stale \u00b6 How old a record can be in seconds before it will not be used for a catch-up. CWOP does not use the timestamp on a posted record. Instead, they use the wall clock time that it came in. This means that if your station is off the air for a long period of time, then when WeeWX attempts a catch-up, old data could be interpreted as the current conditions. Optional. Default is 600 . server_list \u00b6 A comma-delimited list of the servers that should be tried for uploading data. Optional. Default is: cwop.aprs.net:14580, cwop.aprs.net:23 log_success \u00b6 If you set a value here, it will apply only to logging for CWOP. log_failure \u00b6 If you set a value here, it will apply only to logging for CWOP. [[PWSweather]] \u00b6 WeeWX can send your current data to the PWSweather.com service. If you wish to do this, set the option enable to true , then set the options station and password appropriately. When you are done, it will look something like this: [StdRestful] [[PWSweather]] enable = true station = BOISE password = XXX enable \u00b6 Set to true to enable posting to the PWSweather. Optional. Default is false . station \u00b6 Set to your PWSweather station ID (e.g., BOISE ). Required. password \u00b6 Set to your PWSweather password. Required. log_success \u00b6 If you set a value here, it will apply only to logging for PWSweather. log_failure \u00b6 If you set a value here, it will apply only to logging for PWSweather. retry_login \u00b6 How long to wait in seconds before retrying a bad login. Default is 3600 (one hour). post_interval \u00b6 The interval in seconds between posts. Setting this value to zero will cause every archive record to be posted. Optional. Default is zero. [[WOW]] \u00b6 WeeWX can send your current data to the British Weather Observations Website (WOW) service. If you wish to do this, set the option enable to true , then set options station and password appropriately. Read Importing Weather Data into WOW on how to find your site's username and how to set the password for your site. When you are done, it will look something like this: [StdRestful] [[WOW]] enable = true station = 12345678 password = XXX enable \u00b6 Set to true to enable posting to WOW. Optional. Default is false . station \u00b6 Set to your WOW station ID (e.g., 12345678 for Pre June 1996 sites, or 6a571450-df53-e611-9401-0003ff5987fd for later ones). Required. password \u00b6 Set to your WOW Authentication Key. Required. This is not the same as your WOW user password. It is a 6 digit numerical PIN, unique for your station. log_success \u00b6 If you set a value here, it will apply only to logging for WOW. log_failure \u00b6 If you set a value here, it will apply only to logging for WOW. retry_login \u00b6 How long to wait in seconds before retrying a bad login. Default is 3600 (one hour). post_interval \u00b6 The interval in seconds between posts. Setting this value to zero will cause every archive record to be posted. Optional. Default is zero. [[Wunderground]] \u00b6 WeeWX can send your current data to the Weather Underground . If you wish to post to do this, set the option enable to true , then specify a station (e.g., KORBURNS99 ). Use the station key for the password. When you are done, it will look something like this: [StdRestful] [[Wunderground]] enable = true station = KORBURNS99 password = A331D1SIm rapidfire = false enable \u00b6 Set to true to enable posting to the Weather Underground. Optional. Default is false . station \u00b6 Set to your Weather Underground station ID (e.g., KORBURNS99 ). Required. password \u00b6 Set to the station \"key\". You can find this at: https://www.wunderground.com/member/devices . rapidfire \u00b6 Set to true to have WeeWX post using the Weather Underground's \"Rapidfire\" protocol . This will send a post to the WU site with every LOOP packet, which can be as often as every 2.5 seconds in the case of the Vantage instruments. Not all instruments support this. Optional. Default is false . rtfreq \u00b6 When rapidfire is set, the rtfreq parameter is sent, and should correspond to \"the frequency of updates in seconds\". Optional. Default is 2.5 . archive_post \u00b6 This option tells WeeWX to post on every archive record, which is the normal \"PWS\" mode for the Weather Underground. Because they prefer that you either use their \"Rapidfire\" protocol, or their PWS mode, but not both, the default for this option is the opposite for whatever you choose above for option rapidfire. However, if for some reason you want to do both, then you may set both options to true . post_indoor_observations \u00b6 In the interest of respecting your privacy, WeeWX does not post indoor temperature or humidity to the Weather Underground unless you set this option to true . Default is false . log_success \u00b6 If you set a value here, it will apply only to logging for the Weather Underground. log_failure \u00b6 If you set a value here, it will apply only to logging for the Weather Underground. retry_login \u00b6 How long to wait in seconds before retrying a bad login. Default is 3600 (one hour). post_interval \u00b6 The interval in seconds between posts. Setting this value to zero will cause every archive record to be posted. Optional. Default is zero. force_direction \u00b6 The Weather Underground has a bug where they will claim that a station is \"unavailable\" if it sends a null wind direction, even when the wind speed is zero. Setting this option to true causes the software to cache the last non-null wind direction and use that instead of sending a null value. Default is False . [[[Essentials]]] \u00b6 Occasionally (but not always!) when the Weather Underground is missing a data point it will substitute the value zero (0.0), thus messing up statistics and plots. For all observation types listed in this section, the post will be skipped if that type is missing. For example: [StdRestful] [[Wunderground]] ... [[[Essentials]]] outTemp = True would cause the post to be skipped if there is no outside temperature (observation type outTemp ).","title":"[StdRESTful]"},{"location":"reference/weewx-options/stdrestful/#stdrestful","text":"This section is for configuring the StdRESTful services, which upload to simple RESTful services such as: Weather Underground PWSweather.com CWOP British Weather Observations Website (WOW) Automatisches Wetterkarten System (AWEKAS)","title":"[StdRESTful]"},{"location":"reference/weewx-options/stdrestful/#general-options-for-each-restful-service","text":"","title":"General options for each RESTful Service"},{"location":"reference/weewx-options/stdrestful/#log_success","text":"If you set a value for log_success here, it will override the value set at the top-level and will apply only to RESTful services. In addition, log_success can be set for individual services by putting them under the appropriate subsection ( e.g. , under [[CWOP]] ).","title":"log_success"},{"location":"reference/weewx-options/stdrestful/#log_failure","text":"If you set a value for log_failure here, it will override the value set at the top-level and will apply only to RESTful services. In addition, log_failure can be set for individual services by putting them under the appropriate subsection ( e.g. , under [[CWOP]] ).","title":"log_failure"},{"location":"reference/weewx-options/stdrestful/#stationregistry","text":"A registry of WeeWX weather stations is maintained at weewx.com . Stations are displayed on a map and a list at https://weewx.com/stations.html . How does the registry work? Individual weather stations periodically contact the registry. Each station provides a unique URL to identify itself, plus other information such as the station type, Python version, WeeWX version and installation method. No personal information, nor any meteorological data, is sent. To add your station to this list, you must do two things: Enable the station registry by setting option register_this_station to true . Your station will contact the registry once per day. If your station does not contact the registry for about a month, it will be removed from the list. Provide a value for option station_url . This value must be unique, so choose it carefully. [StdRestful] [[StationRegistry]] register_this_station = True description = \"Beach side weather\" station_url = https://acme.com","title":"[[StationRegistry]]"},{"location":"reference/weewx-options/stdrestful/#register_this_station","text":"Set this to true to register the weather station.","title":"register_this_station"},{"location":"reference/weewx-options/stdrestful/#description","text":"A description of the station. If no description is specified, the location from section [Station] will be used.","title":"description"},{"location":"reference/weewx-options/stdrestful/#station_url","text":"The URL to the weather station. If no URL is specified, the station_url from section [Station] will be used. It must be a valid URL. In particular, it must start with either http:// or https:// .","title":"station_url"},{"location":"reference/weewx-options/stdrestful/#log_success_1","text":"If you set a value here, it will apply only to the station registry.","title":"log_success"},{"location":"reference/weewx-options/stdrestful/#log_failure_1","text":"If you set a value here, it will apply only to the station registry.","title":"log_failure"},{"location":"reference/weewx-options/stdrestful/#awekas","text":"WeeWX can send your current data to the Automatisches Wetterkarten System (AWEKAS) . If you wish to do this, set the option enable to true , then set options username and password appropriately. When you are done, it will look something like this: [StdRestful] [[AWEKAS]] enable = true username = joeuser password = XXX","title":"[[AWEKAS]]"},{"location":"reference/weewx-options/stdrestful/#enable","text":"Set to true to enable posting to AWEKAS. Optional. Default is false .","title":"enable"},{"location":"reference/weewx-options/stdrestful/#username","text":"Set to your AWEKAS username (e.g., joeuser ). Required.","title":"username"},{"location":"reference/weewx-options/stdrestful/#password","text":"Set to your AWEKAS password. Required.","title":"password"},{"location":"reference/weewx-options/stdrestful/#language","text":"Set to your preferred language. Default is en .","title":"language"},{"location":"reference/weewx-options/stdrestful/#log_success_2","text":"If you set a value here, it will apply only to logging for AWEKAS.","title":"log_success"},{"location":"reference/weewx-options/stdrestful/#log_failure_2","text":"If you set a value here, it will apply only to logging for AWEKAS.","title":"log_failure"},{"location":"reference/weewx-options/stdrestful/#retry_login","text":"How long to wait in seconds before retrying a bad login. If set to zero, no retry will be attempted. Default is 3600 .","title":"retry_login"},{"location":"reference/weewx-options/stdrestful/#post_interval","text":"The interval in seconds between posts. Setting this value to zero will cause every archive record to be posted. Optional. Default is zero.","title":"post_interval"},{"location":"reference/weewx-options/stdrestful/#cwop","text":"WeeWX can send your current data to the Citizen Weather Observer Program . If you wish to do this, set the option enable to true , then set the option station to your CWOP station code. If your station is an amateur radio APRS station, you will have to set passcode as well. When you are done, it will look something like [StdRestful] [[CWOP]] enable = true station = CW1234 passcode = XXX # Replace with your passcode (APRS stations only) post_interval = 600","title":"[[CWOP]]"},{"location":"reference/weewx-options/stdrestful/#enable_1","text":"Set to true to enable posting to the CWOP. Optional. Default is false .","title":"enable"},{"location":"reference/weewx-options/stdrestful/#station","text":"Set to your CWOP station ID (e.g., CW1234) or amateur radio callsign (APRS). Required.","title":"station"},{"location":"reference/weewx-options/stdrestful/#passcode","text":"This is used for APRS (amateur radio) stations only. Set to the passcode given to you by the CWOP operators. Required for APRS stations, ignored for others.","title":"passcode"},{"location":"reference/weewx-options/stdrestful/#post_interval_1","text":"The interval in seconds between posts. Because CWOP is heavily used, the operators discourage very frequent posts. Every 5 minutes (300 seconds) is fine, but they prefer every 10 minutes (600 s) or even longer. Setting this value to zero will cause every archive record to be posted. Optional. Default is 600 .","title":"post_interval"},{"location":"reference/weewx-options/stdrestful/#stale","text":"How old a record can be in seconds before it will not be used for a catch-up. CWOP does not use the timestamp on a posted record. Instead, they use the wall clock time that it came in. This means that if your station is off the air for a long period of time, then when WeeWX attempts a catch-up, old data could be interpreted as the current conditions. Optional. Default is 600 .","title":"stale"},{"location":"reference/weewx-options/stdrestful/#server_list","text":"A comma-delimited list of the servers that should be tried for uploading data. Optional. Default is: cwop.aprs.net:14580, cwop.aprs.net:23","title":"server_list"},{"location":"reference/weewx-options/stdrestful/#log_success_3","text":"If you set a value here, it will apply only to logging for CWOP.","title":"log_success"},{"location":"reference/weewx-options/stdrestful/#log_failure_3","text":"If you set a value here, it will apply only to logging for CWOP.","title":"log_failure"},{"location":"reference/weewx-options/stdrestful/#pwsweather","text":"WeeWX can send your current data to the PWSweather.com service. If you wish to do this, set the option enable to true , then set the options station and password appropriately. When you are done, it will look something like this: [StdRestful] [[PWSweather]] enable = true station = BOISE password = XXX","title":"[[PWSweather]]"},{"location":"reference/weewx-options/stdrestful/#enable_2","text":"Set to true to enable posting to the PWSweather. Optional. Default is false .","title":"enable"},{"location":"reference/weewx-options/stdrestful/#station_1","text":"Set to your PWSweather station ID (e.g., BOISE ). Required.","title":"station"},{"location":"reference/weewx-options/stdrestful/#password_1","text":"Set to your PWSweather password. Required.","title":"password"},{"location":"reference/weewx-options/stdrestful/#log_success_4","text":"If you set a value here, it will apply only to logging for PWSweather.","title":"log_success"},{"location":"reference/weewx-options/stdrestful/#log_failure_4","text":"If you set a value here, it will apply only to logging for PWSweather.","title":"log_failure"},{"location":"reference/weewx-options/stdrestful/#retry_login_1","text":"How long to wait in seconds before retrying a bad login. Default is 3600 (one hour).","title":"retry_login"},{"location":"reference/weewx-options/stdrestful/#post_interval_2","text":"The interval in seconds between posts. Setting this value to zero will cause every archive record to be posted. Optional. Default is zero.","title":"post_interval"},{"location":"reference/weewx-options/stdrestful/#wow","text":"WeeWX can send your current data to the British Weather Observations Website (WOW) service. If you wish to do this, set the option enable to true , then set options station and password appropriately. Read Importing Weather Data into WOW on how to find your site's username and how to set the password for your site. When you are done, it will look something like this: [StdRestful] [[WOW]] enable = true station = 12345678 password = XXX","title":"[[WOW]]"},{"location":"reference/weewx-options/stdrestful/#enable_3","text":"Set to true to enable posting to WOW. Optional. Default is false .","title":"enable"},{"location":"reference/weewx-options/stdrestful/#station_2","text":"Set to your WOW station ID (e.g., 12345678 for Pre June 1996 sites, or 6a571450-df53-e611-9401-0003ff5987fd for later ones). Required.","title":"station"},{"location":"reference/weewx-options/stdrestful/#password_2","text":"Set to your WOW Authentication Key. Required. This is not the same as your WOW user password. It is a 6 digit numerical PIN, unique for your station.","title":"password"},{"location":"reference/weewx-options/stdrestful/#log_success_5","text":"If you set a value here, it will apply only to logging for WOW.","title":"log_success"},{"location":"reference/weewx-options/stdrestful/#log_failure_5","text":"If you set a value here, it will apply only to logging for WOW.","title":"log_failure"},{"location":"reference/weewx-options/stdrestful/#retry_login_2","text":"How long to wait in seconds before retrying a bad login. Default is 3600 (one hour).","title":"retry_login"},{"location":"reference/weewx-options/stdrestful/#post_interval_3","text":"The interval in seconds between posts. Setting this value to zero will cause every archive record to be posted. Optional. Default is zero.","title":"post_interval"},{"location":"reference/weewx-options/stdrestful/#wunderground","text":"WeeWX can send your current data to the Weather Underground . If you wish to post to do this, set the option enable to true , then specify a station (e.g., KORBURNS99 ). Use the station key for the password. When you are done, it will look something like this: [StdRestful] [[Wunderground]] enable = true station = KORBURNS99 password = A331D1SIm rapidfire = false","title":"[[Wunderground]]"},{"location":"reference/weewx-options/stdrestful/#enable_4","text":"Set to true to enable posting to the Weather Underground. Optional. Default is false .","title":"enable"},{"location":"reference/weewx-options/stdrestful/#station_3","text":"Set to your Weather Underground station ID (e.g., KORBURNS99 ). Required.","title":"station"},{"location":"reference/weewx-options/stdrestful/#password_3","text":"Set to the station \"key\". You can find this at: https://www.wunderground.com/member/devices .","title":"password"},{"location":"reference/weewx-options/stdrestful/#rapidfire","text":"Set to true to have WeeWX post using the Weather Underground's \"Rapidfire\" protocol . This will send a post to the WU site with every LOOP packet, which can be as often as every 2.5 seconds in the case of the Vantage instruments. Not all instruments support this. Optional. Default is false .","title":"rapidfire"},{"location":"reference/weewx-options/stdrestful/#rtfreq","text":"When rapidfire is set, the rtfreq parameter is sent, and should correspond to \"the frequency of updates in seconds\". Optional. Default is 2.5 .","title":"rtfreq"},{"location":"reference/weewx-options/stdrestful/#archive_post","text":"This option tells WeeWX to post on every archive record, which is the normal \"PWS\" mode for the Weather Underground. Because they prefer that you either use their \"Rapidfire\" protocol, or their PWS mode, but not both, the default for this option is the opposite for whatever you choose above for option rapidfire. However, if for some reason you want to do both, then you may set both options to true .","title":"archive_post"},{"location":"reference/weewx-options/stdrestful/#post_indoor_observations","text":"In the interest of respecting your privacy, WeeWX does not post indoor temperature or humidity to the Weather Underground unless you set this option to true . Default is false .","title":"post_indoor_observations"},{"location":"reference/weewx-options/stdrestful/#log_success_6","text":"If you set a value here, it will apply only to logging for the Weather Underground.","title":"log_success"},{"location":"reference/weewx-options/stdrestful/#log_failure_6","text":"If you set a value here, it will apply only to logging for the Weather Underground.","title":"log_failure"},{"location":"reference/weewx-options/stdrestful/#retry_login_3","text":"How long to wait in seconds before retrying a bad login. Default is 3600 (one hour).","title":"retry_login"},{"location":"reference/weewx-options/stdrestful/#post_interval_4","text":"The interval in seconds between posts. Setting this value to zero will cause every archive record to be posted. Optional. Default is zero.","title":"post_interval"},{"location":"reference/weewx-options/stdrestful/#force_direction","text":"The Weather Underground has a bug where they will claim that a station is \"unavailable\" if it sends a null wind direction, even when the wind speed is zero. Setting this option to true causes the software to cache the last non-null wind direction and use that instead of sending a null value. Default is False .","title":"force_direction"},{"location":"reference/weewx-options/stdrestful/#essentials","text":"Occasionally (but not always!) when the Weather Underground is missing a data point it will substitute the value zero (0.0), thus messing up statistics and plots. For all observation types listed in this section, the post will be skipped if that type is missing. For example: [StdRestful] [[Wunderground]] ... [[[Essentials]]] outTemp = True would cause the post to be skipped if there is no outside temperature (observation type outTemp ).","title":"[[[Essentials]]]"},{"location":"reference/weewx-options/stdtimesynch/","text":"[StdTimeSynch] \u00b6 The StdTymeSynch service can synchronize the onboard clock of station with your computer. Not all weather station hardware supports this. clock_check \u00b6 How often to check the clock on the weather station in seconds. Default is 14400 (every 4 hours). max_drift \u00b6 The maximum amount of clock drift to tolerate, in seconds, before resetting the clock. Default is 5 .","title":"[StdTimeSynch]"},{"location":"reference/weewx-options/stdtimesynch/#stdtimesynch","text":"The StdTymeSynch service can synchronize the onboard clock of station with your computer. Not all weather station hardware supports this.","title":"[StdTimeSynch]"},{"location":"reference/weewx-options/stdtimesynch/#clock_check","text":"How often to check the clock on the weather station in seconds. Default is 14400 (every 4 hours).","title":"clock_check"},{"location":"reference/weewx-options/stdtimesynch/#max_drift","text":"The maximum amount of clock drift to tolerate, in seconds, before resetting the clock. Default is 5 .","title":"max_drift"},{"location":"reference/weewx-options/stdwxcalculate/","text":"[StdWXCalculate] \u00b6 Some hardware provides derived quantities, such as dewpoint , windchill , and heatindex , while other hardware does not. This service can be used to fill in any missing quantities, or to substitute a software-calculated value for hardware that has unreliable or obsolete calculations. By default, the service can calculate the following values, although the list can be extended: altimeter appTemp barometer cloudbase dewpoint ET heatindex humidex inDewpoint maxSolarRad pressure rainRate windchill windrun The configuration section [StdWXCalculate] consists of two different parts: The subsection [[Calculations]] , which specifies which derived types are to be calculated and under what circumstances. Zero or more subsections, which specify what parameters are to be used for the calculation. These are described below. The service StdWXCalculate can be extended by the user to add new, derived types by using the XTypes system. See the wiki article Extensible types (XTypes) for how to do this. data_binding \u00b6 The data source to be used for historical data when calculating derived quantities. It should match a binding given in section [DataBindings] . Optional. Default is wx_binding . Note The data binding used by the StdWXCalculate service should normally match the data binding used by the StdArchive service. Users who use custom or additional data bindings should take care to ensure the correct data bindings are used by both services. [[Calculations]] \u00b6 This section specifies which strategy is to be used to provide values for derived variables. It consists of zero or more options with the syntax: obs_type = directive[, optional_bindings]... where directive is one of prefer_hardware , hardware , or software : directive Definition prefer_hardware Calculate the value in software only if it is not provided by hardware. hardware Hardware values only are accepted: never calculate the value in software. software Always calculate the value in software. The option optional_binding is optional, and consists of either loop , or archive . If loop , then the calculation will be done only for LOOP packets. If archive , then the calculation will be done only for archive records. If no binding is specified, then it will be done for both LOOP packets and archive records. Example 1: if your weather station calculates windchill using the pre-2001 algorithm, and you prefer to have WeeWX calculate it using a modern algorithm, specify the following: [StdWXCalculate] [[Calculations]] windchill = software This will force WeeWX to always calculate a value for windchill , regardless of whether the hardware provides one. Example 2: suppose you want ET to be calculated, but only for archive records. The option would look like: [StdWXCalculate] [[Calculations]] ET = software, archive Defaults \u00b6 In the absence of a [[Calculations]] section, no values will be calculated! However, the version of weewx.conf that comes with the WeeWX distribution includes a [[Calculations]] section that looks like this: [StdWXCalculate] [[Calculations]] pressure = prefer_hardware altimeter = prefer_hardware appTemp = prefer_hardware barometer = prefer_hardware cloudbase = prefer_hardware dewpoint = prefer_hardware ET = prefer_hardware heatindex = prefer_hardware humidex = prefer_hardware inDewpoint = prefer_hardware maxSolarRad = prefer_hardware rainRate = prefer_hardware windchill = prefer_hardware windrun = prefer_hardware [[WXXTypes]] \u00b6 The StdWXXTypes class is responsible for calculating the following simple, derived types: appTemp cloudbase dewpoint ET heatindex humidex inDewpoint maxSolarRad windchill windDir windRun A few of these types have an option or two that can be set. These are described below. [[[ET]]] \u00b6 This subsection contains several options used when calculating ET (evapotranspiration). See the document Step by Step Calculation of the Penman-Monteith Evapotranspiration for the definitions of cn and cd . et_period \u00b6 The length of time in seconds over which evapotranspiration is calculated. Default is 3600 (one hour). wind_height \u00b6 The height in meters of your anemometer. Default is 2.0 . albedo \u00b6 The albedo to be used in the calculations. Default is 0.23 . cn \u00b6 The numerator constant for the reference crop type and time step. Default is 37 . cd \u00b6 The denominator constant for the reference crop type and time step. Default is 0.34 . [[[heatindex]]] \u00b6 algorithm \u00b6 Controls which algorithm will be used to calculate heat-index. Choices are new (see https://www.wpc.ncep.noaa.gov/html/heatindex_equation.shtml ), or old . The newer algorithm will give results down to 40\u00b0F, which are sometimes less than the sensible temperature. For this reason, some people prefer the older algorithm, which applies only to temperatures above 80\u00b0F. Default is new . [[[maxSolarRad]]] \u00b6 This section is used for specifying options when calculating maxSolarRad , the theoretical maximum solar radiation. algorithm \u00b6 Controls which algorithm will be used to calculate maxSolarRad. Choices are bras (\"Bras\") , or rs (Ryan-Stolzenbach) . Default is rs . atc \u00b6 The coefficient atc is the \"atmospheric transmission coefficient\" used by the 'Ryan-Stolzenbach' algorithm for calculating maximum solar radiation. Value must be between 0.7 and 0.91 . Default is 0.8 . nfac \u00b6 The coefficient nfac is \"atmospheric turbidity\" used by the 'Bras' algorithm for calculating maximum solar radiation. Values must be between 2 (clear) and 5 (smoggy). Default is 2 . [[[windDir]]] \u00b6 force_null \u00b6 Indicates whether the wind direction should be undefined when the wind speed is zero. The default value is true : when the wind speed is zero, the wind direction will be set to undefined (Python None ). To report the wind vane direction even when there is no wind speed, change this to false : [StdWXCalculate] [[WXXTypes]] [[[windDir]]] force_null = false [[PressureCooker]] \u00b6 This class is responsible for calculating pressure-related values. Given the right set of input types, it can calculate barometer , pressure , and altimeter . See the Wiki article Barometer, pressure, and altimeter for the differences between these three types. max_delta_12h \u00b6 Some of the calculations require the temperature 12 hours ago (to compensate for tidal effects), which requires a database lookup. There may or may not be a temperature exactly 12 hours ago. This option sets how much of a time difference in seconds is allowed. The default is 1800 . [[[altimeter]]] \u00b6 algorithm \u00b6 Which algorithm to use when calculating altimeter from gauge pressure. Possible choices are ASOS , ASOS2 , MADIS , NOAA , WOB , and SMT . The default is ASOS . [[RainRater]] \u00b6 This class calculates rainRate from recent rain events. rain_period \u00b6 The algorithm calculates a running average over a period of time in the past. This option controls how far back to go in time in seconds. Default is 1800 .","title":"[StdWXCalculate]"},{"location":"reference/weewx-options/stdwxcalculate/#stdwxcalculate","text":"Some hardware provides derived quantities, such as dewpoint , windchill , and heatindex , while other hardware does not. This service can be used to fill in any missing quantities, or to substitute a software-calculated value for hardware that has unreliable or obsolete calculations. By default, the service can calculate the following values, although the list can be extended: altimeter appTemp barometer cloudbase dewpoint ET heatindex humidex inDewpoint maxSolarRad pressure rainRate windchill windrun The configuration section [StdWXCalculate] consists of two different parts: The subsection [[Calculations]] , which specifies which derived types are to be calculated and under what circumstances. Zero or more subsections, which specify what parameters are to be used for the calculation. These are described below. The service StdWXCalculate can be extended by the user to add new, derived types by using the XTypes system. See the wiki article Extensible types (XTypes) for how to do this.","title":"[StdWXCalculate]"},{"location":"reference/weewx-options/stdwxcalculate/#data_binding","text":"The data source to be used for historical data when calculating derived quantities. It should match a binding given in section [DataBindings] . Optional. Default is wx_binding . Note The data binding used by the StdWXCalculate service should normally match the data binding used by the StdArchive service. Users who use custom or additional data bindings should take care to ensure the correct data bindings are used by both services.","title":"data_binding"},{"location":"reference/weewx-options/stdwxcalculate/#calculations","text":"This section specifies which strategy is to be used to provide values for derived variables. It consists of zero or more options with the syntax: obs_type = directive[, optional_bindings]... where directive is one of prefer_hardware , hardware , or software : directive Definition prefer_hardware Calculate the value in software only if it is not provided by hardware. hardware Hardware values only are accepted: never calculate the value in software. software Always calculate the value in software. The option optional_binding is optional, and consists of either loop , or archive . If loop , then the calculation will be done only for LOOP packets. If archive , then the calculation will be done only for archive records. If no binding is specified, then it will be done for both LOOP packets and archive records. Example 1: if your weather station calculates windchill using the pre-2001 algorithm, and you prefer to have WeeWX calculate it using a modern algorithm, specify the following: [StdWXCalculate] [[Calculations]] windchill = software This will force WeeWX to always calculate a value for windchill , regardless of whether the hardware provides one. Example 2: suppose you want ET to be calculated, but only for archive records. The option would look like: [StdWXCalculate] [[Calculations]] ET = software, archive","title":"[[Calculations]]"},{"location":"reference/weewx-options/stdwxcalculate/#defaults","text":"In the absence of a [[Calculations]] section, no values will be calculated! However, the version of weewx.conf that comes with the WeeWX distribution includes a [[Calculations]] section that looks like this: [StdWXCalculate] [[Calculations]] pressure = prefer_hardware altimeter = prefer_hardware appTemp = prefer_hardware barometer = prefer_hardware cloudbase = prefer_hardware dewpoint = prefer_hardware ET = prefer_hardware heatindex = prefer_hardware humidex = prefer_hardware inDewpoint = prefer_hardware maxSolarRad = prefer_hardware rainRate = prefer_hardware windchill = prefer_hardware windrun = prefer_hardware","title":"Defaults"},{"location":"reference/weewx-options/stdwxcalculate/#wxxtypes","text":"The StdWXXTypes class is responsible for calculating the following simple, derived types: appTemp cloudbase dewpoint ET heatindex humidex inDewpoint maxSolarRad windchill windDir windRun A few of these types have an option or two that can be set. These are described below.","title":"[[WXXTypes]]"},{"location":"reference/weewx-options/stdwxcalculate/#et","text":"This subsection contains several options used when calculating ET (evapotranspiration). See the document Step by Step Calculation of the Penman-Monteith Evapotranspiration for the definitions of cn and cd .","title":"[[[ET]]]"},{"location":"reference/weewx-options/stdwxcalculate/#et_period","text":"The length of time in seconds over which evapotranspiration is calculated. Default is 3600 (one hour).","title":"et_period"},{"location":"reference/weewx-options/stdwxcalculate/#wind_height","text":"The height in meters of your anemometer. Default is 2.0 .","title":"wind_height"},{"location":"reference/weewx-options/stdwxcalculate/#albedo","text":"The albedo to be used in the calculations. Default is 0.23 .","title":"albedo"},{"location":"reference/weewx-options/stdwxcalculate/#cn","text":"The numerator constant for the reference crop type and time step. Default is 37 .","title":"cn"},{"location":"reference/weewx-options/stdwxcalculate/#cd","text":"The denominator constant for the reference crop type and time step. Default is 0.34 .","title":"cd"},{"location":"reference/weewx-options/stdwxcalculate/#heatindex","text":"","title":"[[[heatindex]]]"},{"location":"reference/weewx-options/stdwxcalculate/#algorithm","text":"Controls which algorithm will be used to calculate heat-index. Choices are new (see https://www.wpc.ncep.noaa.gov/html/heatindex_equation.shtml ), or old . The newer algorithm will give results down to 40\u00b0F, which are sometimes less than the sensible temperature. For this reason, some people prefer the older algorithm, which applies only to temperatures above 80\u00b0F. Default is new .","title":"algorithm"},{"location":"reference/weewx-options/stdwxcalculate/#maxsolarrad","text":"This section is used for specifying options when calculating maxSolarRad , the theoretical maximum solar radiation.","title":"[[[maxSolarRad]]]"},{"location":"reference/weewx-options/stdwxcalculate/#algorithm_1","text":"Controls which algorithm will be used to calculate maxSolarRad. Choices are bras (\"Bras\") , or rs (Ryan-Stolzenbach) . Default is rs .","title":"algorithm"},{"location":"reference/weewx-options/stdwxcalculate/#atc","text":"The coefficient atc is the \"atmospheric transmission coefficient\" used by the 'Ryan-Stolzenbach' algorithm for calculating maximum solar radiation. Value must be between 0.7 and 0.91 . Default is 0.8 .","title":"atc"},{"location":"reference/weewx-options/stdwxcalculate/#nfac","text":"The coefficient nfac is \"atmospheric turbidity\" used by the 'Bras' algorithm for calculating maximum solar radiation. Values must be between 2 (clear) and 5 (smoggy). Default is 2 .","title":"nfac"},{"location":"reference/weewx-options/stdwxcalculate/#winddir","text":"","title":"[[[windDir]]]"},{"location":"reference/weewx-options/stdwxcalculate/#force_null","text":"Indicates whether the wind direction should be undefined when the wind speed is zero. The default value is true : when the wind speed is zero, the wind direction will be set to undefined (Python None ). To report the wind vane direction even when there is no wind speed, change this to false : [StdWXCalculate] [[WXXTypes]] [[[windDir]]] force_null = false","title":"force_null"},{"location":"reference/weewx-options/stdwxcalculate/#pressurecooker","text":"This class is responsible for calculating pressure-related values. Given the right set of input types, it can calculate barometer , pressure , and altimeter . See the Wiki article Barometer, pressure, and altimeter for the differences between these three types.","title":"[[PressureCooker]]"},{"location":"reference/weewx-options/stdwxcalculate/#max_delta_12h","text":"Some of the calculations require the temperature 12 hours ago (to compensate for tidal effects), which requires a database lookup. There may or may not be a temperature exactly 12 hours ago. This option sets how much of a time difference in seconds is allowed. The default is 1800 .","title":"max_delta_12h"},{"location":"reference/weewx-options/stdwxcalculate/#altimeter","text":"","title":"[[[altimeter]]]"},{"location":"reference/weewx-options/stdwxcalculate/#algorithm_2","text":"Which algorithm to use when calculating altimeter from gauge pressure. Possible choices are ASOS , ASOS2 , MADIS , NOAA , WOB , and SMT . The default is ASOS .","title":"algorithm"},{"location":"reference/weewx-options/stdwxcalculate/#rainrater","text":"This class calculates rainRate from recent rain events.","title":"[[RainRater]]"},{"location":"reference/weewx-options/stdwxcalculate/#rain_period","text":"The algorithm calculates a running average over a period of time in the past. This option controls how far back to go in time in seconds. Default is 1800 .","title":"rain_period"},{"location":"usersguide/backup/","text":"Backup and restore \u00b6 Backup \u00b6 To back up a WeeWX installation, you will need to make a copy of the configuration information ( weewx.conf ), skins and templates, custom code, and the WeeWX database. The location of these items depends on how you installed WeeWX. Debian Redhat openSUSE pip Item Location Configuration /etc/weewx/weewx.conf Skins /etc/weewx/skins Custom code /usr/share/weewx/user Database /var/lib/weewx/weewx.sdb Item Location Configuration /etc/weewx/weewx.conf Skins /etc/weewx/skins Custom code /usr/share/weewx/user Database /var/lib/weewx/weewx.sdb Item Location Configuration /etc/weewx/weewx.conf Skins /etc/weewx/skins Custom code /usr/share/weewx/user Database /var/lib/weewx/weewx.sdb Item Location Configuration ~/weewx-data/weewx.conf Skins ~/weewx-data/skins Custom code ~/weewx-data/user Database ~/weewx-data/archive/weewx.sdb It is not necessary to back up the generated images, HTML files, or NOAA reports, because WeeWX can easily regenerate them. It is also not necessary to back up the WeeWX code, because it can be installed again. However, it doesn't hurt to do so. Note For a SQLite configuration, do not make the copy of the database file while in the middle of a transaction! Schedule the backup for immediately after an archive record is written, and then make sure the backup completes before the next archive record arrives. Alternatively, stop WeeWX, perform the backup, then start WeeWX. Note For a MySQL/MariaDB configuration, save a dump of the archive database. Restore \u00b6 To restore from backup, do a fresh installation of WeeWX, replace the configuration file, skins, and database with those from a backup, then start weewxd .","title":"Backup & restore"},{"location":"usersguide/backup/#backup-and-restore","text":"","title":"Backup and restore"},{"location":"usersguide/backup/#backup","text":"To back up a WeeWX installation, you will need to make a copy of the configuration information ( weewx.conf ), skins and templates, custom code, and the WeeWX database. The location of these items depends on how you installed WeeWX. Debian Redhat openSUSE pip Item Location Configuration /etc/weewx/weewx.conf Skins /etc/weewx/skins Custom code /usr/share/weewx/user Database /var/lib/weewx/weewx.sdb Item Location Configuration /etc/weewx/weewx.conf Skins /etc/weewx/skins Custom code /usr/share/weewx/user Database /var/lib/weewx/weewx.sdb Item Location Configuration /etc/weewx/weewx.conf Skins /etc/weewx/skins Custom code /usr/share/weewx/user Database /var/lib/weewx/weewx.sdb Item Location Configuration ~/weewx-data/weewx.conf Skins ~/weewx-data/skins Custom code ~/weewx-data/user Database ~/weewx-data/archive/weewx.sdb It is not necessary to back up the generated images, HTML files, or NOAA reports, because WeeWX can easily regenerate them. It is also not necessary to back up the WeeWX code, because it can be installed again. However, it doesn't hurt to do so. Note For a SQLite configuration, do not make the copy of the database file while in the middle of a transaction! Schedule the backup for immediately after an archive record is written, and then make sure the backup completes before the next archive record arrives. Alternatively, stop WeeWX, perform the backup, then start WeeWX. Note For a MySQL/MariaDB configuration, save a dump of the archive database.","title":"Backup"},{"location":"usersguide/backup/#restore","text":"To restore from backup, do a fresh installation of WeeWX, replace the configuration file, skins, and database with those from a backup, then start weewxd .","title":"Restore"},{"location":"usersguide/installing/","text":"Installing WeeWX \u00b6 If you're an old hand at installing software on Unix systems, you may be able to use one of our Quickstart guides : Debian - including Ubuntu, Mint, Raspberry Pi OS, Devuan. Uses apt . Redhat - including Fedora, CentOS, Rocky. Uses yum . SUSE - including openSUSE. Uses zypper . pip - any operating system. Uses pip git - any operating system. Run directly from repository. Otherwise, continue on... Required skills \u00b6 In the world of open-source hobbyist software, WeeWX is pretty easy to install and configure. There are not many package dependencies, the configuration is simple, and this guide includes extensive instructions. There are thousands of people who have successfully done an install. However, there is no \"point-and-click\" interface, so you will have to do some manual configuring. You should have the following skills: The patience to read and follow this guide. Willingness and ability to edit a configuration file. Some familiarity with Linux or other Unix derivatives. Ability to do simple Unix tasks such as changing file permissions and running commands. No programming experience is necessary unless you wish to extend WeeWX. In this case, you should be comfortable programming in Python. If you get stuck, there is a very active User's Group to help. Installation overview \u00b6 This is an outline of the process to install, configure, and run WeeWX: Check the Hardware guide . This will let you know of any features, limitations, or quirks of your hardware. If your weather station is not in the guide, you will have to download the driver after you install WeeWX. Install WeeWX. Use the step-by-step instructions in one of the installation methods . If the driver for your hardware if it is not included with WeeWX, install the driver as explained in the installing a driver section. Configure the hardware. This involves setting things like the onboard archive interval, rain bucket size, etc. You may have to follow directions given by your hardware manufacturer, or you may be able to use the utility weectl device . Run WeeWX by launching the weewxd program, either directly , or as a daemon . Customize the installation. Typically, this is done by changing settings in the WeeWX application configuration file (typically, weewx.conf ). For example, you might want to register your station , so it shows up on a world-wide map of WeeWX installations. To make changes to reports, see the Customization Guide . Installation methods \u00b6 There are several different ways to install WeeWX. Installer Systems Best for... Debian including Ubuntu, Mint, Raspberry Pi OS, Devuan The Debian, Redhat, and SUSE package installers use apt , yum , and zypper , respectively. This is the fastest and easiest way to get up and running. You will need root access to install and run. Redhat including Fedora, CentOS, Rocky SUSE including openSUSE pip any operating system The pip installer will work on any operating system. Use this approach for macOS or one of the BSDs, or if you are using an older operating system. When used in a \"virtual environment\" (recommended), this approach is least likely to disturb other applications on your computer. This is also a good approach if you plan to do a lot of customization, or if you are developing a driver, skin, or other extension. Root access is not needed to install, but may be needed to run. git any operating system If you want to install WeeWX on a system with very little storage, or if you want to experiment with code that is under development, then you may want to run directly from the WeeWX sources. Root access is not needed to install, but may be needed to run. Installing a driver \u00b6 If your hardware requires a driver that is not included with WeeWX, use the WeeWX extension management utility to download and install the driver. First locate the driver for your hardware - start by looking in the drivers section of the WeeWX Wiki . You will need the URL for the driver release; the URL will refer to a zip or tgz file. Then install the driver, using the driver's URL: weectl extension install https://github.com/path/to/driver.zip Finally, reconfigure WeeWX to use the driver: weectl station reconfigure See the documentation for weectl extension for details.","title":"Installing WeeWX"},{"location":"usersguide/installing/#installing-weewx","text":"If you're an old hand at installing software on Unix systems, you may be able to use one of our Quickstart guides : Debian - including Ubuntu, Mint, Raspberry Pi OS, Devuan. Uses apt . Redhat - including Fedora, CentOS, Rocky. Uses yum . SUSE - including openSUSE. Uses zypper . pip - any operating system. Uses pip git - any operating system. Run directly from repository. Otherwise, continue on...","title":"Installing WeeWX"},{"location":"usersguide/installing/#required-skills","text":"In the world of open-source hobbyist software, WeeWX is pretty easy to install and configure. There are not many package dependencies, the configuration is simple, and this guide includes extensive instructions. There are thousands of people who have successfully done an install. However, there is no \"point-and-click\" interface, so you will have to do some manual configuring. You should have the following skills: The patience to read and follow this guide. Willingness and ability to edit a configuration file. Some familiarity with Linux or other Unix derivatives. Ability to do simple Unix tasks such as changing file permissions and running commands. No programming experience is necessary unless you wish to extend WeeWX. In this case, you should be comfortable programming in Python. If you get stuck, there is a very active User's Group to help.","title":"Required skills"},{"location":"usersguide/installing/#installation-overview","text":"This is an outline of the process to install, configure, and run WeeWX: Check the Hardware guide . This will let you know of any features, limitations, or quirks of your hardware. If your weather station is not in the guide, you will have to download the driver after you install WeeWX. Install WeeWX. Use the step-by-step instructions in one of the installation methods . If the driver for your hardware if it is not included with WeeWX, install the driver as explained in the installing a driver section. Configure the hardware. This involves setting things like the onboard archive interval, rain bucket size, etc. You may have to follow directions given by your hardware manufacturer, or you may be able to use the utility weectl device . Run WeeWX by launching the weewxd program, either directly , or as a daemon . Customize the installation. Typically, this is done by changing settings in the WeeWX application configuration file (typically, weewx.conf ). For example, you might want to register your station , so it shows up on a world-wide map of WeeWX installations. To make changes to reports, see the Customization Guide .","title":"Installation overview"},{"location":"usersguide/installing/#installation-methods","text":"There are several different ways to install WeeWX. Installer Systems Best for... Debian including Ubuntu, Mint, Raspberry Pi OS, Devuan The Debian, Redhat, and SUSE package installers use apt , yum , and zypper , respectively. This is the fastest and easiest way to get up and running. You will need root access to install and run. Redhat including Fedora, CentOS, Rocky SUSE including openSUSE pip any operating system The pip installer will work on any operating system. Use this approach for macOS or one of the BSDs, or if you are using an older operating system. When used in a \"virtual environment\" (recommended), this approach is least likely to disturb other applications on your computer. This is also a good approach if you plan to do a lot of customization, or if you are developing a driver, skin, or other extension. Root access is not needed to install, but may be needed to run. git any operating system If you want to install WeeWX on a system with very little storage, or if you want to experiment with code that is under development, then you may want to run directly from the WeeWX sources. Root access is not needed to install, but may be needed to run.","title":"Installation methods"},{"location":"usersguide/installing/#installing-a-driver","text":"If your hardware requires a driver that is not included with WeeWX, use the WeeWX extension management utility to download and install the driver. First locate the driver for your hardware - start by looking in the drivers section of the WeeWX Wiki . You will need the URL for the driver release; the URL will refer to a zip or tgz file. Then install the driver, using the driver's URL: weectl extension install https://github.com/path/to/driver.zip Finally, reconfigure WeeWX to use the driver: weectl station reconfigure See the documentation for weectl extension for details.","title":"Installing a driver"},{"location":"usersguide/introduction/","text":"User's Guide \u00b6 This is the complete guide to installing, configuring, and troubleshooting WeeWX. System requirements \u00b6 Python \u00b6 Python 3.7 or later is required. Python 2 will not work. Station hardware \u00b6 WeeWX includes support for many types of weather stations. In addition to hardware support, WeeWX comes with a software simulator, useful for testing and evaluation. The driver compatibility table in the Hardware guide has a detailed list of the manufacturers and models supported by the drivers that come with WeeWX. If you do not see your hardware in this table, check the list of supported hardware ; the pictures may help you identify the manufacturer and/or model. Compatibility for some hardware is provided by 3rd party drivers, available at the Wiki . Finally, check the hardware comparison to see if your hardware is known, but not yet supported. If you still cannot find your hardware, post to the User's Group for help. Computer hardware \u00b6 WeeWX is written in Python, so it has the overhead associated with that language. Nevertheless, it is \"fast enough\" on just about any hardware. It has been run on everything from an early MacBook to a router! I run WeeWX on a vintage 32-bit Fit-PC with a 500 MHz AMD Geode processor and 512 MB of memory. Configured this way, it consumes about 5% of the CPU, 150 MB of virtual memory, and 50 MB of real memory. WeeWX also runs great on a Raspberry Pi, although report generation will take longer. For example, here are some generation times for the 21 HTML files and 68 images used by the Seasons skin. See the Wiki article Benchmarks of file and image generation for details. Hardware Files (21) Images (68) Mac Mini, M1 2020 0.60s 1.06s NUC Intel i7, 11th gen 0.89s 1.14s RPI 5 1.63s 2.03s RPi 4 6.24s 6.39s RPi 3 13.06s 14.07s RPi 2 (32-bit) 24.27s 25.95s Rpi Zero W (32-bit) 53.97s 57.79s Time \u00b6 You should run some sort of time synchronization daemon to ensure that your computer has the correct time. Doing so will greatly reduce errors, especially if you send data to services such as the Weather Underground. See the Wiki article Time services . On stations that support it, the time is automatically synchronized with the WeeWX server, nominally every four hours. The synchronization frequency can be adjusted in the WeeWX configuration.","title":"Introduction"},{"location":"usersguide/introduction/#users-guide","text":"This is the complete guide to installing, configuring, and troubleshooting WeeWX.","title":"User's Guide"},{"location":"usersguide/introduction/#system-requirements","text":"","title":"System requirements"},{"location":"usersguide/introduction/#python","text":"Python 3.7 or later is required. Python 2 will not work.","title":"Python"},{"location":"usersguide/introduction/#station-hardware","text":"WeeWX includes support for many types of weather stations. In addition to hardware support, WeeWX comes with a software simulator, useful for testing and evaluation. The driver compatibility table in the Hardware guide has a detailed list of the manufacturers and models supported by the drivers that come with WeeWX. If you do not see your hardware in this table, check the list of supported hardware ; the pictures may help you identify the manufacturer and/or model. Compatibility for some hardware is provided by 3rd party drivers, available at the Wiki . Finally, check the hardware comparison to see if your hardware is known, but not yet supported. If you still cannot find your hardware, post to the User's Group for help.","title":"Station hardware"},{"location":"usersguide/introduction/#computer-hardware","text":"WeeWX is written in Python, so it has the overhead associated with that language. Nevertheless, it is \"fast enough\" on just about any hardware. It has been run on everything from an early MacBook to a router! I run WeeWX on a vintage 32-bit Fit-PC with a 500 MHz AMD Geode processor and 512 MB of memory. Configured this way, it consumes about 5% of the CPU, 150 MB of virtual memory, and 50 MB of real memory. WeeWX also runs great on a Raspberry Pi, although report generation will take longer. For example, here are some generation times for the 21 HTML files and 68 images used by the Seasons skin. See the Wiki article Benchmarks of file and image generation for details. Hardware Files (21) Images (68) Mac Mini, M1 2020 0.60s 1.06s NUC Intel i7, 11th gen 0.89s 1.14s RPI 5 1.63s 2.03s RPi 4 6.24s 6.39s RPi 3 13.06s 14.07s RPi 2 (32-bit) 24.27s 25.95s Rpi Zero W (32-bit) 53.97s 57.79s","title":"Computer hardware"},{"location":"usersguide/introduction/#time","text":"You should run some sort of time synchronization daemon to ensure that your computer has the correct time. Doing so will greatly reduce errors, especially if you send data to services such as the Weather Underground. See the Wiki article Time services . On stations that support it, the time is automatically synchronized with the WeeWX server, nominally every four hours. The synchronization frequency can be adjusted in the WeeWX configuration.","title":"Time"},{"location":"usersguide/mysql-mariadb/","text":"Configuring MySQL / MariaDB \u00b6 This section applies only to those who wish to use the MySQL database, instead of the default SQLite database. It assumes that you have installed a working version of MySQL or MariaDB. Install the client libraries. How to do this depends on your operating system and how you installed WeeWX. Debian Redhat openSUSE pip sudo apt install mysql-client sudo apt install python3-mysqldb sudo yum install MySQL-python sudo zypper install python3-mysqlclient The base MySQL libraries are included as part of a normal pip install. However, you might want to install a standalone MySQL or MariaDB client to help with testing. Change the WeeWX configuration to use MySQL instead of SQLite. In the WeeWX configuration file, change the [[wx_binding]] section to point to the MySQL database, archive_mysql , instead of the SQLite database archive_sqlite . After the change, it will look something like this (change Highlighted ): [[wx_binding]] # The database should match one of the sections in [Databases] database = archive_mysql # The name of the table within the database table_name = archive # The class to manage the database manager = weewx.manager.DaySummaryManager # The schema defines to structure of the database contents schema = schemas.wview_extended.schema Configure the MySQL host and credentials. Assuming that you want to use the default database configuration, the [[MySQL]] section should look something like this: [[MySQL]] driver = weedb.mysql host = localhost user = weewx password = weewx This assumes user weewx has the password weewx . Adjust as necessary. Configure MySQL to give the necessary permissions for the database weewx to whatever MySQL user you choose. Here are the necessary minimum permissions, again assuming user weewx with password weewx . Adjust as necessary. mysql > CREATE USER 'weewx' @ 'localhost' IDENTIFIED BY 'weewx' ; mysql > GRANT select , update , create , delete , insert , alter , drop ON weewx . * TO weewx @ localhost ;","title":"MySQL/MariaDB"},{"location":"usersguide/mysql-mariadb/#configuring-mysql-mariadb","text":"This section applies only to those who wish to use the MySQL database, instead of the default SQLite database. It assumes that you have installed a working version of MySQL or MariaDB. Install the client libraries. How to do this depends on your operating system and how you installed WeeWX. Debian Redhat openSUSE pip sudo apt install mysql-client sudo apt install python3-mysqldb sudo yum install MySQL-python sudo zypper install python3-mysqlclient The base MySQL libraries are included as part of a normal pip install. However, you might want to install a standalone MySQL or MariaDB client to help with testing. Change the WeeWX configuration to use MySQL instead of SQLite. In the WeeWX configuration file, change the [[wx_binding]] section to point to the MySQL database, archive_mysql , instead of the SQLite database archive_sqlite . After the change, it will look something like this (change Highlighted ): [[wx_binding]] # The database should match one of the sections in [Databases] database = archive_mysql # The name of the table within the database table_name = archive # The class to manage the database manager = weewx.manager.DaySummaryManager # The schema defines to structure of the database contents schema = schemas.wview_extended.schema Configure the MySQL host and credentials. Assuming that you want to use the default database configuration, the [[MySQL]] section should look something like this: [[MySQL]] driver = weedb.mysql host = localhost user = weewx password = weewx This assumes user weewx has the password weewx . Adjust as necessary. Configure MySQL to give the necessary permissions for the database weewx to whatever MySQL user you choose. Here are the necessary minimum permissions, again assuming user weewx with password weewx . Adjust as necessary. mysql > CREATE USER 'weewx' @ 'localhost' IDENTIFIED BY 'weewx' ; mysql > GRANT select , update , create , delete , insert , alter , drop ON weewx . * TO weewx @ localhost ;","title":"Configuring MySQL / MariaDB"},{"location":"usersguide/running/","text":"Running WeeWX \u00b6 WeeWX can be run either directly, or as a daemon. When first trying WeeWX, it is best to run it directly because you will be able to see sensor output and diagnostics, as well as log messages. Once everything is working properly, run it as a daemon. Running directly \u00b6 To run WeeWX directly, invoke the main program, weewxd . weewxd Note Depending on device permissions, you may need root permissions to communicate with the station hardware. If this is the case, use sudo : sudo weewxd Note If your configuration file is named something other than weewx.conf , or if it is in a non-standard place, then you will have to specify it explicitly on the command line. For example: weewxd /some/path/to/weewx.conf If your station has a data logger, the program will start by downloading any data stored in your weather station into the archive database. For some stations, such as the Davis Vantage with a couple of thousand records, this could take a minute or two. WeeWX will then start monitoring live sensor data (also referred to as 'LOOP' data), printing a short version of the received data on standard output, about once every two seconds for a Vantage station, or considerably longer for some other stations. Running as a daemon \u00b6 For unattended operations it is best to have WeeWX run as a daemon, started automatically when the server is rebooted. If you use a packaged installer, this is done automatically. The installer finishes with a daemon running in the background. For a pip install, you will have to do this yourself. See the section Run as a daemon in the pip quick start guide. Monitoring WeeWX \u00b6 WeeWX logs many events to the system log. On Debian systems, this is /var/log/syslog , on SuSE, /var/log/messages . Your system may use yet another place. When troubleshooting the system, be sure to check it! To watch the log as it is generated, use the tail command with the -f option: tail -f /var/log/syslog Set the debug option in weewx.conf to generate many more checks and output more information. This can be useful for diagnosing problems and debugging. debug = 1","title":"Running WeeWX"},{"location":"usersguide/running/#running-weewx","text":"WeeWX can be run either directly, or as a daemon. When first trying WeeWX, it is best to run it directly because you will be able to see sensor output and diagnostics, as well as log messages. Once everything is working properly, run it as a daemon.","title":"Running WeeWX"},{"location":"usersguide/running/#running-directly","text":"To run WeeWX directly, invoke the main program, weewxd . weewxd Note Depending on device permissions, you may need root permissions to communicate with the station hardware. If this is the case, use sudo : sudo weewxd Note If your configuration file is named something other than weewx.conf , or if it is in a non-standard place, then you will have to specify it explicitly on the command line. For example: weewxd /some/path/to/weewx.conf If your station has a data logger, the program will start by downloading any data stored in your weather station into the archive database. For some stations, such as the Davis Vantage with a couple of thousand records, this could take a minute or two. WeeWX will then start monitoring live sensor data (also referred to as 'LOOP' data), printing a short version of the received data on standard output, about once every two seconds for a Vantage station, or considerably longer for some other stations.","title":"Running directly"},{"location":"usersguide/running/#running-as-a-daemon","text":"For unattended operations it is best to have WeeWX run as a daemon, started automatically when the server is rebooted. If you use a packaged installer, this is done automatically. The installer finishes with a daemon running in the background. For a pip install, you will have to do this yourself. See the section Run as a daemon in the pip quick start guide.","title":"Running as a daemon"},{"location":"usersguide/running/#monitoring-weewx","text":"WeeWX logs many events to the system log. On Debian systems, this is /var/log/syslog , on SuSE, /var/log/messages . Your system may use yet another place. When troubleshooting the system, be sure to check it! To watch the log as it is generated, use the tail command with the -f option: tail -f /var/log/syslog Set the debug option in weewx.conf to generate many more checks and output more information. This can be useful for diagnosing problems and debugging. debug = 1","title":"Monitoring WeeWX"},{"location":"usersguide/webserver/","text":"Integrating with a web server \u00b6 If the server is on the same machine \u00b6 The reports generated by WeeWX can be served by a web server running on the same machine as WeeWX. The WeeWX reports work with most web servers, including Apache, nginx, and lighttpd. There are a few strategies for making the web server see the WeeWX reports. You can modify the web server configuration, you can modify the WeeWX configuration, or you can make links in the file system. The strategy you choose depends on the operating system, web server, how you installed WeeWX, and how you prefer to manage your system. If you installed WeeWX using a Debian/Redhat/SUSE installer, you might not have to do anything! See the wiki article Configure a web server for details. If the server is on a different machine \u00b6 Use FTP or RSYNC to transfer the files generated by WeeWX to your remote server. In WeeWX, FTP and RSYNC are implemented as reports. They are configured in the [StdReport] section of the WeeWX configuration file. For example, the following configuration would use RSYNC to copy the html and images files from the standard report to a folder /var/www/html/weewx on the server wx.example.com : [StdReport] [[RSYNC]] skin = Rsync server = wx.example.com path = /var/www/html/weewx user = wxuser The following configuration would use FTP to copy the html and image files: [StdReport] [[FTP]] skin = Ftp server = wx.example.com path = /weewx user = wxuser password = wxpass It is possible to rsync or FTP more than one directory to the remote server. For example, suppose you have a home webcam that puts its images in /home/webcam/www . You want to FTP not only the files generated by WeeWX, but also these webcam images, to a remote server. The webcam images should go in a subdirectory webcam of the weewx directory. The solution is to include more than one FTP section under [StdReport] : [StdReport] # Location of the generated reports, relative to WEEWX_ROOT HTML_ROOT = public_html ... # As before: [[FTP]] skin = Ftp server = wx.example.com path = /weewx user = wxuser password = wxpass # Add a second FTP. You can name it anything. [[webcam_FTP]] skin = Ftp # Override HTML_ROOT: HTML_ROOT = /home/webcam/www server = wx.example.com path = /weewx/webcam user = wxuser password = wxpass See the documentation for the [[FTP]] and [[RSYNC]] sections of the configuration file weewx.conf for details and options.","title":"Web server integration"},{"location":"usersguide/webserver/#integrating-with-a-web-server","text":"","title":"Integrating with a web server"},{"location":"usersguide/webserver/#if-the-server-is-on-the-same-machine","text":"The reports generated by WeeWX can be served by a web server running on the same machine as WeeWX. The WeeWX reports work with most web servers, including Apache, nginx, and lighttpd. There are a few strategies for making the web server see the WeeWX reports. You can modify the web server configuration, you can modify the WeeWX configuration, or you can make links in the file system. The strategy you choose depends on the operating system, web server, how you installed WeeWX, and how you prefer to manage your system. If you installed WeeWX using a Debian/Redhat/SUSE installer, you might not have to do anything! See the wiki article Configure a web server for details.","title":"If the server is on the same machine"},{"location":"usersguide/webserver/#if-the-server-is-on-a-different-machine","text":"Use FTP or RSYNC to transfer the files generated by WeeWX to your remote server. In WeeWX, FTP and RSYNC are implemented as reports. They are configured in the [StdReport] section of the WeeWX configuration file. For example, the following configuration would use RSYNC to copy the html and images files from the standard report to a folder /var/www/html/weewx on the server wx.example.com : [StdReport] [[RSYNC]] skin = Rsync server = wx.example.com path = /var/www/html/weewx user = wxuser The following configuration would use FTP to copy the html and image files: [StdReport] [[FTP]] skin = Ftp server = wx.example.com path = /weewx user = wxuser password = wxpass It is possible to rsync or FTP more than one directory to the remote server. For example, suppose you have a home webcam that puts its images in /home/webcam/www . You want to FTP not only the files generated by WeeWX, but also these webcam images, to a remote server. The webcam images should go in a subdirectory webcam of the weewx directory. The solution is to include more than one FTP section under [StdReport] : [StdReport] # Location of the generated reports, relative to WEEWX_ROOT HTML_ROOT = public_html ... # As before: [[FTP]] skin = Ftp server = wx.example.com path = /weewx user = wxuser password = wxpass # Add a second FTP. You can name it anything. [[webcam_FTP]] skin = Ftp # Override HTML_ROOT: HTML_ROOT = /home/webcam/www server = wx.example.com path = /weewx/webcam user = wxuser password = wxpass See the documentation for the [[FTP]] and [[RSYNC]] sections of the configuration file weewx.conf for details and options.","title":"If the server is on a different machine"},{"location":"usersguide/where/","text":"Where to find things \u00b6 Location of WeeWX components \u00b6 Here is a summary of the layout for the different install methods, along with the symbolic names used for each component. These names are used throughout the documentation. Debian RedHat openSUSE pip Component Symbolic name Nominal value WeeWX root directory WEEWX_ROOT /etc/weewx Skins and templates SKIN_ROOT /etc/weewx/skins/ User directory USER_ROOT /etc/weewx/bin/user/ Examples EXAMPLE_ROOT /etc/weewx/examples/ Executables BIN_ROOT /usr/share/weewx/ SQLite databases SQLITE_ROOT /var/lib/weewx/ Web pages and images HTML_ROOT /var/www/html/weewx/ Documentation DOC_ROOT /usr/share/doc/weewx/ Component Symbolic name Nominal value WeeWX root directory WEEWX_ROOT /etc/weewx Skins and templates SKIN_ROOT /etc/weewx/skins/ User directory USER_ROOT /etc/weewx/bin/user/ Examples EXAMPLE_ROOT /etc/weewx/examples/ Executables BIN_ROOT /usr/share/weewx/ SQLite databases SQLITE_ROOT /var/lib/weewx/ Web pages and images HTML_ROOT /var/www/html/weewx/ Documentation DOC_ROOT /usr/share/doc/weewx-x.y.z/ Component Symbolic name Nominal value WeeWX root directory WEEWX_ROOT /etc/weewx Skins and templates SKIN_ROOT /etc/weewx/skins/ User directory USER_ROOT /etc/weewx/bin/user/ Examples EXAMPLE_ROOT /etc/weewx/examples/ Executables BIN_ROOT /usr/share/weewx/ SQLite databases SQLITE_ROOT /var/lib/weewx/ Web pages and images HTML_ROOT /var/www/html/weewx/ Documentation DOC_ROOT /usr/share/doc/weewx-x.y.z/ Component Symbolic name Nominal value WeeWX root directory WEEWX_ROOT ~/weewx-data Skins and templates SKIN_ROOT skins/ User directory USER_ROOT bin/user/ Examples EXAMPLE_ROOT examples/ Executables BIN_ROOT varies SQLite databases SQLITE_ROOT archive/ Web pages and images HTML_ROOT public_html/ Documentation DOC_ROOT docs/ Note In the locations above, relative paths are relative to WEEWX_ROOT . Absolute paths begin with a forward slash ( / ). The tilde character ~ represents the HOME directory of the user. Location of executables in a pip install \u00b6 If you use a pip install, the location of the executables will depend on how the installation was done. Install method Commands Location of executables Virtual environment (recommended) python3 -m venv ~/ve source ~/ve/bin/activate pip3 install weewx ~/ve/bin/ pip, no sudo, with --user pip3 install weewx --user ~/.local/bin/ pip, no sudo, no --user pip3 install weewx ~/.local/bin/ pip with sudo (not recommended) sudo pip3 install weewx /usr/local/bin/ (1) Virtual environment with --user (not allowed) python3 -m venv ~/ve source ~/ve/bin/activate pip3 install weewx --user N/A (1) Checked on Ubuntu 22.02 and Rocky v9.1 Log files \u00b6 In the default configuration, WeeWX writes its status to the system log. This is where to find the system log for each platform. Debian RedHat openSUSE macOS /var/log/syslog Note You need root permission to view the log. /var/log/messages Note You need root permission to view the log. /var/log/messages Note You need root permission to view the log. /var/log/syslog Note On macOS, the log file is likely to contain only severe log messages. If the default for your system is inconvenient, or does not provide the logging fidelity that you require, then you may want to consider logging to a separate, rotating log file. See the wiki article Logging to rotating files .","title":"Where to find things"},{"location":"usersguide/where/#where-to-find-things","text":"","title":"Where to find things"},{"location":"usersguide/where/#location-of-weewx-components","text":"Here is a summary of the layout for the different install methods, along with the symbolic names used for each component. These names are used throughout the documentation. Debian RedHat openSUSE pip Component Symbolic name Nominal value WeeWX root directory WEEWX_ROOT /etc/weewx Skins and templates SKIN_ROOT /etc/weewx/skins/ User directory USER_ROOT /etc/weewx/bin/user/ Examples EXAMPLE_ROOT /etc/weewx/examples/ Executables BIN_ROOT /usr/share/weewx/ SQLite databases SQLITE_ROOT /var/lib/weewx/ Web pages and images HTML_ROOT /var/www/html/weewx/ Documentation DOC_ROOT /usr/share/doc/weewx/ Component Symbolic name Nominal value WeeWX root directory WEEWX_ROOT /etc/weewx Skins and templates SKIN_ROOT /etc/weewx/skins/ User directory USER_ROOT /etc/weewx/bin/user/ Examples EXAMPLE_ROOT /etc/weewx/examples/ Executables BIN_ROOT /usr/share/weewx/ SQLite databases SQLITE_ROOT /var/lib/weewx/ Web pages and images HTML_ROOT /var/www/html/weewx/ Documentation DOC_ROOT /usr/share/doc/weewx-x.y.z/ Component Symbolic name Nominal value WeeWX root directory WEEWX_ROOT /etc/weewx Skins and templates SKIN_ROOT /etc/weewx/skins/ User directory USER_ROOT /etc/weewx/bin/user/ Examples EXAMPLE_ROOT /etc/weewx/examples/ Executables BIN_ROOT /usr/share/weewx/ SQLite databases SQLITE_ROOT /var/lib/weewx/ Web pages and images HTML_ROOT /var/www/html/weewx/ Documentation DOC_ROOT /usr/share/doc/weewx-x.y.z/ Component Symbolic name Nominal value WeeWX root directory WEEWX_ROOT ~/weewx-data Skins and templates SKIN_ROOT skins/ User directory USER_ROOT bin/user/ Examples EXAMPLE_ROOT examples/ Executables BIN_ROOT varies SQLite databases SQLITE_ROOT archive/ Web pages and images HTML_ROOT public_html/ Documentation DOC_ROOT docs/ Note In the locations above, relative paths are relative to WEEWX_ROOT . Absolute paths begin with a forward slash ( / ). The tilde character ~ represents the HOME directory of the user.","title":"Location of WeeWX components"},{"location":"usersguide/where/#location-of-executables-in-a-pip-install","text":"If you use a pip install, the location of the executables will depend on how the installation was done. Install method Commands Location of executables Virtual environment (recommended) python3 -m venv ~/ve source ~/ve/bin/activate pip3 install weewx ~/ve/bin/ pip, no sudo, with --user pip3 install weewx --user ~/.local/bin/ pip, no sudo, no --user pip3 install weewx ~/.local/bin/ pip with sudo (not recommended) sudo pip3 install weewx /usr/local/bin/ (1) Virtual environment with --user (not allowed) python3 -m venv ~/ve source ~/ve/bin/activate pip3 install weewx --user N/A (1) Checked on Ubuntu 22.02 and Rocky v9.1","title":"Location of executables in a pip install"},{"location":"usersguide/where/#log-files","text":"In the default configuration, WeeWX writes its status to the system log. This is where to find the system log for each platform. Debian RedHat openSUSE macOS /var/log/syslog Note You need root permission to view the log. /var/log/messages Note You need root permission to view the log. /var/log/messages Note You need root permission to view the log. /var/log/syslog Note On macOS, the log file is likely to contain only severe log messages. If the default for your system is inconvenient, or does not provide the logging fidelity that you require, then you may want to consider logging to a separate, rotating log file. See the wiki article Logging to rotating files .","title":"Log files"},{"location":"usersguide/troubleshooting/hardware/","text":"Hardware problems \u00b6 Tips on making a system reliable \u00b6 If you are having problems keeping your weather station up for long periods of time, here are some tips, in decreasing order of importance: Run on dedicated hardware. If you are using the server for other tasks, particularly as your desktop machine, you will have reliability problems. If you are using it as a print or network server, you will probably be OK. Run headless. Modern graphical systems are extremely complex. As new features are added, test suites do not always catch up. Your system will be much more reliable if you run it without a windowing system. Use an Uninterruptible Power Supply (UPS). The vast majority of power glitches are very short-lived \u2014 just a second or two \u2014 so you do not need a big one. The 425VA unit I use to protect my fit-PC cost $55 at Best Buy. If you buy a Davis VantagePro and your computer has an old-fashioned serial port, get the VantagePro with a serial connection, not a USB connection. See the Wiki article on Davis cp2101 converter problems for details. If you do use a USB connection, put a ferrite coil on each end of the cable to your console. If you have enough length and the ferrite coil is big enough, make a loop, so it goes through the coil twice. See the picture below: Cable connection looped through a ferrite coil Ferrite coils on a Davis Envoy. There are two coils, one on the USB connection (top wire) and one on the power supply. Both have loops. Archive interval \u00b6 Most hardware with data-logging includes a parameter to specify the archive interval used by the logger. If the hardware and driver support it, WeeWX will use this interval as the archive interval. If not, WeeWX will fall back to using option archive_interval specified in [StdArchive] . The default fallback value is 300 seconds (5 minutes). If the hardware archive interval is large, it will take a long time before anything shows up in the WeeWX reports. For example, WS23xx stations ship with an archive interval of 60 minutes, and Fine Offset stations ship with an archive interval of 30 minutes. If you run WeeWX with a WS23xx station in its factory default configuration, it will take 60 minutes before the first data point shows up, then another 60 minutes until the next one, and so on. Since reports are generated when a new archive record arrives, a large archive interval means that reports will be generated infrequently. If you want data and reports closer to real-time, use the weectl device utility to change the interval. Raspberry Pi \u00b6 WeeWX runs very well on the Raspberry Pi, from the original Model A and Model B, to the latest incarnations. However, the Pi does have some quirks, including issues with USB power and lack of a clock. See the Wiki for up-to-date information on Running WeeWX on a Raspberry Pi . Davis stations \u00b6 For Davis-specific tips, see the Wiki article Troubleshooting Davis stations Fine Offset USB lockups \u00b6 The Fine Offset series weather stations and their derivatives are a fine value and can be made to work reasonably reliably, but they have one problem that is difficult to work around: the USB can unexpectantly lock up, making it impossible to communicate with the console. The symptom in the log will look something like this: Jun 7 21:50:33 localhost weewx[2460]: fousb: get archive interval failed attempt 1 of 3: could not detach kernel driver from interface 0: No data available The exact error may vary, but the thing to look for is the \"could not detach kernel driver\" message. Unfortunately, we have not found a software cure for this. Instead, you must power cycle the unit. Remove the batteries and unplug the USB, then put it back together. No need to restart WeeWX. More details about Fine Offset lockups can be found in the Wiki .","title":"Hardware problems"},{"location":"usersguide/troubleshooting/hardware/#hardware-problems","text":"","title":"Hardware problems"},{"location":"usersguide/troubleshooting/hardware/#tips-on-making-a-system-reliable","text":"If you are having problems keeping your weather station up for long periods of time, here are some tips, in decreasing order of importance: Run on dedicated hardware. If you are using the server for other tasks, particularly as your desktop machine, you will have reliability problems. If you are using it as a print or network server, you will probably be OK. Run headless. Modern graphical systems are extremely complex. As new features are added, test suites do not always catch up. Your system will be much more reliable if you run it without a windowing system. Use an Uninterruptible Power Supply (UPS). The vast majority of power glitches are very short-lived \u2014 just a second or two \u2014 so you do not need a big one. The 425VA unit I use to protect my fit-PC cost $55 at Best Buy. If you buy a Davis VantagePro and your computer has an old-fashioned serial port, get the VantagePro with a serial connection, not a USB connection. See the Wiki article on Davis cp2101 converter problems for details. If you do use a USB connection, put a ferrite coil on each end of the cable to your console. If you have enough length and the ferrite coil is big enough, make a loop, so it goes through the coil twice. See the picture below: Cable connection looped through a ferrite coil Ferrite coils on a Davis Envoy. There are two coils, one on the USB connection (top wire) and one on the power supply. Both have loops.","title":"Tips on making a system reliable"},{"location":"usersguide/troubleshooting/hardware/#archive-interval","text":"Most hardware with data-logging includes a parameter to specify the archive interval used by the logger. If the hardware and driver support it, WeeWX will use this interval as the archive interval. If not, WeeWX will fall back to using option archive_interval specified in [StdArchive] . The default fallback value is 300 seconds (5 minutes). If the hardware archive interval is large, it will take a long time before anything shows up in the WeeWX reports. For example, WS23xx stations ship with an archive interval of 60 minutes, and Fine Offset stations ship with an archive interval of 30 minutes. If you run WeeWX with a WS23xx station in its factory default configuration, it will take 60 minutes before the first data point shows up, then another 60 minutes until the next one, and so on. Since reports are generated when a new archive record arrives, a large archive interval means that reports will be generated infrequently. If you want data and reports closer to real-time, use the weectl device utility to change the interval.","title":"Archive interval"},{"location":"usersguide/troubleshooting/hardware/#raspberry-pi","text":"WeeWX runs very well on the Raspberry Pi, from the original Model A and Model B, to the latest incarnations. However, the Pi does have some quirks, including issues with USB power and lack of a clock. See the Wiki for up-to-date information on Running WeeWX on a Raspberry Pi .","title":"Raspberry Pi"},{"location":"usersguide/troubleshooting/hardware/#davis-stations","text":"For Davis-specific tips, see the Wiki article Troubleshooting Davis stations","title":"Davis stations"},{"location":"usersguide/troubleshooting/hardware/#fine-offset-usb-lockups","text":"The Fine Offset series weather stations and their derivatives are a fine value and can be made to work reasonably reliably, but they have one problem that is difficult to work around: the USB can unexpectantly lock up, making it impossible to communicate with the console. The symptom in the log will look something like this: Jun 7 21:50:33 localhost weewx[2460]: fousb: get archive interval failed attempt 1 of 3: could not detach kernel driver from interface 0: No data available The exact error may vary, but the thing to look for is the \"could not detach kernel driver\" message. Unfortunately, we have not found a software cure for this. Instead, you must power cycle the unit. Remove the batteries and unplug the USB, then put it back together. No need to restart WeeWX. More details about Fine Offset lockups can be found in the Wiki .","title":"Fine Offset USB lockups"},{"location":"usersguide/troubleshooting/meteo/","text":"Meteorological problems \u00b6 The pressure reported by WeeWX does not match the pressure on the console \u00b6 Be sure that you are comparing the right values. There are three different types of pressure: Station Pressure : The Station Pressure (SP), which is the raw, absolute pressure measured by the station. This is pressure in WeeWX packets and archive records. Sea Level Pressure : The Sea Level Pressure (SLP) is obtained by correcting the Station Pressure for altitude and local temperature. This is barometer in WeeWX packets and archive records. Altimeter : The Altimeter Setting (AS) is obtained by correcting the Station Pressure for altitude. This is altimeter in WeeWX packets and archive records. Any station might require calibration. For some hardware, this can be done at the weather station console. Alternatively, use the StdCalibrate section to apply an offset. If your station is significantly above (or below) sea level, be sure that the station altitude is specified properly. Also, be sure that any calibration results in a station pressure and/or barometric pressure that matches those reported by other stations in your area. Calibrating barometer does not change the pressure displayed by WeeWX \u00b6 Be sure that the calibration is applied to the correct quantity. The corrections in the StdCalibrate section apply only to raw values from the hardware; corrections are not applied to derived quantities. The station hardware matters. Some stations report gauge pressure ( pressure ) while other stations report sea-level pressure ( barometer ). For example, if the hardware is a Vantage station, the correction must be applied to barometer since the Vantage station reports barometer and WeeWX calculates pressure . However, if the hardware is a FineOffset station, the correction must be applied to pressure since the FineOffset stations report pressure and WeeWX calculates barometer . The rainfall and/or rain rate reported by WeeWX do not match the console \u00b6 First of all, be sure that you are comparing the right quantities. The value rain is the amount of rainfall observed in a period of time. The period of time might be a LOOP interval, in which case the rain is the amount of rain since the last LOOP packet. Because LOOP packets arrive quite frequently, this value is likely to be very small. Or the period of time might be an archive interval, in which case rain is the total amount of rain reported since the last archive record. Some consoles report the amount of rain in the past hour, or the amount of rain since midnight. The rain rate is a derived quantity. Some stations report a rain rate, but for those that do not, WeeWX will calculate the rain rate. Finally, beware of calibration factors specific to the hardware. For example, the bucket type on a Vantage station must be specified when you set up the weather station. If you modify the rain bucket with a larger collection area, then you will have to add a multiplier in the StdCalibrate section. To diagnose rain issues, run WeeWX directly so that you can see each LOOP packet and REC archive record. Tip the bucket to verify that each bucket tip is detected and reported by WeeWX. Verify that each bucket tip is converted to the correct rainfall amount. Then check the database to verify that the values are properly added and recorded. There is no wind direction when wind speed is zero \u00b6 This is by design \u2014 if there is no wind, then the wind direction is undefined, represented by NULL in the database or None in Python. This policy is enforced by the StdWXCalculate service. If necessary, it can be overridden. See option force_null in the [StdWXCalculate] section. WeeWX distinguishes between a value of zero and no value (NULL or None). However, some services do not make this distinction and replace a NULL or None with a clearly invalid value such as -999.","title":"Meteorological problems"},{"location":"usersguide/troubleshooting/meteo/#meteorological-problems","text":"","title":"Meteorological problems"},{"location":"usersguide/troubleshooting/meteo/#the-pressure-reported-by-weewx-does-not-match-the-pressure-on-the-console","text":"Be sure that you are comparing the right values. There are three different types of pressure: Station Pressure : The Station Pressure (SP), which is the raw, absolute pressure measured by the station. This is pressure in WeeWX packets and archive records. Sea Level Pressure : The Sea Level Pressure (SLP) is obtained by correcting the Station Pressure for altitude and local temperature. This is barometer in WeeWX packets and archive records. Altimeter : The Altimeter Setting (AS) is obtained by correcting the Station Pressure for altitude. This is altimeter in WeeWX packets and archive records. Any station might require calibration. For some hardware, this can be done at the weather station console. Alternatively, use the StdCalibrate section to apply an offset. If your station is significantly above (or below) sea level, be sure that the station altitude is specified properly. Also, be sure that any calibration results in a station pressure and/or barometric pressure that matches those reported by other stations in your area.","title":"The pressure reported by WeeWX does not match the pressure on the console"},{"location":"usersguide/troubleshooting/meteo/#calibrating-barometer-does-not-change-the-pressure-displayed-by-weewx","text":"Be sure that the calibration is applied to the correct quantity. The corrections in the StdCalibrate section apply only to raw values from the hardware; corrections are not applied to derived quantities. The station hardware matters. Some stations report gauge pressure ( pressure ) while other stations report sea-level pressure ( barometer ). For example, if the hardware is a Vantage station, the correction must be applied to barometer since the Vantage station reports barometer and WeeWX calculates pressure . However, if the hardware is a FineOffset station, the correction must be applied to pressure since the FineOffset stations report pressure and WeeWX calculates barometer .","title":"Calibrating barometer does not change the pressure displayed by WeeWX"},{"location":"usersguide/troubleshooting/meteo/#the-rainfall-andor-rain-rate-reported-by-weewx-do-not-match-the-console","text":"First of all, be sure that you are comparing the right quantities. The value rain is the amount of rainfall observed in a period of time. The period of time might be a LOOP interval, in which case the rain is the amount of rain since the last LOOP packet. Because LOOP packets arrive quite frequently, this value is likely to be very small. Or the period of time might be an archive interval, in which case rain is the total amount of rain reported since the last archive record. Some consoles report the amount of rain in the past hour, or the amount of rain since midnight. The rain rate is a derived quantity. Some stations report a rain rate, but for those that do not, WeeWX will calculate the rain rate. Finally, beware of calibration factors specific to the hardware. For example, the bucket type on a Vantage station must be specified when you set up the weather station. If you modify the rain bucket with a larger collection area, then you will have to add a multiplier in the StdCalibrate section. To diagnose rain issues, run WeeWX directly so that you can see each LOOP packet and REC archive record. Tip the bucket to verify that each bucket tip is detected and reported by WeeWX. Verify that each bucket tip is converted to the correct rainfall amount. Then check the database to verify that the values are properly added and recorded.","title":"The rainfall and/or rain rate reported by WeeWX do not match the console"},{"location":"usersguide/troubleshooting/meteo/#there-is-no-wind-direction-when-wind-speed-is-zero","text":"This is by design \u2014 if there is no wind, then the wind direction is undefined, represented by NULL in the database or None in Python. This policy is enforced by the StdWXCalculate service. If necessary, it can be overridden. See option force_null in the [StdWXCalculate] section. WeeWX distinguishes between a value of zero and no value (NULL or None). However, some services do not make this distinction and replace a NULL or None with a clearly invalid value such as -999.","title":"There is no wind direction when wind speed is zero"},{"location":"usersguide/troubleshooting/software/","text":"Software problems \u00b6 Nothing in the log file \u00b6 As it is running, WeeWX periodically sends status information, failures, and other things to your system's logging facility. They typically look something like this (the first line is not actually part of the log): DATE TIME HOST weewx[PID] LEVL MESSAGE Feb 8 04:25:16 hummingbird weewx[6932] INFO weewx.manager: Added record 2020-02-08 04:25:00 PST (1581164700) to database 'weewx.sdb' Feb 8 04:25:16 hummingbird weewx[6932] INFO weewx.manager: Added record 2020-02-08 04:25:00 PST (1581164700) to daily summary in 'weewx.sdb' Feb 8 04:25:17 hummingbird weewx[6932] INFO weewx.restx: PWSWeather: Published record 2020-02-08 04:25:00 PST (1581164700) Feb 8 04:25:17 hummingbird weewx[6932] INFO weewx.restx: Wunderground-PWS: Published record 2020-02-08 04:25:00 PST (1581164700) Feb 8 04:25:17 hummingbird weewx[6932] INFO weewx.restx: Windy: Published record 2020-02-08 04:25:00 PST (1581164700) Feb 8 04:25:17 hummingbird weewx[6932] ERROR weewx.restx: WOW: Failed to publish record 2020-02-08 04:25:00 PST (1581164700): Failed upload after 3 tries The location of this logging file varies from system to system, but it is typically in /var/log/syslog or /var/log/messages . However, some systems default to saving only warning or critical information, so INFO messages from WeeWX may not appear. If this happens to you, check your system logging configuration. On Debian systems, look in /etc/rsyslog.conf . On Redhat systems, look in /etc/syslog.conf . ConfigObj errors \u00b6 These are errors in the configuration file. Two are very common. Incidentally, these errors are far easier to diagnose when WeeWX is run directly from the command line than when it is run as a daemon. Exception configobj.DuplicateError \u00b6 This error is caused by using an identifier more than once in the configuration file. For example, you may have inadvertently listed your FTP server twice: [Reports] [[FTP]] ... (details elided) user = fred server = ftp.myhost.com password = mypassword server = ftp.myhost.com # OOPS! Listed it twice! path = /weather ... Generally, if you encounter this error, the log file will give you the line number it happened in: Apr 24 12:09:15 raven weewx[11480]: wxengine: Error while parsing configuration file /home/weewx/weewx.conf Apr 24 12:09:15 raven weewx[11480]: wxengine: Unable to initialize main loop: Apr 24 12:09:15 raven weewx[11480]: **** Duplicate keyword name at line 254. Apr 24 12:09:15 raven weewx[11480]: **** Exiting. Exception configobj.NestingError \u00b6 This is a very similar error, and is caused by a misformed section nesting. For example: [Reports] [[FTP]]] ... Note the extra closing bracket on the subsection FTP . No barometer data \u00b6 If everything appears normal except that you have no barometer data, the problem may be a mismatch between the unit system used for service StdConvert and the unit system used by service StdQC . For example: [StdConvert] target_unit = METRIC ... [StdQC] [[MinMax]] barometer = 28, 32.5 The problem is that you are requiring the barometer data to be between 28 and 32.5, but with the unit system set to METRIC , the data will be in the range 990 to 1050 or so! The solution is to change the values to match the units in StdConvert , or, better yet, specify the units in MinMax . For example: [StdConvert] target_unit = US ... [StdQC] [[MinMax]] barometer = 950, 1100, mbar Exception Cheetah.NameMapper.NotFound \u00b6 If you get errors of the sort: Apr 12 05:12:32 raven reportengine[3074]: filegenerator: Caught exception \"<class 'NameMapper.NotFound'>\" Apr 12 05:12:32 raven reportengine[3074]: **** Message: \"cannot find 'fubar' in template /home/weewx/skins/Standard/index.html.tmpl\" Apr 12 05:12:32 raven reportengine[3074]: **** Ignoring template and continuing. you have a tag in your template that WeeWX does not recognize. In this example, it is the tag $fubar in the template /home/weewx/skins/Standard/index.html.tmpl . Dots in the plots \u00b6 If you see dots instead of lines in the daily plots, you might want to change the graphing options or adjust the station's archive interval. In a default configuration, a time period greater than 1% of the displayed timespan is considered to be a gap in data. So when the interval between data points is greater than about 10 minutes, the daily plots show dots instead of connected points. Change the option line_gap_fraction in skin.conf to control how much time is considered a break in data. As for the archive interval, check the log file for an entry like this soon after WeeWX starts up: Dec 30 10:54:17 saga weewx[10035]: wxengine: The archive interval in the configuration file (300) does not match the station hardware interval (1800). Dec 30 10:54:17 saga weewx[10035]: wxengine: Using archive interval of 1800 In this example, the interval specified in weewx.conf is 5 minutes, but the interval specified in the station hardware is 30 minutes. When the interval in weewx.conf does not match the station's hardware interval, WeeWX defers to the station's interval. Use the weectl device utility to change the station's interval. Spikes in the graphs \u00b6 Occasionally you may see anomalous readings, typically manifested as spikes in the graphs. The source could be a flaky serial/USB connection, radio or other interference, a cheap USB-Serial adapter, low-quality sensors, or simply an anomalous reading. Sensor quality matters. It is not unusual for some low-end hardware to report odd sensor readings occasionally (once every few days). Some sensors, such as solar radiation/UV, have a limited lifespan of about 5 years. The (analog) humidity sensors on older Vantage stations are known to deteriorate after a few years in wet environments. If you frequently see anomalous data, first check the hardware. To keep bad data from the database, add a quality control (QC) rule such as Min/Max bounds. See the section [StdQC] for details. To remove bad data from the database, see the Wiki article Cleaning up old \"bad\" data . 'Database is locked' error \u00b6 This seems to be a problem with the Raspberry Pi, when using SQLite . There is no analogous problem with MySQL databases. You will see errors in the system log that looks like this: Feb 12 07:11:06 rpi weewx[20930]: **** File \"/usr/share/weewx/weewx/archive.py\", line 118, in lastGoodStamp Feb 12 07:11:06 rpi weewx[20930]: **** _row = self.getSql(\"SELECT MAX(dateTime) FROM %s\" % self.table) Feb 12 07:11:06 rpi weewx[20930]: **** File \"/usr/share/weewx/weewx/archive.py\", line 250, in getSql Feb 12 07:11:06 rpi weewx[20930]: **** File \"/usr/share/weewx/weedb/sqlite.py\", line 120, in execute Feb 12 07:11:06 rpi weewx[20930]: **** raise weedb.OperationalError(e) Feb 12 07:11:06 rpi weewx[20930]: **** OperationalError: database is locked Feb 12 07:11:06 rpi weewx[20930]: **** _cursor.execute(sql, sqlargs) Feb 12 07:11:06 rpi weewx[20930]: **** File \"/usr/share/weewx/weedb/sqlite.py\", line 120, in execute Feb 12 07:11:06 rpi weewx[20930]: **** raise weedb.OperationalError(e) Feb 12 07:11:06 rpi weewx[20930]: **** OperationalError: database is locked We are still trying to decipher exactly what the problem is, but it seems that (many? most? all?) implementations of the SQLite 'C' access libraries on the RPi sleep for a full second if they find the database locked. This gives them only five chances within the 5-second timeout period before an exception is raised. Not all Raspberry Pis have this problem. It seems to be most acute when running big templates with lots of queries, such as the forecast extension. There are a few possible fixes: Increase the option timeout . Use a high quality SD card in your RPi. There seems to be some evidence that faster SD cards are more immune to this problem. Trim the size of your templates to minimize the number of queries necessary. None of these 'fixes' are very satisfying, and we're trying to come up with a more robust solution. Funky symbols in plots \u00b6 If your plots have strange looking symbols for units, such as degrees Fahrenheit (\u00b0F), that look something like this: Then the problem may be that you are missing the fonts specified for the option unit_label_font_path in your skin.conf file and, instead, WeeWX is substituting a default font, which does not support the Unicode character necessary to make a degree sign. Look in section [ImageGenerator] for a line that looks like: unit_label_font_path = /usr/share/fonts/truetype/freefont/FreeMonoBold.ttf Make sure that the specified path ( /usr/share/fonts/truetype/freefont/FreeMonoBold.ttf in this case) actually exists. If it does not, on Debian operating systems (such as Ubuntu), you may be able to install the necessary fonts: sudo apt-get install fonts-freefont-ttf sudo fc-cache -f -v (On older systems, the package fonts-freefont-ttf may be called ttf-freefont ). The first command installs the \"Truetype\" fonts, the second rebuilds the font cache. If your system does not have the fc-cache command, then install it from the fontconfig package: sudo apt-get install fontconfig If none of this works, or if you are on a different operating system, then you will have to change the option unit_label_font_path to point to something on your system which does support the Unicode characters you plan to use. Exception UnicodeEncodeError \u00b6 This problem is closely related to the \"Funky symbols\" problem above. In this case, you may see errors in your log that look like: May 14 13:35:23 web weewx[5633]: cheetahgenerator: Generated 14 files for report StandardReport in 1.27 seconds May 14 13:35:23 web weewx[5633]: reportengine: Caught unrecoverable exception in generator weewx.imagegenerator.ImageGenerator May 14 13:35:23 web weewx[5633]: **** 'ascii' codec can't encode character u'\\xe8' in position 5: ordinal not in range(128) May 14 13:35:23 web weewx[5633]: **** Traceback (most recent call last): May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weewx/reportengine.py\", line 139, in run May 14 13:35:23 web weewx[5633]: **** obj.start() May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weewx/reportengine.py\", line 170, in start May 14 13:35:23 web weewx[5633]: **** self.run() May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weewx/imagegenerator.py\", line 36, in run May 14 13:35:23 web weewx[5633]: **** self.gen_images(self.gen_ts) May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weewx/imagegenerator.py\", line 220, in gen_images May 14 13:35:23 web weewx[5633]: **** image = plot.render() May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weeplot/genplot.py\", line 175, in render May 14 13:35:23 web weewx[5633]: **** self._renderTopBand(draw) May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weeplot/genplot.py\", line 390, in _renderTopBand May 14 13:35:23 web weewx[5633]: **** top_label_size = draw.textsize(top_label, font=top_label_font) May 14 13:35:23 web weewx[5633]: **** File \"/usr/lib/python2.7/dist-packages/PIL/ImageDraw.py\", line 278, in textsize May 14 13:35:23 web weewx[5633]: **** return font.getsize(text) May 14 13:35:23 web weewx[5633]: **** UnicodeEncodeError: 'ascii' codec can't encode character u'\\xe8' in position 5: ordinal not in range(128) May 14 13:35:23 web weewx[5633]: **** Generator terminated... This is frequently caused by the necessary Truetype fonts not being installed on your computer and, instead, a default font is being substituted, which only knows how to plot ASCII characters. The cure is as before: install the font. Data is archived but some/all reports do not run \u00b6 If WeeWX appears to be running normally but some or all reports are not being run, either all the time or periodically, the problem could be the inadvertant use or incorrect setting of the report_timing option in weewx.conf . The report_timing option allows the user to specify when some or all reports are run (see Scheduling report generation ). By default, the option report_timing is disabled and all reports are run each archive period. To see if the report_timing option is causing reports to be skipped, inspect the log file. Any reports that are skipped due to the report_timing option will be logged as follows: Apr 29 09:30:17 rosella weewx[3319]: reportengine: Report StandardReport skipped due to report_timing setting If reports are being incorrectly skipped due to report_timing , then edit weewx.conf and check for a report_timing option in [StdReport] . Either remove all occurrences of report_timing to run all reports each archive period, or confirm the correct use and setting of the report_timing option. The wrong reports are being skipped by report_timing \u00b6 If the option report_timing is being used, and the results are not as expected, there may be an error in the report_timing option. If there are errors in the report_timing parameter, the report will be run on each archive interval. First check the report_timing option parameters to ensure they are valid and there are no additonal spaces or other unwanted characters. Then check that the parameters are correctly set for the desired report generation times. For example, is the correct day of the week number being used if limiting the day of the week parameter. Refer to the section Scheduling report generation . Check the log file for any entries relating to the reports concerned. Errors in the report_timing parameter and skipped reports are logged only when debug=1 in weewx.conf .","title":"Software problems"},{"location":"usersguide/troubleshooting/software/#software-problems","text":"","title":"Software problems"},{"location":"usersguide/troubleshooting/software/#nothing-in-the-log-file","text":"As it is running, WeeWX periodically sends status information, failures, and other things to your system's logging facility. They typically look something like this (the first line is not actually part of the log): DATE TIME HOST weewx[PID] LEVL MESSAGE Feb 8 04:25:16 hummingbird weewx[6932] INFO weewx.manager: Added record 2020-02-08 04:25:00 PST (1581164700) to database 'weewx.sdb' Feb 8 04:25:16 hummingbird weewx[6932] INFO weewx.manager: Added record 2020-02-08 04:25:00 PST (1581164700) to daily summary in 'weewx.sdb' Feb 8 04:25:17 hummingbird weewx[6932] INFO weewx.restx: PWSWeather: Published record 2020-02-08 04:25:00 PST (1581164700) Feb 8 04:25:17 hummingbird weewx[6932] INFO weewx.restx: Wunderground-PWS: Published record 2020-02-08 04:25:00 PST (1581164700) Feb 8 04:25:17 hummingbird weewx[6932] INFO weewx.restx: Windy: Published record 2020-02-08 04:25:00 PST (1581164700) Feb 8 04:25:17 hummingbird weewx[6932] ERROR weewx.restx: WOW: Failed to publish record 2020-02-08 04:25:00 PST (1581164700): Failed upload after 3 tries The location of this logging file varies from system to system, but it is typically in /var/log/syslog or /var/log/messages . However, some systems default to saving only warning or critical information, so INFO messages from WeeWX may not appear. If this happens to you, check your system logging configuration. On Debian systems, look in /etc/rsyslog.conf . On Redhat systems, look in /etc/syslog.conf .","title":"Nothing in the log file"},{"location":"usersguide/troubleshooting/software/#configobj-errors","text":"These are errors in the configuration file. Two are very common. Incidentally, these errors are far easier to diagnose when WeeWX is run directly from the command line than when it is run as a daemon.","title":"ConfigObj errors"},{"location":"usersguide/troubleshooting/software/#exception-configobjduplicateerror","text":"This error is caused by using an identifier more than once in the configuration file. For example, you may have inadvertently listed your FTP server twice: [Reports] [[FTP]] ... (details elided) user = fred server = ftp.myhost.com password = mypassword server = ftp.myhost.com # OOPS! Listed it twice! path = /weather ... Generally, if you encounter this error, the log file will give you the line number it happened in: Apr 24 12:09:15 raven weewx[11480]: wxengine: Error while parsing configuration file /home/weewx/weewx.conf Apr 24 12:09:15 raven weewx[11480]: wxengine: Unable to initialize main loop: Apr 24 12:09:15 raven weewx[11480]: **** Duplicate keyword name at line 254. Apr 24 12:09:15 raven weewx[11480]: **** Exiting.","title":"Exception configobj.DuplicateError"},{"location":"usersguide/troubleshooting/software/#exception-configobjnestingerror","text":"This is a very similar error, and is caused by a misformed section nesting. For example: [Reports] [[FTP]]] ... Note the extra closing bracket on the subsection FTP .","title":"Exception configobj.NestingError"},{"location":"usersguide/troubleshooting/software/#no-barometer-data","text":"If everything appears normal except that you have no barometer data, the problem may be a mismatch between the unit system used for service StdConvert and the unit system used by service StdQC . For example: [StdConvert] target_unit = METRIC ... [StdQC] [[MinMax]] barometer = 28, 32.5 The problem is that you are requiring the barometer data to be between 28 and 32.5, but with the unit system set to METRIC , the data will be in the range 990 to 1050 or so! The solution is to change the values to match the units in StdConvert , or, better yet, specify the units in MinMax . For example: [StdConvert] target_unit = US ... [StdQC] [[MinMax]] barometer = 950, 1100, mbar","title":"No barometer data"},{"location":"usersguide/troubleshooting/software/#exception-cheetahnamemappernotfound","text":"If you get errors of the sort: Apr 12 05:12:32 raven reportengine[3074]: filegenerator: Caught exception \"<class 'NameMapper.NotFound'>\" Apr 12 05:12:32 raven reportengine[3074]: **** Message: \"cannot find 'fubar' in template /home/weewx/skins/Standard/index.html.tmpl\" Apr 12 05:12:32 raven reportengine[3074]: **** Ignoring template and continuing. you have a tag in your template that WeeWX does not recognize. In this example, it is the tag $fubar in the template /home/weewx/skins/Standard/index.html.tmpl .","title":"Exception Cheetah.NameMapper.NotFound"},{"location":"usersguide/troubleshooting/software/#dots-in-the-plots","text":"If you see dots instead of lines in the daily plots, you might want to change the graphing options or adjust the station's archive interval. In a default configuration, a time period greater than 1% of the displayed timespan is considered to be a gap in data. So when the interval between data points is greater than about 10 minutes, the daily plots show dots instead of connected points. Change the option line_gap_fraction in skin.conf to control how much time is considered a break in data. As for the archive interval, check the log file for an entry like this soon after WeeWX starts up: Dec 30 10:54:17 saga weewx[10035]: wxengine: The archive interval in the configuration file (300) does not match the station hardware interval (1800). Dec 30 10:54:17 saga weewx[10035]: wxengine: Using archive interval of 1800 In this example, the interval specified in weewx.conf is 5 minutes, but the interval specified in the station hardware is 30 minutes. When the interval in weewx.conf does not match the station's hardware interval, WeeWX defers to the station's interval. Use the weectl device utility to change the station's interval.","title":"Dots in the plots"},{"location":"usersguide/troubleshooting/software/#spikes-in-the-graphs","text":"Occasionally you may see anomalous readings, typically manifested as spikes in the graphs. The source could be a flaky serial/USB connection, radio or other interference, a cheap USB-Serial adapter, low-quality sensors, or simply an anomalous reading. Sensor quality matters. It is not unusual for some low-end hardware to report odd sensor readings occasionally (once every few days). Some sensors, such as solar radiation/UV, have a limited lifespan of about 5 years. The (analog) humidity sensors on older Vantage stations are known to deteriorate after a few years in wet environments. If you frequently see anomalous data, first check the hardware. To keep bad data from the database, add a quality control (QC) rule such as Min/Max bounds. See the section [StdQC] for details. To remove bad data from the database, see the Wiki article Cleaning up old \"bad\" data .","title":"Spikes in the graphs"},{"location":"usersguide/troubleshooting/software/#database-is-locked-error","text":"This seems to be a problem with the Raspberry Pi, when using SQLite . There is no analogous problem with MySQL databases. You will see errors in the system log that looks like this: Feb 12 07:11:06 rpi weewx[20930]: **** File \"/usr/share/weewx/weewx/archive.py\", line 118, in lastGoodStamp Feb 12 07:11:06 rpi weewx[20930]: **** _row = self.getSql(\"SELECT MAX(dateTime) FROM %s\" % self.table) Feb 12 07:11:06 rpi weewx[20930]: **** File \"/usr/share/weewx/weewx/archive.py\", line 250, in getSql Feb 12 07:11:06 rpi weewx[20930]: **** File \"/usr/share/weewx/weedb/sqlite.py\", line 120, in execute Feb 12 07:11:06 rpi weewx[20930]: **** raise weedb.OperationalError(e) Feb 12 07:11:06 rpi weewx[20930]: **** OperationalError: database is locked Feb 12 07:11:06 rpi weewx[20930]: **** _cursor.execute(sql, sqlargs) Feb 12 07:11:06 rpi weewx[20930]: **** File \"/usr/share/weewx/weedb/sqlite.py\", line 120, in execute Feb 12 07:11:06 rpi weewx[20930]: **** raise weedb.OperationalError(e) Feb 12 07:11:06 rpi weewx[20930]: **** OperationalError: database is locked We are still trying to decipher exactly what the problem is, but it seems that (many? most? all?) implementations of the SQLite 'C' access libraries on the RPi sleep for a full second if they find the database locked. This gives them only five chances within the 5-second timeout period before an exception is raised. Not all Raspberry Pis have this problem. It seems to be most acute when running big templates with lots of queries, such as the forecast extension. There are a few possible fixes: Increase the option timeout . Use a high quality SD card in your RPi. There seems to be some evidence that faster SD cards are more immune to this problem. Trim the size of your templates to minimize the number of queries necessary. None of these 'fixes' are very satisfying, and we're trying to come up with a more robust solution.","title":"'Database is locked' error"},{"location":"usersguide/troubleshooting/software/#funky-symbols-in-plots","text":"If your plots have strange looking symbols for units, such as degrees Fahrenheit (\u00b0F), that look something like this: Then the problem may be that you are missing the fonts specified for the option unit_label_font_path in your skin.conf file and, instead, WeeWX is substituting a default font, which does not support the Unicode character necessary to make a degree sign. Look in section [ImageGenerator] for a line that looks like: unit_label_font_path = /usr/share/fonts/truetype/freefont/FreeMonoBold.ttf Make sure that the specified path ( /usr/share/fonts/truetype/freefont/FreeMonoBold.ttf in this case) actually exists. If it does not, on Debian operating systems (such as Ubuntu), you may be able to install the necessary fonts: sudo apt-get install fonts-freefont-ttf sudo fc-cache -f -v (On older systems, the package fonts-freefont-ttf may be called ttf-freefont ). The first command installs the \"Truetype\" fonts, the second rebuilds the font cache. If your system does not have the fc-cache command, then install it from the fontconfig package: sudo apt-get install fontconfig If none of this works, or if you are on a different operating system, then you will have to change the option unit_label_font_path to point to something on your system which does support the Unicode characters you plan to use.","title":"Funky symbols in plots"},{"location":"usersguide/troubleshooting/software/#exception-unicodeencodeerror","text":"This problem is closely related to the \"Funky symbols\" problem above. In this case, you may see errors in your log that look like: May 14 13:35:23 web weewx[5633]: cheetahgenerator: Generated 14 files for report StandardReport in 1.27 seconds May 14 13:35:23 web weewx[5633]: reportengine: Caught unrecoverable exception in generator weewx.imagegenerator.ImageGenerator May 14 13:35:23 web weewx[5633]: **** 'ascii' codec can't encode character u'\\xe8' in position 5: ordinal not in range(128) May 14 13:35:23 web weewx[5633]: **** Traceback (most recent call last): May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weewx/reportengine.py\", line 139, in run May 14 13:35:23 web weewx[5633]: **** obj.start() May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weewx/reportengine.py\", line 170, in start May 14 13:35:23 web weewx[5633]: **** self.run() May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weewx/imagegenerator.py\", line 36, in run May 14 13:35:23 web weewx[5633]: **** self.gen_images(self.gen_ts) May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weewx/imagegenerator.py\", line 220, in gen_images May 14 13:35:23 web weewx[5633]: **** image = plot.render() May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weeplot/genplot.py\", line 175, in render May 14 13:35:23 web weewx[5633]: **** self._renderTopBand(draw) May 14 13:35:23 web weewx[5633]: **** File \"/usr/share/weewx/weeplot/genplot.py\", line 390, in _renderTopBand May 14 13:35:23 web weewx[5633]: **** top_label_size = draw.textsize(top_label, font=top_label_font) May 14 13:35:23 web weewx[5633]: **** File \"/usr/lib/python2.7/dist-packages/PIL/ImageDraw.py\", line 278, in textsize May 14 13:35:23 web weewx[5633]: **** return font.getsize(text) May 14 13:35:23 web weewx[5633]: **** UnicodeEncodeError: 'ascii' codec can't encode character u'\\xe8' in position 5: ordinal not in range(128) May 14 13:35:23 web weewx[5633]: **** Generator terminated... This is frequently caused by the necessary Truetype fonts not being installed on your computer and, instead, a default font is being substituted, which only knows how to plot ASCII characters. The cure is as before: install the font.","title":"Exception UnicodeEncodeError"},{"location":"usersguide/troubleshooting/software/#data-is-archived-but-someall-reports-do-not-run","text":"If WeeWX appears to be running normally but some or all reports are not being run, either all the time or periodically, the problem could be the inadvertant use or incorrect setting of the report_timing option in weewx.conf . The report_timing option allows the user to specify when some or all reports are run (see Scheduling report generation ). By default, the option report_timing is disabled and all reports are run each archive period. To see if the report_timing option is causing reports to be skipped, inspect the log file. Any reports that are skipped due to the report_timing option will be logged as follows: Apr 29 09:30:17 rosella weewx[3319]: reportengine: Report StandardReport skipped due to report_timing setting If reports are being incorrectly skipped due to report_timing , then edit weewx.conf and check for a report_timing option in [StdReport] . Either remove all occurrences of report_timing to run all reports each archive period, or confirm the correct use and setting of the report_timing option.","title":"Data is archived but some/all reports do not run"},{"location":"usersguide/troubleshooting/software/#the-wrong-reports-are-being-skipped-by-report_timing","text":"If the option report_timing is being used, and the results are not as expected, there may be an error in the report_timing option. If there are errors in the report_timing parameter, the report will be run on each archive interval. First check the report_timing option parameters to ensure they are valid and there are no additonal spaces or other unwanted characters. Then check that the parameters are correctly set for the desired report generation times. For example, is the correct day of the week number being used if limiting the day of the week parameter. Refer to the section Scheduling report generation . Check the log file for any entries relating to the reports concerned. Errors in the report_timing parameter and skipped reports are logged only when debug=1 in weewx.conf .","title":"The wrong reports are being skipped by report_timing"},{"location":"usersguide/troubleshooting/what-to-do/","text":"Troubleshooting \u00b6 If you are having problems, first look at the hardware, software, and meteorological problems pages. You might be experiencing a problem that someone else has already solved. Hardware problems Software problems Meteorological problems Be sure to search the weewx-user group , especially if you are using a driver or skin that is not part of the WeeWX core. If you still have problems, here are a few things to try on your system: Look at the log file . We are always happy to take questions, but the first thing someone will ask is, \"What did you find in the log file?\" Run weewxd directly, rather than as a daemon. Generally, WeeWX will catch and log any unrecoverable exceptions, but if you are getting strange results, it is worth running directly and looking for any clues. Set the option debug = 1 in weewx.conf . This will put much more information in the log file, which can be very useful for troubleshooting and debugging! If you are still stuck, post your problem to the weewx-user group . The Wiki has some guidelines on how to do an effective post .","title":"What to do"},{"location":"usersguide/troubleshooting/what-to-do/#troubleshooting","text":"If you are having problems, first look at the hardware, software, and meteorological problems pages. You might be experiencing a problem that someone else has already solved. Hardware problems Software problems Meteorological problems Be sure to search the weewx-user group , especially if you are using a driver or skin that is not part of the WeeWX core. If you still have problems, here are a few things to try on your system: Look at the log file . We are always happy to take questions, but the first thing someone will ask is, \"What did you find in the log file?\" Run weewxd directly, rather than as a daemon. Generally, WeeWX will catch and log any unrecoverable exceptions, but if you are getting strange results, it is worth running directly and looking for any clues. Set the option debug = 1 in weewx.conf . This will put much more information in the log file, which can be very useful for troubleshooting and debugging! If you are still stuck, post your problem to the weewx-user group . The Wiki has some guidelines on how to do an effective post .","title":"Troubleshooting"},{"location":"utilities/wee_import-about/","text":"wee_import \u00b6 Some WeeWX users will have historical data from another source (e.g., other weather station software or a manually compiled file) which they wish to import into WeeWX. Such data can, depending upon the source, be imported using the wee_import utility. The wee_import utility supports importing observational data from the following sources: a single Comma Separated Values (CSV) format file the historical observations of a Weather Underground personal weather station one or more Cumulus monthly log files one or more Weather Display monthly log files one or more WeatherCat monthly .cat files","title":"Introduction"},{"location":"utilities/wee_import-about/#wee_import","text":"Some WeeWX users will have historical data from another source (e.g., other weather station software or a manually compiled file) which they wish to import into WeeWX. Such data can, depending upon the source, be imported using the wee_import utility. The wee_import utility supports importing observational data from the following sources: a single Comma Separated Values (CSV) format file the historical observations of a Weather Underground personal weather station one or more Cumulus monthly log files one or more Weather Display monthly log files one or more WeatherCat monthly .cat files","title":"wee_import"},{"location":"utilities/wee_import-common_opt/","text":"Before starting, it's worth running the utility with the --help flag to see how wee_import is used: wee_import --help Usage: wee_import --help wee_import --version wee_import --import-config=IMPORT_CONFIG_FILE [--config=CONFIG_FILE] [--date=YYYY-mm-dd | --from=YYYY-mm-dd[THH:MM] --to=YYYY-mm-dd[THH:MM]] [--dry-run] [--verbose] [--no-prompt] [--suppress-warnings] Import observation data into a WeeWX archive. Options: -h, --help show this help message and exit --config=CONFIG_FILE Use configuration file CONFIG_FILE. --import-config=IMPORT_CONFIG_FILE Use import configuration file IMPORT_CONFIG_FILE. --dry-run Print what would happen but do not do it. --date=YYYY-mm-dd Import data for this date. Format is YYYY-mm-dd. --from=YYYY-mm-dd[THH:MM] Import data starting at this date or date-time. Format is YYYY-mm-dd[THH:MM]. --to=YYYY-mm-dd[THH:MM] Import data up until this date or date-time. Format is YYYY-mm-dd[THH:MM]. --verbose Print and log useful extra output. --no-prompt Do not prompt. Accept relevant defaults and all y/n prompts. --suppress-warnings Suppress warnings to stdout. Warnings are still logged. --version Display wee_import version number. wee_import will import data from an external source into a WeeWX archive. Daily summaries are updated as each archive record is imported so there should be no need to separately rebuild the daily summaries. Options \u00b6 --config=FILENAME \u00b6 The utility can usually guess where the configuration file is, but if you have an unusual installation or multiple stations, you may have to tell it explicitly. wee_import --config=/this/directory/weewx.conf --import-config=/directory/import.conf --import-config=FILENAME \u00b6 wee_import uses a secondary configuration file, known as the import configuration file, to store various import parameters. The --import-config option is mandatory for all imports. Example import configuration files for each type of import supported by wee_import are provided in the util/import directory. These example files are best used by making a copy of into a working directory and then modifying the copy to suit your needs. The --import-config option is used as follows: wee_import --import-config=/directory/import.conf --dry-run \u00b6 The --dry-run option will cause the import to proceed but no actual data will be saved to the database. This is a useful option to use when first importing data. wee_import --import-config=/directory/import.conf --dry-run --date=YYYY-mm-dd \u00b6 Records from a single date can be imported by use of the --date option. The --date option accepts strings of the format YYYY-mm-dd . Whilst the use of the --date option will limit the imported data to that of a single date, the default action if the --date option (and the --from and --to options) is omitted may vary depending on the source. The operation of the --date option is summarised in the following table: Option --date option Records imported for a CSV, Cumulus, Weather Display or WeatherCat import Records imported for a Weather Underground import omitted (i.e., the default) All available records Today's records only --date=2015-12-22 All records from 2015-12-22 00:00 (exclusive) to 2015-12-23 00:00 (inclusive) All records from 2015-12-22 00:00 (exclusive) to 2015-12-23 00:00 (inclusive) Note If the --date , --from and --to options are omitted the default is to import today's records only when importing from Weather Underground or to import all available records when importing from any other source. Note WeeWX considers an archive record to represent an aggregation of data over the archive interval preceding the archive record's timestamp. For this reason imports which are to be limited to a given date with the --date option will only import records timestamped after midnight at the start of the day concerned and up to and including midnight at the end of the day concerned. --from and --to \u00b6 Whilst the --date option allows imported data to be limited to a single date, the --from and --to options allow finer control by importing only the records that fall within the date or date-time range specified by the --from and --to options. The --from option determines the earliest (inclusive), and the --to option determines the latest (exclusive), date or date-time of the records being imported. The --from and --to options accept a string of the format YYYY-mm-dd[THH:MM] . The T literal is mandatory if specifying a date-time. Note The --from and --to options must be used as a pair, they cannot be used individually or in conjunction with the --date option. The operation of the --from and --to options is summarised in the following table: Options --from and --to options Records imported for a CSV, Cumulus, Weather Display or WeatherCat import Records imported for a Weather Underground import omitted (i.e., the default) omitted (i.e., the default) All available records Today's records only --from=2015-12-22 --to=2015-12-29 All records from 2015-12-22 00:00 (exclusive) to 2015-12-30 00:00 (inclusive) All records from 2015-12-22 00:00 (exclusive) to 2015-12-30 00:00 (inclusive) --from=2016-7-18T15:29 --to=2016-7-25 All records from 2016-7-18 15:29 (exclusive) to 2016-7-26 00:00 (inclusive) All records from 2016-7-18 15:29 (exclusive) to 2016-7-26 00:00 (inclusive) --from=2016-5-12 --to=2016-7-22T22:15 All records from 2016-5-12 00:00 (exclusive) to 2016-7-22 22:15 (inclusive) All records from 2016-5-12 00:00 (exclusive) to 2016-7-22 22:15 (inclusive) --from=2016-3-18T15:29 --to=2016-6-20T22:00 All records from 2016-3-18 15:29 (exclusive) to 2016-6-20 22:00 (inclusive) All records from 2016-3-18 15:29 (exclusive) to 2016-6-20 22:00 (inclusive) Note If the --date , --from and --to options are omitted the default is to import today's records only when importing from Weather Underground or to import all available records when importing from any other source. Note WeeWX considers an archive record to represent an aggregation of data over the archive interval preceding the archive record's timestamp. For this reason imports which are to be limited to a given timespan with the --from and --to options will only import records timestamped after the timestamp represented by the --from option and up to and including the timestamp represented by the --to option. --verbose \u00b6 Inclusion of the --verbose option will cause additional information to be printed during wee_import execution. wee_import --import-config=/directory/import.conf --verbose --no-prompt \u00b6 Inclusion of the --no-prompt option will run wee_import without prompts. Relevant defaults will be used and all y/n prompts are automatically accepted as 'y'. This may be useful for unattended use of wee_import . wee_import --import-config=/directory/import.conf --no-prompt Warning Care must be taken when using the --no-prompt option as ignoring warnings during the import process can lead to unexpected results. Whilst existing data will be protected, the use or acceptance of an incorrect or unexpected parameter or default may lead to significant amounts of unwanted data being imported. --suppress-warnings \u00b6 The --suppress-warnings option suppresses wee_import warning messages from being displayed on the console during the import. wee_import may issue a number of warnings during import. These warnings may be due to the source containing more than one entry for a given timestamp or there being no data found for a mapped import field. These warnings do not necessarily require action, but they can consist of extensive output and thus make it difficult to follow the import progress. Irrespective of whether --suppress-warnings is used all warnings are sent to log. wee_import --import-config=/directory/import.conf --suppress-warnings","title":"Common options"},{"location":"utilities/wee_import-common_opt/#options","text":"","title":"Options"},{"location":"utilities/wee_import-common_opt/#-configfilename","text":"The utility can usually guess where the configuration file is, but if you have an unusual installation or multiple stations, you may have to tell it explicitly. wee_import --config=/this/directory/weewx.conf --import-config=/directory/import.conf","title":"--config=FILENAME"},{"location":"utilities/wee_import-common_opt/#-import-configfilename","text":"wee_import uses a secondary configuration file, known as the import configuration file, to store various import parameters. The --import-config option is mandatory for all imports. Example import configuration files for each type of import supported by wee_import are provided in the util/import directory. These example files are best used by making a copy of into a working directory and then modifying the copy to suit your needs. The --import-config option is used as follows: wee_import --import-config=/directory/import.conf","title":"--import-config=FILENAME"},{"location":"utilities/wee_import-common_opt/#-dry-run","text":"The --dry-run option will cause the import to proceed but no actual data will be saved to the database. This is a useful option to use when first importing data. wee_import --import-config=/directory/import.conf --dry-run","title":"--dry-run"},{"location":"utilities/wee_import-common_opt/#-dateyyyy-mm-dd","text":"Records from a single date can be imported by use of the --date option. The --date option accepts strings of the format YYYY-mm-dd . Whilst the use of the --date option will limit the imported data to that of a single date, the default action if the --date option (and the --from and --to options) is omitted may vary depending on the source. The operation of the --date option is summarised in the following table: Option --date option Records imported for a CSV, Cumulus, Weather Display or WeatherCat import Records imported for a Weather Underground import omitted (i.e., the default) All available records Today's records only --date=2015-12-22 All records from 2015-12-22 00:00 (exclusive) to 2015-12-23 00:00 (inclusive) All records from 2015-12-22 00:00 (exclusive) to 2015-12-23 00:00 (inclusive) Note If the --date , --from and --to options are omitted the default is to import today's records only when importing from Weather Underground or to import all available records when importing from any other source. Note WeeWX considers an archive record to represent an aggregation of data over the archive interval preceding the archive record's timestamp. For this reason imports which are to be limited to a given date with the --date option will only import records timestamped after midnight at the start of the day concerned and up to and including midnight at the end of the day concerned.","title":"--date=YYYY-mm-dd"},{"location":"utilities/wee_import-common_opt/#-from-and-to","text":"Whilst the --date option allows imported data to be limited to a single date, the --from and --to options allow finer control by importing only the records that fall within the date or date-time range specified by the --from and --to options. The --from option determines the earliest (inclusive), and the --to option determines the latest (exclusive), date or date-time of the records being imported. The --from and --to options accept a string of the format YYYY-mm-dd[THH:MM] . The T literal is mandatory if specifying a date-time. Note The --from and --to options must be used as a pair, they cannot be used individually or in conjunction with the --date option. The operation of the --from and --to options is summarised in the following table: Options --from and --to options Records imported for a CSV, Cumulus, Weather Display or WeatherCat import Records imported for a Weather Underground import omitted (i.e., the default) omitted (i.e., the default) All available records Today's records only --from=2015-12-22 --to=2015-12-29 All records from 2015-12-22 00:00 (exclusive) to 2015-12-30 00:00 (inclusive) All records from 2015-12-22 00:00 (exclusive) to 2015-12-30 00:00 (inclusive) --from=2016-7-18T15:29 --to=2016-7-25 All records from 2016-7-18 15:29 (exclusive) to 2016-7-26 00:00 (inclusive) All records from 2016-7-18 15:29 (exclusive) to 2016-7-26 00:00 (inclusive) --from=2016-5-12 --to=2016-7-22T22:15 All records from 2016-5-12 00:00 (exclusive) to 2016-7-22 22:15 (inclusive) All records from 2016-5-12 00:00 (exclusive) to 2016-7-22 22:15 (inclusive) --from=2016-3-18T15:29 --to=2016-6-20T22:00 All records from 2016-3-18 15:29 (exclusive) to 2016-6-20 22:00 (inclusive) All records from 2016-3-18 15:29 (exclusive) to 2016-6-20 22:00 (inclusive) Note If the --date , --from and --to options are omitted the default is to import today's records only when importing from Weather Underground or to import all available records when importing from any other source. Note WeeWX considers an archive record to represent an aggregation of data over the archive interval preceding the archive record's timestamp. For this reason imports which are to be limited to a given timespan with the --from and --to options will only import records timestamped after the timestamp represented by the --from option and up to and including the timestamp represented by the --to option.","title":"--from and --to"},{"location":"utilities/wee_import-common_opt/#-verbose","text":"Inclusion of the --verbose option will cause additional information to be printed during wee_import execution. wee_import --import-config=/directory/import.conf --verbose","title":"--verbose"},{"location":"utilities/wee_import-common_opt/#-no-prompt","text":"Inclusion of the --no-prompt option will run wee_import without prompts. Relevant defaults will be used and all y/n prompts are automatically accepted as 'y'. This may be useful for unattended use of wee_import . wee_import --import-config=/directory/import.conf --no-prompt Warning Care must be taken when using the --no-prompt option as ignoring warnings during the import process can lead to unexpected results. Whilst existing data will be protected, the use or acceptance of an incorrect or unexpected parameter or default may lead to significant amounts of unwanted data being imported.","title":"--no-prompt"},{"location":"utilities/wee_import-common_opt/#-suppress-warnings","text":"The --suppress-warnings option suppresses wee_import warning messages from being displayed on the console during the import. wee_import may issue a number of warnings during import. These warnings may be due to the source containing more than one entry for a given timestamp or there being no data found for a mapped import field. These warnings do not necessarily require action, but they can consist of extensive output and thus make it difficult to follow the import progress. Irrespective of whether --suppress-warnings is used all warnings are sent to log. wee_import --import-config=/directory/import.conf --suppress-warnings","title":"--suppress-warnings"},{"location":"utilities/wee_import-config_opt/","text":"wee_import requires a second configuration file, the import configuration file, in addition to the standard WeeWX configuration file. The import configuration file specifies the import type and various options associated with each type of import. The import configuration file is specified using the mandatory --import-config option. How you construct the import configuration file is up to you; however, the recommended method is to copy one of the example import configuration files located in the /home/weewx/util/import or /etc/weewx/import directory as applicable, modify the configuration options in the newly copied file to suit the import to be performed and then use this file as the import configuration file. Following is the definitive guide to the options available in the import configuration file. Default values are provided for a number of options, meaning that if they are not listed in the import configuration file at all wee_import will pick sensible values. When the documentation below gives a default value this is the value that will be used if the option is omitted. source \u00b6 The source option determines the type of import to be performed by wee_import . The option is mandatory and must be set to one of the following: CSV to import from a single CSV format file. WU to import from a Weather Underground PWS history Cumulus to import from one or more Cumulus monthly log files. WD to import from one or more Weather Display monthly log files. WeatherCat to import from one or more WeatherCat monthly .cat files. There is no default. [CSV] \u00b6 The [CSV] section contains the options controlling the import of observational data from a CSV format file. file \u00b6 The file containing the CSV format data to be used as the source during the import. Include full path and filename. There is no default. source_encoding \u00b6 The source file encoding. This parameter is optional and should only need be used if the source file uses an encoding other than UTF-8 or an ASCII compatible encoding. If used, the setting used should be a Python Standard Encoding . The default is utf-8-sig . delimiter \u00b6 The character used to separate fields. Default is , (comma). decimal \u00b6 The character used as the decimal point in the source files. A full stop is frequently used, but it may be another character. This parameter must be included in quotation marks. The default is '.' . interval \u00b6 Determines how the time interval (WeeWX archive table field interval ) between successive observations is derived. The interval can be derived by one of three methods: The interval can be calculated as the time, rounded to the nearest minute, between the date-time of successive records. This method is suitable when the data was recorded at fixed intervals and there are NO missing records in the source data. Use of this method when there are missing records in the source data can compromise the integrity of the WeeWX statistical data. Select this method by setting interval = derive . The interval can be set to the same value as the archive_interval setting under [StdArchive] in weewx.conf . This setting is useful if the data was recorded at fixed intervals but there are some missing records and the fixed interval is the same as the archive_interval setting under [StdArchive] in weewx.conf . Select this method by setting interval = conf . The interval can be set to a fixed number of minutes. This setting is useful if the source data was recorded at fixed intervals but there are some missing records and the fixed interval is different to the archive_interval setting under [StdArchive] in weewx.conf . Select this method by setting interval = x where x is an integer number of minutes. If the CSV source data records are equally spaced in time, but some records are missing, then a better result may be achieved using conf or a fixed interval setting. The default is derive . qc \u00b6 Determines whether simple quality control checks are applied to imported data. Setting qc = True will result in wee_import applying the WeeWX StdQC minimum and maximum checks to any imported observations. wee_import quality control checks use the same configuration settings, and operate in the same manner, as the StdQC service. For example, for minimum/maximum quality checks, if an observation falls outside of the quality control range for that observation, the observation will be set to None . In such cases you will be alerted through a short message similar to: 2016-01-12 10:00:00 AEST (1452556800) record value 'outTemp' 194.34 outside limits (0.0, 120.0) As derived observations are calculated after the quality control check is applied, derived observations are not subject to quality control checks. Setting qc = False will result in wee_import not applying quality control checks to imported data. The default is True . calc_missing \u00b6 Determines whether any missing derived observations will be calculated from the imported data. Setting calc_missing = True will result in wee_import using the WeeWX StdWXCalculate service to calculate any missing derived observations from the imported data. Setting calc_missing = False will result in WeeWX leaving any missing derived observations as None . See [StdWXCalculate] for details of the observations the StdWXCalculate service can calculate. The default is True . ignore_invalid_data \u00b6 Determines whether invalid data in a source field is ignored or the import aborted. If invalid data is found in a source field and ignore_invalid_data is True the corresponding WeeWX destination field is set to None and the import continues. If invalid data is found in a source field and ignore_invalid_data is False the import is aborted. The default is True . tranche \u00b6 To speed up database operations imported records are committed to database in groups of records rather than individually. The size of the group is set by the tranche parameter. Increasing the tranche parameter may result in a slight speed increase but at the expense of increased memory usage. Decreasing the tranche parameter will result in less memory usage but at the expense of more frequent database access and likely increased time to import. The default is 250 which should suit most users. UV_sensor \u00b6 WeeWX records a None/null for UV when no UV sensor is installed, whereas some weather station software records a value of 0 for UV index when there is no UV sensor installed. The UV_sensor parameter enables wee_import to distinguish between the case where a UV sensor is present and the UV index is 0 and the case where no UV sensor is present and UV index is 0. UV_sensor = False should be used when no UV sensor was used in producing the source data. UV_sensor = False will result in None/null being recorded in the WeeWX archive field UV irrespective of any UV observations in the source data. UV_sensor = True should be used when a UV sensor was used in producing the source data. UV_sensor = True will result in UV observations in the source data being stored in the WeeWX archive field UV . The default is True . solar_sensor \u00b6 WeeWX records a None/null when no solar radiation sensor is installed, whereas some weather station software records a value of 0 for solar radiation when there is no solar radiation sensor installed. The solar_sensor parameter enables wee_import to distinguish between the case where a solar radiation sensor is present and solar radiation is 0 and the case where no solar radiation sensor is present and solar radiation is 0. solar_sensor = False should be used when no solar radiation sensor was used in producing the source data. solar_sensor = False will result in None/null being recorded in the WeeWX archive field radiation irrespective of any solar radiation observations in the source data. solar_sensor = True should be used when a solar radiation sensor was used in producing the source data. solar_sensor = True will result in solar radiation observations in the source data being stored in the WeeWX archive field radiation . The default is True . raw_datetime_format \u00b6 WeeWX records each record with a unique unix epoch timestamp, whereas many weather station applications or web sources export observational data with a human-readable date-time. This human-readable date-time is interpreted according to the format set by the raw_datetime_format option. This option consists of Python strptime() format codes and literal characters to represent the date-time data being imported. For example, if the source data uses the format 23 January 2015 15:34 the appropriate setting for raw_datetime_format would be %d %B %Y %H:%M , 9:25:00 12/28/16 would use %H:%M:%S %m/%d/%y . If the source data provides a unix epoch timestamp as the date-time field the unix epoch timestamp is used directly and the raw_datetime_format option is ignored. The default is %Y-%m-%d %H:%M:%S . Note wee_import does not support the construction of the unique record date time stamp from separate date and time fields, rather the date-time information for each imported record must be contained in a single field. CSV data containing separate date and time fields may require further manual processing before they can be imported. rain \u00b6 The WeeWX rain field records rainfall that was recorded in the preceding archive period, so for a five-minute archive period the rain field in each archive record would contain the total rainfall that fell in the previous five minutes. Many weather station applications provide a daily or yearly total. wee_import can derive the WeeWX rain field in one of two ways: If the imported rainfall data is a running total then wee_import can derive the WeeWX rain field from successive totals. For this method use rain = cumulative . If the imported rainfall data is a discrete value per date-time period then rain = discrete should be used. Note wee_import only supports cumulative rainfall data that resets on a midnight boundary, cumulative rainfall data that resets at some other time; e.g., 9am, is not supported. In such cases the rainfall data will need to be converted to either reset on a midnight boundary or a discrete value per date-time period and rain = discrete used. The former may be possible by selecting another rainfall field (if available) in the source data, otherwise it will require manual manipulation of the source data. wind_direction \u00b6 WeeWX records wind direction in degrees as a number from 0 to 360 inclusive (no wind direction is recorded as None/null ), whereas some data sources may provide wind direction as number over a different range (e.g., -180 to +180) or may use a particular value when there is no wind direction (e.g., 0 may represent no wind direction and 360 may represent a northerly wind, or -9999 (or some similar clearly invalid number) to represent there being no wind direction). wee_import handles such variations in data by defining a range over which imported wind direction values are accepted. Any value outside of this range is treated as there being no wind direction and is recorded as None/null . Any value inside the range is normalised to the range 0 to 360 inclusive (e.g., -180 would be normalised to 180). The wind_direction option consists of two comma separated numbers of the format lower, upper where lower and upper are inclusive. The operation of the wind_direction option is best illustrated through the following table: Option wind_direction wind_direction option setting Source data wind direction value Imported wind direction value 0, 360 0 0 160 160 360 360 500 None/null -45 None/null -9999 None/null No data None/null -360, 360 0 0 160 160 360 360 500 None/null -45 315 -9999 None/null No data None/null -180, 180 0 0 160 160 360 None/null 500 None/null -45 315 -9999 None/null No data None/null The default is 0, 360 . [[FieldMap]] \u00b6 The [[FieldMap]] stanza defines the mapping from the source data fields to WeeWX archive fields. The map consists of one row per field being imported using either of the following formats: weewx_archive_field_name = csv_field_name, weewx_unit_name or weewx_archive_field_name = csv_field_name, text Where: weewx_archive_field_name is a field name in the in-use WeeWX archive table schema csv_field_name is the name of a field from the CSV file weewx_unit_name is the WeeWX unit name of the units used by csv_field_name text is the literal word text This mapping allows wee_import to take a source data field, do the appropriate unit conversion and store the resulting value in the appropriate WeeWX archive field. Source data text fields may be mapped to a WeeWX text archive field by using the second form of the field map entry where the literal text is used in place of a WeeWX unit name. A mapping is not required for every WeeWX archive field (e.g., the source may not provide inside temperature so no inTemp field mapping is required) and neither does every CSV field need to be included in a mapping (e.g., the source data field monthrain may have no use if the source data field rain provides the data for the WeeWX archive `rain field). Unused field mapping lines will not be used and may be omitted. Note Importing of text data into text fields in the WeeWX archive is only supported for WeeWX archive fields that have been configured as text fields. Refer to the Wiki page Storing text in the database for details. If the source data includes a field that contains a WeeWX unit system code (i.e. the equivalent of the WeeWX usUnits field such as may be obtained from WeeWX or wview data) then this field can be mapped to the WeeWX usUnits field and used to set the units used for all fields being imported. In such cases the weewx_unit_name portion of the imported fields in the field map is not used and can be omitted. For example, source CSV data with the following structure: date_and_time,temp,humid,wind,dir,rainfall,rad,river 23 May 2018 13:00,17.4,56,3.0,45,0.0,956,340 23 May 2018 13:05,17.6,56,1.0,22.5,0.4,746,341 where temp is temperature in Celsius, humid is humidity in percent, wind is wind speed in km/h, dir is wind direction in degrees, rainfall is rain in mm, rad is radiation in watts per square meter and river is river height in mm might use a field map as follows: [[FieldMap]] dateTime = date_and_time, unix_epoch outTemp = temp, degree_C outHumidity = humid, percent windSpeed = wind, km_per_hour windDir = dir, degree_compass rain = rainfall, mm radiation = rad, watt_per_meter_squared If the same source CSV data included a field unit_info that contains WeeWX unit system data as follows: date_and_time,temp,humid,wind,dir,rainfall,rad,river,unit_info 23 May 2018 13:00,17.4,56,3.0,45,0.0,956,340,1 23 May 2018 13:05,17.6,56,1.0,22.5,0.4,746,341,16 then a field map such as the following might be used: [[FieldMap]] dateTime = date_and_time, unix_epoch usUnits = unit_info outTemp = temp outHumidity = humid windSpeed = wind windDir = dir rain = rainfall radiation = rad Note Any WeeWX archive fields that are derived (e.g., dewpoint ) and for which there is no field mapping may be calculated during import by use of the calc_missing option in the [CSV] section of the import configuration file. Note The dateTime field map entry is a special case. Whereas other field map entries may use any supported WeeWX unit name, or no unit name if the usUnits field is populated, the dateTime field map entry must include the WeeWX unit name unix_epoch . This is because wee_import uses the raw_datetime_format config option to convert the supplied date-time field data to a Unix epoch timestamp before the field map is applied. [WU] \u00b6 The [WU] section contains the options relating to the import of observational data from a Weather Underground PWS history. station_id \u00b6 The Weather Underground weather station ID of the PWS from which the historical data will be imported. There is no default. api_key \u00b6 The Weather Underground API key to be used to obtain the PWS history data. There is no default. Note The API key is a seemingly random string of 32 characters used to access the new (2019) Weather Underground API. PWS contributors can obtain an API key by logging onto the Weather Underground internet site and accessing Member Settings. 16 character API keys used with the previous Weather Underground API are not supported. interval \u00b6 Determines how the time interval (WeeWX database field interval ) between successive observations is determined. This option is identical in operation to the CSV interval option but applies to Weather Underground imports only. As a Weather Underground PWS history sometimes has missing records, the use of interval = derive may give incorrect or inconsistent interval values. Better results may be obtained by using interval = conf if the current WeeWX installation has the same archive_interval as the Weather Underground data, or by using interval = x where x is the time interval in minutes used to upload the Weather Underground data. The most appropriate setting will depend on the completeness and (time) accuracy of the Weather Underground data being imported. The default is derive . qc \u00b6 Determines whether simple quality control checks are applied to imported data. This option is identical in operation to the CSV qc option but applies to Weather Underground imports only. As Weather Underground imports at times contain nonsense values, particularly for fields for which no data was uploaded to Weather Underground by the PWS, the use of quality control checks on imported data can prevent these nonsense values from being imported and contaminating the WeeWX database. The default is True . calc_missing \u00b6 Determines whether any missing derived observations will be calculated from the imported data. This option is identical in operation to the CSV calc_missing \" option but applies to Weather Underground imports only. The default is True . ignore_invalid_data \u00b6 Determines whether invalid data in a source field is ignored or the import aborted. This option is identical in operation to the CSV ignore_invalid_data option but applies to Weather Underground imports only. The default is True . tranche \u00b6 The number of records written to the WeeWX database in each transaction. This option is identical in operation to the CSV tranche option but applies to Weather Underground imports only. The default is 250 which should suit most users. wind_direction \u00b6 Determines the range of acceptable wind direction values in degrees. This option is identical in operation to the CSV wind_direction option but applies to Weather Underground imports only. The default is 0, 360 . [Cumulus] \u00b6 The [Cumulus] section contains the options relating to the import of observational data from Cumulus monthly log files. directory \u00b6 The full path to the directory containing the Cumulus monthly log files to be imported. Do not include a trailing / . There is no default. source_encoding \u00b6 The Cumulus monthly log file encoding. This option is identical in operation to the CSV source_encoding option but applies to Cumulus imports only. The default is utf-8-sig . interval \u00b6 Determines how the time interval (WeeWX database field interval ) between successive observations is determined. This option is identical in operation to the CSV interval option but applies to Cumulus monthly log file imports only. As Cumulus monthly log files can, at times, have missing entries, the use of interval = derive may give incorrect or inconsistent interval values. Better results may be obtained by using interval = conf if the archive_interval for the current WeeWX installation is the same as the Cumulus 'data log interval' setting used to generate the Cumulus monthly log files, or by using interval = x where x is the time interval in minutes used as the Cumulus 'data log interval' setting. The most appropriate setting will depend on the completeness and (time) accuracy of the Cumulus data being imported. The default is derive . qc \u00b6 Determines whether simple quality control checks are applied to imported data. This option is identical in operation to the CSV qc option but applies to Cumulus imports only. The default is >True . calc_missing \u00b6 Determines whether any missing derived observations will be calculated from the imported data. This option is identical in operation to the CSV calc_missing option but applies to Cumulus imports only. The default is True . separator \u00b6 The character used as the date field separator in the Cumulus monthly log file. A solidus (/) is frequently used, but it may be another character depending on the settings on the machine that produced the Cumulus monthly log files. This parameter must be included in quotation marks. The default is / . delimiter \u00b6 The character used as the field delimiter in the Cumulus monthly log file. A comma is frequently used, but it may be another character depending on the settings on the machine that produced the Cumulus monthly log files. This parameter must be included in quotation marks. The default is , . decimal \u00b6 The character used as the decimal point in the Cumulus monthly log files. A full stop is frequently used, but it may be another character depending on the settings on the machine that produced the Cumulus monthly log files. This parameter must be included in quotation marks. The default is . . ignore_invalid_data \u00b6 Determines whether invalid data in a source field is ignored or the import aborted. This option is identical in operation to the CSV ignore_invalid_data option but applies to Cumulus monthly log file imports only. The default is True . tranche \u00b6 The number of records written to the WeeWX database in each transaction. This option is identical in operation to the CSV tranche option but applies to Cumulus monthly log file imports only. The default is 250 which should suit most users. UV_sensor \u00b6 Enables wee_import to distinguish between the case where a UV sensor is present and the UV index is 0 and the case where no UV sensor is present and UV index is 0. This option is identical in operation to the CSV UV_sensor option but applies to Cumulus monthly log file imports only. The default is True . solar_sensor \u00b6 Enables wee_import to distinguish between the case where a solar radiation sensor is present and the solar radiation is 0 and the case where no solar radiation sensor is present and solar radiation is 0. This option is identical in operation to the CSV solar_sensor option but applies to Cumulus monthly log file imports only. The default is True . [[Units]] \u00b6 The [[Units]] stanza defines the units used in the Cumulus monthly log files. Units settings are required for temperature , pressure , rain and speed . The format for each setting is: obs_type = weewx_unit_name Where obs_type is one of temperature , pressure , rain or speed and weewx_unit_name is the WeeWX unit name of the units used by that particular obs_type . As Cumulus supports a different suite of possible units only a subset of the available WeeWX unit names can be used for some settings. [WD] \u00b6 The [WD] section contains the options relating to the import of observational data from Weather Display monthly log files. directory \u00b6 The full path to the directory containing the Weather Display monthly log files to be imported. Do not include a trailing / . There is no default. logs_to_process \u00b6 The Weather Display monthly log files to be processed. Weather Display uses multiple files to record each month of data. Which monthly log files are produced depends on the Weather Display configuration and the capabilities of the weather station. wee_import supports the following Weather Display monthly log files: MMYYYYlg.txt MMYYYYlgcsv.csv (csv format version of MMYYYYlg.txt) MMYYYYvantagelog.txt MMYYYYvantagelogcsv.csv (csv format version of MMYYYYvantagelog.txt) MMYYYYvantageextrasensorslog.csv where MM is a one or two-digit month and YYYY is a four digit year The format for the logs_to_process setting is: logs_to_process = [lg.txt, | logcsv.csv, | vantagelog.txt, | vantagelogcsv.csv, | vantageextrasensorslog.csv] Note The leading MMYYYY is omitted when listing the monthly log files to be processed using the logs_to_process setting. Inclusion of the leading MMYYYY will cause the import to fail. Note The MMYYYYlgcsv.csv and MMYYYYvantagelogcsv.csv log files are CSV versions of MMYYYYlg.txt and MMYYYYvantagelog.txt respectively. Either the .txt or .csv version of these files should be used but not both. The monthly log files selected for processing should be chosen carefully as the selected log files will determine the Weather Display data fields available for import. wee_import is able to import the following data from the indicated monthly log files: MMYYYYlg.txt/MMYYlgcsv.csv: average wind speed barometer date and time dew point heat index outside humidity outside temperature rain fall wind direction wind gust speed MMYYYYvantagelog.txt/MMYYYYvantagelogcsv.csv: date and time soil moisture soil temperature solar radiation UV index MMYYYYvantageextrasensorslog.csv: date and time extra humidity 1 extra humidity 2 extra humidity 3 extra humidity 4 extra humidity 5 extra humidity 6 extra temperature 1 extra temperature 2 extra temperature 3 extra temperature 4 extra temperature 5 extra temperature 6 Note Whilst the above log files may contain the indicated data the data may only be imported subject to a suitable field map and in-use WeeWX archive table schema (refer to the [[FieldMap]] option). The default is lg.txt, vantagelog.txt, vantageextrasensorslog.csv . source_encoding \u00b6 The Weather Display monthly log file encoding. This option is identical in operation to the CSV source_encoding option but applies to Weather Display imports only. The default is utf-8-sig . interval \u00b6 Determines how the time interval (WeeWX database field interval ) between successive observations is determined. This option is identical in operation to the CSV interval option but applies to Weather Display monthly log file imports only. As Weather Display log files nominally have entries at one minute intervals the recommended approach is to set interval = 1 . As Weather Display monthly log files can, at times, have missing entries, the use of interval = derive may give incorrect or inconsistent interval values. If then archive_interval for the current WeeWX installation is 1 minute interval = conf may be used. In most cases the most appropriate setting will be interval = 1 . The default is 1 . qc \u00b6 Determines whether simple quality control checks are applied to imported data. This option is identical in operation to the CSV qc option but applies to Weather Display imports only. The default is True . calc_missing \u00b6 Determines whether any missing derived observations will be calculated from the imported data. This option is identical in operation to the CSV calc_missing option but applies to Weather Display imports only. The default is True . txt_delimiter \u00b6 The character used as the field delimiter in Weather Display text format monthly log files (.txt files). A space is normally used but another character may be used if necessary. This parameter must be included in quotation marks. The default is ' ' . csv_delimiter \u00b6 The character used as the field delimiter in Weather Display csv format monthly log files (.csv files). A comma is normally used but another character may be used if necessary. This parameter must be included in quotation marks. The default is , . decimal \u00b6 The character used as the decimal point in the Weather Display monthly log files. A full stop is frequently used but another character may be used if necessary. This parameter must be included in quotation marks. The default is . . ignore_missing_log \u00b6 Determines whether missing log files are to be ignored or the import aborted. Weather Display log files are complete in themselves and a missing log file will have no effect other than there will be no imported data for the period covered by the missing log file. The default is True . ignore_invalid_data \u00b6 Determines whether invalid data in a source field is ignored or the import aborted. This option is identical in operation to the CSV ignore_invalid_data option but applies to Weather Display monthly log file imports only. The default is True . tranche \u00b6 The number of records written to the WeeWX database in each transaction. This option is identical in operation to the CSV tranche option but applies to Weather Display monthly log file imports only. The default is 250 which should suit most users. UV_sensor \u00b6 Enables wee_import to distinguish between the case where a UV sensor is present and the UV index is 0 and the case where no UV sensor is present and UV index is 0. This option is identical in operation to the CSV UV_sensor option but applies to Weather Display monthly log file imports only. The default is True . solar_sensor \u00b6 Enables wee_import to distinguish between the case where a solar radiation sensor is present and the solar radiation is 0 and the case where no solar radiation sensor is present and solar radiation is 0. This option is identical in operation to the CSV solar_sensor option but applies to Weather Display monthly log file imports only. The default is True . ignore_extreme_temp_hum \u00b6 Determines whether extreme temperature and humidity values are ignored. Weather Display log files record the value 255 for temperature and humidity fields if no corresponding sensor is present. Setting ignore_extreme_temp_hum = True will cause temperature and humidity values of 255 to be ignored. Setting ignore_extreme_temp_hum = False will cause temperature and humidity values of 255 to be treated as valid data to be imported. The default is True . Note Setting ignore_extreme_temp_hum = False will cause temperature and humidity values of 255 to be imported; however, these values may be rejected by the simple quality control checks implemented if qc = True is used. [[Units]] \u00b6 The [[Units]] stanza defines the units used in the Weather Display monthly log files. Weather Display monthly log files normally use Metric or US customary units depending on the Log File setting under Units on the Units/Wind Chill tab of the Weather Display Universal Setup . In such cases the units configuration option may be set to Metric or US to select either Metric or US customary units. There is no default. It is also possible to individually specify the log file units used for temperature , pressure , rain and speed . The format for each setting is: obs_type = weewx_unit_name Where obs_type is one of temperature , pressure , rain or speed and weewx_unit_name is the WeeWX unit name of the units used by that particular obs_type. As Weather Display supports a different suite of possible units only a subset of the available WeeWX unit names can be used for some settings. The preferred method for defining the Weather Display log file units is through the use of the units configuration option. When defining the import log file units either the units configuration option should be used or the individual temperature , pressure , rain and >speed units defined but not both. If both the units configuration option is defined as well as the individual temperature , pressure , rain and speed units defined the units configuration option takes precedence and all other units settings are ignored. [[FieldMap]] \u00b6 The [[FieldMap]] stanza defines the mapping from the Weather Display monthly log data fields to WeeWX archive fields. By default, imported Weather Display data is mapped to the corresponding WeeWX archive fields using a default field map. The default field map will likely suit most users; however, depending on the station capabilities and the in-use WeeWX database schema, a custom field map may be required if Weather Display monthly logs contain data from additional sensors that cannot be stored in the WeeWX archive using the default field map. A custom field map also makes it possible to limit the Weather Display monthly log data fields that are imported into WeeWX. The field map consists of one row per field using the format: weewx_archive_field_name = weather_display_field_name Where weewx_archive_field_name is a field name in the in-use WeeWX archive table schema and weather_display_field_name is a Weather Display import field name. The available Weather Display import field names are listed in the table below. Available import field names Field name Description barometer barometric pressure dewpoint dew point direction wind direction gustspeed wind gust speed heatindex heat index humidity outside humidity hum1 extra humidity 1 hum2 extra humidity 2 hum3 extra humidity 3 hum4 extra humidity 4 hum5 extra humidity 5 hum6 extra humidity 6 radiation solar radiation rainlastmin rainfall in the last 1 minute soilmoist soil moisture soiltemp soil temperature temperature outside temperature temp1 extra temperature 1 temp2 extra temperature 2 temp3 extra temperature 3 temp4 extra temperature 4 temp5 extra temperature 5 temp6 extra temperature 6 uv UV index windspeed average wind speed A mapping is not required for every WeeWX archive field (e.g., the Weather Display monthly logs may not provide inside temperature so no inTemp field mapping is required) and neither does every Weather Display monthly log field need to be included in a mapping (e.g., the Weather Display monthly log field soiltemp may have no data as the station has no soil temperature probe). Note Any WeeWX archive fields that are derived (e.g., dewpoint ) and for which there is no field mapping may be calculated during import by use of the calc_missing option in the [WD] section of the import configuration file. The example Weather Display import configuration file located in the /home/weewx/util/import] or the `/etc/weewx/import directory contains an example field map in the import configuration file comments. There is no default. [WeatherCat] \u00b6 The [WeatherCat] section contains the options relating to the import of observational data from WeatherCat monthly .cat files. directory \u00b6 The full path to the directory containing the year directories that contain the WeatherCat monthly .cat files to be imported. Do not include a trailing / . There is no default. source_encoding \u00b6 The WeatherCat monthly .cat file encoding. This option is identical in operation to the CSV source_encoding option but applies to WeatherCat imports only. The default is utf-8-sig . interval \u00b6 Determines how the time interval (WeeWX database field interval ) between successive observations is determined. This option is identical in operation to the CSV interval option but applies to WeatherCat imports only. As WeatherCat monthly .cat files can, at times, have missing entries, the use of interval = derive may give incorrect or inconsistent interval values. Better results may be obtained by using interval = conf if the archive_interval for the current WeeWX installation is the same as the WeatherCat .cat file log interval, or by using interval = x where x is the time interval in minutes used in the WeatherCat monthly .cat file(s). The most appropriate setting will depend on the completeness and (time) accuracy of the WeatherCat data being imported. The default is derive . qc \u00b6 Determines whether simple quality control checks are applied to imported data. This option is identical in operation to the CSV qc option but applies to WeatherCat imports only. The default is True . calc_missing \u00b6 Determines whether any missing derived observations will be calculated from the imported data. This option is identical in operation to the CSV calc_missing option but applies to WeatherCat imports only. The default is True . decimal \u00b6 The character used as the decimal point in the WeatherCat monthly .cat files. This parameter must be included in quotation marks. The default is . . tranche \u00b6 The number of records written to the WeeWX database in each transaction. This option is identical in operation to the CSV tranche option but applies to WeatherCat imports only. The default is 250 which should suit most users. UV_sensor \u00b6 Enables wee_import to distinguish between the case where a UV sensor is present and the UV index is 0 and the case where no UV sensor is present and UV index is 0. This option is identical in operation to the CSV UV_sensor option but applies to WeatherCat imports only. The default is True . solar_sensor \u00b6 Enables wee_import to distinguish between the case where a solar radiation sensor is present and the solar radiation is 0 and the case where no solar radiation sensor is present and solar radiation is 0. This option is identical in operation to the CSV solar_sensor option but applies to WeatherCat imports only. The default is True . [[Units]] \u00b6 The [[Units]] stanza defines the units used in the WeatherCat monthly .cat files. Unit settings are required for temperature , pressure , rain and speed . The format for each setting is: obs_type = weewx_unit_name Where obs_type is one of temperature , pressure , rain or speed and weewx_unit_name is the WeeWX unit name of the units used by that particular obs_type (refer to the Units for details of available WeeWX unit names). As WeatherCat supports a different suite of possible units only a subset of the available WeeWX unit names can be used for some settings. There is no default.","title":"Configuration options"},{"location":"utilities/wee_import-config_opt/#source","text":"The source option determines the type of import to be performed by wee_import . The option is mandatory and must be set to one of the following: CSV to import from a single CSV format file. WU to import from a Weather Underground PWS history Cumulus to import from one or more Cumulus monthly log files. WD to import from one or more Weather Display monthly log files. WeatherCat to import from one or more WeatherCat monthly .cat files. There is no default.","title":"source"},{"location":"utilities/wee_import-config_opt/#csv","text":"The [CSV] section contains the options controlling the import of observational data from a CSV format file.","title":"[CSV]"},{"location":"utilities/wee_import-config_opt/#file","text":"The file containing the CSV format data to be used as the source during the import. Include full path and filename. There is no default.","title":"file"},{"location":"utilities/wee_import-config_opt/#source_encoding","text":"The source file encoding. This parameter is optional and should only need be used if the source file uses an encoding other than UTF-8 or an ASCII compatible encoding. If used, the setting used should be a Python Standard Encoding . The default is utf-8-sig .","title":"source_encoding"},{"location":"utilities/wee_import-config_opt/#delimiter","text":"The character used to separate fields. Default is , (comma).","title":"delimiter"},{"location":"utilities/wee_import-config_opt/#decimal","text":"The character used as the decimal point in the source files. A full stop is frequently used, but it may be another character. This parameter must be included in quotation marks. The default is '.' .","title":"decimal"},{"location":"utilities/wee_import-config_opt/#interval","text":"Determines how the time interval (WeeWX archive table field interval ) between successive observations is derived. The interval can be derived by one of three methods: The interval can be calculated as the time, rounded to the nearest minute, between the date-time of successive records. This method is suitable when the data was recorded at fixed intervals and there are NO missing records in the source data. Use of this method when there are missing records in the source data can compromise the integrity of the WeeWX statistical data. Select this method by setting interval = derive . The interval can be set to the same value as the archive_interval setting under [StdArchive] in weewx.conf . This setting is useful if the data was recorded at fixed intervals but there are some missing records and the fixed interval is the same as the archive_interval setting under [StdArchive] in weewx.conf . Select this method by setting interval = conf . The interval can be set to a fixed number of minutes. This setting is useful if the source data was recorded at fixed intervals but there are some missing records and the fixed interval is different to the archive_interval setting under [StdArchive] in weewx.conf . Select this method by setting interval = x where x is an integer number of minutes. If the CSV source data records are equally spaced in time, but some records are missing, then a better result may be achieved using conf or a fixed interval setting. The default is derive .","title":"interval"},{"location":"utilities/wee_import-config_opt/#qc","text":"Determines whether simple quality control checks are applied to imported data. Setting qc = True will result in wee_import applying the WeeWX StdQC minimum and maximum checks to any imported observations. wee_import quality control checks use the same configuration settings, and operate in the same manner, as the StdQC service. For example, for minimum/maximum quality checks, if an observation falls outside of the quality control range for that observation, the observation will be set to None . In such cases you will be alerted through a short message similar to: 2016-01-12 10:00:00 AEST (1452556800) record value 'outTemp' 194.34 outside limits (0.0, 120.0) As derived observations are calculated after the quality control check is applied, derived observations are not subject to quality control checks. Setting qc = False will result in wee_import not applying quality control checks to imported data. The default is True .","title":"qc"},{"location":"utilities/wee_import-config_opt/#calc_missing","text":"Determines whether any missing derived observations will be calculated from the imported data. Setting calc_missing = True will result in wee_import using the WeeWX StdWXCalculate service to calculate any missing derived observations from the imported data. Setting calc_missing = False will result in WeeWX leaving any missing derived observations as None . See [StdWXCalculate] for details of the observations the StdWXCalculate service can calculate. The default is True .","title":"calc_missing"},{"location":"utilities/wee_import-config_opt/#ignore_invalid_data","text":"Determines whether invalid data in a source field is ignored or the import aborted. If invalid data is found in a source field and ignore_invalid_data is True the corresponding WeeWX destination field is set to None and the import continues. If invalid data is found in a source field and ignore_invalid_data is False the import is aborted. The default is True .","title":"ignore_invalid_data"},{"location":"utilities/wee_import-config_opt/#tranche","text":"To speed up database operations imported records are committed to database in groups of records rather than individually. The size of the group is set by the tranche parameter. Increasing the tranche parameter may result in a slight speed increase but at the expense of increased memory usage. Decreasing the tranche parameter will result in less memory usage but at the expense of more frequent database access and likely increased time to import. The default is 250 which should suit most users.","title":"tranche"},{"location":"utilities/wee_import-config_opt/#uv_sensor","text":"WeeWX records a None/null for UV when no UV sensor is installed, whereas some weather station software records a value of 0 for UV index when there is no UV sensor installed. The UV_sensor parameter enables wee_import to distinguish between the case where a UV sensor is present and the UV index is 0 and the case where no UV sensor is present and UV index is 0. UV_sensor = False should be used when no UV sensor was used in producing the source data. UV_sensor = False will result in None/null being recorded in the WeeWX archive field UV irrespective of any UV observations in the source data. UV_sensor = True should be used when a UV sensor was used in producing the source data. UV_sensor = True will result in UV observations in the source data being stored in the WeeWX archive field UV . The default is True .","title":"UV_sensor"},{"location":"utilities/wee_import-config_opt/#solar_sensor","text":"WeeWX records a None/null when no solar radiation sensor is installed, whereas some weather station software records a value of 0 for solar radiation when there is no solar radiation sensor installed. The solar_sensor parameter enables wee_import to distinguish between the case where a solar radiation sensor is present and solar radiation is 0 and the case where no solar radiation sensor is present and solar radiation is 0. solar_sensor = False should be used when no solar radiation sensor was used in producing the source data. solar_sensor = False will result in None/null being recorded in the WeeWX archive field radiation irrespective of any solar radiation observations in the source data. solar_sensor = True should be used when a solar radiation sensor was used in producing the source data. solar_sensor = True will result in solar radiation observations in the source data being stored in the WeeWX archive field radiation . The default is True .","title":"solar_sensor"},{"location":"utilities/wee_import-config_opt/#raw_datetime_format","text":"WeeWX records each record with a unique unix epoch timestamp, whereas many weather station applications or web sources export observational data with a human-readable date-time. This human-readable date-time is interpreted according to the format set by the raw_datetime_format option. This option consists of Python strptime() format codes and literal characters to represent the date-time data being imported. For example, if the source data uses the format 23 January 2015 15:34 the appropriate setting for raw_datetime_format would be %d %B %Y %H:%M , 9:25:00 12/28/16 would use %H:%M:%S %m/%d/%y . If the source data provides a unix epoch timestamp as the date-time field the unix epoch timestamp is used directly and the raw_datetime_format option is ignored. The default is %Y-%m-%d %H:%M:%S . Note wee_import does not support the construction of the unique record date time stamp from separate date and time fields, rather the date-time information for each imported record must be contained in a single field. CSV data containing separate date and time fields may require further manual processing before they can be imported.","title":"raw_datetime_format"},{"location":"utilities/wee_import-config_opt/#rain","text":"The WeeWX rain field records rainfall that was recorded in the preceding archive period, so for a five-minute archive period the rain field in each archive record would contain the total rainfall that fell in the previous five minutes. Many weather station applications provide a daily or yearly total. wee_import can derive the WeeWX rain field in one of two ways: If the imported rainfall data is a running total then wee_import can derive the WeeWX rain field from successive totals. For this method use rain = cumulative . If the imported rainfall data is a discrete value per date-time period then rain = discrete should be used. Note wee_import only supports cumulative rainfall data that resets on a midnight boundary, cumulative rainfall data that resets at some other time; e.g., 9am, is not supported. In such cases the rainfall data will need to be converted to either reset on a midnight boundary or a discrete value per date-time period and rain = discrete used. The former may be possible by selecting another rainfall field (if available) in the source data, otherwise it will require manual manipulation of the source data.","title":"rain"},{"location":"utilities/wee_import-config_opt/#wind_direction","text":"WeeWX records wind direction in degrees as a number from 0 to 360 inclusive (no wind direction is recorded as None/null ), whereas some data sources may provide wind direction as number over a different range (e.g., -180 to +180) or may use a particular value when there is no wind direction (e.g., 0 may represent no wind direction and 360 may represent a northerly wind, or -9999 (or some similar clearly invalid number) to represent there being no wind direction). wee_import handles such variations in data by defining a range over which imported wind direction values are accepted. Any value outside of this range is treated as there being no wind direction and is recorded as None/null . Any value inside the range is normalised to the range 0 to 360 inclusive (e.g., -180 would be normalised to 180). The wind_direction option consists of two comma separated numbers of the format lower, upper where lower and upper are inclusive. The operation of the wind_direction option is best illustrated through the following table: Option wind_direction wind_direction option setting Source data wind direction value Imported wind direction value 0, 360 0 0 160 160 360 360 500 None/null -45 None/null -9999 None/null No data None/null -360, 360 0 0 160 160 360 360 500 None/null -45 315 -9999 None/null No data None/null -180, 180 0 0 160 160 360 None/null 500 None/null -45 315 -9999 None/null No data None/null The default is 0, 360 .","title":"wind_direction"},{"location":"utilities/wee_import-config_opt/#fieldmap","text":"The [[FieldMap]] stanza defines the mapping from the source data fields to WeeWX archive fields. The map consists of one row per field being imported using either of the following formats: weewx_archive_field_name = csv_field_name, weewx_unit_name or weewx_archive_field_name = csv_field_name, text Where: weewx_archive_field_name is a field name in the in-use WeeWX archive table schema csv_field_name is the name of a field from the CSV file weewx_unit_name is the WeeWX unit name of the units used by csv_field_name text is the literal word text This mapping allows wee_import to take a source data field, do the appropriate unit conversion and store the resulting value in the appropriate WeeWX archive field. Source data text fields may be mapped to a WeeWX text archive field by using the second form of the field map entry where the literal text is used in place of a WeeWX unit name. A mapping is not required for every WeeWX archive field (e.g., the source may not provide inside temperature so no inTemp field mapping is required) and neither does every CSV field need to be included in a mapping (e.g., the source data field monthrain may have no use if the source data field rain provides the data for the WeeWX archive `rain field). Unused field mapping lines will not be used and may be omitted. Note Importing of text data into text fields in the WeeWX archive is only supported for WeeWX archive fields that have been configured as text fields. Refer to the Wiki page Storing text in the database for details. If the source data includes a field that contains a WeeWX unit system code (i.e. the equivalent of the WeeWX usUnits field such as may be obtained from WeeWX or wview data) then this field can be mapped to the WeeWX usUnits field and used to set the units used for all fields being imported. In such cases the weewx_unit_name portion of the imported fields in the field map is not used and can be omitted. For example, source CSV data with the following structure: date_and_time,temp,humid,wind,dir,rainfall,rad,river 23 May 2018 13:00,17.4,56,3.0,45,0.0,956,340 23 May 2018 13:05,17.6,56,1.0,22.5,0.4,746,341 where temp is temperature in Celsius, humid is humidity in percent, wind is wind speed in km/h, dir is wind direction in degrees, rainfall is rain in mm, rad is radiation in watts per square meter and river is river height in mm might use a field map as follows: [[FieldMap]] dateTime = date_and_time, unix_epoch outTemp = temp, degree_C outHumidity = humid, percent windSpeed = wind, km_per_hour windDir = dir, degree_compass rain = rainfall, mm radiation = rad, watt_per_meter_squared If the same source CSV data included a field unit_info that contains WeeWX unit system data as follows: date_and_time,temp,humid,wind,dir,rainfall,rad,river,unit_info 23 May 2018 13:00,17.4,56,3.0,45,0.0,956,340,1 23 May 2018 13:05,17.6,56,1.0,22.5,0.4,746,341,16 then a field map such as the following might be used: [[FieldMap]] dateTime = date_and_time, unix_epoch usUnits = unit_info outTemp = temp outHumidity = humid windSpeed = wind windDir = dir rain = rainfall radiation = rad Note Any WeeWX archive fields that are derived (e.g., dewpoint ) and for which there is no field mapping may be calculated during import by use of the calc_missing option in the [CSV] section of the import configuration file. Note The dateTime field map entry is a special case. Whereas other field map entries may use any supported WeeWX unit name, or no unit name if the usUnits field is populated, the dateTime field map entry must include the WeeWX unit name unix_epoch . This is because wee_import uses the raw_datetime_format config option to convert the supplied date-time field data to a Unix epoch timestamp before the field map is applied.","title":"[[FieldMap]]"},{"location":"utilities/wee_import-config_opt/#wu","text":"The [WU] section contains the options relating to the import of observational data from a Weather Underground PWS history.","title":"[WU]"},{"location":"utilities/wee_import-config_opt/#station_id","text":"The Weather Underground weather station ID of the PWS from which the historical data will be imported. There is no default.","title":"station_id"},{"location":"utilities/wee_import-config_opt/#api_key","text":"The Weather Underground API key to be used to obtain the PWS history data. There is no default. Note The API key is a seemingly random string of 32 characters used to access the new (2019) Weather Underground API. PWS contributors can obtain an API key by logging onto the Weather Underground internet site and accessing Member Settings. 16 character API keys used with the previous Weather Underground API are not supported.","title":"api_key"},{"location":"utilities/wee_import-config_opt/#interval_1","text":"Determines how the time interval (WeeWX database field interval ) between successive observations is determined. This option is identical in operation to the CSV interval option but applies to Weather Underground imports only. As a Weather Underground PWS history sometimes has missing records, the use of interval = derive may give incorrect or inconsistent interval values. Better results may be obtained by using interval = conf if the current WeeWX installation has the same archive_interval as the Weather Underground data, or by using interval = x where x is the time interval in minutes used to upload the Weather Underground data. The most appropriate setting will depend on the completeness and (time) accuracy of the Weather Underground data being imported. The default is derive .","title":"interval"},{"location":"utilities/wee_import-config_opt/#qc_1","text":"Determines whether simple quality control checks are applied to imported data. This option is identical in operation to the CSV qc option but applies to Weather Underground imports only. As Weather Underground imports at times contain nonsense values, particularly for fields for which no data was uploaded to Weather Underground by the PWS, the use of quality control checks on imported data can prevent these nonsense values from being imported and contaminating the WeeWX database. The default is True .","title":"qc"},{"location":"utilities/wee_import-config_opt/#calc_missing_1","text":"Determines whether any missing derived observations will be calculated from the imported data. This option is identical in operation to the CSV calc_missing \" option but applies to Weather Underground imports only. The default is True .","title":"calc_missing"},{"location":"utilities/wee_import-config_opt/#ignore_invalid_data_1","text":"Determines whether invalid data in a source field is ignored or the import aborted. This option is identical in operation to the CSV ignore_invalid_data option but applies to Weather Underground imports only. The default is True .","title":"ignore_invalid_data"},{"location":"utilities/wee_import-config_opt/#tranche_1","text":"The number of records written to the WeeWX database in each transaction. This option is identical in operation to the CSV tranche option but applies to Weather Underground imports only. The default is 250 which should suit most users.","title":"tranche"},{"location":"utilities/wee_import-config_opt/#wind_direction_1","text":"Determines the range of acceptable wind direction values in degrees. This option is identical in operation to the CSV wind_direction option but applies to Weather Underground imports only. The default is 0, 360 .","title":"wind_direction"},{"location":"utilities/wee_import-config_opt/#cumulus","text":"The [Cumulus] section contains the options relating to the import of observational data from Cumulus monthly log files.","title":"[Cumulus]"},{"location":"utilities/wee_import-config_opt/#directory","text":"The full path to the directory containing the Cumulus monthly log files to be imported. Do not include a trailing / . There is no default.","title":"directory"},{"location":"utilities/wee_import-config_opt/#source_encoding_1","text":"The Cumulus monthly log file encoding. This option is identical in operation to the CSV source_encoding option but applies to Cumulus imports only. The default is utf-8-sig .","title":"source_encoding"},{"location":"utilities/wee_import-config_opt/#interval_2","text":"Determines how the time interval (WeeWX database field interval ) between successive observations is determined. This option is identical in operation to the CSV interval option but applies to Cumulus monthly log file imports only. As Cumulus monthly log files can, at times, have missing entries, the use of interval = derive may give incorrect or inconsistent interval values. Better results may be obtained by using interval = conf if the archive_interval for the current WeeWX installation is the same as the Cumulus 'data log interval' setting used to generate the Cumulus monthly log files, or by using interval = x where x is the time interval in minutes used as the Cumulus 'data log interval' setting. The most appropriate setting will depend on the completeness and (time) accuracy of the Cumulus data being imported. The default is derive .","title":"interval"},{"location":"utilities/wee_import-config_opt/#qc_2","text":"Determines whether simple quality control checks are applied to imported data. This option is identical in operation to the CSV qc option but applies to Cumulus imports only. The default is >True .","title":"qc"},{"location":"utilities/wee_import-config_opt/#calc_missing_2","text":"Determines whether any missing derived observations will be calculated from the imported data. This option is identical in operation to the CSV calc_missing option but applies to Cumulus imports only. The default is True .","title":"calc_missing"},{"location":"utilities/wee_import-config_opt/#separator","text":"The character used as the date field separator in the Cumulus monthly log file. A solidus (/) is frequently used, but it may be another character depending on the settings on the machine that produced the Cumulus monthly log files. This parameter must be included in quotation marks. The default is / .","title":"separator"},{"location":"utilities/wee_import-config_opt/#delimiter_1","text":"The character used as the field delimiter in the Cumulus monthly log file. A comma is frequently used, but it may be another character depending on the settings on the machine that produced the Cumulus monthly log files. This parameter must be included in quotation marks. The default is , .","title":"delimiter"},{"location":"utilities/wee_import-config_opt/#decimal_1","text":"The character used as the decimal point in the Cumulus monthly log files. A full stop is frequently used, but it may be another character depending on the settings on the machine that produced the Cumulus monthly log files. This parameter must be included in quotation marks. The default is . .","title":"decimal"},{"location":"utilities/wee_import-config_opt/#ignore_invalid_data_2","text":"Determines whether invalid data in a source field is ignored or the import aborted. This option is identical in operation to the CSV ignore_invalid_data option but applies to Cumulus monthly log file imports only. The default is True .","title":"ignore_invalid_data"},{"location":"utilities/wee_import-config_opt/#tranche_2","text":"The number of records written to the WeeWX database in each transaction. This option is identical in operation to the CSV tranche option but applies to Cumulus monthly log file imports only. The default is 250 which should suit most users.","title":"tranche"},{"location":"utilities/wee_import-config_opt/#uv_sensor_1","text":"Enables wee_import to distinguish between the case where a UV sensor is present and the UV index is 0 and the case where no UV sensor is present and UV index is 0. This option is identical in operation to the CSV UV_sensor option but applies to Cumulus monthly log file imports only. The default is True .","title":"UV_sensor"},{"location":"utilities/wee_import-config_opt/#solar_sensor_1","text":"Enables wee_import to distinguish between the case where a solar radiation sensor is present and the solar radiation is 0 and the case where no solar radiation sensor is present and solar radiation is 0. This option is identical in operation to the CSV solar_sensor option but applies to Cumulus monthly log file imports only. The default is True .","title":"solar_sensor"},{"location":"utilities/wee_import-config_opt/#units","text":"The [[Units]] stanza defines the units used in the Cumulus monthly log files. Units settings are required for temperature , pressure , rain and speed . The format for each setting is: obs_type = weewx_unit_name Where obs_type is one of temperature , pressure , rain or speed and weewx_unit_name is the WeeWX unit name of the units used by that particular obs_type . As Cumulus supports a different suite of possible units only a subset of the available WeeWX unit names can be used for some settings.","title":"[[Units]]"},{"location":"utilities/wee_import-config_opt/#wd","text":"The [WD] section contains the options relating to the import of observational data from Weather Display monthly log files.","title":"[WD]"},{"location":"utilities/wee_import-config_opt/#directory_1","text":"The full path to the directory containing the Weather Display monthly log files to be imported. Do not include a trailing / . There is no default.","title":"directory"},{"location":"utilities/wee_import-config_opt/#logs_to_process","text":"The Weather Display monthly log files to be processed. Weather Display uses multiple files to record each month of data. Which monthly log files are produced depends on the Weather Display configuration and the capabilities of the weather station. wee_import supports the following Weather Display monthly log files: MMYYYYlg.txt MMYYYYlgcsv.csv (csv format version of MMYYYYlg.txt) MMYYYYvantagelog.txt MMYYYYvantagelogcsv.csv (csv format version of MMYYYYvantagelog.txt) MMYYYYvantageextrasensorslog.csv where MM is a one or two-digit month and YYYY is a four digit year The format for the logs_to_process setting is: logs_to_process = [lg.txt, | logcsv.csv, | vantagelog.txt, | vantagelogcsv.csv, | vantageextrasensorslog.csv] Note The leading MMYYYY is omitted when listing the monthly log files to be processed using the logs_to_process setting. Inclusion of the leading MMYYYY will cause the import to fail. Note The MMYYYYlgcsv.csv and MMYYYYvantagelogcsv.csv log files are CSV versions of MMYYYYlg.txt and MMYYYYvantagelog.txt respectively. Either the .txt or .csv version of these files should be used but not both. The monthly log files selected for processing should be chosen carefully as the selected log files will determine the Weather Display data fields available for import. wee_import is able to import the following data from the indicated monthly log files: MMYYYYlg.txt/MMYYlgcsv.csv: average wind speed barometer date and time dew point heat index outside humidity outside temperature rain fall wind direction wind gust speed MMYYYYvantagelog.txt/MMYYYYvantagelogcsv.csv: date and time soil moisture soil temperature solar radiation UV index MMYYYYvantageextrasensorslog.csv: date and time extra humidity 1 extra humidity 2 extra humidity 3 extra humidity 4 extra humidity 5 extra humidity 6 extra temperature 1 extra temperature 2 extra temperature 3 extra temperature 4 extra temperature 5 extra temperature 6 Note Whilst the above log files may contain the indicated data the data may only be imported subject to a suitable field map and in-use WeeWX archive table schema (refer to the [[FieldMap]] option). The default is lg.txt, vantagelog.txt, vantageextrasensorslog.csv .","title":"logs_to_process"},{"location":"utilities/wee_import-config_opt/#source_encoding_2","text":"The Weather Display monthly log file encoding. This option is identical in operation to the CSV source_encoding option but applies to Weather Display imports only. The default is utf-8-sig .","title":"source_encoding"},{"location":"utilities/wee_import-config_opt/#interval_3","text":"Determines how the time interval (WeeWX database field interval ) between successive observations is determined. This option is identical in operation to the CSV interval option but applies to Weather Display monthly log file imports only. As Weather Display log files nominally have entries at one minute intervals the recommended approach is to set interval = 1 . As Weather Display monthly log files can, at times, have missing entries, the use of interval = derive may give incorrect or inconsistent interval values. If then archive_interval for the current WeeWX installation is 1 minute interval = conf may be used. In most cases the most appropriate setting will be interval = 1 . The default is 1 .","title":"interval"},{"location":"utilities/wee_import-config_opt/#qc_3","text":"Determines whether simple quality control checks are applied to imported data. This option is identical in operation to the CSV qc option but applies to Weather Display imports only. The default is True .","title":"qc"},{"location":"utilities/wee_import-config_opt/#calc_missing_3","text":"Determines whether any missing derived observations will be calculated from the imported data. This option is identical in operation to the CSV calc_missing option but applies to Weather Display imports only. The default is True .","title":"calc_missing"},{"location":"utilities/wee_import-config_opt/#txt_delimiter","text":"The character used as the field delimiter in Weather Display text format monthly log files (.txt files). A space is normally used but another character may be used if necessary. This parameter must be included in quotation marks. The default is ' ' .","title":"txt_delimiter"},{"location":"utilities/wee_import-config_opt/#csv_delimiter_1","text":"The character used as the field delimiter in Weather Display csv format monthly log files (.csv files). A comma is normally used but another character may be used if necessary. This parameter must be included in quotation marks. The default is , .","title":"csv_delimiter"},{"location":"utilities/wee_import-config_opt/#decimal_2","text":"The character used as the decimal point in the Weather Display monthly log files. A full stop is frequently used but another character may be used if necessary. This parameter must be included in quotation marks. The default is . .","title":"decimal"},{"location":"utilities/wee_import-config_opt/#ignore_missing_log","text":"Determines whether missing log files are to be ignored or the import aborted. Weather Display log files are complete in themselves and a missing log file will have no effect other than there will be no imported data for the period covered by the missing log file. The default is True .","title":"ignore_missing_log"},{"location":"utilities/wee_import-config_opt/#ignore_invalid_data_3","text":"Determines whether invalid data in a source field is ignored or the import aborted. This option is identical in operation to the CSV ignore_invalid_data option but applies to Weather Display monthly log file imports only. The default is True .","title":"ignore_invalid_data"},{"location":"utilities/wee_import-config_opt/#tranche_3","text":"The number of records written to the WeeWX database in each transaction. This option is identical in operation to the CSV tranche option but applies to Weather Display monthly log file imports only. The default is 250 which should suit most users.","title":"tranche"},{"location":"utilities/wee_import-config_opt/#uv_sensor_2","text":"Enables wee_import to distinguish between the case where a UV sensor is present and the UV index is 0 and the case where no UV sensor is present and UV index is 0. This option is identical in operation to the CSV UV_sensor option but applies to Weather Display monthly log file imports only. The default is True .","title":"UV_sensor"},{"location":"utilities/wee_import-config_opt/#solar_sensor_2","text":"Enables wee_import to distinguish between the case where a solar radiation sensor is present and the solar radiation is 0 and the case where no solar radiation sensor is present and solar radiation is 0. This option is identical in operation to the CSV solar_sensor option but applies to Weather Display monthly log file imports only. The default is True .","title":"solar_sensor"},{"location":"utilities/wee_import-config_opt/#ignore_extreme_temp_hum","text":"Determines whether extreme temperature and humidity values are ignored. Weather Display log files record the value 255 for temperature and humidity fields if no corresponding sensor is present. Setting ignore_extreme_temp_hum = True will cause temperature and humidity values of 255 to be ignored. Setting ignore_extreme_temp_hum = False will cause temperature and humidity values of 255 to be treated as valid data to be imported. The default is True . Note Setting ignore_extreme_temp_hum = False will cause temperature and humidity values of 255 to be imported; however, these values may be rejected by the simple quality control checks implemented if qc = True is used.","title":"ignore_extreme_temp_hum"},{"location":"utilities/wee_import-config_opt/#units_1","text":"The [[Units]] stanza defines the units used in the Weather Display monthly log files. Weather Display monthly log files normally use Metric or US customary units depending on the Log File setting under Units on the Units/Wind Chill tab of the Weather Display Universal Setup . In such cases the units configuration option may be set to Metric or US to select either Metric or US customary units. There is no default. It is also possible to individually specify the log file units used for temperature , pressure , rain and speed . The format for each setting is: obs_type = weewx_unit_name Where obs_type is one of temperature , pressure , rain or speed and weewx_unit_name is the WeeWX unit name of the units used by that particular obs_type. As Weather Display supports a different suite of possible units only a subset of the available WeeWX unit names can be used for some settings. The preferred method for defining the Weather Display log file units is through the use of the units configuration option. When defining the import log file units either the units configuration option should be used or the individual temperature , pressure , rain and >speed units defined but not both. If both the units configuration option is defined as well as the individual temperature , pressure , rain and speed units defined the units configuration option takes precedence and all other units settings are ignored.","title":"[[Units]]"},{"location":"utilities/wee_import-config_opt/#fieldmap_1","text":"The [[FieldMap]] stanza defines the mapping from the Weather Display monthly log data fields to WeeWX archive fields. By default, imported Weather Display data is mapped to the corresponding WeeWX archive fields using a default field map. The default field map will likely suit most users; however, depending on the station capabilities and the in-use WeeWX database schema, a custom field map may be required if Weather Display monthly logs contain data from additional sensors that cannot be stored in the WeeWX archive using the default field map. A custom field map also makes it possible to limit the Weather Display monthly log data fields that are imported into WeeWX. The field map consists of one row per field using the format: weewx_archive_field_name = weather_display_field_name Where weewx_archive_field_name is a field name in the in-use WeeWX archive table schema and weather_display_field_name is a Weather Display import field name. The available Weather Display import field names are listed in the table below. Available import field names Field name Description barometer barometric pressure dewpoint dew point direction wind direction gustspeed wind gust speed heatindex heat index humidity outside humidity hum1 extra humidity 1 hum2 extra humidity 2 hum3 extra humidity 3 hum4 extra humidity 4 hum5 extra humidity 5 hum6 extra humidity 6 radiation solar radiation rainlastmin rainfall in the last 1 minute soilmoist soil moisture soiltemp soil temperature temperature outside temperature temp1 extra temperature 1 temp2 extra temperature 2 temp3 extra temperature 3 temp4 extra temperature 4 temp5 extra temperature 5 temp6 extra temperature 6 uv UV index windspeed average wind speed A mapping is not required for every WeeWX archive field (e.g., the Weather Display monthly logs may not provide inside temperature so no inTemp field mapping is required) and neither does every Weather Display monthly log field need to be included in a mapping (e.g., the Weather Display monthly log field soiltemp may have no data as the station has no soil temperature probe). Note Any WeeWX archive fields that are derived (e.g., dewpoint ) and for which there is no field mapping may be calculated during import by use of the calc_missing option in the [WD] section of the import configuration file. The example Weather Display import configuration file located in the /home/weewx/util/import] or the `/etc/weewx/import directory contains an example field map in the import configuration file comments. There is no default.","title":"[[FieldMap]]"},{"location":"utilities/wee_import-config_opt/#weathercat","text":"The [WeatherCat] section contains the options relating to the import of observational data from WeatherCat monthly .cat files.","title":"[WeatherCat]"},{"location":"utilities/wee_import-config_opt/#directory_2","text":"The full path to the directory containing the year directories that contain the WeatherCat monthly .cat files to be imported. Do not include a trailing / . There is no default.","title":"directory"},{"location":"utilities/wee_import-config_opt/#source_encoding_3","text":"The WeatherCat monthly .cat file encoding. This option is identical in operation to the CSV source_encoding option but applies to WeatherCat imports only. The default is utf-8-sig .","title":"source_encoding"},{"location":"utilities/wee_import-config_opt/#interval_4","text":"Determines how the time interval (WeeWX database field interval ) between successive observations is determined. This option is identical in operation to the CSV interval option but applies to WeatherCat imports only. As WeatherCat monthly .cat files can, at times, have missing entries, the use of interval = derive may give incorrect or inconsistent interval values. Better results may be obtained by using interval = conf if the archive_interval for the current WeeWX installation is the same as the WeatherCat .cat file log interval, or by using interval = x where x is the time interval in minutes used in the WeatherCat monthly .cat file(s). The most appropriate setting will depend on the completeness and (time) accuracy of the WeatherCat data being imported. The default is derive .","title":"interval"},{"location":"utilities/wee_import-config_opt/#qc_4","text":"Determines whether simple quality control checks are applied to imported data. This option is identical in operation to the CSV qc option but applies to WeatherCat imports only. The default is True .","title":"qc"},{"location":"utilities/wee_import-config_opt/#calc_missing_4","text":"Determines whether any missing derived observations will be calculated from the imported data. This option is identical in operation to the CSV calc_missing option but applies to WeatherCat imports only. The default is True .","title":"calc_missing"},{"location":"utilities/wee_import-config_opt/#decimal_3","text":"The character used as the decimal point in the WeatherCat monthly .cat files. This parameter must be included in quotation marks. The default is . .","title":"decimal"},{"location":"utilities/wee_import-config_opt/#tranche_4","text":"The number of records written to the WeeWX database in each transaction. This option is identical in operation to the CSV tranche option but applies to WeatherCat imports only. The default is 250 which should suit most users.","title":"tranche"},{"location":"utilities/wee_import-config_opt/#uv_sensor_3","text":"Enables wee_import to distinguish between the case where a UV sensor is present and the UV index is 0 and the case where no UV sensor is present and UV index is 0. This option is identical in operation to the CSV UV_sensor option but applies to WeatherCat imports only. The default is True .","title":"UV_sensor"},{"location":"utilities/wee_import-config_opt/#solar_sensor_3","text":"Enables wee_import to distinguish between the case where a solar radiation sensor is present and the solar radiation is 0 and the case where no solar radiation sensor is present and solar radiation is 0. This option is identical in operation to the CSV solar_sensor option but applies to WeatherCat imports only. The default is True .","title":"solar_sensor"},{"location":"utilities/wee_import-config_opt/#units_2","text":"The [[Units]] stanza defines the units used in the WeatherCat monthly .cat files. Unit settings are required for temperature , pressure , rain and speed . The format for each setting is: obs_type = weewx_unit_name Where obs_type is one of temperature , pressure , rain or speed and weewx_unit_name is the WeeWX unit name of the units used by that particular obs_type (refer to the Units for details of available WeeWX unit names). As WeatherCat supports a different suite of possible units only a subset of the available WeeWX unit names can be used for some settings. There is no default.","title":"[[Units]]"},{"location":"utilities/wee_import-csv/","text":"Warning Running WeeWX during a wee_import session can lead to abnormal termination of the import. If WeeWX must remain running (e.g., so that live data is not lost) run the wee_import session on another machine or to a second database and merge the in-use and second database once the import is complete. wee_import can import data from a single CSV file. The CSV source file must be structured as follows: The file must have a header row consisting of a comma separated list of field names. The field names can be any valid string as long as each field name is unique within the list. There is no requirement for the field names to be in any particular order as long as the same order is used for the observations on each row in the file. These field names will be mapped to WeeWX field names in the [CSV] section of the import configuration file. Observation data for a given date-time must be listed on a single line with individual fields separated by a comma. The fields must be in the same order as the field names in the header row. Blank fields are represented by the use of white space or no space only between commas. Direction data being imported may be represented as numeric degrees or as a string representing the cardinal, intercardinal and/or secondary intercardinal directions . There must a field that represents the date-time of the observations on each line. This date-time field must be either a Unix epoch timestamp or any date-time format that can be represented using Python strptime() format codes . A CSV file suitable for import by wee_import may look like this: Time,Barometer,Temp,Humidity,Windspeed,Dir,Gust,Dayrain,Radiation,Uv,Comment 28/11/2017 08:00:00,1016.9,24.6,84,1.8,113,8,0,359,3.8,\"start of observations\" 28/11/2017 08:05:00,1016.9,25.1,82,4.8,135,11.3,0,775,4.7, 28/11/2017 08:10:00,1016.9,25.4,80,4.4,127,11.3,0,787,5.1,\"note temperature\" 28/11/2017 08:15:00,1017,25.7,79,3.5,74,11.3,0,800,5.4, 28/11/2017 08:20:00,1016.9,25.9,79,1.6,95,9.7,0,774,5.5, 28/11/2017 08:25:00,1017,25.5,78,2.9,48,9.7,0,303,3.4,\"forecast received\" 28/11/2017 08:30:00,1017.1,25.1,80,3.1,54,9.7,0,190,3.6, or this: Time,Barometer,Temp,Humidity,Windspeed,Dir,Gust,Dayrain,Radiation,Uv 2/1/2017 06:20:00,1006.4,4.8,48,2.8,NE,4,0,349,2.8 2/1/2017 06:25:00,1006.9,5.0,48,3.8,NNE,21.3,0,885,4.3 2/1/2017 06:30:00,1006.8,5.4,47,3.4,North,12.3,0,887,5.3 2/1/2017 06:35:00,1007,5.2,49,5.5,NNE,13.3,0,600,5.4 2/1/2017 06:40:00,1006.9,5.7,49,2.6,ESE,9.7,0,732,5.5 2/1/2017 06:45:00,1007,5.5,48,1.9,Southsoutheast,9.8,0,393,6.4 2/1/2017 06:50:00,1007.1,5.2,50,2.1,southeast,9.9,0,180,6.6 Note Cardinal, intercardinal and/or secondary intercardinal directions may be represented by one, two or three letter abbreviations e.g., N, SE or SSW; by a single word e.g., North, Southwest or Southsouthwest or by hyphenated or spaced words e.g., North West or South-south-west. Capitalisation is ignored as are any spaces, hyphens or other white space. At present only English abbreviations and directions are supported. Mapping data to archive fields \u00b6 The WeeWX archive fields populated during a CSV import depend on the CSV-to-WeeWX field mappings specified in [[FieldMap]] stanza in the import configuration file. If a valid field mapping exists, the WeeWX field exists in the WeeWX archive table schema and provided the mapped CSV field contains valid data, the corresponding WeeWX field will be populated. Note that the CSV import is the only import supported by wee_import that allows any WeeWX archive field to be populated. Note The use of the calc_missing option in the import configuration file may result in a number of derived fields being calculated from the imported data. If these derived fields exist in the in-use database schema they will be saved to the database as well. Step-by-step instructions \u00b6 To import observations from a CSV file: Ensure the source data file is in a directory accessible by the machine that will run wee_import . For the purposes of the following examples the source data file data.csv located in the /var/tmp directory will be used. Make a backup of the WeeWX database in case the import should go awry. Create an import configuration file. In this case we will make a copy of the example CSV import configuration file and save it as csv.conf in the /var/tmp directory: $ cp /home/weewx/util/import/csv-example.conf /var/tmp/csv.conf Confirm that the source option is set to CSV: source = CSV Confirm the following options in the [CSV] section are set: file . The full path and file name of the file containing the CSV formatted data to be imported. delimiter . The single character used to separate fields. interval . Determines how the WeeWX interval field is derived. qc . Determines whether quality control checks are performed on the imported data. calc_missing . Determines whether missing derived observations will be calculated from the imported data. ignore_invalid_data . Determines whether invalid data in a source field is ignored or the import aborted. tranche . The number of records written to the WeeWX database in each transaction. UV_sensor . Whether a UV sensor was installed when the source data was produced. solar_sensor . Whether a solar radiation sensor was installed when the source data was produced. raw_datetime_format . The format of the imported date time field. rain . Determines how the WeeWX rain field is derived. wind_direction . Determines how imported wind direction fields are interpreted. [[FieldMap]] . Defines the mapping between imported data fields and WeeWX archive fields. Also defines the units of measure for each imported field. When first importing data it is prudent to do a dry run import before any data are actually imported. A dry run import will perform all steps of the import without actually writing imported data to the WeeWX database. In addition, consideration should be given to any additional options such as --date . To perform a dry run enter the following command: wee_import --import-config=/var/tmp/csv.conf --dry-run The output should be something like: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... A CSV import from source file '/var/tmp/data.csv' has been requested. Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... 27337 records identified for import. Unique records processed: 27337; Last timestamp: 2018-03-03 06:00:00 AEST (1520020800) Finished dry run import 27337 records were processed and 27337 unique records would have been imported. The output includes details about the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. Upon completion a brief summary of the records processed is provided. Once the dry run results are satisfactory the data can be imported using the following command: wee_import --import-config=/var/tmp/csv.conf This will result in a short preamble similar to that from the dry run. At the end of the preamble there will be a prompt: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... A CSV import from source file '/var/tmp/data.csv' has been requested. Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... 27337 records identified for import. Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If the import parameters are acceptable enter y to proceed with the import or n to abort the import. If the import is confirmed the source data will be imported, processed and saved in the WeeWX database. Information on the progress of the import will be displayed similar to the following: Unique records processed: 3250; Last timestamp: 2017-12-09 14:45:00 AEST (1512794700) The line commencing with Unique records processed should update as records are imported with progress information on number of records processed, number of unique records imported and the date time of the latest record processed. Once the initial import is complete wee_import will, if requested, calculate any missing derived observations and rebuild the daily summaries. A brief summary should be displayed similar to the following: Calculating missing derived observations... Processing record: 27337; Last record: 2018-03-03 06:00:00 AEST (1520020800) Recalculating daily summaries... Records processed: 27337; Last date: 2018-03-03 06:00:00 AEST (1520020800) Finished recalculating daily summaries Finished calculating missing derived observations When the import is complete a brief summary is displayed similar to the following: Finished import 27337 records were processed and 27337 unique records imported in 113.91 seconds. Those records with a timestamp already in the archive will not have been imported. Confirm successful import in the WeeWX log file. Whilst wee_import will advise of the number of records processed and the number of unique records found, wee_import does know how many, if any, of the imported records were successfully saved to the database. You should look carefully through the WeeWX log file covering the wee_import session and take note of any records that were not imported. The most common reason for imported records not being saved to the database is because a record with that timestamp already exists in the database, in such cases something similar to the following will be found in the log: Aug 22 14:38:28 stretch12 wee_import[1226] ERROR weewx.manager: Unable to add record 2018-09-04 04:20:00 AEST (1535998800) to database 'weewx.sdb': UNIQUE constraint failed: archive.dateTime In such cases you should take note of the timestamp of the record(s) concerned and make a decision about whether to delete the pre-existing record and re-import the record or retain the pre-existing record.","title":"CSV"},{"location":"utilities/wee_import-csv/#mapping-data-to-archive-fields","text":"The WeeWX archive fields populated during a CSV import depend on the CSV-to-WeeWX field mappings specified in [[FieldMap]] stanza in the import configuration file. If a valid field mapping exists, the WeeWX field exists in the WeeWX archive table schema and provided the mapped CSV field contains valid data, the corresponding WeeWX field will be populated. Note that the CSV import is the only import supported by wee_import that allows any WeeWX archive field to be populated. Note The use of the calc_missing option in the import configuration file may result in a number of derived fields being calculated from the imported data. If these derived fields exist in the in-use database schema they will be saved to the database as well.","title":"Mapping data to archive fields"},{"location":"utilities/wee_import-csv/#step-by-step-instructions","text":"To import observations from a CSV file: Ensure the source data file is in a directory accessible by the machine that will run wee_import . For the purposes of the following examples the source data file data.csv located in the /var/tmp directory will be used. Make a backup of the WeeWX database in case the import should go awry. Create an import configuration file. In this case we will make a copy of the example CSV import configuration file and save it as csv.conf in the /var/tmp directory: $ cp /home/weewx/util/import/csv-example.conf /var/tmp/csv.conf Confirm that the source option is set to CSV: source = CSV Confirm the following options in the [CSV] section are set: file . The full path and file name of the file containing the CSV formatted data to be imported. delimiter . The single character used to separate fields. interval . Determines how the WeeWX interval field is derived. qc . Determines whether quality control checks are performed on the imported data. calc_missing . Determines whether missing derived observations will be calculated from the imported data. ignore_invalid_data . Determines whether invalid data in a source field is ignored or the import aborted. tranche . The number of records written to the WeeWX database in each transaction. UV_sensor . Whether a UV sensor was installed when the source data was produced. solar_sensor . Whether a solar radiation sensor was installed when the source data was produced. raw_datetime_format . The format of the imported date time field. rain . Determines how the WeeWX rain field is derived. wind_direction . Determines how imported wind direction fields are interpreted. [[FieldMap]] . Defines the mapping between imported data fields and WeeWX archive fields. Also defines the units of measure for each imported field. When first importing data it is prudent to do a dry run import before any data are actually imported. A dry run import will perform all steps of the import without actually writing imported data to the WeeWX database. In addition, consideration should be given to any additional options such as --date . To perform a dry run enter the following command: wee_import --import-config=/var/tmp/csv.conf --dry-run The output should be something like: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... A CSV import from source file '/var/tmp/data.csv' has been requested. Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... 27337 records identified for import. Unique records processed: 27337; Last timestamp: 2018-03-03 06:00:00 AEST (1520020800) Finished dry run import 27337 records were processed and 27337 unique records would have been imported. The output includes details about the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. Upon completion a brief summary of the records processed is provided. Once the dry run results are satisfactory the data can be imported using the following command: wee_import --import-config=/var/tmp/csv.conf This will result in a short preamble similar to that from the dry run. At the end of the preamble there will be a prompt: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... A CSV import from source file '/var/tmp/data.csv' has been requested. Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... 27337 records identified for import. Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If the import parameters are acceptable enter y to proceed with the import or n to abort the import. If the import is confirmed the source data will be imported, processed and saved in the WeeWX database. Information on the progress of the import will be displayed similar to the following: Unique records processed: 3250; Last timestamp: 2017-12-09 14:45:00 AEST (1512794700) The line commencing with Unique records processed should update as records are imported with progress information on number of records processed, number of unique records imported and the date time of the latest record processed. Once the initial import is complete wee_import will, if requested, calculate any missing derived observations and rebuild the daily summaries. A brief summary should be displayed similar to the following: Calculating missing derived observations... Processing record: 27337; Last record: 2018-03-03 06:00:00 AEST (1520020800) Recalculating daily summaries... Records processed: 27337; Last date: 2018-03-03 06:00:00 AEST (1520020800) Finished recalculating daily summaries Finished calculating missing derived observations When the import is complete a brief summary is displayed similar to the following: Finished import 27337 records were processed and 27337 unique records imported in 113.91 seconds. Those records with a timestamp already in the archive will not have been imported. Confirm successful import in the WeeWX log file. Whilst wee_import will advise of the number of records processed and the number of unique records found, wee_import does know how many, if any, of the imported records were successfully saved to the database. You should look carefully through the WeeWX log file covering the wee_import session and take note of any records that were not imported. The most common reason for imported records not being saved to the database is because a record with that timestamp already exists in the database, in such cases something similar to the following will be found in the log: Aug 22 14:38:28 stretch12 wee_import[1226] ERROR weewx.manager: Unable to add record 2018-09-04 04:20:00 AEST (1535998800) to database 'weewx.sdb': UNIQUE constraint failed: archive.dateTime In such cases you should take note of the timestamp of the record(s) concerned and make a decision about whether to delete the pre-existing record and re-import the record or retain the pre-existing record.","title":"Step-by-step instructions"},{"location":"utilities/wee_import-cumulus/","text":"Warning Running WeeWX during a wee_import session can lead to abnormal termination of the import. If WeeWX must remain running (e.g., so that live data is not lost) run the wee_import session on another machine or to a second database and merge the in-use and second database once the import is complete. wee_import can import observational data from the one or more Cumulus monthly log files. A Cumulus monthly log file records weather station observations for a single month. These files are accumulated over time and can be considered analogous to the WeeWX archive table. When wee_import imports data from the Cumulus monthly log files each log file is considered a 'period'. wee_import processes one period at a time in chronological order (oldest to newest) and provides import summary data on a per period basis. Mapping data to archive fields \u00b6 A Cumulus monthly log file import will populate the WeeWX archive fields as follows: Provided data exists for each field in the Cumulus monthly logs, the following WeeWX archive fields will be directly populated by imported data: dateTime barometer dewpoint heatindex inHumidity inTemp outHumidity outTemp radiation rain rainRate UV windDir windGust windSpeed windchill Note If a field in the Cumulus monthly log file has no data the corresponding WeeWX archive field will be set to None/null . The following WeeWX archive fields will be populated from other settings or configuration options: interval usUnits The following WeeWX archive fields will be populated with values derived from the imported data provided calc_missing = True is included in the [Cumulus] section of the import configuration file being used and the field exists in the in-use WeeWX archive table schema. altimeter ET pressure Note If calc_missing = False is included in the [Cumulus] section of the import configuration file being used then all of the above fields will be set to None/null . The calc_missing option default is True . Step-by-step instructions \u00b6 To import observations from one or more Cumulus monthly log files: Ensure the Cumulus monthly log file(s) to be used for the import are located in a directory accessible by the machine that will run wee_import . For the purposes of the following examples, there are nine monthly logs files covering the period October 2016 to June 2017, inclusive, located in the /var/tmp/cumulus directory. Make a backup of the WeeWX database in case the import should go awry. Create an import configuration file. In this case we will make a copy of the example Cumulus import configuration file and save it as cumulus.conf in the /var/tmp directory: $ cp /home/weewx/util/import/cumulus-example.conf /var/tmp/cumulus.conf Confirm the source option is set to Cumulus: source = Cumulus Confirm that the following options in the [Cumulus] section are correctly set: directory . The full path to the directory containing the Cumulus monthly log files to be used as the source of the imported data. interval . Determines how the WeeWX interval field is derived. qc . Determines whether quality control checks are performed on the imported data. calc_missing . Determines whether missing derived observations will be calculated from the imported data. separator . The date field separator used in the Cumulus monthly log files. delimiter . The field delimiter used in the Cumulus monthly log files. decimal . The decimal point character used in the Cumulus monthly log files. ignore_invalid_data . Determines whether invalid data in a source field is ignored or the import aborted. tranche . The number of records written to the WeeWX database in each transaction. UV_sensor . Whether a UV sensor was installed when the source data was produced. solar_sensor . Whether a solar radiation sensor was installed when the source data was produced. [[Units]] . Defines the units used in the Cumulus monthly log files. When first importing data it is prudent to do a dry run import before any data is actually imported. A dry run import will perform all steps of the import without actually writing imported data to the WeeWX database. In addition, consideration should be given to any additional options to be used such as --date . To perform a dry run enter the following command: wee_import --import-config=/var/tmp/cumulus.conf --dry-run This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Cumulus monthly log files in the '/var/tmp/cumulus' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Unique records processed: 8858; Last timestamp: 2016-10-31 23:55:00 AEST (1477922100) Period 2 ... Unique records processed: 8636; Last timestamp: 2016-11-30 23:55:00 AEST (1480514100) Period 3 ... Unique records processed: 8925; Last timestamp: 2016-12-31 23:55:00 AEST (1483192500) Period 4 ... Unique records processed: 8908; Last timestamp: 2017-01-31 23:55:00 AEST (1485870900) Period 5 ... Unique records processed: 8029; Last timestamp: 2017-02-28 23:55:00 AEST (1488290100) Period 6 ... Unique records processed: 8744; Last timestamp: 2017-03-31 23:55:00 AEST (1490968500) Period 7 ... Unique records processed: 8489; Last timestamp: 2017-04-30 23:02:00 AEST (1493557320) Period 8 ... Unique records processed: 8754; Last timestamp: 2017-05-31 23:55:00 AEST (1496238900) Period 9 ... Unique records processed: 8470; Last timestamp: 2017-06-30 23:55:00 AEST (1498830900) Finished dry run import 77813 records were processed and 77813 unique records would have been imported. Note The nine periods correspond to the nine monthly log files used for this import. Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing Cumulus monthly log file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. Once the dry run results are satisfactory the data can be imported using the following command: wee_import --import-config=/var/tmp/cumulus.conf This will result in a preamble similar to that of a dry run. At the end of the preamble there will be a prompt: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Cumulus monthly log files in the '/var/tmp/cumulus' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If there is more than one Cumulus monthly log file then wee_import will provide summary information on a per period basis during the import. In addition, if the --date option is used then source data that falls outside the date or date range specified with the --date option is ignored. In such cases the preamble may look similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Cumulus monthly log files in the '/var/tmp/cumulus' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Period 1 - no records identified for import. Period 2 ... Period 2 - no records identified for import. Period 3 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If the import parameters are acceptable enter y to proceed with the import or n to abort the import. If the import is confirmed, the source data will be imported, processed and saved in the WeeWX database. Information on the progress of the import will be displayed similar to the following: Unique records processed: 2305; Last timestamp: 2016-12-30 00:00:00 AEST (1483020000) Again if there is more than one Cumulus monthly log file and if the --date option is used the progress information may instead look similar to: Period 4 ... Unique records processed: 8908; Last timestamp: 2017-01-31 23:55:00 AEST (1485870900) Period 5 ... Unique records processed: 8029; Last timestamp: 2017-02-28 23:55:00 AEST (1488290100) Period 6 ... Unique records processed: 8744; Last timestamp: 2017-03-31 23:55:00 AEST (1490968500) Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing Cumulus monthly log file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. The line commencing with Unique records processed should update as records are imported with progress information on number of records processed, number of unique records imported and the date time of the latest record processed. If the import spans multiple months (ie multiple monthly log files) then a new Period line is created for each month. Once the initial import is complete wee_import will, if requested, calculate any missing derived observations and rebuild the daily summaries. A brief summary should be displayed similar to the following: Calculating missing derived observations ... Processing record: 77782; Last record: 2017-06-30 00:00:00 AEST (1519826400) Recalculating daily summaries... Records processed: 77000; Last date: 2017-06-28 11:45:00 AEST (1519811100) Finished recalculating daily summaries Finished calculating missing derived observations When the import is complete a brief summary is displayed similar to the following: Finished import 77813 records were processed and 77813 unique records imported in 106.96 seconds. Those records with a timestamp already in the archive will not have been imported. Confirm successful import in the WeeWX log file. Whilst wee_import will advise of the number of records processed and the number of unique records found, wee_import does know how many, if any, of the imported records were successfully saved to the database. You should look carefully through the WeeWX log file covering the wee_import session and take note of any records that were not imported. The most common reason for imported records not being saved to the database is because a record with that timestamp already exists in the database, in such cases something similar to the following will be found in the log: Aug 22 14:38:28 stretch12 weewx[863]: manager: unable to add record 2018-09-04 04:20:00 AEST (1535998800) to database 'weewx.sdb': UNIQUE constraint failed: archive.dateTime In such cases take note of the timestamp of the record(s) concerned and make a decision about whether to delete the pre-existing record and re-import the record or retain the pre-existing record.","title":"Cumulus"},{"location":"utilities/wee_import-cumulus/#mapping-data-to-archive-fields","text":"A Cumulus monthly log file import will populate the WeeWX archive fields as follows: Provided data exists for each field in the Cumulus monthly logs, the following WeeWX archive fields will be directly populated by imported data: dateTime barometer dewpoint heatindex inHumidity inTemp outHumidity outTemp radiation rain rainRate UV windDir windGust windSpeed windchill Note If a field in the Cumulus monthly log file has no data the corresponding WeeWX archive field will be set to None/null . The following WeeWX archive fields will be populated from other settings or configuration options: interval usUnits The following WeeWX archive fields will be populated with values derived from the imported data provided calc_missing = True is included in the [Cumulus] section of the import configuration file being used and the field exists in the in-use WeeWX archive table schema. altimeter ET pressure Note If calc_missing = False is included in the [Cumulus] section of the import configuration file being used then all of the above fields will be set to None/null . The calc_missing option default is True .","title":"Mapping data to archive fields"},{"location":"utilities/wee_import-cumulus/#step-by-step-instructions","text":"To import observations from one or more Cumulus monthly log files: Ensure the Cumulus monthly log file(s) to be used for the import are located in a directory accessible by the machine that will run wee_import . For the purposes of the following examples, there are nine monthly logs files covering the period October 2016 to June 2017, inclusive, located in the /var/tmp/cumulus directory. Make a backup of the WeeWX database in case the import should go awry. Create an import configuration file. In this case we will make a copy of the example Cumulus import configuration file and save it as cumulus.conf in the /var/tmp directory: $ cp /home/weewx/util/import/cumulus-example.conf /var/tmp/cumulus.conf Confirm the source option is set to Cumulus: source = Cumulus Confirm that the following options in the [Cumulus] section are correctly set: directory . The full path to the directory containing the Cumulus monthly log files to be used as the source of the imported data. interval . Determines how the WeeWX interval field is derived. qc . Determines whether quality control checks are performed on the imported data. calc_missing . Determines whether missing derived observations will be calculated from the imported data. separator . The date field separator used in the Cumulus monthly log files. delimiter . The field delimiter used in the Cumulus monthly log files. decimal . The decimal point character used in the Cumulus monthly log files. ignore_invalid_data . Determines whether invalid data in a source field is ignored or the import aborted. tranche . The number of records written to the WeeWX database in each transaction. UV_sensor . Whether a UV sensor was installed when the source data was produced. solar_sensor . Whether a solar radiation sensor was installed when the source data was produced. [[Units]] . Defines the units used in the Cumulus monthly log files. When first importing data it is prudent to do a dry run import before any data is actually imported. A dry run import will perform all steps of the import without actually writing imported data to the WeeWX database. In addition, consideration should be given to any additional options to be used such as --date . To perform a dry run enter the following command: wee_import --import-config=/var/tmp/cumulus.conf --dry-run This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Cumulus monthly log files in the '/var/tmp/cumulus' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Unique records processed: 8858; Last timestamp: 2016-10-31 23:55:00 AEST (1477922100) Period 2 ... Unique records processed: 8636; Last timestamp: 2016-11-30 23:55:00 AEST (1480514100) Period 3 ... Unique records processed: 8925; Last timestamp: 2016-12-31 23:55:00 AEST (1483192500) Period 4 ... Unique records processed: 8908; Last timestamp: 2017-01-31 23:55:00 AEST (1485870900) Period 5 ... Unique records processed: 8029; Last timestamp: 2017-02-28 23:55:00 AEST (1488290100) Period 6 ... Unique records processed: 8744; Last timestamp: 2017-03-31 23:55:00 AEST (1490968500) Period 7 ... Unique records processed: 8489; Last timestamp: 2017-04-30 23:02:00 AEST (1493557320) Period 8 ... Unique records processed: 8754; Last timestamp: 2017-05-31 23:55:00 AEST (1496238900) Period 9 ... Unique records processed: 8470; Last timestamp: 2017-06-30 23:55:00 AEST (1498830900) Finished dry run import 77813 records were processed and 77813 unique records would have been imported. Note The nine periods correspond to the nine monthly log files used for this import. Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing Cumulus monthly log file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. Once the dry run results are satisfactory the data can be imported using the following command: wee_import --import-config=/var/tmp/cumulus.conf This will result in a preamble similar to that of a dry run. At the end of the preamble there will be a prompt: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Cumulus monthly log files in the '/var/tmp/cumulus' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If there is more than one Cumulus monthly log file then wee_import will provide summary information on a per period basis during the import. In addition, if the --date option is used then source data that falls outside the date or date range specified with the --date option is ignored. In such cases the preamble may look similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Cumulus monthly log files in the '/var/tmp/cumulus' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Period 1 - no records identified for import. Period 2 ... Period 2 - no records identified for import. Period 3 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If the import parameters are acceptable enter y to proceed with the import or n to abort the import. If the import is confirmed, the source data will be imported, processed and saved in the WeeWX database. Information on the progress of the import will be displayed similar to the following: Unique records processed: 2305; Last timestamp: 2016-12-30 00:00:00 AEST (1483020000) Again if there is more than one Cumulus monthly log file and if the --date option is used the progress information may instead look similar to: Period 4 ... Unique records processed: 8908; Last timestamp: 2017-01-31 23:55:00 AEST (1485870900) Period 5 ... Unique records processed: 8029; Last timestamp: 2017-02-28 23:55:00 AEST (1488290100) Period 6 ... Unique records processed: 8744; Last timestamp: 2017-03-31 23:55:00 AEST (1490968500) Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing Cumulus monthly log file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. The line commencing with Unique records processed should update as records are imported with progress information on number of records processed, number of unique records imported and the date time of the latest record processed. If the import spans multiple months (ie multiple monthly log files) then a new Period line is created for each month. Once the initial import is complete wee_import will, if requested, calculate any missing derived observations and rebuild the daily summaries. A brief summary should be displayed similar to the following: Calculating missing derived observations ... Processing record: 77782; Last record: 2017-06-30 00:00:00 AEST (1519826400) Recalculating daily summaries... Records processed: 77000; Last date: 2017-06-28 11:45:00 AEST (1519811100) Finished recalculating daily summaries Finished calculating missing derived observations When the import is complete a brief summary is displayed similar to the following: Finished import 77813 records were processed and 77813 unique records imported in 106.96 seconds. Those records with a timestamp already in the archive will not have been imported. Confirm successful import in the WeeWX log file. Whilst wee_import will advise of the number of records processed and the number of unique records found, wee_import does know how many, if any, of the imported records were successfully saved to the database. You should look carefully through the WeeWX log file covering the wee_import session and take note of any records that were not imported. The most common reason for imported records not being saved to the database is because a record with that timestamp already exists in the database, in such cases something similar to the following will be found in the log: Aug 22 14:38:28 stretch12 weewx[863]: manager: unable to add record 2018-09-04 04:20:00 AEST (1535998800) to database 'weewx.sdb': UNIQUE constraint failed: archive.dateTime In such cases take note of the timestamp of the record(s) concerned and make a decision about whether to delete the pre-existing record and re-import the record or retain the pre-existing record.","title":"Step-by-step instructions"},{"location":"utilities/wee_import-troubleshoot/","text":"Dealing with import failures \u00b6 Sometimes bad things happen during an import. If errors were encountered, or if you suspect that the WeeWX database has been contaminated with incorrect data, here are some things you can try to fix things up. Manually delete the contaminated data. Use SQL commands to manipulate the data in the WeeWX archive database. The simplicity of this process will depend on your ability to use SQL, the amount of data imported, and whether the imported data was dispersed amongst existing. Once contaminated data have been removed the daily summary tables will need to be rebuilt using the weectl database rebuild-daily utility. Delete the database and start over. For SQLite, simply delete the database file. For MySQL, drop the database. Then try the import again. Warning Deleting the database file or dropping the database will result in all data in the database being lost. If the above steps are not appropriate the database should be restored from backup. You did make a backup before starting the import?","title":"Troubleshooting"},{"location":"utilities/wee_import-troubleshoot/#import_failures","text":"Sometimes bad things happen during an import. If errors were encountered, or if you suspect that the WeeWX database has been contaminated with incorrect data, here are some things you can try to fix things up. Manually delete the contaminated data. Use SQL commands to manipulate the data in the WeeWX archive database. The simplicity of this process will depend on your ability to use SQL, the amount of data imported, and whether the imported data was dispersed amongst existing. Once contaminated data have been removed the daily summary tables will need to be rebuilt using the weectl database rebuild-daily utility. Delete the database and start over. For SQLite, simply delete the database file. For MySQL, drop the database. Then try the import again. Warning Deleting the database file or dropping the database will result in all data in the database being lost. If the above steps are not appropriate the database should be restored from backup. You did make a backup before starting the import?","title":"Dealing with import failures"},{"location":"utilities/wee_import-wd/","text":"Warning Running WeeWX during a wee_import session can lead to abnormal termination of the import. If WeeWX must remain running (e.g., so that live data is not lost) run the wee_import session on another machine or to a second database and merge the in-use and second database once the import is complete. wee_import can import observational data from the one or more Weather Display monthly log files. Weather Display records observational data on a monthly basis in a number of either space delimited (.txt) and/or comma separated (.csv) text files. wee_import can import observational data from the following Weather Display log files: MMYYYYlg.txt MMYYYYlgcsv.csv (csv format version of MMYYYYlg.txt) MMYYYYvantagelog.txt MMYYYYvantagelogcsv.csv (csv format version of MMYYYYvantagelog.txt) MMYYYYvantageextrasensorslog.csv where MM is a one or two-digit month and YYYY is a four digit year The Weather Display monthly log files record observational data using a nominal one-minute interval with each file recording various observations for the month and year designated by the MM and YYYY components of the file name. These files are accumulated over time and can be considered analogous to the WeeWX archive table. When wee_import imports data from the Weather Display monthly log files each set of log files for a given month and year is considered a 'period'. wee_import processes one period at a time in chronological order (oldest to newest) and provides import summary data on a per period basis. Mapping data to archive fields \u00b6 The WeeWX archive fields populated during the import of Weather Display data depends on the field mapping specified in [[FieldMap]] stanza in the import configuration file. A given WeeWX field will be populated if: a valid field mapping exists, the WeeWX field exists in the WeeWX archive table schema, and the mapped Weather Display field contains valid data. The following WeeWX archive fields will be populated from other settings or configuration options and need not be included in the field map: interval usUnits The following WeeWX archive fields will be populated with values derived from the imported data provided calc_missing = True is included in the [WD] section of the import configuration file being used and the field exists in the in-use WeeWX archive table schema: altimeter pressure rainRate windchill Note If calc_missing = False is included in the [WD] section of the import configuration file being used then all of the above fields will be set to None/null . The calc_missing option default is True . Step-by-step instructions \u00b6 To import observations from one or more Weather Display monthly log files: Ensure the Weather Display monthly log file(s) to be used for the import are located in a directory accessible by the machine that will run wee_import . For the purposes of the following examples, there are five months of logs files covering the period September 2018 to January 2019 inclusive located in the /var/tmp/wd directory. Make a backup of the WeeWX database in case the import should go awry. Create an import configuration file, this is easily done by making a copy of the example Weather Display import configuration file located in the /home/weewx/util/import or /etc/weewx/import directory as applicable. In this case we will make a copy of the example Weather Display import configuration file and save it as wd.conf in the /var/tmp directory: $ cp /home/weewx/util/import/wd-example.conf /var/tmp/wd.conf Confirm that the source option is set to WD: source = WD Confirm that the following options in the [WD] section are correctly set: directory . The full path to the directory containing the Weather Display monthly log files to be used as the source of the imported data. logs_to_process . Specifies the Weather Display monthly log files to be used to import data. interval . Determines how the WeeWX interval field is derived. qc . Determines whether quality control checks are performed on the imported data. calc_missing . Determines whether missing derived observations will be calculated from the imported data. txt_delimiter . The field delimiter used in the Weather Display space delimited (*.txt) monthly log files. csv_delimiter . The field delimiter used in the Weather Display monthly comma separated values (*.csv) monthly log files. decimal . The decimal point character used in the Weather Display monthly log files. ignore_missing_log . Determines whether missing log files are to be ignored or the import aborted. ignore_invalid_data . Determines whether invalid data in a source field is ignored or the import aborted. tranche . The number of records written to the WeeWX database in each transaction. UV_sensor . Whether a UV sensor was installed when the source data was produced. solar_sensor . Whether a solar radiation sensor was installed when the source data was produced. ignore_extreme_temp_hum . Determines whether temperature and humidity values of 255 will be ignored. [[Units]] . Defines the units used in the Weather Display monthly log files. [[FieldMap]] . Defines the mapping between imported data fields and WeeWX archive fields. When first importing data it is prudent to do a dry run import before any data is actually imported. A dry run import will perform all steps of the import without actually writing imported data to the WeeWX database. In addition, consideration should be given to any additional options to be used such as --date . Note Due to some peculiarities of the Weather Display log structure it may be prudent to use the --suppress-warnings option during the initial dry run so the overall progress of the import can be observed. To perform a dry run enter the following command: wee_import --import-config=/var/tmp/wd.conf --dry-run --suppress-warnings This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Weather Display monthly log files in the '/var/tmp/WD' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Unique records processed: 43183; Last timestamp: 2018-09-30 23:59:00 AEST (1538315940) Period 2 ... Unique records processed: 44620; Last timestamp: 2018-10-31 23:59:00 AEST (1540994340) Period 3 ... Unique records processed: 43136; Last timestamp: 2018-11-30 23:59:00 AEST (1543586340) Period 4 ... Unique records processed: 44633; Last timestamp: 2018-12-31 23:59:00 AEST (1546264740) Period 5 ... Unique records processed: 8977; Last timestamp: 2019-01-07 05:43:00 AEST (1546803780) Finished dry run import 184765 records were processed and 184549 unique records would have been imported. 216 duplicate records were ignored. Note The five periods correspond to the five months of log files used for this import. Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing Weather Display log file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. If the --suppress-warnings option was used it may be prudent to do a second dry run this time without the --suppress-warnings option. This will allow any warnings generated by the dry run import to be observed: wee_import --import-config=/var/tmp/wd.conf --dry-run This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Weather Display monthly log files in the '/var/tmp/WD' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Warning: Import field 'radiation' is mapped to WeeWX field 'radiation' but the import field 'radiation' could not be found in one or more records. WeeWX field 'radiation' will be set to 'None' in these records. Warning: Import field 'soiltemp' is mapped to WeeWX field 'soilTemp1' but the import field 'soiltemp' could not be found in one or more records. WeeWX field 'soilTemp1' will be set to 'None' in these records. Warning: Import field 'soilmoist' is mapped to WeeWX field 'soilMoist1' but the import field 'soilmoist' could not be found in one or more records. WeeWX field 'soilMoist1' will be set to 'None' in these records. Warning: Import field 'humidity' is mapped to WeeWX field 'outHumidity' but the import field 'humidity' could not be found in one or more records. WeeWX field 'outHumidity' will be set to 'None' in these records. Warning: Import field 'heatindex' is mapped to WeeWX field 'heatindex' but the import field 'heatindex' could not be found in one or more records. WeeWX field 'heatindex' will be set to 'None' in these records. Warning: Import field 'windspeed' is mapped to WeeWX field 'windSpeed' but the import field 'windspeed' could not be found in one or more records. WeeWX field 'windSpeed' will be set to 'None' in these records. Warning: Import field 'barometer' is mapped to WeeWX field 'barometer' but the import field 'barometer' could not be found in one or more records. WeeWX field 'barometer' will be set to 'None' in these records. Warning: Import field 'dewpoint' is mapped to WeeWX field 'dewpoint' but the import field 'dewpoint' could not be found in one or more records. WeeWX field 'dewpoint' will be set to 'None' in these records. Warning: Import field 'rainlastmin' is mapped to WeeWX field 'rain' but the import field 'rainlastmin' could not be found in one or more records. WeeWX field 'rain' will be set to 'None' in these records. Warning: Import field 'direction' is mapped to WeeWX field 'windDir' but the import field 'direction' could not be found in one or more records. WeeWX field 'windDir' will be set to 'None' in these records. Warning: Import field 'temperature' is mapped to WeeWX field 'outTemp' but the import field 'temperature' could not be found in one or more records. WeeWX field 'outTemp' will be set to 'None' in these records. Warning: Import field 'gustspeed' is mapped to WeeWX field 'windGust' but the import field 'gustspeed' could not be found in one or more records. WeeWX field 'windGust' will be set to 'None' in these records. Unique records processed: 43183; Last timestamp: 2018-09-30 23:59:00 AEST (1538315940) Period 2 ... Unique records processed: 44620; Last timestamp: 2018-10-31 23:59:00 AEST (1540994340) Period 3 ... Unique records processed: 43136; Last timestamp: 2018-11-30 23:59:00 AEST (1543586340) Period 4 ... Unique records processed: 44633; Last timestamp: 2018-12-31 23:59:00 AEST (1546264740) Period 5 ... Unique records processed: 8977; Last timestamp: 2019-01-07 05:43:00 AEST (1546803780) 6 duplicate records were identified in period 5: 2019-01-04 10:31:00 AEST (1546561860) 2019-01-04 10:32:00 AEST (1546561920) 2019-01-04 10:33:00 AEST (1546561980) 2019-01-04 10:34:00 AEST (1546562040) 2019-01-04 10:35:00 AEST (1546562100) 2019-01-04 10:36:00 AEST (1546562160) Finished dry run import 184555 records were processed and 184549 unique records would have been imported. 6 duplicate records were ignored. In this case the following warnings are evident: Period one had 12 warnings for import fields that were mapped to WeeWX data fields but for which no data was found. This could be a sign that a complete month of data or a significant portion of the month could be missing, or it could be a case of just the first record of the month is missing (a significant number of Weather Display monthly log files have been found to be missing the first record of the month). In most cases this warning can be ignored. Period five shows warnings for six entries in the period that have duplicate timestamps. This could be a sign that there is a problem in one or more of the Weather Display monthly log files for that month. However, anecdotally it has been found that duplicate entries often exist in one or more Weather Display monthly log files. If the duplicates are to be ignored then such warnings can be ignored otherwise the incorrect data should be removed from the affected log files before import. Once the dry run results are satisfactory the data can be imported using the following command: wee_import --import-config=/var/tmp/wd.conf --suppress-warnings Note The --suppress-warnings option has been used to suppress the previously encountered warnings. This will result in a preamble similar to that of a dry run. At the end of the preamble there will be a prompt: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Weather Display monthly log files in the '/var/tmp/WD' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If there is more than one month of Weather Display monthly log files then wee_import will provide summary information on a per period basis during the import. In addition, if the --date option is used then source data that falls outside the date or date range specified with the --date option is ignored. In such cases the preamble may look similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Weather Display monthly log files in the '/var/tmp/WD' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Observations timestamped after 2018-10-12 00:00:00 AEST (1539266400) and up to and including 2018-10-13 00:00:00 AEST (1539352800) will be imported. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Period 1 - no records identified for import. Period 2 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If the import parameters are acceptable enter y to proceed with the import or n to abort the import. If the import is confirmed, the source data will be imported, processed and saved in the WeeWX database. Information on the progress of the import will be displayed similar to the following: Unique records processed: 1250; Last timestamp: 2018-12-01 20:49:00 AEST (1543661340) Again if there is more than one month of Weather Display monthly log files and if the --date option is used the progress information may instead look similar to: Period 2 ... Unique records processed: 44620; Last timestamp: 2018-10-31 23:59:00 AEST (1540994340) Period 3 ... Unique records processed: 43136; Last timestamp: 2018-11-30 23:59:00 AEST (1543586340) Period 4 ... Unique records processed: 12000; Last timestamp: 2018-12-09 07:59:00 AEST (1544306340) Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing Weather Display log file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. The line commencing with Unique records processed should update as records are imported with progress information on number of unique records processed and the date time of the latest record processed. If the import spans multiple months then a new Period line is created for each month. Once the initial import is complete wee_import will, if requested, calculate any missing derived observations and rebuild the daily summaries. A brief summary should be displayed similar to the following: Calculating missing derived observations ... Processing record: 184549; Last record: 2019-01-08 00:00:00 AEST (1546869600) Recalculating daily summaries... Records processed: 184000; Last date: 2019-01-06 20:34:00 AEST (1546770840) Finished recalculating daily summaries Finished calculating missing derived observations When the import is complete a brief summary is displayed similar to the following: Finished import 184765 records were processed and 184549 unique records imported in 699.27 seconds. 216 duplicate records were ignored. Those records with a timestamp already in the archive will not have been imported. Confirm successful import in the WeeWX log file. Whilst wee_import will advise of the number of unique records imported, wee_import does know how many, if any, of the imported records were successfully saved to the database. You should look carefully through the WeeWX log file covering the wee_import session and take note of any records that were not imported. The most common reason for imported records not being saved to the database is because a record with that timestamp already exists in the database, in such cases something similar to the following will be found in the log: Aug 22 14:38:28 stretch12 weewx[863]: manager: unable to add record 2018-09-04 04:20:00 AEST (1535998800) to database 'weewx.sdb': UNIQUE constraint failed: archive.dateTime In such cases take note of the timestamp of the record(s) concerned and make a decision about whether to delete the pre-existing record and re-import the record or retain the pre-existing record.","title":"Weather Display"},{"location":"utilities/wee_import-wd/#mapping-data-to-archive-fields","text":"The WeeWX archive fields populated during the import of Weather Display data depends on the field mapping specified in [[FieldMap]] stanza in the import configuration file. A given WeeWX field will be populated if: a valid field mapping exists, the WeeWX field exists in the WeeWX archive table schema, and the mapped Weather Display field contains valid data. The following WeeWX archive fields will be populated from other settings or configuration options and need not be included in the field map: interval usUnits The following WeeWX archive fields will be populated with values derived from the imported data provided calc_missing = True is included in the [WD] section of the import configuration file being used and the field exists in the in-use WeeWX archive table schema: altimeter pressure rainRate windchill Note If calc_missing = False is included in the [WD] section of the import configuration file being used then all of the above fields will be set to None/null . The calc_missing option default is True .","title":"Mapping data to archive fields"},{"location":"utilities/wee_import-wd/#step-by-step-instructions","text":"To import observations from one or more Weather Display monthly log files: Ensure the Weather Display monthly log file(s) to be used for the import are located in a directory accessible by the machine that will run wee_import . For the purposes of the following examples, there are five months of logs files covering the period September 2018 to January 2019 inclusive located in the /var/tmp/wd directory. Make a backup of the WeeWX database in case the import should go awry. Create an import configuration file, this is easily done by making a copy of the example Weather Display import configuration file located in the /home/weewx/util/import or /etc/weewx/import directory as applicable. In this case we will make a copy of the example Weather Display import configuration file and save it as wd.conf in the /var/tmp directory: $ cp /home/weewx/util/import/wd-example.conf /var/tmp/wd.conf Confirm that the source option is set to WD: source = WD Confirm that the following options in the [WD] section are correctly set: directory . The full path to the directory containing the Weather Display monthly log files to be used as the source of the imported data. logs_to_process . Specifies the Weather Display monthly log files to be used to import data. interval . Determines how the WeeWX interval field is derived. qc . Determines whether quality control checks are performed on the imported data. calc_missing . Determines whether missing derived observations will be calculated from the imported data. txt_delimiter . The field delimiter used in the Weather Display space delimited (*.txt) monthly log files. csv_delimiter . The field delimiter used in the Weather Display monthly comma separated values (*.csv) monthly log files. decimal . The decimal point character used in the Weather Display monthly log files. ignore_missing_log . Determines whether missing log files are to be ignored or the import aborted. ignore_invalid_data . Determines whether invalid data in a source field is ignored or the import aborted. tranche . The number of records written to the WeeWX database in each transaction. UV_sensor . Whether a UV sensor was installed when the source data was produced. solar_sensor . Whether a solar radiation sensor was installed when the source data was produced. ignore_extreme_temp_hum . Determines whether temperature and humidity values of 255 will be ignored. [[Units]] . Defines the units used in the Weather Display monthly log files. [[FieldMap]] . Defines the mapping between imported data fields and WeeWX archive fields. When first importing data it is prudent to do a dry run import before any data is actually imported. A dry run import will perform all steps of the import without actually writing imported data to the WeeWX database. In addition, consideration should be given to any additional options to be used such as --date . Note Due to some peculiarities of the Weather Display log structure it may be prudent to use the --suppress-warnings option during the initial dry run so the overall progress of the import can be observed. To perform a dry run enter the following command: wee_import --import-config=/var/tmp/wd.conf --dry-run --suppress-warnings This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Weather Display monthly log files in the '/var/tmp/WD' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Unique records processed: 43183; Last timestamp: 2018-09-30 23:59:00 AEST (1538315940) Period 2 ... Unique records processed: 44620; Last timestamp: 2018-10-31 23:59:00 AEST (1540994340) Period 3 ... Unique records processed: 43136; Last timestamp: 2018-11-30 23:59:00 AEST (1543586340) Period 4 ... Unique records processed: 44633; Last timestamp: 2018-12-31 23:59:00 AEST (1546264740) Period 5 ... Unique records processed: 8977; Last timestamp: 2019-01-07 05:43:00 AEST (1546803780) Finished dry run import 184765 records were processed and 184549 unique records would have been imported. 216 duplicate records were ignored. Note The five periods correspond to the five months of log files used for this import. Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing Weather Display log file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. If the --suppress-warnings option was used it may be prudent to do a second dry run this time without the --suppress-warnings option. This will allow any warnings generated by the dry run import to be observed: wee_import --import-config=/var/tmp/wd.conf --dry-run This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Weather Display monthly log files in the '/var/tmp/WD' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Warning: Import field 'radiation' is mapped to WeeWX field 'radiation' but the import field 'radiation' could not be found in one or more records. WeeWX field 'radiation' will be set to 'None' in these records. Warning: Import field 'soiltemp' is mapped to WeeWX field 'soilTemp1' but the import field 'soiltemp' could not be found in one or more records. WeeWX field 'soilTemp1' will be set to 'None' in these records. Warning: Import field 'soilmoist' is mapped to WeeWX field 'soilMoist1' but the import field 'soilmoist' could not be found in one or more records. WeeWX field 'soilMoist1' will be set to 'None' in these records. Warning: Import field 'humidity' is mapped to WeeWX field 'outHumidity' but the import field 'humidity' could not be found in one or more records. WeeWX field 'outHumidity' will be set to 'None' in these records. Warning: Import field 'heatindex' is mapped to WeeWX field 'heatindex' but the import field 'heatindex' could not be found in one or more records. WeeWX field 'heatindex' will be set to 'None' in these records. Warning: Import field 'windspeed' is mapped to WeeWX field 'windSpeed' but the import field 'windspeed' could not be found in one or more records. WeeWX field 'windSpeed' will be set to 'None' in these records. Warning: Import field 'barometer' is mapped to WeeWX field 'barometer' but the import field 'barometer' could not be found in one or more records. WeeWX field 'barometer' will be set to 'None' in these records. Warning: Import field 'dewpoint' is mapped to WeeWX field 'dewpoint' but the import field 'dewpoint' could not be found in one or more records. WeeWX field 'dewpoint' will be set to 'None' in these records. Warning: Import field 'rainlastmin' is mapped to WeeWX field 'rain' but the import field 'rainlastmin' could not be found in one or more records. WeeWX field 'rain' will be set to 'None' in these records. Warning: Import field 'direction' is mapped to WeeWX field 'windDir' but the import field 'direction' could not be found in one or more records. WeeWX field 'windDir' will be set to 'None' in these records. Warning: Import field 'temperature' is mapped to WeeWX field 'outTemp' but the import field 'temperature' could not be found in one or more records. WeeWX field 'outTemp' will be set to 'None' in these records. Warning: Import field 'gustspeed' is mapped to WeeWX field 'windGust' but the import field 'gustspeed' could not be found in one or more records. WeeWX field 'windGust' will be set to 'None' in these records. Unique records processed: 43183; Last timestamp: 2018-09-30 23:59:00 AEST (1538315940) Period 2 ... Unique records processed: 44620; Last timestamp: 2018-10-31 23:59:00 AEST (1540994340) Period 3 ... Unique records processed: 43136; Last timestamp: 2018-11-30 23:59:00 AEST (1543586340) Period 4 ... Unique records processed: 44633; Last timestamp: 2018-12-31 23:59:00 AEST (1546264740) Period 5 ... Unique records processed: 8977; Last timestamp: 2019-01-07 05:43:00 AEST (1546803780) 6 duplicate records were identified in period 5: 2019-01-04 10:31:00 AEST (1546561860) 2019-01-04 10:32:00 AEST (1546561920) 2019-01-04 10:33:00 AEST (1546561980) 2019-01-04 10:34:00 AEST (1546562040) 2019-01-04 10:35:00 AEST (1546562100) 2019-01-04 10:36:00 AEST (1546562160) Finished dry run import 184555 records were processed and 184549 unique records would have been imported. 6 duplicate records were ignored. In this case the following warnings are evident: Period one had 12 warnings for import fields that were mapped to WeeWX data fields but for which no data was found. This could be a sign that a complete month of data or a significant portion of the month could be missing, or it could be a case of just the first record of the month is missing (a significant number of Weather Display monthly log files have been found to be missing the first record of the month). In most cases this warning can be ignored. Period five shows warnings for six entries in the period that have duplicate timestamps. This could be a sign that there is a problem in one or more of the Weather Display monthly log files for that month. However, anecdotally it has been found that duplicate entries often exist in one or more Weather Display monthly log files. If the duplicates are to be ignored then such warnings can be ignored otherwise the incorrect data should be removed from the affected log files before import. Once the dry run results are satisfactory the data can be imported using the following command: wee_import --import-config=/var/tmp/wd.conf --suppress-warnings Note The --suppress-warnings option has been used to suppress the previously encountered warnings. This will result in a preamble similar to that of a dry run. At the end of the preamble there will be a prompt: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Weather Display monthly log files in the '/var/tmp/WD' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If there is more than one month of Weather Display monthly log files then wee_import will provide summary information on a per period basis during the import. In addition, if the --date option is used then source data that falls outside the date or date range specified with the --date option is ignored. In such cases the preamble may look similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Weather Display monthly log files in the '/var/tmp/WD' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Observations timestamped after 2018-10-12 00:00:00 AEST (1539266400) and up to and including 2018-10-13 00:00:00 AEST (1539352800) will be imported. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Period 1 - no records identified for import. Period 2 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If the import parameters are acceptable enter y to proceed with the import or n to abort the import. If the import is confirmed, the source data will be imported, processed and saved in the WeeWX database. Information on the progress of the import will be displayed similar to the following: Unique records processed: 1250; Last timestamp: 2018-12-01 20:49:00 AEST (1543661340) Again if there is more than one month of Weather Display monthly log files and if the --date option is used the progress information may instead look similar to: Period 2 ... Unique records processed: 44620; Last timestamp: 2018-10-31 23:59:00 AEST (1540994340) Period 3 ... Unique records processed: 43136; Last timestamp: 2018-11-30 23:59:00 AEST (1543586340) Period 4 ... Unique records processed: 12000; Last timestamp: 2018-12-09 07:59:00 AEST (1544306340) Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing Weather Display log file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. The line commencing with Unique records processed should update as records are imported with progress information on number of unique records processed and the date time of the latest record processed. If the import spans multiple months then a new Period line is created for each month. Once the initial import is complete wee_import will, if requested, calculate any missing derived observations and rebuild the daily summaries. A brief summary should be displayed similar to the following: Calculating missing derived observations ... Processing record: 184549; Last record: 2019-01-08 00:00:00 AEST (1546869600) Recalculating daily summaries... Records processed: 184000; Last date: 2019-01-06 20:34:00 AEST (1546770840) Finished recalculating daily summaries Finished calculating missing derived observations When the import is complete a brief summary is displayed similar to the following: Finished import 184765 records were processed and 184549 unique records imported in 699.27 seconds. 216 duplicate records were ignored. Those records with a timestamp already in the archive will not have been imported. Confirm successful import in the WeeWX log file. Whilst wee_import will advise of the number of unique records imported, wee_import does know how many, if any, of the imported records were successfully saved to the database. You should look carefully through the WeeWX log file covering the wee_import session and take note of any records that were not imported. The most common reason for imported records not being saved to the database is because a record with that timestamp already exists in the database, in such cases something similar to the following will be found in the log: Aug 22 14:38:28 stretch12 weewx[863]: manager: unable to add record 2018-09-04 04:20:00 AEST (1535998800) to database 'weewx.sdb': UNIQUE constraint failed: archive.dateTime In such cases take note of the timestamp of the record(s) concerned and make a decision about whether to delete the pre-existing record and re-import the record or retain the pre-existing record.","title":"Step-by-step instructions"},{"location":"utilities/wee_import-weathercat/","text":"Warning Running WeeWX during a wee_import session can lead to abnormal termination of the import. If WeeWX must remain running (e.g., so that live data is not lost) run the wee_import session on another machine or to a second database and merge the in-use and second database once the import is complete. wee_import can import observational data from the one or more WeatherCat monthly .cat files. A WeatherCat monthly .cat file records weather station observations for a single month. These files are accumulated over time and can be considered analogous to the WeeWX archive table. When wee_import imports data from the WeatherCat monthly .cat files each file is considered a 'period'. wee_import processes one period at a time in chronological order (oldest to newest) and provides import summary data on a per period basis. Mapping data to archive fields \u00b6 A WeatherCat import will populate the WeeWX archive fields as follows: Provided data exists for each field in the WeatherCat monthly .cat files, the following WeeWX archive fields will be directly populated by imported data: dateTime barometer dewpoint heatindex inHumidity inTemp outHumidity outTemp radiation rain rainRate UV windDir windGust windSpeed windchill Note If a field in the WeatherCat monthly .cat file has no data the corresponding WeeWX archive field will be set to None/null . The following WeeWX archive fields will be populated from other settings or configuration options: interval usUnits The following WeeWX archive fields will be populated with values derived from the imported data provided calc_missing = True is included in the [WeatherCat] section of the import configuration file being used and the field exists in the in-use WeeWX archive table schema: altimeter ET pressure Note If calc_missing = False is included in the [WeatherCat] section of the import configuration file being used then all of the above fields will be set to None/null . The calc_missing option default is True . Step-by-step instructions \u00b6 To import observations from one or more WeatherCat monthly .cat files: Ensure the WeatherCat monthly .cat file(s) to be used for the import are located in year directories with the year directories in turn located in a directory accessible by the machine that will run wee_import . For the purposes of the following examples, there are nine monthly logs files covering the period October 2016 to June 2017 inclusive, located in the /var/tmp/wcat/2016 and /var/tmp/wcat/2017 directories respectively. Make a backup of the WeeWX database in case the import should go awry. Create an import configuration file. In this case we will make a copy of the example WeatherCat import configuration file and save it as wcat.conf in the /var/tmp directory: $ cp /home/weewx/util/import/weathercat-example.conf /var/tmp/wcat.conf Confirm that the source option is set to WeatherCat : source = WeatherCat Confirm the following options in the [WeatherCat] section are correctly set: directory . The full path to the directory containing the directories containing the WeatherCat monthly .cat files to be used as the source of the imported data. interval . Determines how the WeeWX interval field is derived. qc . Determines whether quality control checks are performed on the imported data. calc_missing . Determines whether missing derived observations will be calculated from the imported data. decimal . The decimal point character used in the WeatherCat monthly log files. tranche . The number of records written to the WeeWX database in each transaction. UV_sensor . Whether a UV sensor was installed when the source data was produced. solar_sensor . Whether a solar radiation sensor was installed when the source data was produced. [[Units]] . Defines the units used in the WeatherCat monthly .cat files. When first importing data it is prudent to do a dry run import before any data is actually imported. A dry run import will perform all steps of the import without actually writing imported data to the WeeWX database. In addition, consideration should be given to any additional options to be used such as --date . Note Whilst WeatherCat monthly .cat files use a fixed set of fields the inclusion of fields other than t (timestamp) and V (validation) is optional. For this reason the field map used for WeatherCat imports includes fields that may not exist in some WeatherCat monthly .cat files resulting in warnings by wee_import that there may be missing data in the import source. These warnings can be extensive and may detract from the ability of the user to monitor the progress of the import. It may be prudent to use the --suppress-warnings option during the initial dry run so the overall progress of the import can be more easily observed. To perform a dry run enter the following command: wee_import --import-config=/var/tmp/wcat.conf --dry-run --suppress-warnings This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... WeatherCat monthly .cat files in the '/var/tmp/wcat' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Unique records processed: 39555; Last timestamp: 2016-10-31 23:59:00 AEST (1477922340) Period 2 ... Unique records processed: 38284; Last timestamp: 2016-11-30 23:59:00 AEST (1480514340) Period 3 ... Unique records processed: 39555; Last timestamp: 2016-12-31 23:59:00 AEST (1483192740) Period 4 ... Unique records processed: 39555; Last timestamp: 2017-01-31 23:59:00 AEST (1485871140) Period 5 ... Unique records processed: 35598; Last timestamp: 2017-02-28 23:59:00 AEST (1488290340) Period 6 ... Unique records processed: 39555; Last timestamp: 2017-03-31 23:59:00 AEST (1490968740) Period 7 ... Unique records processed: 38284; Last timestamp: 2017-04-30 23:59:00 AEST (1493560740) Period 8 ... Unique records processed: 38284; Last timestamp: 2017-06-30 23:59:00 AEST (1498831140) Finished dry run import 308670 records were processed and 308670 unique records would have been imported. Note The eight periods correspond to the eight monthly .cat files used for this import. Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing WeatherCat monthly .cat file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. If the --suppress-warnings option was used it may be prudent to do a second dry run this time without the --suppress-warnings option. This will allow any warnings generated by the dry run import to be observed: wee_import --import-config=/var/tmp/wcat.conf --dry-run</pre> This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... WeatherCat monthly .cat files in the '/var/tmp/wcat' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Warning: Import field 'T1' is mapped to WeeWX field 'extraTemp1' but the import field 'T1' could not be found in one or more records. WeeWX field 'extraTemp1' will be set to 'None' in these records. Warning: Import field 'T2' is mapped to WeeWX field 'extraTemp2' but the import field 'T2' could not be found in one or more records. WeeWX field 'extraTemp2' will be set to 'None' in these records. Warning: Import field 'T3' is mapped to WeeWX field 'extraTemp3' but the import field 'T3' could not be found in one or more records. WeeWX field 'extraTemp3' will be set to 'None' in these records. Warning: Import field 'H1' is mapped to WeeWX field 'extraHumid1' but the import field 'H1' could not be found in one or more records. WeeWX field 'extraHumid1' will be set to 'None' in these records. Warning: Import field 'H2' is mapped to WeeWX field 'extraHumid2' but the import field 'H2' could not be found in one or more records. WeeWX field 'extraHumid2' will be set to 'None' in these records. Warning: Import field 'Sm1' is mapped to WeeWX field 'soilMoist1' but the import field 'Sm1' could not be found in one or more records. WeeWX field 'soilMoist1' will be set to 'None' in these records. Warning: Import field 'Sm2' is mapped to WeeWX field 'soilMoist2' but the import field 'Sm2' could not be found in one or more records. WeeWX field 'soilMoist2' will be set to 'None' in these records. Warning: Import field 'Sm3' is mapped to WeeWX field 'soilMoist3' but the import field 'Sm3' could not be found in one or more records. WeeWX field 'soilMoist3' will be set to 'None' in these records. Warning: Import field 'Sm4' is mapped to WeeWX field 'soilMoist4' but the import field 'Sm4' could not be found in one or more records. WeeWX field 'soilMoist4' will be set to 'None' in these records. Warning: Import field 'Lw1' is mapped to WeeWX field 'leafWet1' but the import field 'Lw1' could not be found in one or more records. WeeWX field 'leafWet1' will be set to 'None' in these records. Warning: Import field 'Lw2' is mapped to WeeWX field 'leafWet2' but the import field 'Lw2' could not be found in one or more records. WeeWX field 'leafWet2' will be set to 'None' in these records. Warning: Import field 'St1' is mapped to WeeWX field 'soilTemp1' but the import field 'St1' could not be found in one or more records. WeeWX field 'soilTemp1' will be set to 'None' in these records. Warning: Import field 'St2' is mapped to WeeWX field 'soilTemp2' but the import field 'St2' could not be found in one or more records. WeeWX field 'soilTemp2' will be set to 'None' in these records. Warning: Import field 'St3' is mapped to WeeWX field 'soilTemp3' but the import field 'St3' could not be found in one or more records. WeeWX field 'soilTemp3' will be set to 'None' in these records. Warning: Import field 'St4' is mapped to WeeWX field 'soilTemp4' but the import field 'St4' could not be found in one or more records. WeeWX field 'soilTemp4' will be set to 'None' in these records. Warning: Import field 'Lt1' is mapped to WeeWX field 'leafTemp1' but the import field 'Lt1' could not be found in one or more records. WeeWX field 'leafTemp1' will be set to 'None' in these records. Warning: Import field 'Lt2' is mapped to WeeWX field 'leafTemp2' but the import field 'Lt2' could not be found in one or more records. WeeWX field 'leafTemp2' will be set to 'None' in these records. Unique records processed: 39555; Last timestamp: 2016-10-31 23:59:00 AEST (1477922340) Period 2 ... Warning: Import field 'T1' is mapped to WeeWX field 'extraTemp1' but the import field 'T1' could not be found in one or more records. WeeWX field 'extraTemp1' will be set to 'None' in these records. Warning: Import field 'T2' is mapped to WeeWX field 'extraTemp2' but the import field 'T2' could not be found in one or more records. WeeWX field 'extraTemp2' will be set to 'None' in these records. Warning: Import field 'T3' is mapped to WeeWX field 'extraTemp3' but the import field 'T3' could not be found in one or more records. WeeWX field 'extraTemp3' will be set to 'None' in these records. Warning: Import field 'H1' is mapped to WeeWX field 'extraHumid1' but the import field 'H1' could not be found in one or more records. WeeWX field 'extraHumid1' will be set to 'None' in these records. Warning: Import field 'H2' is mapped to WeeWX field 'extraHumid2' but the import field 'H2' could not be found in one or more records. WeeWX field 'extraHumid2' will be set to 'None' in these records. Warning: Import field 'Sm1' is mapped to WeeWX field 'soilMoist1' but the import field 'Sm1' could not be found in one or more records. WeeWX field 'soilMoist1' will be set to 'None' in these records. Warning: Import field 'Sm2' is mapped to WeeWX field 'soilMoist2' but the import field 'Sm2' could not be found in one or more records. WeeWX field 'soilMoist2' will be set to 'None' in these records. Warning: Import field 'Sm3' is mapped to WeeWX field 'soilMoist3' but the import field 'Sm3' could not be found in one or more records. WeeWX field 'soilMoist3' will be set to 'None' in these records. Warning: Import field 'Sm4' is mapped to WeeWX field 'soilMoist4' but the import field 'Sm4' could not be found in one or more records. WeeWX field 'soilMoist4' will be set to 'None' in these records. Warning: Import field 'Lw1' is mapped to WeeWX field 'leafWet1' but the import field 'Lw1' could not be found in one or more records. WeeWX field 'leafWet1' will be set to 'None' in these records. Warning: Import field 'Lw2' is mapped to WeeWX field 'leafWet2' but the import field 'Lw2' could not be found in one or more records. WeeWX field 'leafWet2' will be set to 'None' in these records. Warning: Import field 'St1' is mapped to WeeWX field 'soilTemp1' but the import field 'St1' could not be found in one or more records. WeeWX field 'soilTemp1' will be set to 'None' in these records. Warning: Import field 'St2' is mapped to WeeWX field 'soilTemp2' but the import field 'St2' could not be found in one or more records. WeeWX field 'soilTemp2' will be set to 'None' in these records. Warning: Import field 'St3' is mapped to WeeWX field 'soilTemp3' but the import field 'St3' could not be found in one or more records. WeeWX field 'soilTemp3' will be set to 'None' in these records. Warning: Import field 'St4' is mapped to WeeWX field 'soilTemp4' but the import field 'St4' could not be found in one or more records. WeeWX field 'soilTemp4' will be set to 'None' in these records. Warning: Import field 'Lt1' is mapped to WeeWX field 'leafTemp1' but the import field 'Lt1' could not be found in one or more records. WeeWX field 'leafTemp1' will be set to 'None' in these records. Warning: Import field 'Lt2' is mapped to WeeWX field 'leafTemp2' but the import field 'Lt2' could not be found in one or more records. WeeWX field 'leafTemp2' will be set to 'None' in these records. Unique records processed: 38284; Last timestamp: 2016-11-30 23:59:00 AEST (1480514340) ... (identical entries for periods 3 to 7 omitted for conciseness) Period 8 ... Warning: Import field 'T1' is mapped to WeeWX field 'extraTemp1' but the import field 'T1' could not be found in one or more records. WeeWX field 'extraTemp1' will be set to 'None' in these records. Warning: Import field 'T2' is mapped to WeeWX field 'extraTemp2' but the import field 'T2' could not be found in one or more records. WeeWX field 'extraTemp2' will be set to 'None' in these records. Warning: Import field 'T3' is mapped to WeeWX field 'extraTemp3' but the import field 'T3' could not be found in one or more records. WeeWX field 'extraTemp3' will be set to 'None' in these records. Warning: Import field 'H1' is mapped to WeeWX field 'extraHumid1' but the import field 'H1' could not be found in one or more records. WeeWX field 'extraHumid1' will be set to 'None' in these records. Warning: Import field 'H2' is mapped to WeeWX field 'extraHumid2' but the import field 'H2' could not be found in one or more records. WeeWX field 'extraHumid2' will be set to 'None' in these records. Warning: Import field 'Sm1' is mapped to WeeWX field 'soilMoist1' but the import field 'Sm1' could not be found in one or more records. WeeWX field 'soilMoist1' will be set to 'None' in these records. Warning: Import field 'Sm2' is mapped to WeeWX field 'soilMoist2' but the import field 'Sm2' could not be found in one or more records. WeeWX field 'soilMoist2' will be set to 'None' in these records. Warning: Import field 'Sm3' is mapped to WeeWX field 'soilMoist3' but the import field 'Sm3' could not be found in one or more records. WeeWX field 'soilMoist3' will be set to 'None' in these records. Warning: Import field 'Sm4' is mapped to WeeWX field 'soilMoist4' but the import field 'Sm4' could not be found in one or more records. WeeWX field 'soilMoist4' will be set to 'None' in these records. Warning: Import field 'Lw1' is mapped to WeeWX field 'leafWet1' but the import field 'Lw1' could not be found in one or more records. WeeWX field 'leafWet1' will be set to 'None' in these records. Warning: Import field 'Lw2' is mapped to WeeWX field 'leafWet2' but the import field 'Lw2' could not be found in one or more records. WeeWX field 'leafWet2' will be set to 'None' in these records. Warning: Import field 'St1' is mapped to WeeWX field 'soilTemp1' but the import field 'St1' could not be found in one or more records. WeeWX field 'soilTemp1' will be set to 'None' in these records. Warning: Import field 'St2' is mapped to WeeWX field 'soilTemp2' but the import field 'St2' could not be found in one or more records. WeeWX field 'soilTemp2' will be set to 'None' in these records. Warning: Import field 'St3' is mapped to WeeWX field 'soilTemp3' but the import field 'St3' could not be found in one or more records. WeeWX field 'soilTemp3' will be set to 'None' in these records. Warning: Import field 'St4' is mapped to WeeWX field 'soilTemp4' but the import field 'St4' could not be found in one or more records. WeeWX field 'soilTemp4' will be set to 'None' in these records. Warning: Import field 'Lt1' is mapped to WeeWX field 'leafTemp1' but the import field 'Lt1' could not be found in one or more records. WeeWX field 'leafTemp1' will be set to 'None' in these records. Warning: Import field 'Lt2' is mapped to WeeWX field 'leafTemp2' but the import field 'Lt2' could not be found in one or more records. WeeWX field 'leafTemp2' will be set to 'None' in these records. Unique records processed: 38284; Last timestamp: 2017-06-30 23:59:00 AEST (1498831140) Finished dry run import 308670 records were processed and 308670 unique records would have been imported. In this case warnings are evident for numerous import/WeeWX field pairs that are mapped but for which no data could be found. If the warnings relate to fields that are not included in the import source data the warning may be safely ignored. If the warning relate to fields that the user expects to be in the import source data the issue should be investigated further before the import is completed. Once the dry run results are satisfactory the data can be imported using the following command: wee_import --import-config=/var/tmp/wcat.conf --suppress-warnings This will result in a preamble similar to that of a dry run. At the end of the preamble there will be a prompt: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... WeatherCat monthly .cat files in the '/var/tmp/wcat' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If there is more than one WeatherCat monthly .cat file then wee_import will provide summary information on a per period basis during the import. In addition, if the --date option is used then source data that falls outside the date or date range specified with the --date option is ignored. In such cases the preamble may look similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... WeatherCat monthly .cat files in the '/var/tmp/wcat' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Period 1 - no records identified for import. Period 2 ... Period 2 - no records identified for import. Period 3 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If the import parameters are acceptable enter y to proceed with the import or n to abort the import. If the import is confirmed, the source data will be imported, processed and saved in the WeeWX database. Information on the progress of the import will be displayed similar to the following: Unique records processed: 2305; Last timestamp: 2016-12-30 00:00:00 AEST (1483020000) Again if there is more than one WeatherCat monthly .cat file and if the --date option is used the progress information may instead look similar to: Period 4 ... Unique records processed: 8908; Last timestamp: 2017-01-31 23:59:00 AEST (1485870900) Period 5 ... Unique records processed: 8029; Last timestamp: 2017-02-28 23:59:00 AEST (1488290100) Period 6 ... Unique records processed: 8744; Last timestamp: 2017-03-31 23:59:00 AEST (1490968500) Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing WeatherCat monthly .cat file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. The line commencing with Unique records processed should update as records are imported with progress information on number of records processed, number of unique records imported and the date time of the latest record processed. If the import spans multiple months (ie multiple monthly .cat files) then a new Period line is created for each month. Once the initial import is complete wee_import will, if requested, calculate any missing derived observations and rebuild the daily summaries. A brief summary should be displayed similar to the following: Calculating missing derived observations ... Processing record: 77782; Last record: 2017-06-30 00:00:00 AEST (1519826400) Recalculating daily summaries... Records processed: 77000; Last date: 2017-06-28 11:45:00 AEST (1519811100) Finished recalculating daily summaries Finished calculating missing derived observations When the import is complete a brief summary is displayed similar to the following: Finished import 308670 records were processed and 308670 unique records imported in 1907.61 seconds. Those records with a timestamp already in the archive will not have been imported. Confirm successful import in the WeeWX log file. Whilst wee_import will advise of the number of records processed and the number of unique records found, wee_import does know how many, if any, of the imported records were successfully saved to the database. You should look carefully through the WeeWX log file covering the wee_import session and take note of any records that were not imported. The most common reason for imported records not being saved to the database is because a record with that timestamp already exists in the database, in such cases something similar to the following will be found in the log: Aug 22 14:38:28 stretch12 weewx[863]: manager: unable to add record 2018-09-04 04:20:00 AEST (1535998800) to database 'weewx.sdb': UNIQUE constraint failed: archive.dateTime In such cases take note of the timestamp of the record(s) concerned and make a decision about whether to delete the pre-existing record and re-import the record or retain the pre-existing record.","title":"WeatherCat"},{"location":"utilities/wee_import-weathercat/#mapping-data-to-archive-fields","text":"A WeatherCat import will populate the WeeWX archive fields as follows: Provided data exists for each field in the WeatherCat monthly .cat files, the following WeeWX archive fields will be directly populated by imported data: dateTime barometer dewpoint heatindex inHumidity inTemp outHumidity outTemp radiation rain rainRate UV windDir windGust windSpeed windchill Note If a field in the WeatherCat monthly .cat file has no data the corresponding WeeWX archive field will be set to None/null . The following WeeWX archive fields will be populated from other settings or configuration options: interval usUnits The following WeeWX archive fields will be populated with values derived from the imported data provided calc_missing = True is included in the [WeatherCat] section of the import configuration file being used and the field exists in the in-use WeeWX archive table schema: altimeter ET pressure Note If calc_missing = False is included in the [WeatherCat] section of the import configuration file being used then all of the above fields will be set to None/null . The calc_missing option default is True .","title":"Mapping data to archive fields"},{"location":"utilities/wee_import-weathercat/#step-by-step-instructions","text":"To import observations from one or more WeatherCat monthly .cat files: Ensure the WeatherCat monthly .cat file(s) to be used for the import are located in year directories with the year directories in turn located in a directory accessible by the machine that will run wee_import . For the purposes of the following examples, there are nine monthly logs files covering the period October 2016 to June 2017 inclusive, located in the /var/tmp/wcat/2016 and /var/tmp/wcat/2017 directories respectively. Make a backup of the WeeWX database in case the import should go awry. Create an import configuration file. In this case we will make a copy of the example WeatherCat import configuration file and save it as wcat.conf in the /var/tmp directory: $ cp /home/weewx/util/import/weathercat-example.conf /var/tmp/wcat.conf Confirm that the source option is set to WeatherCat : source = WeatherCat Confirm the following options in the [WeatherCat] section are correctly set: directory . The full path to the directory containing the directories containing the WeatherCat monthly .cat files to be used as the source of the imported data. interval . Determines how the WeeWX interval field is derived. qc . Determines whether quality control checks are performed on the imported data. calc_missing . Determines whether missing derived observations will be calculated from the imported data. decimal . The decimal point character used in the WeatherCat monthly log files. tranche . The number of records written to the WeeWX database in each transaction. UV_sensor . Whether a UV sensor was installed when the source data was produced. solar_sensor . Whether a solar radiation sensor was installed when the source data was produced. [[Units]] . Defines the units used in the WeatherCat monthly .cat files. When first importing data it is prudent to do a dry run import before any data is actually imported. A dry run import will perform all steps of the import without actually writing imported data to the WeeWX database. In addition, consideration should be given to any additional options to be used such as --date . Note Whilst WeatherCat monthly .cat files use a fixed set of fields the inclusion of fields other than t (timestamp) and V (validation) is optional. For this reason the field map used for WeatherCat imports includes fields that may not exist in some WeatherCat monthly .cat files resulting in warnings by wee_import that there may be missing data in the import source. These warnings can be extensive and may detract from the ability of the user to monitor the progress of the import. It may be prudent to use the --suppress-warnings option during the initial dry run so the overall progress of the import can be more easily observed. To perform a dry run enter the following command: wee_import --import-config=/var/tmp/wcat.conf --dry-run --suppress-warnings This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... WeatherCat monthly .cat files in the '/var/tmp/wcat' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Unique records processed: 39555; Last timestamp: 2016-10-31 23:59:00 AEST (1477922340) Period 2 ... Unique records processed: 38284; Last timestamp: 2016-11-30 23:59:00 AEST (1480514340) Period 3 ... Unique records processed: 39555; Last timestamp: 2016-12-31 23:59:00 AEST (1483192740) Period 4 ... Unique records processed: 39555; Last timestamp: 2017-01-31 23:59:00 AEST (1485871140) Period 5 ... Unique records processed: 35598; Last timestamp: 2017-02-28 23:59:00 AEST (1488290340) Period 6 ... Unique records processed: 39555; Last timestamp: 2017-03-31 23:59:00 AEST (1490968740) Period 7 ... Unique records processed: 38284; Last timestamp: 2017-04-30 23:59:00 AEST (1493560740) Period 8 ... Unique records processed: 38284; Last timestamp: 2017-06-30 23:59:00 AEST (1498831140) Finished dry run import 308670 records were processed and 308670 unique records would have been imported. Note The eight periods correspond to the eight monthly .cat files used for this import. Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing WeatherCat monthly .cat file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. If the --suppress-warnings option was used it may be prudent to do a second dry run this time without the --suppress-warnings option. This will allow any warnings generated by the dry run import to be observed: wee_import --import-config=/var/tmp/wcat.conf --dry-run</pre> This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... WeatherCat monthly .cat files in the '/var/tmp/wcat' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Warning: Import field 'T1' is mapped to WeeWX field 'extraTemp1' but the import field 'T1' could not be found in one or more records. WeeWX field 'extraTemp1' will be set to 'None' in these records. Warning: Import field 'T2' is mapped to WeeWX field 'extraTemp2' but the import field 'T2' could not be found in one or more records. WeeWX field 'extraTemp2' will be set to 'None' in these records. Warning: Import field 'T3' is mapped to WeeWX field 'extraTemp3' but the import field 'T3' could not be found in one or more records. WeeWX field 'extraTemp3' will be set to 'None' in these records. Warning: Import field 'H1' is mapped to WeeWX field 'extraHumid1' but the import field 'H1' could not be found in one or more records. WeeWX field 'extraHumid1' will be set to 'None' in these records. Warning: Import field 'H2' is mapped to WeeWX field 'extraHumid2' but the import field 'H2' could not be found in one or more records. WeeWX field 'extraHumid2' will be set to 'None' in these records. Warning: Import field 'Sm1' is mapped to WeeWX field 'soilMoist1' but the import field 'Sm1' could not be found in one or more records. WeeWX field 'soilMoist1' will be set to 'None' in these records. Warning: Import field 'Sm2' is mapped to WeeWX field 'soilMoist2' but the import field 'Sm2' could not be found in one or more records. WeeWX field 'soilMoist2' will be set to 'None' in these records. Warning: Import field 'Sm3' is mapped to WeeWX field 'soilMoist3' but the import field 'Sm3' could not be found in one or more records. WeeWX field 'soilMoist3' will be set to 'None' in these records. Warning: Import field 'Sm4' is mapped to WeeWX field 'soilMoist4' but the import field 'Sm4' could not be found in one or more records. WeeWX field 'soilMoist4' will be set to 'None' in these records. Warning: Import field 'Lw1' is mapped to WeeWX field 'leafWet1' but the import field 'Lw1' could not be found in one or more records. WeeWX field 'leafWet1' will be set to 'None' in these records. Warning: Import field 'Lw2' is mapped to WeeWX field 'leafWet2' but the import field 'Lw2' could not be found in one or more records. WeeWX field 'leafWet2' will be set to 'None' in these records. Warning: Import field 'St1' is mapped to WeeWX field 'soilTemp1' but the import field 'St1' could not be found in one or more records. WeeWX field 'soilTemp1' will be set to 'None' in these records. Warning: Import field 'St2' is mapped to WeeWX field 'soilTemp2' but the import field 'St2' could not be found in one or more records. WeeWX field 'soilTemp2' will be set to 'None' in these records. Warning: Import field 'St3' is mapped to WeeWX field 'soilTemp3' but the import field 'St3' could not be found in one or more records. WeeWX field 'soilTemp3' will be set to 'None' in these records. Warning: Import field 'St4' is mapped to WeeWX field 'soilTemp4' but the import field 'St4' could not be found in one or more records. WeeWX field 'soilTemp4' will be set to 'None' in these records. Warning: Import field 'Lt1' is mapped to WeeWX field 'leafTemp1' but the import field 'Lt1' could not be found in one or more records. WeeWX field 'leafTemp1' will be set to 'None' in these records. Warning: Import field 'Lt2' is mapped to WeeWX field 'leafTemp2' but the import field 'Lt2' could not be found in one or more records. WeeWX field 'leafTemp2' will be set to 'None' in these records. Unique records processed: 39555; Last timestamp: 2016-10-31 23:59:00 AEST (1477922340) Period 2 ... Warning: Import field 'T1' is mapped to WeeWX field 'extraTemp1' but the import field 'T1' could not be found in one or more records. WeeWX field 'extraTemp1' will be set to 'None' in these records. Warning: Import field 'T2' is mapped to WeeWX field 'extraTemp2' but the import field 'T2' could not be found in one or more records. WeeWX field 'extraTemp2' will be set to 'None' in these records. Warning: Import field 'T3' is mapped to WeeWX field 'extraTemp3' but the import field 'T3' could not be found in one or more records. WeeWX field 'extraTemp3' will be set to 'None' in these records. Warning: Import field 'H1' is mapped to WeeWX field 'extraHumid1' but the import field 'H1' could not be found in one or more records. WeeWX field 'extraHumid1' will be set to 'None' in these records. Warning: Import field 'H2' is mapped to WeeWX field 'extraHumid2' but the import field 'H2' could not be found in one or more records. WeeWX field 'extraHumid2' will be set to 'None' in these records. Warning: Import field 'Sm1' is mapped to WeeWX field 'soilMoist1' but the import field 'Sm1' could not be found in one or more records. WeeWX field 'soilMoist1' will be set to 'None' in these records. Warning: Import field 'Sm2' is mapped to WeeWX field 'soilMoist2' but the import field 'Sm2' could not be found in one or more records. WeeWX field 'soilMoist2' will be set to 'None' in these records. Warning: Import field 'Sm3' is mapped to WeeWX field 'soilMoist3' but the import field 'Sm3' could not be found in one or more records. WeeWX field 'soilMoist3' will be set to 'None' in these records. Warning: Import field 'Sm4' is mapped to WeeWX field 'soilMoist4' but the import field 'Sm4' could not be found in one or more records. WeeWX field 'soilMoist4' will be set to 'None' in these records. Warning: Import field 'Lw1' is mapped to WeeWX field 'leafWet1' but the import field 'Lw1' could not be found in one or more records. WeeWX field 'leafWet1' will be set to 'None' in these records. Warning: Import field 'Lw2' is mapped to WeeWX field 'leafWet2' but the import field 'Lw2' could not be found in one or more records. WeeWX field 'leafWet2' will be set to 'None' in these records. Warning: Import field 'St1' is mapped to WeeWX field 'soilTemp1' but the import field 'St1' could not be found in one or more records. WeeWX field 'soilTemp1' will be set to 'None' in these records. Warning: Import field 'St2' is mapped to WeeWX field 'soilTemp2' but the import field 'St2' could not be found in one or more records. WeeWX field 'soilTemp2' will be set to 'None' in these records. Warning: Import field 'St3' is mapped to WeeWX field 'soilTemp3' but the import field 'St3' could not be found in one or more records. WeeWX field 'soilTemp3' will be set to 'None' in these records. Warning: Import field 'St4' is mapped to WeeWX field 'soilTemp4' but the import field 'St4' could not be found in one or more records. WeeWX field 'soilTemp4' will be set to 'None' in these records. Warning: Import field 'Lt1' is mapped to WeeWX field 'leafTemp1' but the import field 'Lt1' could not be found in one or more records. WeeWX field 'leafTemp1' will be set to 'None' in these records. Warning: Import field 'Lt2' is mapped to WeeWX field 'leafTemp2' but the import field 'Lt2' could not be found in one or more records. WeeWX field 'leafTemp2' will be set to 'None' in these records. Unique records processed: 38284; Last timestamp: 2016-11-30 23:59:00 AEST (1480514340) ... (identical entries for periods 3 to 7 omitted for conciseness) Period 8 ... Warning: Import field 'T1' is mapped to WeeWX field 'extraTemp1' but the import field 'T1' could not be found in one or more records. WeeWX field 'extraTemp1' will be set to 'None' in these records. Warning: Import field 'T2' is mapped to WeeWX field 'extraTemp2' but the import field 'T2' could not be found in one or more records. WeeWX field 'extraTemp2' will be set to 'None' in these records. Warning: Import field 'T3' is mapped to WeeWX field 'extraTemp3' but the import field 'T3' could not be found in one or more records. WeeWX field 'extraTemp3' will be set to 'None' in these records. Warning: Import field 'H1' is mapped to WeeWX field 'extraHumid1' but the import field 'H1' could not be found in one or more records. WeeWX field 'extraHumid1' will be set to 'None' in these records. Warning: Import field 'H2' is mapped to WeeWX field 'extraHumid2' but the import field 'H2' could not be found in one or more records. WeeWX field 'extraHumid2' will be set to 'None' in these records. Warning: Import field 'Sm1' is mapped to WeeWX field 'soilMoist1' but the import field 'Sm1' could not be found in one or more records. WeeWX field 'soilMoist1' will be set to 'None' in these records. Warning: Import field 'Sm2' is mapped to WeeWX field 'soilMoist2' but the import field 'Sm2' could not be found in one or more records. WeeWX field 'soilMoist2' will be set to 'None' in these records. Warning: Import field 'Sm3' is mapped to WeeWX field 'soilMoist3' but the import field 'Sm3' could not be found in one or more records. WeeWX field 'soilMoist3' will be set to 'None' in these records. Warning: Import field 'Sm4' is mapped to WeeWX field 'soilMoist4' but the import field 'Sm4' could not be found in one or more records. WeeWX field 'soilMoist4' will be set to 'None' in these records. Warning: Import field 'Lw1' is mapped to WeeWX field 'leafWet1' but the import field 'Lw1' could not be found in one or more records. WeeWX field 'leafWet1' will be set to 'None' in these records. Warning: Import field 'Lw2' is mapped to WeeWX field 'leafWet2' but the import field 'Lw2' could not be found in one or more records. WeeWX field 'leafWet2' will be set to 'None' in these records. Warning: Import field 'St1' is mapped to WeeWX field 'soilTemp1' but the import field 'St1' could not be found in one or more records. WeeWX field 'soilTemp1' will be set to 'None' in these records. Warning: Import field 'St2' is mapped to WeeWX field 'soilTemp2' but the import field 'St2' could not be found in one or more records. WeeWX field 'soilTemp2' will be set to 'None' in these records. Warning: Import field 'St3' is mapped to WeeWX field 'soilTemp3' but the import field 'St3' could not be found in one or more records. WeeWX field 'soilTemp3' will be set to 'None' in these records. Warning: Import field 'St4' is mapped to WeeWX field 'soilTemp4' but the import field 'St4' could not be found in one or more records. WeeWX field 'soilTemp4' will be set to 'None' in these records. Warning: Import field 'Lt1' is mapped to WeeWX field 'leafTemp1' but the import field 'Lt1' could not be found in one or more records. WeeWX field 'leafTemp1' will be set to 'None' in these records. Warning: Import field 'Lt2' is mapped to WeeWX field 'leafTemp2' but the import field 'Lt2' could not be found in one or more records. WeeWX field 'leafTemp2' will be set to 'None' in these records. Unique records processed: 38284; Last timestamp: 2017-06-30 23:59:00 AEST (1498831140) Finished dry run import 308670 records were processed and 308670 unique records would have been imported. In this case warnings are evident for numerous import/WeeWX field pairs that are mapped but for which no data could be found. If the warnings relate to fields that are not included in the import source data the warning may be safely ignored. If the warning relate to fields that the user expects to be in the import source data the issue should be investigated further before the import is completed. Once the dry run results are satisfactory the data can be imported using the following command: wee_import --import-config=/var/tmp/wcat.conf --suppress-warnings This will result in a preamble similar to that of a dry run. At the end of the preamble there will be a prompt: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... WeatherCat monthly .cat files in the '/var/tmp/wcat' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If there is more than one WeatherCat monthly .cat file then wee_import will provide summary information on a per period basis during the import. In addition, if the --date option is used then source data that falls outside the date or date range specified with the --date option is ignored. In such cases the preamble may look similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... WeatherCat monthly .cat files in the '/var/tmp/wcat' directory will be imported Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Period 1 - no records identified for import. Period 2 ... Period 2 - no records identified for import. Period 3 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? If the import parameters are acceptable enter y to proceed with the import or n to abort the import. If the import is confirmed, the source data will be imported, processed and saved in the WeeWX database. Information on the progress of the import will be displayed similar to the following: Unique records processed: 2305; Last timestamp: 2016-12-30 00:00:00 AEST (1483020000) Again if there is more than one WeatherCat monthly .cat file and if the --date option is used the progress information may instead look similar to: Period 4 ... Unique records processed: 8908; Last timestamp: 2017-01-31 23:59:00 AEST (1485870900) Period 5 ... Unique records processed: 8029; Last timestamp: 2017-02-28 23:59:00 AEST (1488290100) Period 6 ... Unique records processed: 8744; Last timestamp: 2017-03-31 23:59:00 AEST (1490968500) Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to a missing WeatherCat monthly .cat file. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. The line commencing with Unique records processed should update as records are imported with progress information on number of records processed, number of unique records imported and the date time of the latest record processed. If the import spans multiple months (ie multiple monthly .cat files) then a new Period line is created for each month. Once the initial import is complete wee_import will, if requested, calculate any missing derived observations and rebuild the daily summaries. A brief summary should be displayed similar to the following: Calculating missing derived observations ... Processing record: 77782; Last record: 2017-06-30 00:00:00 AEST (1519826400) Recalculating daily summaries... Records processed: 77000; Last date: 2017-06-28 11:45:00 AEST (1519811100) Finished recalculating daily summaries Finished calculating missing derived observations When the import is complete a brief summary is displayed similar to the following: Finished import 308670 records were processed and 308670 unique records imported in 1907.61 seconds. Those records with a timestamp already in the archive will not have been imported. Confirm successful import in the WeeWX log file. Whilst wee_import will advise of the number of records processed and the number of unique records found, wee_import does know how many, if any, of the imported records were successfully saved to the database. You should look carefully through the WeeWX log file covering the wee_import session and take note of any records that were not imported. The most common reason for imported records not being saved to the database is because a record with that timestamp already exists in the database, in such cases something similar to the following will be found in the log: Aug 22 14:38:28 stretch12 weewx[863]: manager: unable to add record 2018-09-04 04:20:00 AEST (1535998800) to database 'weewx.sdb': UNIQUE constraint failed: archive.dateTime In such cases take note of the timestamp of the record(s) concerned and make a decision about whether to delete the pre-existing record and re-import the record or retain the pre-existing record.","title":"Step-by-step instructions"},{"location":"utilities/wee_import-wu/","text":"Warning Running WeeWX during a wee_import session can lead to abnormal termination of the import. If WeeWX must remain running (e.g., so that live data is not lost) run the wee_import session on another machine or to a second database and merge the in-use and second database once the import is complete. wee_import can import historical observation data for a Weather Underground PWS via the Weather Underground API. The Weather Underground API provides historical weather station observations received by Weather Underground for the PWS concerned on a day by day basis. As such, the data is analogous to the WeeWX archive table. When wee_import imports data from the Weather Underground API each day is considered a 'period'. wee_import processes one period at a time in chronological order (oldest to newest) and provides import summary data on a per period basis. Mapping data to archive fields \u00b6 A Weather Underground import will populate WeeWX archive fields as follows: Provided data exists for each field returned by the Weather Underground API, the following WeeWX archive fields will be directly populated by imported data: dateTime barometer dewpoint heatindex outHumidity outTemp radiation rain rainRate UV windchill windDir windGust windSpeed Note If an appropriate field is not returned by the Weather Underground API the corresponding WeeWX archive field will contain no data. If the API returns an appropriate field but with no data, the corresponding WeeWX archive field will be set to None/null . For example, if the API response has no solar radiation field the WeeWX radiation archive field will have no data stored. However, if the API response has a solar radiation field but contains no data, the WeeWX radiation archive field will be None/null . The following WeeWX archive fields will be populated from other settings or configuration options: interval usUnits The following WeeWX archive fields will be populated with values derived from the imported data provided calc_missing = True is included in the [WU] section of the import configuration file and the field exists in the in-use WeeWX archive table schema. altimeter ET pressure Note If calc_missing = False is included in the [WU] section of the import configuration file being used then all of the above fields will be set to None/null . The calc_missing option default is True . Step-by-step instructions \u00b6 To import observations from a Weather Underground PWS history: Obtain the weather station ID of the Weather Underground PWS from which data is to be imported. The station ID will be a sequence of numbers and upper case letters that is usually 11 or 12 characters in length. For the purposes of the following examples a weather station ID of ISTATION123 will be used. Obtain the API key to be used to access the Weather Underground API. This will be a seemingly random alphanumeric sequence of 32 characters. API keys are available to Weather Underground PWS contributors by logging on to their Weather Underground account and accessing Member Settings. Make a backup of the WeeWX database in case the import should go awry. Create an import configuration file. In this case we will make a copy of the example Weather Underground import configuration file and save it as wu.conf in the /var/tmp directory: $ cp /home/weewx/util/import/wu-example.conf /var/tmp/wu.conf Confirm that the source option is set to WU : source = WU Confirm that the following options in the [WU] section are correctly set: station_id . The 11 or 12 character weather station ID of the Weather Underground PWS that will be the source of the imported data. api_key . The 32 character API key to be used to access the Weather Underground API. interval . Determines how the WeeWX interval field is derived. qc . Determines whether quality control checks are performed on the imported data. Note As Weather Underground imports at times contain nonsense values, particularly for fields for which no data were uploaded to Weather Underground by the PWS, the use of quality control checks on imported data can prevent these nonsense values from being imported and contaminating the WeeWX database. calc_missing . Determines whether missing derived observations will be calculated from the imported data. ignore_invalid_data . Determines whether invalid data in a source field is ignored or the import aborted. tranche . The number of records written to the WeeWX database in each transaction. wind_direction . Determines how imported wind direction fields are interpreted. When first importing data it is prudent to do a dry run import before any data is actually imported. A dry run import will perform all steps of the import without actually writing imported data to the WeeWX database. In addition, consideration should be given to any additional options to be used such as --date , --from or --to . To perform a dry run enter the following command: wee_import --import-config=/var/tmp/wu.conf --from=2016-01-20T22:30 --to=2016-01-23T06:00 --dry-run In this case the --from and --to options have been used to import Weather Underground records from 10:30pm on 20 January 2016 to 6:00am on 23 January 2016 inclusive. Note If the --date option is omitted, or a date (not date-time) range is specified using the --from and --to options during a Weather Underground import, then one or more full days of history data will be imported. This includes records timestamped from 00:00 (inclusive) at the start of the day up to but NOT including the 00:00 record at the end of the last day. As the timestamped record refers to observations of the previous interval, such an import actually includes one record with observations from the previous day (the 00:00 record at the start of the day). Whilst this will not present a problem for wee_import as any records being imported with a timestamp that already exists in the WeeWX database are ignored, you may wish to use the --from and --to options with a suitable date-time range to precisely control which records are imported. Note wee_import obtains Weather Underground daily history data one day at a time via a HTTP request and as such the import of large time spans of data may take some time. Such imports may be best handled as a series of imports of smaller time spans. This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Observation history for Weather Underground station 'ISTATION123' will be imported. Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Observations timestamped after 2016-01-20 22:30:00 AEST (1453293000) and up to and including 2016-01-23 06:00:00 AEST (1453492800) will be imported. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Unique records processed: 18; Last timestamp: 2016-01-20 23:55:00 AEST (1453298100) Period 2 ... Unique records processed: 284; Last timestamp: 2016-01-21 23:55:00 AEST (1453384500) Period 3 ... Unique records processed: 284; Last timestamp: 2016-01-22 23:55:00 AEST (1453470900) Period 4 ... Unique records processed: 71; Last timestamp: 2016-01-23 06:00:00 AEST (1453492800) Finished dry run import 657 records were processed and 657 unique records would have been imported. Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to an incorrect station ID, an incorrect date or Weather Underground API problems. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. Once the dry run results are satisfactory the source data can be imported using the following command: wee_import --import-config=/var/tmp/wu.conf --from=2016-01-20T22:30 --to=2016-01-23T06:00 This will result in a short preamble similar to that of a dry run. At the end of the preamble there will be a prompt: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Observation history for Weather Underground station 'ISTATION123' will be imported. Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Observations timestamped after 2016-01-20 22:30:00 AEST (1453293000) and up to and including 2016-01-23 06:00:00 AEST (1453492800) will be imported. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? Note wee_import obtains Weather Underground data one day at a time via a HTTP request and as such the import of large time spans of data may take some time. Such imports may be best handled as a series of imports of smaller time spans. If the import parameters are acceptable enter y to proceed with the import or n to abort the import. If the import is confirmed, the source data will be imported, processed and saved in the WeeWX database. Information on the progress of the import will be displayed similar to the following: Unique records processed: 18; Last timestamp: 2016-01-20 23:55:00 AEST (1453298100) Period 2 ... Unique records processed: 284; Last timestamp: 2016-01-21 23:55:00 AEST (1453384500) Period 3 ... Unique records processed: 284; Last timestamp: 2016-01-22 23:55:00 AEST (1453470900) Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to an incorrect station ID, an incorrect date or Weather Underground API problems. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. The line commencing with Unique records processed should update as records are imported with progress information on number of records processed, number of unique records imported and the date time of the latest record processed. If the import spans multiple days then a new Period line is created for each day. Once the initial import is complete wee_import will, if requested, calculate any missing derived observations and rebuild the daily summaries. A brief summary should be displayed similar to the following: Calculating missing derived observations ... Processing record: 204; Last record: 2016-01-22 23:55:00 AEST (1453470900) Recalculating daily summaries... Finished recalculating daily summaries Finished calculating missing derived observations When the import is complete a brief summary is displayed similar to the following: Finished import 657 records were processed and 657 unique records imported in 78.97 seconds. Those records with a timestamp already in the archive will not have been imported. Confirm successful import in the WeeWX log file. Note The new (2019) Weather Underground API appears to have an issue when obtaining historical data for the current day. The first time the API is queried the API returns all historical data up to and including the most recent record. However, subsequent later API queries during the same day return the same set of records rather than all records up to and including the time of the latest API query. Users importing Weather Underground data that includes data from the current day are advised to carefully check the WeeWX log to ensure that all expected records were imported. If some records are missing from the current day try running an import for the current day again using the --date option setting. If this fails then wait until the following day and perform another import for the day concerned again using the --date option setting. In all cases confirm what data has been imported by referring to the WeeWX log. Whilst wee_import will advise of the number of records processed and the number of unique records found, wee_import does know how many, if any, of the imported records were successfully saved to the database. You should look carefully through the WeeWX log file covering the wee_import session and take note of any records that were not imported. The most common reason for imported records not being saved to the database is because a record with that timestamp already exists in the database, in such cases something similar to the following will be found in the log: Aug 22 14:38:28 stretch12 weewx[863]: manager: unable to add record 2018-09-04 04:20:00 AEST (1535998800) to database 'weewx.sdb': UNIQUE constraint failed: archive.dateTime In such cases you should take note of the timestamp of the record(s) concerned and make a decision about whether to delete the pre-existing record and re-import the record or retain the pre-existing record.","title":"Weather Underground"},{"location":"utilities/wee_import-wu/#mapping-data-to-archive-fields","text":"A Weather Underground import will populate WeeWX archive fields as follows: Provided data exists for each field returned by the Weather Underground API, the following WeeWX archive fields will be directly populated by imported data: dateTime barometer dewpoint heatindex outHumidity outTemp radiation rain rainRate UV windchill windDir windGust windSpeed Note If an appropriate field is not returned by the Weather Underground API the corresponding WeeWX archive field will contain no data. If the API returns an appropriate field but with no data, the corresponding WeeWX archive field will be set to None/null . For example, if the API response has no solar radiation field the WeeWX radiation archive field will have no data stored. However, if the API response has a solar radiation field but contains no data, the WeeWX radiation archive field will be None/null . The following WeeWX archive fields will be populated from other settings or configuration options: interval usUnits The following WeeWX archive fields will be populated with values derived from the imported data provided calc_missing = True is included in the [WU] section of the import configuration file and the field exists in the in-use WeeWX archive table schema. altimeter ET pressure Note If calc_missing = False is included in the [WU] section of the import configuration file being used then all of the above fields will be set to None/null . The calc_missing option default is True .","title":"Mapping data to archive fields"},{"location":"utilities/wee_import-wu/#step-by-step-instructions","text":"To import observations from a Weather Underground PWS history: Obtain the weather station ID of the Weather Underground PWS from which data is to be imported. The station ID will be a sequence of numbers and upper case letters that is usually 11 or 12 characters in length. For the purposes of the following examples a weather station ID of ISTATION123 will be used. Obtain the API key to be used to access the Weather Underground API. This will be a seemingly random alphanumeric sequence of 32 characters. API keys are available to Weather Underground PWS contributors by logging on to their Weather Underground account and accessing Member Settings. Make a backup of the WeeWX database in case the import should go awry. Create an import configuration file. In this case we will make a copy of the example Weather Underground import configuration file and save it as wu.conf in the /var/tmp directory: $ cp /home/weewx/util/import/wu-example.conf /var/tmp/wu.conf Confirm that the source option is set to WU : source = WU Confirm that the following options in the [WU] section are correctly set: station_id . The 11 or 12 character weather station ID of the Weather Underground PWS that will be the source of the imported data. api_key . The 32 character API key to be used to access the Weather Underground API. interval . Determines how the WeeWX interval field is derived. qc . Determines whether quality control checks are performed on the imported data. Note As Weather Underground imports at times contain nonsense values, particularly for fields for which no data were uploaded to Weather Underground by the PWS, the use of quality control checks on imported data can prevent these nonsense values from being imported and contaminating the WeeWX database. calc_missing . Determines whether missing derived observations will be calculated from the imported data. ignore_invalid_data . Determines whether invalid data in a source field is ignored or the import aborted. tranche . The number of records written to the WeeWX database in each transaction. wind_direction . Determines how imported wind direction fields are interpreted. When first importing data it is prudent to do a dry run import before any data is actually imported. A dry run import will perform all steps of the import without actually writing imported data to the WeeWX database. In addition, consideration should be given to any additional options to be used such as --date , --from or --to . To perform a dry run enter the following command: wee_import --import-config=/var/tmp/wu.conf --from=2016-01-20T22:30 --to=2016-01-23T06:00 --dry-run In this case the --from and --to options have been used to import Weather Underground records from 10:30pm on 20 January 2016 to 6:00am on 23 January 2016 inclusive. Note If the --date option is omitted, or a date (not date-time) range is specified using the --from and --to options during a Weather Underground import, then one or more full days of history data will be imported. This includes records timestamped from 00:00 (inclusive) at the start of the day up to but NOT including the 00:00 record at the end of the last day. As the timestamped record refers to observations of the previous interval, such an import actually includes one record with observations from the previous day (the 00:00 record at the start of the day). Whilst this will not present a problem for wee_import as any records being imported with a timestamp that already exists in the WeeWX database are ignored, you may wish to use the --from and --to options with a suitable date-time range to precisely control which records are imported. Note wee_import obtains Weather Underground daily history data one day at a time via a HTTP request and as such the import of large time spans of data may take some time. Such imports may be best handled as a series of imports of smaller time spans. This will result in a short preamble with details on the data source, the destination of the imported data and some other details on how the data will be processed. The import will then be performed but no data will be written to the WeeWX database. The output should be similar to: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Observation history for Weather Underground station 'ISTATION123' will be imported. Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Observations timestamped after 2016-01-20 22:30:00 AEST (1453293000) and up to and including 2016-01-23 06:00:00 AEST (1453492800) will be imported. This is a dry run, imported data will not be saved to archive. Starting dry run import ... Records covering multiple periods have been identified for import. Period 1 ... Unique records processed: 18; Last timestamp: 2016-01-20 23:55:00 AEST (1453298100) Period 2 ... Unique records processed: 284; Last timestamp: 2016-01-21 23:55:00 AEST (1453384500) Period 3 ... Unique records processed: 284; Last timestamp: 2016-01-22 23:55:00 AEST (1453470900) Period 4 ... Unique records processed: 71; Last timestamp: 2016-01-23 06:00:00 AEST (1453492800) Finished dry run import 657 records were processed and 657 unique records would have been imported. Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to an incorrect station ID, an incorrect date or Weather Underground API problems. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. Once the dry run results are satisfactory the source data can be imported using the following command: wee_import --import-config=/var/tmp/wu.conf --from=2016-01-20T22:30 --to=2016-01-23T06:00 This will result in a short preamble similar to that of a dry run. At the end of the preamble there will be a prompt: Using WeeWX configuration file /home/weewx/weewx.conf Starting wee_import... Observation history for Weather Underground station 'ISTATION123' will be imported. Using database binding 'wx_binding', which is bound to database 'weewx.sdb' Destination table 'archive' unit system is '0x01' (US). Missing derived observations will be calculated. Observations timestamped after 2016-01-20 22:30:00 AEST (1453293000) and up to and including 2016-01-23 06:00:00 AEST (1453492800) will be imported. Starting import ... Records covering multiple periods have been identified for import. Period 1 ... Proceeding will save all imported records in the WeeWX archive. Are you sure you want to proceed (y/n)? Note wee_import obtains Weather Underground data one day at a time via a HTTP request and as such the import of large time spans of data may take some time. Such imports may be best handled as a series of imports of smaller time spans. If the import parameters are acceptable enter y to proceed with the import or n to abort the import. If the import is confirmed, the source data will be imported, processed and saved in the WeeWX database. Information on the progress of the import will be displayed similar to the following: Unique records processed: 18; Last timestamp: 2016-01-20 23:55:00 AEST (1453298100) Period 2 ... Unique records processed: 284; Last timestamp: 2016-01-21 23:55:00 AEST (1453384500) Period 3 ... Unique records processed: 284; Last timestamp: 2016-01-22 23:55:00 AEST (1453470900) Note Any periods for which no data could be obtained will be skipped. The lack of data may be due to an incorrect station ID, an incorrect date or Weather Underground API problems. A short explanatory note to this effect will be displayed against the period concerned and an entry included in the log. The line commencing with Unique records processed should update as records are imported with progress information on number of records processed, number of unique records imported and the date time of the latest record processed. If the import spans multiple days then a new Period line is created for each day. Once the initial import is complete wee_import will, if requested, calculate any missing derived observations and rebuild the daily summaries. A brief summary should be displayed similar to the following: Calculating missing derived observations ... Processing record: 204; Last record: 2016-01-22 23:55:00 AEST (1453470900) Recalculating daily summaries... Finished recalculating daily summaries Finished calculating missing derived observations When the import is complete a brief summary is displayed similar to the following: Finished import 657 records were processed and 657 unique records imported in 78.97 seconds. Those records with a timestamp already in the archive will not have been imported. Confirm successful import in the WeeWX log file. Note The new (2019) Weather Underground API appears to have an issue when obtaining historical data for the current day. The first time the API is queried the API returns all historical data up to and including the most recent record. However, subsequent later API queries during the same day return the same set of records rather than all records up to and including the time of the latest API query. Users importing Weather Underground data that includes data from the current day are advised to carefully check the WeeWX log to ensure that all expected records were imported. If some records are missing from the current day try running an import for the current day again using the --date option setting. If this fails then wait until the following day and perform another import for the day concerned again using the --date option setting. In all cases confirm what data has been imported by referring to the WeeWX log. Whilst wee_import will advise of the number of records processed and the number of unique records found, wee_import does know how many, if any, of the imported records were successfully saved to the database. You should look carefully through the WeeWX log file covering the wee_import session and take note of any records that were not imported. The most common reason for imported records not being saved to the database is because a record with that timestamp already exists in the database, in such cases something similar to the following will be found in the log: Aug 22 14:38:28 stretch12 weewx[863]: manager: unable to add record 2018-09-04 04:20:00 AEST (1535998800) to database 'weewx.sdb': UNIQUE constraint failed: archive.dateTime In such cases you should take note of the timestamp of the record(s) concerned and make a decision about whether to delete the pre-existing record and re-import the record or retain the pre-existing record.","title":"Step-by-step instructions"},{"location":"utilities/wee_reports/","text":"wee_reports \u00b6 In normal operation, WeeWX generates reports at each archive interval, when new data arrive. The reports utility is used to generate reports on demand. It uses the same configuration file that weewxd uses. Specify --help to see how it is used: wee_reports --help usage: wee_reports --help wee_reports [CONFIG_FILE | --config=CONFIG_FILE] wee_reports [CONFIG_FILE | --config=CONFIG_FILE] --epoch=TIMESTAMP wee_reports [CONFIG_FILE | --config=CONFIG_FILE] --date=YYYY-MM-DD --time=HH:MM Run all reports defined in the specified configuration file. Use this utility to run reports immediately instead of waiting for the end of an archive interval. positional arguments: CONFIG_FILE optional arguments: -h, --help show this help message and exit --config CONFIG_FILE Use the configuration file CONFIG_FILE --epoch EPOCH_TIME Time of the report in unix epoch time --date YYYY-MM-DD Date for the report --time HH:MM Time of day for the report Specify either the positional argument CONFIG_FILE, or the optional argument --config, but not both. By default, the reports are generated as of the last timestamp in the database, however, an explicit time can be given by using either option --epoch , or by using options --date and --time . --config=FILENAME \u00b6 An optional path to the configuration file (usually, weewx.conf ) can be given as either a positional argument, or by using option --config (but not both). If not given, the location of the configuration file will be inferred. --epoch=EPOCH \u00b6 Generate the reports so that they are current as of the given unix epoch time. wee_reports --epoch=1652367600 This would generate a report for unix epoch time 1652367600 (12-May-2022 at 8AM PDT). --date=YYYY-MM-DD and --time=HH:MM \u00b6 Generate the reports so that they are current as of the given date and time. The date should be given in the form YYYY-MM-DD and the time should be given as HH:DD . wee_reports /home/weewx/weewx.conf --date=2022-05-12 --time=08:00 This would generate a report for 12-May-2022 at 8AM (unix epoch time 1652367600).","title":"wee_reports"},{"location":"utilities/wee_reports/#wee_reports","text":"In normal operation, WeeWX generates reports at each archive interval, when new data arrive. The reports utility is used to generate reports on demand. It uses the same configuration file that weewxd uses. Specify --help to see how it is used: wee_reports --help usage: wee_reports --help wee_reports [CONFIG_FILE | --config=CONFIG_FILE] wee_reports [CONFIG_FILE | --config=CONFIG_FILE] --epoch=TIMESTAMP wee_reports [CONFIG_FILE | --config=CONFIG_FILE] --date=YYYY-MM-DD --time=HH:MM Run all reports defined in the specified configuration file. Use this utility to run reports immediately instead of waiting for the end of an archive interval. positional arguments: CONFIG_FILE optional arguments: -h, --help show this help message and exit --config CONFIG_FILE Use the configuration file CONFIG_FILE --epoch EPOCH_TIME Time of the report in unix epoch time --date YYYY-MM-DD Date for the report --time HH:MM Time of day for the report Specify either the positional argument CONFIG_FILE, or the optional argument --config, but not both. By default, the reports are generated as of the last timestamp in the database, however, an explicit time can be given by using either option --epoch , or by using options --date and --time .","title":"wee_reports"},{"location":"utilities/wee_reports/#-configfilename","text":"An optional path to the configuration file (usually, weewx.conf ) can be given as either a positional argument, or by using option --config (but not both). If not given, the location of the configuration file will be inferred.","title":"--config=FILENAME"},{"location":"utilities/wee_reports/#-epochepoch","text":"Generate the reports so that they are current as of the given unix epoch time. wee_reports --epoch=1652367600 This would generate a report for unix epoch time 1652367600 (12-May-2022 at 8AM PDT).","title":"--epoch=EPOCH"},{"location":"utilities/wee_reports/#-dateyyyy-mm-dd-and-timehhmm","text":"Generate the reports so that they are current as of the given date and time. The date should be given in the form YYYY-MM-DD and the time should be given as HH:DD . wee_reports /home/weewx/weewx.conf --date=2022-05-12 --time=08:00 This would generate a report for 12-May-2022 at 8AM (unix epoch time 1652367600).","title":"--date=YYYY-MM-DD and --time=HH:MM"},{"location":"utilities/weectl-about/","text":"weectl \u00b6 The command weectl is the entry point for most WeeWX utilities. To see the various utilities available, run it with the --help option: $ weectl --help usage: weectl -v|--version weectl -h|--help weectl database --help weectl debug --help weectl extension --help weectl station --help optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit Available subcommands: {database,debug,extension,station} database Manages WeeWX databases. debug Generate debug info. extension List, install, or uninstall extensions. station Create, modify, or upgrade a station data area. weectl database \u00b6 Use this subcommand to manage your WeeWX database weectl debug \u00b6 Use this subcommand to generate output that captures your WeeWX environment and configuration file. This is useful for remote debugging. weectl extension \u00b6 Use this subcommand to install, uninstall, and list WeeWX extensions. weectl station \u00b6 Use this subcommand to create and manage stations.","title":"weectl"},{"location":"utilities/weectl-about/#weectl","text":"The command weectl is the entry point for most WeeWX utilities. To see the various utilities available, run it with the --help option: $ weectl --help usage: weectl -v|--version weectl -h|--help weectl database --help weectl debug --help weectl extension --help weectl station --help optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit Available subcommands: {database,debug,extension,station} database Manages WeeWX databases. debug Generate debug info. extension List, install, or uninstall extensions. station Create, modify, or upgrade a station data area.","title":"weectl"},{"location":"utilities/weectl-about/#weectl-database","text":"Use this subcommand to manage your WeeWX database","title":"weectl database"},{"location":"utilities/weectl-about/#weectl-debug","text":"Use this subcommand to generate output that captures your WeeWX environment and configuration file. This is useful for remote debugging.","title":"weectl debug"},{"location":"utilities/weectl-about/#weectl-extension","text":"Use this subcommand to install, uninstall, and list WeeWX extensions.","title":"weectl extension"},{"location":"utilities/weectl-about/#weectl-station","text":"Use this subcommand to create and manage stations.","title":"weectl station"},{"location":"utilities/weectl-database/","text":"weectl database \u00b6 Use the weectl subcommand database to manage the WeeWX database. Specify --help to see the various actions and options: weectl database --help Create a new database \u00b6 weectl database create [--config=FILENAME] [--binding=BINDING] [--dry-run] This action is used to create a new database by using the specifications in the WeeWX configuration file. It is rarely needed, as weewxd will do this automatically on startup. Use the --help option to see how to use this action. weectl database create --help Drop the daily summaries \u00b6 weectl database drop-daily [--config=FILENAME] [--binding=BINDING] [--dry-run] In addition to the regular archive data, every WeeWX database also includes a daily summary table for each observation type. Because there can be dozens of observation types, there can be dozens of these daily summaries. It does not happen very often, but there can be occasions when it's necessary to drop them all and then rebuild them. Dropping them by hand would be very tedious! This action does them all at once. Use the --help option to see how to use this action: weectl database drop-daily --help Rebuild the daily summaries \u00b6 weectl database rebuild-daily [[--date=YYYY-mm-dd] | [--from=YYYY-mm-dd] [--to=YYYY-mm-dd]] [--config=FILENAME] [--binding=BINDING] [--dry-run] This action is the inverse of action weectk database drop-daily in that it rebuilds the daily summaries from the archive data. The action rebuild-daily accepts a number of date related options, --date , --from and --to that allow selective rebuilding of the daily summaries for one or more days rather than for the entire archive history. These options may be useful if bogus data has been removed from the archive covering a single day or a period of few days. The daily summaries can then be rebuilt for this period only, resulting in a faster rebuild and detailed low/high values and the associated times being retained for unaffected days. Rebuild a specific date \u00b6 weectl database rebuild-daily --date=YYYY-mm-dd Use this form to rebuild the daily summaries for a specific date. Rebuild for a range of dates \u00b6 weectl database rebuild-daily --from=YYYY-mm-dd --to=YYYY-mm-dd Use this form to rebuild for an inclusive interval of dates. The default value for --from is from the first day in the database. The default value for --to is the last day in the database. Note The period defined by --to and --from is inclusive. Add a new observation type to the database \u00b6 weectl database add-column NAME [--type=COLUMN-DEF] [--config=FILENAME] [--binding=BINDING] [--dry-run] This action adds a new database observation type (column), given by NAME , to the database. The option --type is any valid SQL column definition. It defaults to REAL . For example, to add a new observation pulseCount with a SQL type of INTEGER , whose default value is zero: weectl database add-column pulseCount --type \"INTEGER DEFAULT 0\" Rename an observation type \u00b6 weectl database rename-column FROM-NAME TO-NAME [--config=FILENAME [--binding=BINDING] [--dry-run] Use this action to rename a database observation type (column) to a new name. For example, to rename the column luminosity in your database to illuminance : weectl database rename-column luminosity illuminance Drop (remove) observation types \u00b6 weectl database drop-columns NAME... [--config=FILENAME] [--binding=BINDING] [--dry-run] This action will drop one or more observation types (columns) from the database. If more than one column name is given, they should be separated by spaces. Note When dropping columns from a SQLite database, the entire database must be copied except for the dropped columns. Because this can be quite slow, if you are dropping more than one column, it is better to do them all in one pass. This is why action drop-columns accepts more than one name. Reconfigure a database \u00b6 weectl database reconfigure [--config=FILENAME] [--binding=BINDING] [--dry-run] This action is useful for changing the schema or unit system in your database. It creates a new database with the same name as the old, except with the suffix _new attached at the end (nominally, weewx.sdb_new if you are using SQLite, weewx_new if you are using MySQL). It then initializes the database with the schema specified in weewx.conf . Finally, it copies over the data from your old database into the new database. See the section Changing the database unit system in an existing database in the Customization Guide for step-by-step instructions that use this option. Transfer (copy) a database \u00b6 weectl database transfer --dest-binding=BINDING-NAME [--config=FILENAME] [--binding=BINDING] [--dry-run] This action is useful for moving your database from one type of database to another, such as from SQLite to MySQL. To use it, you must have two bindings specified in your weewx.conf configuration file. One will serve as the source, the other as the destination. Specify the source binding with option --binding (default wx_binding ), the destination binding with option --dest-binding (required). See the Wiki for examples of moving data from SQLite to MySQL , and from MySQL to SQLite by using weectl database transfer . Calculate missing derived variables \u00b6 weectl database calc-missing [--date=YYYY-mm-dd | [--from=YYYY-mm-dd[THH:MM]] [--to=YYYY-mm-dd[THH:MM]]] [--config=FILENAME] [--binding=BINDING-NAME] [--dry-run] This action calculates derived observations for archive records in the database and then stores the calculated observations in the database. This can be useful if erroneous archive data is corrected or some additional observational data is added to the archive that may alter previously calculated or missing derived observations. The period over which the derived observations are calculated can be limited through use of the --date , --from and/or --to options. When used without any of these options --calc-missing will calculate derived observations for all archive records in the database. The --date option limits the calculation of derived observations to the specified date only. The --from and --to options can be used together to specify the start and end date-time respectively of the period over which derived observations will be calculated. If --from is used by itself the period is fom the date-time specified up to and including the last archive record in the database. If --to is used by itself the period is the first archive record in the database through to the specified date-time. weectl database calc-missing weectl database calc-missing --date=YYYY-mm-dd weectl database calc-missing --from=YYYY-mm-dd[THH:MM] weectl database calc-missing --to=YYYY-mm-dd[THH:MM] weectl database calc-missing --from=YYYY-mm-dd[THH:MM] --to=YYYY-mm-dd[THH:MM] Note Action calc-missing uses the StdWXCalculate service to calculate missing derived observations. The data binding used by the StdWXCalculate service should normally match the data binding of the database being operated on by calc-missing . Those who use custom or additional data bindings should take care to ensure the correct data bindings are used by both calc-missing and the StdWXCalculate service. Check a database \u00b6 weectl database check [--config=FILENAME] [--binding=BINDING-NAME] Databases created earlier than 3.7.0 (released 11-March-2017) have a flaw that prevents them from being used with archive intervals that change with time. This utility check whether your database is affected. See Issue #61 . Update a database \u00b6 weectl database update [--config=FILENAME] [--binding=BINDING-NAME] [--dry-run] This action updates the daily summary tables to use interval weighted calculations (see Issue #61 ) as well as recalculating the windSpeed maximum daily values and times (see Issue #195 ). Interval weighted calculations are only applied to the daily summaries if not previously applied. The update process is irreversible and users are advised to back up their database before performing this action. For further information on interval weighting and recalculation of daily windSpeed maximum values, see the sections Changes to daily summaries and Recalculation of wind speed maximum values in the Upgrade Guide . Recalculate daily summary weights \u00b6 weectl database reweight [[--date=YYYY-mm-dd] | [--from=YYYY-mm-dd] [--to=YYYY-mm-dd]] [--config=FILENAME] [--binding=BINDING] [--dry-run] As an alternative to dropping and rebuilding the daily summaries, this action simply rebuilds the weighted daily sums (used to calculate averages) from the archive data. It does not touch the highs and lows. It is much faster than weectl database rebuild-daily , and has the advantage that the highs and lows remain unchanged. Other options are as in weectl database rebuild-daily . Options \u00b6 These are options used by most of the actions. --config \u00b6 Path to the configuration file. Default is ~/weewx-data/weewx.conf . --binding \u00b6 The database binding to use. Default is wx_binding . --dry-run \u00b6 Show what would happen if the action was run, but do not actually make any writable changes.","title":"weectl database"},{"location":"utilities/weectl-database/#weectl-database","text":"Use the weectl subcommand database to manage the WeeWX database. Specify --help to see the various actions and options: weectl database --help","title":"weectl database"},{"location":"utilities/weectl-database/#create-a-new-database","text":"weectl database create [--config=FILENAME] [--binding=BINDING] [--dry-run] This action is used to create a new database by using the specifications in the WeeWX configuration file. It is rarely needed, as weewxd will do this automatically on startup. Use the --help option to see how to use this action. weectl database create --help","title":"Create a new database"},{"location":"utilities/weectl-database/#drop-the-daily-summaries","text":"weectl database drop-daily [--config=FILENAME] [--binding=BINDING] [--dry-run] In addition to the regular archive data, every WeeWX database also includes a daily summary table for each observation type. Because there can be dozens of observation types, there can be dozens of these daily summaries. It does not happen very often, but there can be occasions when it's necessary to drop them all and then rebuild them. Dropping them by hand would be very tedious! This action does them all at once. Use the --help option to see how to use this action: weectl database drop-daily --help","title":"Drop the daily summaries"},{"location":"utilities/weectl-database/#rebuild-the-daily-summaries","text":"weectl database rebuild-daily [[--date=YYYY-mm-dd] | [--from=YYYY-mm-dd] [--to=YYYY-mm-dd]] [--config=FILENAME] [--binding=BINDING] [--dry-run] This action is the inverse of action weectk database drop-daily in that it rebuilds the daily summaries from the archive data. The action rebuild-daily accepts a number of date related options, --date , --from and --to that allow selective rebuilding of the daily summaries for one or more days rather than for the entire archive history. These options may be useful if bogus data has been removed from the archive covering a single day or a period of few days. The daily summaries can then be rebuilt for this period only, resulting in a faster rebuild and detailed low/high values and the associated times being retained for unaffected days.","title":"Rebuild the daily summaries"},{"location":"utilities/weectl-database/#rebuild-a-specific-date","text":"weectl database rebuild-daily --date=YYYY-mm-dd Use this form to rebuild the daily summaries for a specific date.","title":"Rebuild a specific date"},{"location":"utilities/weectl-database/#rebuild-for-a-range-of-dates","text":"weectl database rebuild-daily --from=YYYY-mm-dd --to=YYYY-mm-dd Use this form to rebuild for an inclusive interval of dates. The default value for --from is from the first day in the database. The default value for --to is the last day in the database. Note The period defined by --to and --from is inclusive.","title":"Rebuild for a range of dates"},{"location":"utilities/weectl-database/#add-a-new-observation-type-to-the-database","text":"weectl database add-column NAME [--type=COLUMN-DEF] [--config=FILENAME] [--binding=BINDING] [--dry-run] This action adds a new database observation type (column), given by NAME , to the database. The option --type is any valid SQL column definition. It defaults to REAL . For example, to add a new observation pulseCount with a SQL type of INTEGER , whose default value is zero: weectl database add-column pulseCount --type \"INTEGER DEFAULT 0\"","title":"Add a new observation type to the database"},{"location":"utilities/weectl-database/#rename-an-observation-type","text":"weectl database rename-column FROM-NAME TO-NAME [--config=FILENAME [--binding=BINDING] [--dry-run] Use this action to rename a database observation type (column) to a new name. For example, to rename the column luminosity in your database to illuminance : weectl database rename-column luminosity illuminance","title":"Rename an observation type"},{"location":"utilities/weectl-database/#drop-remove-observation-types","text":"weectl database drop-columns NAME... [--config=FILENAME] [--binding=BINDING] [--dry-run] This action will drop one or more observation types (columns) from the database. If more than one column name is given, they should be separated by spaces. Note When dropping columns from a SQLite database, the entire database must be copied except for the dropped columns. Because this can be quite slow, if you are dropping more than one column, it is better to do them all in one pass. This is why action drop-columns accepts more than one name.","title":"Drop (remove) observation types"},{"location":"utilities/weectl-database/#reconfigure-a-database","text":"weectl database reconfigure [--config=FILENAME] [--binding=BINDING] [--dry-run] This action is useful for changing the schema or unit system in your database. It creates a new database with the same name as the old, except with the suffix _new attached at the end (nominally, weewx.sdb_new if you are using SQLite, weewx_new if you are using MySQL). It then initializes the database with the schema specified in weewx.conf . Finally, it copies over the data from your old database into the new database. See the section Changing the database unit system in an existing database in the Customization Guide for step-by-step instructions that use this option.","title":"Reconfigure a database"},{"location":"utilities/weectl-database/#transfer-copy-a-database","text":"weectl database transfer --dest-binding=BINDING-NAME [--config=FILENAME] [--binding=BINDING] [--dry-run] This action is useful for moving your database from one type of database to another, such as from SQLite to MySQL. To use it, you must have two bindings specified in your weewx.conf configuration file. One will serve as the source, the other as the destination. Specify the source binding with option --binding (default wx_binding ), the destination binding with option --dest-binding (required). See the Wiki for examples of moving data from SQLite to MySQL , and from MySQL to SQLite by using weectl database transfer .","title":"Transfer (copy) a database"},{"location":"utilities/weectl-database/#calculate-missing-derived-variables","text":"weectl database calc-missing [--date=YYYY-mm-dd | [--from=YYYY-mm-dd[THH:MM]] [--to=YYYY-mm-dd[THH:MM]]] [--config=FILENAME] [--binding=BINDING-NAME] [--dry-run] This action calculates derived observations for archive records in the database and then stores the calculated observations in the database. This can be useful if erroneous archive data is corrected or some additional observational data is added to the archive that may alter previously calculated or missing derived observations. The period over which the derived observations are calculated can be limited through use of the --date , --from and/or --to options. When used without any of these options --calc-missing will calculate derived observations for all archive records in the database. The --date option limits the calculation of derived observations to the specified date only. The --from and --to options can be used together to specify the start and end date-time respectively of the period over which derived observations will be calculated. If --from is used by itself the period is fom the date-time specified up to and including the last archive record in the database. If --to is used by itself the period is the first archive record in the database through to the specified date-time. weectl database calc-missing weectl database calc-missing --date=YYYY-mm-dd weectl database calc-missing --from=YYYY-mm-dd[THH:MM] weectl database calc-missing --to=YYYY-mm-dd[THH:MM] weectl database calc-missing --from=YYYY-mm-dd[THH:MM] --to=YYYY-mm-dd[THH:MM] Note Action calc-missing uses the StdWXCalculate service to calculate missing derived observations. The data binding used by the StdWXCalculate service should normally match the data binding of the database being operated on by calc-missing . Those who use custom or additional data bindings should take care to ensure the correct data bindings are used by both calc-missing and the StdWXCalculate service.","title":"Calculate missing derived variables"},{"location":"utilities/weectl-database/#check-a-database","text":"weectl database check [--config=FILENAME] [--binding=BINDING-NAME] Databases created earlier than 3.7.0 (released 11-March-2017) have a flaw that prevents them from being used with archive intervals that change with time. This utility check whether your database is affected. See Issue #61 .","title":"Check a database"},{"location":"utilities/weectl-database/#update-a-database","text":"weectl database update [--config=FILENAME] [--binding=BINDING-NAME] [--dry-run] This action updates the daily summary tables to use interval weighted calculations (see Issue #61 ) as well as recalculating the windSpeed maximum daily values and times (see Issue #195 ). Interval weighted calculations are only applied to the daily summaries if not previously applied. The update process is irreversible and users are advised to back up their database before performing this action. For further information on interval weighting and recalculation of daily windSpeed maximum values, see the sections Changes to daily summaries and Recalculation of wind speed maximum values in the Upgrade Guide .","title":"Update a database"},{"location":"utilities/weectl-database/#recalculate-daily-summary-weights","text":"weectl database reweight [[--date=YYYY-mm-dd] | [--from=YYYY-mm-dd] [--to=YYYY-mm-dd]] [--config=FILENAME] [--binding=BINDING] [--dry-run] As an alternative to dropping and rebuilding the daily summaries, this action simply rebuilds the weighted daily sums (used to calculate averages) from the archive data. It does not touch the highs and lows. It is much faster than weectl database rebuild-daily , and has the advantage that the highs and lows remain unchanged. Other options are as in weectl database rebuild-daily .","title":"Recalculate daily summary weights"},{"location":"utilities/weectl-database/#options","text":"These are options used by most of the actions.","title":"Options"},{"location":"utilities/weectl-database/#-config","text":"Path to the configuration file. Default is ~/weewx-data/weewx.conf .","title":"--config"},{"location":"utilities/weectl-database/#-binding","text":"The database binding to use. Default is wx_binding .","title":"--binding"},{"location":"utilities/weectl-database/#-dry-run","text":"Show what would happen if the action was run, but do not actually make any writable changes.","title":"--dry-run"},{"location":"utilities/weectl-debug/","text":"weectl debug \u00b6 Use the weectl subcommand debug to produce information about your environment. Specify --help to see how it is used: weectl debug --help Create debug information \u00b6 weectl debug [--config=FILENAME] [--output=FILENAME] Troubleshooting problems when running WeeWX often involves analysis of a number of pieces of seemingly disparate system and WeeWX related information. The weectl debug command gathers all this information together into a single output to make troubleshooting easier. The command is particularly useful for new users as the output may be redirected to a file then emailed or posted to a forum to assist in remote troubleshooting. The utility produces two types of information: General information about your environment. This includes: System information, Load information, Driver type, Any installed extensions, and Information about your databse An obfuscated copy of your configuration file (nominally, weewx.conf ). Warning The weectl debug output includes a copy of the WeeWX config file (typically weewx.conf ) and whilst the utility attempts to obfuscate any personal or sensitive information, the user should check the output carefully for any remaining personal or sensitive information before emailing or posting the output publicly. Options \u00b6 --config=FILENAME \u00b6 The utility is pretty good about guessing where the configuration file is, but if you have an unusual installation or multiple stations, you may have to tell it explicitly. You can do this using the --config option. For example, weectl debug --config=/etc/weewx/alt_config.conf --output=FILENAME \u00b6 By default, weectl debug writes to standard output (the console). However, the output can be sent somewhere else using option --output . For example, to send it to /var/tmp/weewx.info : weectl debug --output=/var/tmp/weewx.info","title":"weectl debug"},{"location":"utilities/weectl-debug/#weectl-debug","text":"Use the weectl subcommand debug to produce information about your environment. Specify --help to see how it is used: weectl debug --help","title":"weectl debug"},{"location":"utilities/weectl-debug/#create-debug-information","text":"weectl debug [--config=FILENAME] [--output=FILENAME] Troubleshooting problems when running WeeWX often involves analysis of a number of pieces of seemingly disparate system and WeeWX related information. The weectl debug command gathers all this information together into a single output to make troubleshooting easier. The command is particularly useful for new users as the output may be redirected to a file then emailed or posted to a forum to assist in remote troubleshooting. The utility produces two types of information: General information about your environment. This includes: System information, Load information, Driver type, Any installed extensions, and Information about your databse An obfuscated copy of your configuration file (nominally, weewx.conf ). Warning The weectl debug output includes a copy of the WeeWX config file (typically weewx.conf ) and whilst the utility attempts to obfuscate any personal or sensitive information, the user should check the output carefully for any remaining personal or sensitive information before emailing or posting the output publicly.","title":"Create debug information"},{"location":"utilities/weectl-debug/#options","text":"","title":"Options"},{"location":"utilities/weectl-debug/#-configfilename","text":"The utility is pretty good about guessing where the configuration file is, but if you have an unusual installation or multiple stations, you may have to tell it explicitly. You can do this using the --config option. For example, weectl debug --config=/etc/weewx/alt_config.conf","title":"--config=FILENAME"},{"location":"utilities/weectl-debug/#-outputfilename","text":"By default, weectl debug writes to standard output (the console). However, the output can be sent somewhere else using option --output . For example, to send it to /var/tmp/weewx.info : weectl debug --output=/var/tmp/weewx.info","title":"--output=FILENAME"},{"location":"utilities/weectl-device/","text":"weectl device \u00b6 The weectl subcommand device is used to configure hardware settings, such as rain bucket size, station archive interval, altitude, EEPROM constants, etc. , on your station. In order to do its job, it depends on optional code being present in the hardware driver. Because not all drivers have this code, it may not work for your specific device. If it does not, you will have to consult your manufacturer's instructions for how to set these things through your console or other means. weectl device uses the option station_type in weewx.conf to determine what device you are using and what options to display. Make sure it is set correctly before attempting to use this utility. Because weectl device uses hardware-specific code, its options are different for every station type. You should run it with --help to see how to use it for your specific station: weectl device --help The utility requires a WeeWX configuration file. If no file is specified, it will look for a file called weewx.conf in the standard location. If your configuration file is in a non-standard location, specify the path to the configuration file either as the first argument, or by using the --config option. For example, weectl device /path/to/weewx.conf --help or weectl device --config=/path/to/weewx.conf --help For details about the options available for each type of hardware, see the appropriate hardware section: AcuRite CC3000 FineOffset TE923 Ultimeter Vantage WMR100 WMR300 WMR9x8 WS1 WS23xx WS28xx","title":"weectl device"},{"location":"utilities/weectl-device/#weectl-device","text":"The weectl subcommand device is used to configure hardware settings, such as rain bucket size, station archive interval, altitude, EEPROM constants, etc. , on your station. In order to do its job, it depends on optional code being present in the hardware driver. Because not all drivers have this code, it may not work for your specific device. If it does not, you will have to consult your manufacturer's instructions for how to set these things through your console or other means. weectl device uses the option station_type in weewx.conf to determine what device you are using and what options to display. Make sure it is set correctly before attempting to use this utility. Because weectl device uses hardware-specific code, its options are different for every station type. You should run it with --help to see how to use it for your specific station: weectl device --help The utility requires a WeeWX configuration file. If no file is specified, it will look for a file called weewx.conf in the standard location. If your configuration file is in a non-standard location, specify the path to the configuration file either as the first argument, or by using the --config option. For example, weectl device /path/to/weewx.conf --help or weectl device --config=/path/to/weewx.conf --help For details about the options available for each type of hardware, see the appropriate hardware section: AcuRite CC3000 FineOffset TE923 Ultimeter Vantage WMR100 WMR300 WMR9x8 WS1 WS23xx WS28xx","title":"weectl device"},{"location":"utilities/weectl-extension/","text":"weectl extension \u00b6 Use the weectl subcommand extension to manage WeeWX extensions. Specify --help to see the actions and options: weectl extension --help List installed extensions \u00b6 weectl extension list [--config=FILENAME] [--dry-run] This action will list all the extensions that you have installed. Install an extension \u00b6 weectl extension install (FILE|DIR|URL) This action will install an extension from a zip file, tar file, directory, or URL. For example, this would install the windy extension from the latest zip file located at github.com : weectl extension install https://github.com/matthewwall/weewx-windy/archive/master.zip This would install the windy extension from a compressed tar archive in the current directory: weectl extension install windy-0.1.tgz This would install the windy extension from a zip file in the Downloads directory: weectl extension install ~/Downloads/windy-0.1.zip Uninstall an extension \u00b6 weectl extension uninstall NAME This action uninstalls an extension. Use the list action to see what to use for NAME . For example, this would uninstall the extension called windy : weectl extension uninstall windy Examples \u00b6 These examples illustrate how to use the extension installer to install, list, and uninstall the windy extension. Do a dry run of installing an uploader for the Windy website, maximum verbosity: % weectl extension install https://github.com/matthewwall/weewx-windy/archive/master.zip --dry-run --verbosity = 3 Request to install 'https://github.com/matthewwall/weewx-windy/archive/master.zip' This is a dry run. Nothing will actually be done . Extracting from zip archive /var/folders/xm/72q6zf8j71x8df2cqh0j9f6c0000gn/T/tmpuvuc_c0k Request to install extension found in directory /var/folders/xm/72q6zf8j71x8df2cqh0j9f6c0000gn/T/tmpif_nj_0g/weewx-windy-master/ Found extension with name 'windy' Copying new files Copying from '/var/folders/xm/72q6zf8j71x8df2cqh0j9f6c0000gn/T/tmpif_nj_0g/weewx-windy-master/bin/user/windy.py' to '/Users/Shared/weewx/bin/user/windy.py' Copied 0 files Adding services to service lists Added new service user.windy.Windy to restful_services Adding sections to configuration file Merged extension settings into configuration file Saving installer file to /Users/Shared/weewx/bin/user/installer/windy Finished installing extension windy from https://github.com/matthewwall/weewx-windy/archive/master.zip This was a dry run. Nothing was actually done . Do it for real, default verbosity: % weectl extension install https://github.com/matthewwall/weewx-windy/archive/master.zip Request to install 'https://github.com/matthewwall/weewx-windy/archive/master.zip' Extracting from zip archive /var/folders/xm/72q6zf8j71x8df2cqh0j9f6c0000gn/T/tmpk8ggl4qr Saving installer file to /Users/Shared/weewx/bin/user/installer/windy Saved configuration dictionary. Backup copy at /Users/Shared/weewx/weewx.conf.20230110152037 Finished installing extension windy from https://github.com/matthewwall/weewx-windy/archive/master.zip List the results: % weectl extension list Extension Name Version Description windy 0.7 Upload weather data to Windy. Uninstall the extension: % weectl extension uninstall windy Request to remove extension 'windy' Finished removing extension 'windy' Options \u00b6 These are options used by most of the actions. --help \u00b6 Show the help message, then exit. --config \u00b6 Path to the configuration file. Default is ~/weewx-data/weewx.conf . --dry-run \u00b6 Show what would happen if the action was run, but do not actually make any writable changes. --verbosity=(0|1|2|3) \u00b6 How much information to display (0-3).","title":"weectl extension"},{"location":"utilities/weectl-extension/#weectl-extension","text":"Use the weectl subcommand extension to manage WeeWX extensions. Specify --help to see the actions and options: weectl extension --help","title":"weectl extension"},{"location":"utilities/weectl-extension/#list-installed-extensions","text":"weectl extension list [--config=FILENAME] [--dry-run] This action will list all the extensions that you have installed.","title":"List installed extensions"},{"location":"utilities/weectl-extension/#install-an-extension","text":"weectl extension install (FILE|DIR|URL) This action will install an extension from a zip file, tar file, directory, or URL. For example, this would install the windy extension from the latest zip file located at github.com : weectl extension install https://github.com/matthewwall/weewx-windy/archive/master.zip This would install the windy extension from a compressed tar archive in the current directory: weectl extension install windy-0.1.tgz This would install the windy extension from a zip file in the Downloads directory: weectl extension install ~/Downloads/windy-0.1.zip","title":"Install an extension"},{"location":"utilities/weectl-extension/#uninstall-an-extension","text":"weectl extension uninstall NAME This action uninstalls an extension. Use the list action to see what to use for NAME . For example, this would uninstall the extension called windy : weectl extension uninstall windy","title":"Uninstall an extension"},{"location":"utilities/weectl-extension/#examples","text":"These examples illustrate how to use the extension installer to install, list, and uninstall the windy extension. Do a dry run of installing an uploader for the Windy website, maximum verbosity: % weectl extension install https://github.com/matthewwall/weewx-windy/archive/master.zip --dry-run --verbosity = 3 Request to install 'https://github.com/matthewwall/weewx-windy/archive/master.zip' This is a dry run. Nothing will actually be done . Extracting from zip archive /var/folders/xm/72q6zf8j71x8df2cqh0j9f6c0000gn/T/tmpuvuc_c0k Request to install extension found in directory /var/folders/xm/72q6zf8j71x8df2cqh0j9f6c0000gn/T/tmpif_nj_0g/weewx-windy-master/ Found extension with name 'windy' Copying new files Copying from '/var/folders/xm/72q6zf8j71x8df2cqh0j9f6c0000gn/T/tmpif_nj_0g/weewx-windy-master/bin/user/windy.py' to '/Users/Shared/weewx/bin/user/windy.py' Copied 0 files Adding services to service lists Added new service user.windy.Windy to restful_services Adding sections to configuration file Merged extension settings into configuration file Saving installer file to /Users/Shared/weewx/bin/user/installer/windy Finished installing extension windy from https://github.com/matthewwall/weewx-windy/archive/master.zip This was a dry run. Nothing was actually done . Do it for real, default verbosity: % weectl extension install https://github.com/matthewwall/weewx-windy/archive/master.zip Request to install 'https://github.com/matthewwall/weewx-windy/archive/master.zip' Extracting from zip archive /var/folders/xm/72q6zf8j71x8df2cqh0j9f6c0000gn/T/tmpk8ggl4qr Saving installer file to /Users/Shared/weewx/bin/user/installer/windy Saved configuration dictionary. Backup copy at /Users/Shared/weewx/weewx.conf.20230110152037 Finished installing extension windy from https://github.com/matthewwall/weewx-windy/archive/master.zip List the results: % weectl extension list Extension Name Version Description windy 0.7 Upload weather data to Windy. Uninstall the extension: % weectl extension uninstall windy Request to remove extension 'windy' Finished removing extension 'windy'","title":"Examples"},{"location":"utilities/weectl-extension/#options","text":"These are options used by most of the actions.","title":"Options"},{"location":"utilities/weectl-extension/#-help","text":"Show the help message, then exit.","title":"--help"},{"location":"utilities/weectl-extension/#-config","text":"Path to the configuration file. Default is ~/weewx-data/weewx.conf .","title":"--config"},{"location":"utilities/weectl-extension/#-dry-run","text":"Show what would happen if the action was run, but do not actually make any writable changes.","title":"--dry-run"},{"location":"utilities/weectl-extension/#-verbosity0123","text":"How much information to display (0-3).","title":"--verbosity=(0|1|2|3)"},{"location":"utilities/weectl-station/","text":"weectl station \u00b6 Use the weectl subcommand station to manage the data for a station, including its configuration file. Specify --help to see the actions and options. See the section Options below for details of the various options. Create a new station data directory \u00b6 weectl station create [--driver=DRIVER] [--location=LOCATION] [--altitude=ALTITUDE,(foot|meter)] [--latitude=LATITUDE] [--longitude=LONGITUDE] [--register=(y,n) [--station-url=URL]] [--units=(us|metricwx|metric)] [--skin-root=DIRECTORY] [--sqlite-root=DIRECTORY] [--html-root=DIRECTORY] [--user-root=DIRECTORY] [--docs-root=DIRECTORY] [--examples-root=DIRECTORY] [--no-prompt] [--config=FILENAME] [--dist-config=FILENAME] [--dry-run] The create action will create a directory and populate it with station data. After the command completes, the directory will contain: a configuration file called weewx.conf ; documentation; examples; utility files; and skins. This action is typically used to create the initial station configuration when installing WeeWX for the first time. It can also be used to create configurations for multiple stations. If invoked without any options, the create action will prompt you for various settings, such as the type of hardware you are using, the station altitude and location, etc. Use the option --no-prompt to create a configuration without prompts. This will use settings specified as options, and default values for any setting not specified. This is useful when creating a station with an automated script. For example, weectl station create --no-prompt --driver=weewx.drivers.vantage \\ --altitude=\"400,foot\" --latitude=45.1 --longitude=-105.9 \\ --location=\"My Special Station\" will create a station with the indicated values. Default values will be used for any setting that is not specified. Reconfigure an existing station \u00b6 weectl station reconfigure [--driver=DRIVER] [--location=LOCATION] [--altitude=ALTITUDE,(foot|meter)] [--latitude=LATITUDE] [--longitude=LONGITUDE] [--register=(y,n) [--station-url=URL]] [--units=(us|metricwx|metric)] [--skin-root=DIRECTORY] [--sqlite-root=DIRECTORY] [--html-root=DIRECTORY] [--no-backup] [--no-prompt] [--config=FILENAME] [--dry-run] The reconfigure action will modify the contents of an existing configuration file. It is often used to change drivers. If invoked without any options, reconfigure will prompt you for settings. Use the option --no-prompt to reconfigure without prompts. This will use the settings specified as options, and existing values for anything that is not specified. For example, to keep all settings, but change to the Vantage driver you would use weectl station reconfigure --no-prompt --driver=weewx.drivers.vantage Upgrade an existing station \u00b6 weectl station upgrade [--docs-root=DIRECTORY] [--examples-root=DIRECTORY] [--skin-root=DIRECTORY] [--what (config|docs|examples|util|skins)] [--no-backup] [--no-prompt] [--config=FILENAME] [--dist-config=FILENAME] [--dry-run] When you upgrade WeeWX, only the code is upgraded; upgrades to WeeWX do not modify the station data, specifically configuration file, database, or skins. Use the upgrade action to upgrade one or more of these items. weectl station upgrade When invoked with no options, the upgrade action upgrades only the documentation, examples, and utility files. By default, the configuration file and skins are not upgraded. This is to avoid overwriting any changes you might have made. If you wish to upgrade the skins, you must specify --what skins . This will put the current version of the skins into WEEWX_ROOT , leaving timestamped copies of your old skins. weectl station upgrade --what skins If you wish to upgrade the configuration file, specify --what config . This is rarely necessary, since WeeWX is usually backward compatible. weectl station upgrade --what config Options \u00b6 In what follows, WEEWX_ROOT is the directory holding the configuration file. For a pip install, this is typically ~/weewx-data . For a Debian, Redhat, or SUSE install, it is /etc/weewx . --driver=DRIVER \u00b6 Which driver to use. Default is weewx.drivers.simulator . --location=LOCATION \u00b6 A description of your station, such as --location=\"A small town in Rongovia\" Default is WeeWX . --altitude=ALTITUDE \u00b6 The altitude of your station, along with the unit it is measured in. For example, --altitude=50,meter . Note that the unit is measured in the singular ( foot , not feet ). Default is \"0,foot\" . --latitude=LATITUDE \u00b6 The station latitude in decimal degrees. Negative for the southern hemisphere. Default is 0 . --longitude=LONGITUDE \u00b6 The station longitude in decimal degrees. Negative for the western hemisphere. Default is 0 . --register=(y|n) \u00b6 Whether to include the station in the WeeWX registry and map . If you choose to register your station, you must also specify a unique URL for your station with option --station-url . Default is n (do not register). --station-url=URL \u00b6 A unique URL for the station. The station URL identifies each station in the WeeWX registry and map. Example: --station-url=https://www.wunderground.com/dashboard/pws/KNDPETE15 . No default. --units=UNIT_SYSTEM \u00b6 What units to use for your reports. Options are us , metricwx , or metric . See the Appendix Units for details. Default is us . --config=FILENAME \u00b6 Path to the configuration file, relative to WEEWX_ROOT . If the filename starts with a slash ( / ), it is an absolute path. Default is weewx.conf . --weewx-root=DIR \u00b6 The WEEWX_ROOT directory. This is typically ~/weewx-data or /etc/weewx . --skin-root=DIR \u00b6 The location of the directory holding the skins relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is skins . --sqlite-root=DIR \u00b6 The location of the directory holding the SQLite database relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is skins . --html-root=DIR \u00b6 Where generated HTML files should be placed, relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is public_html . --user-root=DIR \u00b6 Where user extensions can be found, relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is bin/user . --docs-root=DIR \u00b6 Where the WeeWX documentation can be found, relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is docs . --examples-root=DIR \u00b6 Where the WeeWX examples can be found, relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is examples . --what \u00b6 By default, the upgrade action will upgrade the documentation, examples, and utility files. However, you can specify exactly what gets upgraded by using the --what option. The --what option understands the following: config - the configuration file docs - the documentation examples - the example extensions util - the system utility files skins - the report templates For example, to upgrade the configuration file and skins only, you would specify weectl station upgrade --what config skins Note The --what option does not take an equal sign ( = ). Just list the desired things to be upgraded, without commas between them. --no-backup \u00b6 If weectl station changes your configuration file or skins, it will save a timestamped copy of the original. If you specify --no-backup , then it will not save a copy. --no-prompt \u00b6 Generally, the utility will prompt for values unless --no-prompt has been set. When --no-prompt is specified, the values to be used are the default values, replaced with whatever options have been set on the command line. For example, weectl station create --driver='weewx.drivers.vantage' --no-prompt will cause the defaults to be used for all values except --driver . --dry-run \u00b6 With option --dry-run you can test what weect station would do without actually doing it. It will print out the steps, but not actually write anything.","title":"weectl station"},{"location":"utilities/weectl-station/#weectl-station","text":"Use the weectl subcommand station to manage the data for a station, including its configuration file. Specify --help to see the actions and options. See the section Options below for details of the various options.","title":"weectl station"},{"location":"utilities/weectl-station/#create-a-new-station-data-directory","text":"weectl station create [--driver=DRIVER] [--location=LOCATION] [--altitude=ALTITUDE,(foot|meter)] [--latitude=LATITUDE] [--longitude=LONGITUDE] [--register=(y,n) [--station-url=URL]] [--units=(us|metricwx|metric)] [--skin-root=DIRECTORY] [--sqlite-root=DIRECTORY] [--html-root=DIRECTORY] [--user-root=DIRECTORY] [--docs-root=DIRECTORY] [--examples-root=DIRECTORY] [--no-prompt] [--config=FILENAME] [--dist-config=FILENAME] [--dry-run] The create action will create a directory and populate it with station data. After the command completes, the directory will contain: a configuration file called weewx.conf ; documentation; examples; utility files; and skins. This action is typically used to create the initial station configuration when installing WeeWX for the first time. It can also be used to create configurations for multiple stations. If invoked without any options, the create action will prompt you for various settings, such as the type of hardware you are using, the station altitude and location, etc. Use the option --no-prompt to create a configuration without prompts. This will use settings specified as options, and default values for any setting not specified. This is useful when creating a station with an automated script. For example, weectl station create --no-prompt --driver=weewx.drivers.vantage \\ --altitude=\"400,foot\" --latitude=45.1 --longitude=-105.9 \\ --location=\"My Special Station\" will create a station with the indicated values. Default values will be used for any setting that is not specified.","title":"Create a new station data directory"},{"location":"utilities/weectl-station/#reconfigure-an-existing-station","text":"weectl station reconfigure [--driver=DRIVER] [--location=LOCATION] [--altitude=ALTITUDE,(foot|meter)] [--latitude=LATITUDE] [--longitude=LONGITUDE] [--register=(y,n) [--station-url=URL]] [--units=(us|metricwx|metric)] [--skin-root=DIRECTORY] [--sqlite-root=DIRECTORY] [--html-root=DIRECTORY] [--no-backup] [--no-prompt] [--config=FILENAME] [--dry-run] The reconfigure action will modify the contents of an existing configuration file. It is often used to change drivers. If invoked without any options, reconfigure will prompt you for settings. Use the option --no-prompt to reconfigure without prompts. This will use the settings specified as options, and existing values for anything that is not specified. For example, to keep all settings, but change to the Vantage driver you would use weectl station reconfigure --no-prompt --driver=weewx.drivers.vantage","title":"Reconfigure an existing station"},{"location":"utilities/weectl-station/#upgrade-an-existing-station","text":"weectl station upgrade [--docs-root=DIRECTORY] [--examples-root=DIRECTORY] [--skin-root=DIRECTORY] [--what (config|docs|examples|util|skins)] [--no-backup] [--no-prompt] [--config=FILENAME] [--dist-config=FILENAME] [--dry-run] When you upgrade WeeWX, only the code is upgraded; upgrades to WeeWX do not modify the station data, specifically configuration file, database, or skins. Use the upgrade action to upgrade one or more of these items. weectl station upgrade When invoked with no options, the upgrade action upgrades only the documentation, examples, and utility files. By default, the configuration file and skins are not upgraded. This is to avoid overwriting any changes you might have made. If you wish to upgrade the skins, you must specify --what skins . This will put the current version of the skins into WEEWX_ROOT , leaving timestamped copies of your old skins. weectl station upgrade --what skins If you wish to upgrade the configuration file, specify --what config . This is rarely necessary, since WeeWX is usually backward compatible. weectl station upgrade --what config","title":"Upgrade an existing station"},{"location":"utilities/weectl-station/#options","text":"In what follows, WEEWX_ROOT is the directory holding the configuration file. For a pip install, this is typically ~/weewx-data . For a Debian, Redhat, or SUSE install, it is /etc/weewx .","title":"Options"},{"location":"utilities/weectl-station/#-driverdriver","text":"Which driver to use. Default is weewx.drivers.simulator .","title":"--driver=DRIVER"},{"location":"utilities/weectl-station/#-locationlocation","text":"A description of your station, such as --location=\"A small town in Rongovia\" Default is WeeWX .","title":"--location=LOCATION"},{"location":"utilities/weectl-station/#-altitudealtitude","text":"The altitude of your station, along with the unit it is measured in. For example, --altitude=50,meter . Note that the unit is measured in the singular ( foot , not feet ). Default is \"0,foot\" .","title":"--altitude=ALTITUDE"},{"location":"utilities/weectl-station/#-latitudelatitude","text":"The station latitude in decimal degrees. Negative for the southern hemisphere. Default is 0 .","title":"--latitude=LATITUDE"},{"location":"utilities/weectl-station/#-longitudelongitude","text":"The station longitude in decimal degrees. Negative for the western hemisphere. Default is 0 .","title":"--longitude=LONGITUDE"},{"location":"utilities/weectl-station/#-registeryn","text":"Whether to include the station in the WeeWX registry and map . If you choose to register your station, you must also specify a unique URL for your station with option --station-url . Default is n (do not register).","title":"--register=(y|n)"},{"location":"utilities/weectl-station/#-station-urlurl","text":"A unique URL for the station. The station URL identifies each station in the WeeWX registry and map. Example: --station-url=https://www.wunderground.com/dashboard/pws/KNDPETE15 . No default.","title":"--station-url=URL"},{"location":"utilities/weectl-station/#-unitsunit_system","text":"What units to use for your reports. Options are us , metricwx , or metric . See the Appendix Units for details. Default is us .","title":"--units=UNIT_SYSTEM"},{"location":"utilities/weectl-station/#-configfilename","text":"Path to the configuration file, relative to WEEWX_ROOT . If the filename starts with a slash ( / ), it is an absolute path. Default is weewx.conf .","title":"--config=FILENAME"},{"location":"utilities/weectl-station/#-weewx-rootdir","text":"The WEEWX_ROOT directory. This is typically ~/weewx-data or /etc/weewx .","title":"--weewx-root=DIR"},{"location":"utilities/weectl-station/#-skin-rootdir","text":"The location of the directory holding the skins relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is skins .","title":"--skin-root=DIR"},{"location":"utilities/weectl-station/#-sqlite-rootdir","text":"The location of the directory holding the SQLite database relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is skins .","title":"--sqlite-root=DIR"},{"location":"utilities/weectl-station/#-html-rootdir","text":"Where generated HTML files should be placed, relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is public_html .","title":"--html-root=DIR"},{"location":"utilities/weectl-station/#-user-rootdir","text":"Where user extensions can be found, relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is bin/user .","title":"--user-root=DIR"},{"location":"utilities/weectl-station/#-docs-rootdir","text":"Where the WeeWX documentation can be found, relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is docs .","title":"--docs-root=DIR"},{"location":"utilities/weectl-station/#-examples-rootdir","text":"Where the WeeWX examples can be found, relative to WEEWX_ROOT . If the directory starts with a slash ( / ), it is an absolute path. Default is examples .","title":"--examples-root=DIR"},{"location":"utilities/weectl-station/#-what","text":"By default, the upgrade action will upgrade the documentation, examples, and utility files. However, you can specify exactly what gets upgraded by using the --what option. The --what option understands the following: config - the configuration file docs - the documentation examples - the example extensions util - the system utility files skins - the report templates For example, to upgrade the configuration file and skins only, you would specify weectl station upgrade --what config skins Note The --what option does not take an equal sign ( = ). Just list the desired things to be upgraded, without commas between them.","title":"--what"},{"location":"utilities/weectl-station/#-no-backup","text":"If weectl station changes your configuration file or skins, it will save a timestamped copy of the original. If you specify --no-backup , then it will not save a copy.","title":"--no-backup"},{"location":"utilities/weectl-station/#-no-prompt","text":"Generally, the utility will prompt for values unless --no-prompt has been set. When --no-prompt is specified, the values to be used are the default values, replaced with whatever options have been set on the command line. For example, weectl station create --driver='weewx.drivers.vantage' --no-prompt will cause the defaults to be used for all values except --driver .","title":"--no-prompt"},{"location":"utilities/weectl-station/#-dry-run","text":"With option --dry-run you can test what weect station would do without actually doing it. It will print out the steps, but not actually write anything.","title":"--dry-run"},{"location":"utilities/weewxd/","text":"weewxd \u00b6 The weewxd application is the heart of WeeWX. It collects data from hardware, processes the data, archives the data, then generates reports from the data. It can be run directly, or in the background as a daemon. When it is run directly, weewxd emits LOOP and ARCHIVE data to stdout. Specify --help to see how it is used: weewxd --help Usage: weewxd --help weewxd --version weewxd [CONFIG_FILE|--config=CONFIG_FILE] [--daemon] [--pidfile=PIDFILE] [--exit] [--loop-on-init] [--log-label=LABEL] Entry point to the weewx weather program. Can be run directly, or as a daemon by specifying the '--daemon' option. Arguments: CONFIG_FILE: The weewx configuration file to be used. Optional. Options: -h, --help show this help message and exit --config=CONFIG_FILE Use configuration file CONFIG_FILE. -d, --daemon Run as a daemon -p PIDFILE, --pidfile=PIDFILE Store the process ID in PIDFILE -v, --version Display version number then exit -x, --exit Exit on I/O and database errors instead of restarting -r, --loop-on-init Retry forever if device is not ready on startup -n LABEL, --log-label=LABEL Label to use in syslog entries Note that options --daemon and --pidfile are not necessary when running under systemd.","title":"weewxd"},{"location":"utilities/weewxd/#weewxd","text":"The weewxd application is the heart of WeeWX. It collects data from hardware, processes the data, archives the data, then generates reports from the data. It can be run directly, or in the background as a daemon. When it is run directly, weewxd emits LOOP and ARCHIVE data to stdout. Specify --help to see how it is used: weewxd --help Usage: weewxd --help weewxd --version weewxd [CONFIG_FILE|--config=CONFIG_FILE] [--daemon] [--pidfile=PIDFILE] [--exit] [--loop-on-init] [--log-label=LABEL] Entry point to the weewx weather program. Can be run directly, or as a daemon by specifying the '--daemon' option. Arguments: CONFIG_FILE: The weewx configuration file to be used. Optional. Options: -h, --help show this help message and exit --config=CONFIG_FILE Use configuration file CONFIG_FILE. -d, --daemon Run as a daemon -p PIDFILE, --pidfile=PIDFILE Store the process ID in PIDFILE -v, --version Display version number then exit -x, --exit Exit on I/O and database errors instead of restarting -r, --loop-on-init Retry forever if device is not ready on startup -n LABEL, --log-label=LABEL Label to use in syslog entries Note that options --daemon and --pidfile are not necessary when running under systemd.","title":"weewxd"}]}